"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[510],{4407:(e,t,s)=>{s.d(t,{$3d:()=>rs,$Df:()=>O,$fg:()=>sY,B2n:()=>tt,C6T:()=>eg,DuZ:()=>tJ,FAi:()=>rr,HDx:()=>rv,Huc:()=>rI,Iw$:()=>eI,J_l:()=>iW,Jc4:()=>p,KHI:()=>h,Kcj:()=>s1,Lxh:()=>iS,M0F:()=>ex,M0V:()=>a,MZ5:()=>c,N3o:()=>f,NOY:()=>sN,NlN:()=>ec,O$F:()=>rS,O4E:()=>el,OmU:()=>tz,Oou:()=>sk,Owx:()=>ry,P_Y:()=>th,PaW:()=>so,Pk2:()=>sj,QJ7:()=>X,R4S:()=>eR,RRp:()=>eA,RXf:()=>id,SFZ:()=>tQ,TBw:()=>iX,Tgl:()=>e2,TxK:()=>eb,UeC:()=>rD,UhN:()=>rL,W0u:()=>tp,WJX:()=>sR,WPR:()=>o,X96:()=>td,XK0:()=>sG,Y$0:()=>ew,Y5o:()=>I,Z3h:()=>ib,Z8:()=>e3,ZTd:()=>rt,Ziu:()=>m,ZtL:()=>rO,_dh:()=>ev,_l3:()=>sD,a5w:()=>rE,a9e:()=>sJ,bWe:()=>eZ,cO1:()=>eS,cR1:()=>ek,cpr:()=>ia,diq:()=>G,eiX:()=>rd,ewP:()=>sT,fQ5:()=>iF,fq5:()=>tr,ft3:()=>st,hE1:()=>E,iCy:()=>te,iQo:()=>t5,i_6:()=>sZ,ick:()=>rg,jkJ:()=>eE,klW:()=>eQ,kqv:()=>iC,lIY:()=>iG,lSA:()=>eh,lW8:()=>ir,l_V:()=>rp,lf0:()=>ss,nzy:()=>tc,oAg:()=>e6,opu:()=>e7,ot0:()=>iz,pzx:()=>eB,qFp:()=>sb,qMN:()=>eN,qxL:()=>iO,rcl:()=>eL,sHc:()=>er,sMc:()=>ej,tPW:()=>sC,tSj:()=>e1,tmC:()=>eW,vNH:()=>tU,vaN:()=>ef,vm4:()=>eV,voZ:()=>io,wmZ:()=>sL,xWj:()=>sI,xiH:()=>eD,zes:()=>sq});class i{static isAvailable(){return"undefined"!=typeof window}static isFileReaderAvailable(){return!!i.isAvailable()&&!!window.FileReader}static getLocation(){if(i.isAvailable())return window.location}static getVisualViewport(){return i.isAvailable()?window.visualViewport:null}static getInnerWidth(){if(i.isAvailable())return window.innerWidth}static getInnerHeight(){return i.isAvailable()?window.innerHeight:null}static getWindow(){if(i.isAvailable())return window}static hasOwn(e){if(i.isAvailable())return e in window}static getSelection(){if(i.isAvailable()&&window.getSelection)return window.getSelection()}static requestAnimationFrame(e){if(i.isAvailable())return window.requestAnimationFrame(e)}static addEventListener(e,t){i.isAvailable()&&window.addEventListener(e,t)}static removeEventListener(e,t){i.isAvailable()&&window.removeEventListener(e,t)}static matchMedia(e){return i.isAvailable()&&void 0!==window.matchMedia?window.matchMedia(e):null}}class r{static isAvailable(){return"undefined"!=typeof document}static getBody(){if(r.isAvailable())return document.body}static getDocumentElement(){if(r.isAvailable())return document.documentElement}static getDocument(){if(r.isAvailable())return document}static getCookie(){if(r.isAvailable())return document.cookie}static setCookie(e){r.isAvailable()&&(document.cookie=e)}static activeElementBlur(){if(!r.isAvailable())return;let e=document.activeElement;e&&e.blur&&e.blur()}static createElement(e){if(r.isAvailable())return document.createElement(e)}static getComputedStyle(e){return r.isAvailable()?document.defaultView.getComputedStyle(e):new CSSStyleDeclaration}static addEventListener(e,t){r.isAvailable()&&document.addEventListener(e,t)}static removeEventListener(e,t){r.isAvailable()&&document.removeEventListener(e,t)}}function n(e,t){var s;if(!t)return new Date;tp.storeUtcDates||"string"!=typeof t||(s=t).indexOf("T")>0||!/\d{4}-\d{2}-\d{2}/.test(s)||isNaN(new Date(s).getTime())||(t+="T00:00:00");let i=new Date(t);return tp.onDateCreated(i,e,t)}class a{static isValueEmpty(e){if(Array.isArray(e)&&0===e.length)return!0;if(e&&a.isValueObject(e)&&e.constructor===Object){for(var t in e)if(!a.isValueEmpty(e[t]))return!1;return!0}return!e&&0!==e&&!1!==e}static isValueUndefined(e){return null==e||"number"==typeof e&&isNaN(e)}static isArrayContainsEqual(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var s=0;s<e.length;s++){for(var i=0;i<t.length&&!a.isTwoValueEquals(e[s],t[i]);i++);if(i===t.length)return!1}return!0}static isArraysEqual(e,t,s=!1,i,r){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;if(s){for(var n=[],o=[],l=0;l<e.length;l++)n.push(e[l]),o.push(t[l]);n.sort(),o.sort(),e=n,t=o}for(var l=0;l<e.length;l++)if(!a.isTwoValueEquals(e[l],t[l],s,i,r))return!1;return!0}static compareStrings(e,t){let s=tp.comparator.normalizeTextCallback;if(e&&(e=s(e,"compare").trim()),t&&(t=s(t,"compare").trim()),!e&&!t)return 0;if(!e)return -1;if(!t)return 1;if(e===t)return 0;let i=-1;for(let s=0;s<e.length&&s<t.length;s++){if(this.isCharDigit(e[s])&&this.isCharDigit(t[s])){i=s;break}if(e[s]!==t[s])break}if(i>-1){let s=this.getNumberFromStr(e,i),r=this.getNumberFromStr(t,i);if(!Number.isNaN(s)&&!Number.isNaN(r)&&s!==r)return s>r?1:-1}return e>t?1:-1}static isTwoValueEquals(e,t,s=!1,i,r){if(e===t||Array.isArray(e)&&0===e.length&&void 0===t||Array.isArray(t)&&0===t.length&&void 0===e||null==e&&""===t||null==t&&""===e)return!0;if(void 0===r&&(r=tp.comparator.trimStrings),void 0===i&&(i=tp.comparator.caseSensitive),"string"==typeof e&&"string"==typeof t){let s=tp.comparator.normalizeTextCallback;return e=s(e,"compare"),t=s(t,"compare"),r&&(e=e.trim(),t=t.trim()),i||(e=e.toLowerCase(),t=t.toLowerCase()),e===t}if(e instanceof Date&&t instanceof Date)return e.getTime()==t.getTime();if(a.isConvertibleToNumber(e)&&a.isConvertibleToNumber(t)&&parseInt(e)===parseInt(t)&&parseFloat(e)===parseFloat(t))return!0;if(!a.isValueEmpty(e)&&a.isValueEmpty(t)||a.isValueEmpty(e)&&!a.isValueEmpty(t))return!1;if((!0===e||!1===e)&&"string"==typeof t)return e.toString()===t.toLocaleLowerCase();if((!0===t||!1===t)&&"string"==typeof e)return t.toString()===e.toLocaleLowerCase();if(!a.isValueObject(e)&&!a.isValueObject(t))return e==t;if(!a.isValueObject(e)||!a.isValueObject(t))return!1;if(e.equals&&t.equals)return e.equals(t);if(Array.isArray(e)&&Array.isArray(t))return a.isArraysEqual(e,t,s,i,r);for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||!this.isTwoValueEquals(e[n],t[n],s,i,r)))return!1;for(n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}static randomizeArray(e){for(var t=e.length-1;t>0;t--){var s=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[s],e[s]=i}return e}static getUnbindValue(e){if(Array.isArray(e)){let t=[];for(let s=0;s<e.length;s++)t.push(a.getUnbindValue(e[s]));return t}return e&&a.isValueObject(e)&&!(e instanceof Date)?JSON.parse(JSON.stringify(e)):e}static createCopy(e){var t={};if(!e)return t;for(var s in e)t[s]=e[s];return t}static isConvertibleToNumber(e){return null!=e&&!Array.isArray(e)&&!isNaN(e)}static isValueObject(e,t){return e instanceof Object&&(!t||!Array.isArray(e))}static isNumber(e){return!isNaN(this.getNumber(e))}static getNumber(e){let t=a.getNumberCore(e);return tp.parseNumber(e,t)}static getNumberCore(e){if("string"==typeof e){if(!(e=e.trim()))return NaN;if(0==e.indexOf("0x"))return e.length>32?NaN:parseInt(e);if(e.length>15&&a.isDigitsOnly(e)||a.isStringHasOperator(e))return NaN}let t=parseFloat(e=this.prepareStringToNumber(e));return isNaN(t)||!isFinite(e)?NaN:t}static isStringHasOperator(e){if(e.lastIndexOf("-")>0||e.lastIndexOf("+")>0)return!1;let t="*^/%";for(let s=0;s<t.length;s++)if(e.indexOf(t[s])>-1)return!0;return!1}static prepareStringToNumber(e){if("string"!=typeof e||!e)return e;let t=e.indexOf(",");return t>-1&&0>e.indexOf(",",t+1)?e.replace(",","."):e}static getMaxLength(e,t){return e<0&&(e=t),e>0?e:null}static getRemainingCharacterCounterText(e,t){return t&&!(t<=0)&&tp.showMaxLengthIndicator?[e?e.length:"0",t].join("/"):""}static getNumberByIndex(e,t,s){if(e<0)return"";var i=1,r="",n=".",o=!0,l="A",h="";let u=e=>{if(!e)return!1;for(var t=0;t<e.length;t++)if(a.isCharDigit(e[t]))return!0;return!1};if(t){for(var d=(h=t).length-1,c=u(h),g=function(){return c&&!a.isCharDigit(h[d])||a.isCharNotLetterAndDigit(h[d])};d>=0&&g();)d--;var p="";for(d<h.length-1&&(p=h.substring(d+1),h=h.substring(0,d+1)),d=h.length-1;d>=0&&!g()&&(d--,c););l=h.substring(d+1),r=h.substring(0,d+1),parseInt(l)?i=parseInt(l):1==l.length&&(o=!1),(p||r)&&(n=p)}if(s>-1&&u(r)&&(r=this.getNumberByIndex(s,r)),o){let t=(e+i).toString();for(;t.length<l.length;)t="0"+t;return r+t+n}return r+String.fromCharCode(l.charCodeAt(0)+e)+n}static isCharNotLetterAndDigit(e){return e.toUpperCase()==e.toLowerCase()&&!a.isCharDigit(e)}static isCharDigit(e){return e>="0"&&e<="9"}static isDigitsOnly(e){if(!e)return!1;for(let t=0;t<e.length;t++)if(!a.isCharDigit(e[t]))return!1;return!0}static getNumberFromStr(e,t){if(!this.isCharDigit(e[t]))return NaN;let s="";for(;t<e.length&&this.isCharDigit(e[t]);)s+=e[t],t++;return s?this.getNumber(s):NaN}static countDecimals(e){if(a.isNumber(e)&&Math.floor(e)!==e){let t=e.toString().split(".");return t.length>1&&t[1].length||0}return 0}static correctAfterPlusMinis(e,t,s){let i=a.countDecimals(e),r=a.countDecimals(t);if(i>0||r>0){let e=Math.max(i,r);s=parseFloat(s.toFixed(e))}return s}static sumAnyValues(e,t){if(!a.isNumber(e)||!a.isNumber(t)){if(Array.isArray(e)&&Array.isArray(t))return[].concat(e).concat(t);if(Array.isArray(e)||Array.isArray(t)){let i=Array.isArray(e)?e:t,r=i===e?t:e;if("string"==typeof r){let t=i.join(", ");return i===e?t+r:r+t}if("number"==typeof r){let e=0;for(var s=0;s<i.length;s++)"number"==typeof i[s]&&(e=a.correctAfterPlusMinis(e,i[s],e+i[s]));return a.correctAfterPlusMinis(e,r,e+r)}}return e+t}return"string"==typeof e||"string"==typeof t?e+t:a.correctAfterPlusMinis(e,t,e+t)}static correctAfterMultiple(e,t,s){let i=a.countDecimals(e)+a.countDecimals(t);return i>0&&(s=parseFloat(s.toFixed(i))),s}static convertArrayValueToObject(e,t,s){let i=[];if(!e||!Array.isArray(e))return i;for(var r=0;r<e.length;r++){let n;Array.isArray(s)&&(n=a.findObjByPropValue(s,t,e[r])),n||((n={})[t]=e[r]),i.push(n)}return i}static findObjByPropValue(e,t,s){for(var i=0;i<e.length;i++)if(a.isTwoValueEquals(e[i][t],s))return e[i]}static convertArrayObjectToValue(e,t){let s=[];if(!e||!Array.isArray(e))return s;for(var i=0;i<e.length;i++){let r=e[i]?e[i][t]:void 0;a.isValueEmpty(r)||s.push(r)}return s}static convertDateToString(e){let t=e=>e<10?"0"+e.toString():e.toString();return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}static convertDateTimeToString(e){let t=e=>e<10?"0"+e.toString():e.toString();return this.convertDateToString(e)+" "+t(e.getHours())+":"+t(e.getMinutes())}static convertValToQuestionVal(e,t){return e instanceof Date?"datetime-local"===t?a.convertDateTimeToString(e):a.convertDateToString(e):this.getUnbindValue(e)}static compareVerions(e,t){if(!e&&!t)return 0;let s=e.split("."),i=t.split("."),r=s.length,n=i.length;for(let e=0;e<r&&e<n;e++){let t=s[e],r=i[e];if(t.length!==r.length)return t.length<r.length?-1:1;if(t!==r)return t<r?-1:1}return r===n?0:r<n?-1:1}static isUrlYoutubeVideo(e){if(!e)return!1;let t=["www.youtube.com","m.youtube.com","youtube.com","youtu.be"];e=(e=e.toLowerCase()).replace(/^https?:\/\//,"");for(let s=0;s<t.length;s++)if(0===e.indexOf(t[s]+"/"))return!0;return!1}}String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,s){return void 0!==e[s]?e[s]:t})});var o,l,h={currentLocaleValue:"",defaultLocaleValue:"en",locales:{},localeNames:{},localeNamesInEnglish:{},localeDirections:{},supportedLocales:[],useEnglishNames:!1,get showNamesInEnglish(){return this.useEnglishNames},set showNamesInEnglish(val){this.useEnglishNames=val},setupLocale(e){let t=e.localeCode;this.locales[t]=e.strings,this.localeNames[t]=e.nativeName,this.localeNamesInEnglish[t]=e.englishName,void 0!==e.rtl&&(this.localeDirections[t]=e.rtl)},get currentLocale(){return this.currentLocaleValue===this.defaultLocaleValue?"":this.currentLocaleValue},set currentLocale(val){"cz"===val&&(val="cs"),this.currentLocaleValue=val},get defaultLocale(){return this.defaultLocaleValue},set defaultLocale(val){"cz"===val&&(val="cs"),this.defaultLocaleValue=val},getLocaleStrings(e){return this.locales[e]},getString:function(e,t=null){let s=[],i=e=>{let t=this.locales[e];t&&s.push(t)},r=e=>{if(!e)return;i(e);let t=e.indexOf("-");t<1||i(e=e.substring(0,t))};r(t),r(this.currentLocale),r(this.defaultLocale),"en"!==this.defaultLocale&&i("en");for(let t=0;t<s.length;t++){let i=s[t][e];if(void 0!==i)return i}return this.onGetExternalString(e,t)},getLocaleName(e,t){if(!e)return"";void 0===t&&(t=this.showNamesInEnglish);let s=t?this.localeNamesInEnglish:this.localeNames,i=t?this.localeNames:this.localeNamesInEnglish;return s[e]||i[e]||e},getLocales:function(e=!1){var t=[];t.push("");var s=this.locales;if(this.supportedLocales&&this.supportedLocales.length>0){s={};for(var i=0;i<this.supportedLocales.length;i++)s[this.supportedLocales[i]]=!0}for(var r in s)e&&r==this.defaultLocale||t.push(r);var n=e=>this.getLocaleName(e).toLowerCase();return t.sort((e,t)=>{var s=n(e),i=n(t);return s===i?0:s<i?-1:1}),t},onGetExternalString:function(e,t){}};function u(e,t=null){return h.getString(e,t)}function d(e,t,s){let i=e.getLocalizableString(s);if(!i){let r;"object"==typeof t.localizable&&t.localizable.defaultStr&&(r=t.localizable.defaultStr),i=e.createLocalizableString(s,e,!0,r),"object"==typeof t.localizable&&"function"==typeof t.localizable.onGetTextCallback&&(i.onGetTextCallback=t.localizable.onGetTextCallback)}}function c(e={}){return function(t,s){let i=(e,t)=>{if(t&&"object"==typeof t&&t.type===ec.ComputedUpdaterType){eg.startCollectDependencies(()=>e[s]=t.updater(),e,s);let i=t.updater(),r=eg.finishCollectDependencies();return t.setDependencies(r),e.dependencies[s]&&e.dependencies[s].dispose(),e.dependencies[s]=t,i}return t};e&&e.localizable?(Object.defineProperty(t,s,{get:function(){return function(e,t,s){d(e,t,s);let i=e.getLocalizableStringText(s);if(i)return i;if("object"==typeof t.localizable&&t.localizable.defaultStr){let s=e.getLocale?e.getLocale():"";return u(t.localizable.defaultStr,s)}return""}(this,e,s)},set:function(t){d(this,e,s);let r=i(this,t);this.setLocalizableStringText(s,r),e&&e.onSet&&e.onSet(r,this)}}),Object.defineProperty(t,"object"==typeof e.localizable&&e.localizable.name?e.localizable.name:"loc"+s.charAt(0).toUpperCase()+s.slice(1),{get:function(){return d(this,e,s),this.getLocalizableString(s)}})):Object.defineProperty(t,s,{get:function(){let t=null;return e&&("function"==typeof e.getDefaultValue&&(t=e.getDefaultValue(this)),void 0!==e.defaultValue&&(t=e.defaultValue)),this.getPropertyValue(s,t)},set:function(t){let r=i(this,t),n=this.getPropertyValue(s);r!==n&&(this.setPropertyValue(s,r),e&&e.onSet&&e.onSet(r,this,n))}})}}function g(e,t,s){e.ensureArray(s,(s,i)=>{let r=t?t.onPush:null;r&&r(s,i,e)},(s,i)=>{let r=t?t.onRemove:null;r&&r(s,i,e)})}function p(e){return function(t,s){Object.defineProperty(t,s,{get:function(){return g(this,e,s),this.getPropertyValue(s)},set:function(t){g(this,e,s);let i=this.getPropertyValue(s);t!==i&&(i?i.splice(0,i.length,...t||[]):this.setPropertyValue(s,t),e&&e.onSet&&e.onSet(t,this))}})}}h.locales.en={pagePrevText:"Previous",pageNextText:"Next",completeText:"Complete",previewText:"Preview",editText:"Edit",startSurveyText:"Start",otherItemText:"Other (describe)",noneItemText:"None",refuseItemText:"Refuse to answer",dontKnowItemText:"Don't know",selectAllItemText:"Select All",deselectAllItemText:"Deselect all",progressText:"Page {0} of {1}",indexText:"{0} of {1}",panelDynamicProgressText:"{0} of {1}",panelDynamicTabTextFormat:"Panel {panelIndex}",questionsProgressText:"Answered {0}/{1} questions",emptySurvey:"The survey doesn't contain any visible elements.",completingSurvey:"Thank you for completing the survey",completingSurveyBefore:"You have already completed this survey.",loadingSurvey:"Loading Survey...",placeholder:"Select...",ratingOptionsCaption:"Select...",value:"value",requiredError:"Response required.",requiredErrorInPanel:"Response required: answer at least one question.",requiredInAllRowsError:"Response required: answer questions in all rows.",eachRowUniqueError:"Each row must have a unique value.",numericError:"The value should be numeric.",minError:"The value should not be less than {0}",maxError:"The value should not be greater than {0}",textNoDigitsAllow:"Numbers are not allowed.",textMinLength:"Please enter at least {0} character(s).",textMaxLength:"Please enter no more than {0} character(s).",textMinMaxLength:"Please enter at least {0} and no more than {1} characters.",minRowCountError:"Please fill in at least {0} row(s).",minSelectError:"Please select at least {0} option(s).",maxSelectError:"Please select no more than {0} option(s).",numericMinMax:"The '{0}' should be at least {1} and at most {2}",numericMin:"The '{0}' should be at least {1}",numericMax:"The '{0}' should be at most {1}",invalidEmail:"Please enter a valid e-mail address.",invalidExpression:"The expression: {0} should return 'true'.",urlRequestError:"The request returned error '{0}'. {1}",urlGetChoicesError:"The request returned empty data or the 'path' property is incorrect",exceedMaxSize:"The file size should not exceed {0}.",noUploadFilesHandler:"Files cannot be uploaded. Please add a handler for the 'onUploadFiles' event.",otherRequiredError:"Response required: enter another value.",uploadingFile:"Your file is uploading. Please wait several seconds and try again.",loadingFile:"Loading...",chooseFile:"Choose file(s)...",noFileChosen:"No file selected",filePlaceholder:"Drag and drop a file here or click the button below to select a file to upload.",confirmDelete:"Are you sure you want to delete this record?",keyDuplicationError:"This value should be unique.",addColumn:"Add Column",addRow:"Add Row",removeRow:"Remove",noRowsText:"There are no rows.",addPanel:"Add new",removePanel:"Remove",showDetails:"Show Details",hideDetails:"Hide Details",choices_Item:"item",choices_Choice:"Choice option",matrix_column:"Column",matrix_row:"Row",multipletext_itemname:"text",savingData:"The results are being saved on the server...",savingDataError:"An error occurred and we could not save the results.",savingDataSuccess:"The results were saved successfully!",savingExceedSize:"Your response exceeds 64KB. Please reduce the size of your file(s) and try again or contact the survey owner.",saveAgainButton:"Try again",timerMin:"min",timerSec:"sec",timerSpentAll:"You have spent {0} on this page and {1} in total.",timerSpentPage:"You have spent {0} on this page.",timerSpentSurvey:"You have spent {0} in total.",timerLimitAll:"You have spent {0} of {1} on this page and {2} of {3} in total.",timerLimitPage:"You have spent {0} of {1} on this page.",timerLimitSurvey:"You have spent {0} of {1} in total.",clearCaption:"Clear",signaturePlaceHolder:"Sign here",signaturePlaceHolderReadOnly:"No signature",chooseFileCaption:"Select File",takePhotoCaption:"Take Photo",photoPlaceholder:"Click the button below to take a photo using the camera.",fileOrPhotoPlaceholder:"Drag and drop or select a file to upload or take a photo using the camera.",replaceFileCaption:"Replace file",removeFileCaption:"Remove this file",booleanCheckedLabel:"Yes",booleanUncheckedLabel:"No",confirmRemoveFile:"Are you sure that you want to remove this file: {0}?",confirmRemoveAllFiles:"Are you sure that you want to remove all files?",questionTitlePatternText:"Question Title",modalCancelButtonText:"Cancel",modalApplyButtonText:"Apply",filterStringPlaceholder:"Type to search...",emptyMessage:"No data to display",noEntriesText:"No entries yet.\nClick the button below to add a new entry.",noEntriesReadonlyText:"No entries",tabTitlePlaceholder:"New Panel",more:"More",tagboxDoneButtonCaption:"OK",selectToRankEmptyRankedAreaText:"All choices are selected for ranking",selectToRankEmptyUnrankedAreaText:"Drag choices here to rank them",ok:"OK",cancel:"Cancel"},h.localeNames.en="english";class m{constructor(e,t,s=!1){this.name=t,this.isRequiredValue=!1,this.isUniqueValue=!1,this.isSerializable=!0,this.isLightSerializable=!0,this.isCustom=!1,this.isDynamicChoices=!1,this.isBindable=!1,this.category="",this.categoryIndex=-1,this.visibleIndex=-1,this.maxLength=-1,this.isArray=!1,this.classInfoValue=e,this.isRequiredValue=s,this.idValue=m.Index++}get id(){return this.idValue}get classInfo(){return this.classInfoValue}get type(){return this.typeValue?this.typeValue:"string"}set type(e){"itemvalues"===e&&(e="itemvalue[]"),"textitems"===e&&(e="textitem[]"),this.typeValue=e,this.typeValue.indexOf("[]")===this.typeValue.length-2&&(this.isArray=!0,this.className=this.typeValue.substring(0,this.typeValue.length-2))}get locationInTable(){return this.locationInTableValue||"both"}set locationInTable(e){"both"===e&&(e=void 0),this.locationInTableValue=e}get showMode(){let e=this.locationInTable;return"detail"===e?"form":"column"===e?"list":""}set showMode(e){this.locationInTable="form"===e?"detail":"list"===e?"column":void 0}get isRequired(){return this.isRequiredValue}set isRequired(e){e!==this.isRequired&&(this.isRequiredValue=e,this.classInfo&&this.classInfo.resetAllProperties())}get isUnique(){return this.isUniqueValue}set isUnique(e){this.isUniqueValue=e}get uniquePropertyName(){return this.uniquePropertyValue}set uniquePropertyName(e){this.uniquePropertyValue=e}isPropertySerializable(e){return this.isSerializableFunc?this.isSerializableFunc(e):this.isSerializable}getDefaultValue(e){let t=this.defaultValueFunc?this.defaultValueFunc(e):this.defaultValueValue;return m.getItemValuesDefaultValue&&E.isDescendantOf(this.className,"itemvalue")&&(t=m.getItemValuesDefaultValue(this.defaultValueValue||[],this.className)),t}get defaultValue(){return this.getDefaultValue(void 0)}set defaultValue(e){this.defaultValueValue=e}isDefaultValue(e){return this.isDefaultValueByObj(void 0,e)}isDefaultValueByObj(e,t){if(this.isLocalizable)return null==t;let s=this.getDefaultValue(e);return void 0!==s?"object"!=typeof s?s===t:a.isTwoValueEquals(t,s,!1,!0,!1):!1===t&&("boolean"==this.type||"switch"==this.type)&&!this.defaultValueFunc||""===t||a.isValueEmpty(t)}getSerializableValue(e,t){if(this.onSerializeValue)return this.onSerializeValue(e);let s=this.getValue(e);if(null!=s&&!(!t&&this.isDefaultValueByObj(e,s)))return s}getValue(e){return this.onGetValue?(e=this.getOriginalObj(e),this.onGetValue(e)):this.serializationProperty&&e[this.serializationProperty]?e[this.serializationProperty].getJson():e[this.name]}getPropertyValue(e){return this.isLocalizable?e[this.serializationProperty]?e[this.serializationProperty].text:null:this.getValue(e)}get hasToUseSetValue(){return this.onSetValue||this.serializationProperty}settingValue(e,t){return!this.onSettingValue||e.isLoadingFromJson?t:this.onSettingValue(e,t)}setValue(e,t,s){this.onSetValue?(e=this.getOriginalObj(e),this.onSetValue(e,t,s)):this.serializationProperty&&e[this.serializationProperty]?e[this.serializationProperty].setJson(t,!0):(t&&"string"==typeof t&&("number"==this.type&&(t=parseInt(t)),("boolean"==this.type||"switch"==this.type)&&(t="true"===t.toLowerCase())),e[this.name]=t)}validateValue(e){let t=this.choices;return!Array.isArray(t)||0===t.length||t.indexOf(e)>-1}getObjType(e){return this.classNamePart?e.replace(this.classNamePart,""):e}get choices(){return this.getChoices(null)}get hasChoices(){return!!this.choicesValue||!!this.choicesfunc}getChoices(e,t=null){return null!=this.choicesValue?this.choicesValue:null!=this.choicesfunc?this.choicesfunc(e,t):null}setChoices(e,t=null){this.choicesValue=e,this.choicesfunc=t}getBaseValue(){return this.baseValue?"function"==typeof this.baseValue?this.baseValue():this.baseValue:""}setBaseValue(e){this.baseValue=e}get readOnly(){return null!=this.readOnlyValue&&this.readOnlyValue}set readOnly(e){this.readOnlyValue=e}isEnable(e){return!this.readOnly&&(!e||!this.enableIf||this.enableIf(this.getOriginalObj(e)))}isVisible(e,t=null){let s=!this.layout||!e||this.layout===e;return!!this.visible&&!!s&&(!this.visibleIf||!t||this.visibleIf(this.getOriginalObj(t)))}getOriginalObj(e){if(e&&e.getOriginalObj){let t=e.getOriginalObj();if(t&&E.findProperty(t.getType(),this.name))return t}return e}get visible(){return null==this.visibleValue||this.visibleValue}set visible(e){this.visibleValue=e}isAvailableInVersion(e){return!!this.alternativeName||!!this.oldName||this.isAvailableInVersionCore(e)}getSerializedName(e){return this.alternativeName?this.isAvailableInVersionCore(e)?this.name:this.alternativeName||this.oldName:this.name}getSerializedProperty(e,t){return!this.oldName||this.isAvailableInVersionCore(t)?this:e&&e.getType?E.findProperty(e.getType(),this.oldName):null}isAvailableInVersionCore(e){return!e||!this.version||0>=a.compareVerions(this.version,e)}get isLocalizable(){return null!=this.isLocalizableValue&&this.isLocalizableValue}set isLocalizable(e){this.isLocalizableValue=e}get dataList(){return Array.isArray(this.dataListValue)?this.dataListValue:[]}set dataList(e){this.dataListValue=e}mergeWith(e){for(var t=m.mergableValues,s=0;s<t.length;s++)this.mergeValue(e,t[s])}addDependedProperty(e){this.dependedProperties||(this.dependedProperties=[]),0>this.dependedProperties.indexOf(e)&&this.dependedProperties.push(e)}getDependedProperties(){return this.dependedProperties?this.dependedProperties:[]}schemaType(){if("choicesByUrl"!==this.className)return"string"===this.className?this.className:this.className||this.baseClassName?"array":"switch"==this.type?"boolean":"boolean"==this.type||"number"==this.type?this.type:"string"}schemaRef(){if(this.className)return this.className}mergeValue(e,t){null==this[t]&&null!=e[t]&&(this[t]=e[t])}}m.Index=1,m.mergableValues=["typeValue","choicesValue","baseValue","readOnlyValue","visibleValue","isSerializable","isLightSerializable","isCustom","isBindable","isUnique","uniquePropertyName","isDynamicChoices","isLocalizableValue","className","alternativeName","oldName","layout","version","classNamePart","baseClassName","defaultValue","defaultValueFunc","serializationProperty","onGetValue","onSetValue","onSettingValue","displayName","category","categoryIndex","visibleIndex","nextToProperty","overridingProperty","locationInTable","dependedProperties","visibleIf","enableIf","onExecuteExpression","onPropertyEditorUpdate","maxLength","maxValue","minValue","dataListValue"];class v{static addProperty(e,t){e=e.toLowerCase();var s=v.properties;s[e]||(s[e]=[]),s[e].push(t)}static removeProperty(e,t){e=e.toLowerCase();var s=v.properties;if(s[e]){for(var i=s[e],r=0;r<i.length;r++)if(i[r].name==t){s[e].splice(r,1);break}}}static removeAllProperties(e){e=e.toLowerCase(),delete v.properties[e]}static addClass(e,t){e=e.toLowerCase(),t&&(t=t.toLowerCase()),v.parentClasses[e]=t}static getProperties(e){e=e.toLowerCase();for(var t=[],s=v.properties;e;){var i=s[e];if(i)for(var r=0;r<i.length;r++)t.push(i[r]);e=v.parentClasses[e]}return t}static createProperties(e){e&&e.getType&&v.createPropertiesCore(e,e.getType())}static createPropertiesCore(e,t){var s=v.properties;s[t]&&v.createPropertiesInObj(e,s[t]);var i=v.parentClasses[t];i&&v.createPropertiesCore(e,i)}static createPropertiesInObj(e,t){for(var s=0;s<t.length;s++)v.createPropertyInObj(e,t[s])}static createPropertyInObj(e,t){if(!v.checkIsPropertyExists(e,t.name)&&!(t.serializationProperty&&v.checkIsPropertyExists(e,t.serializationProperty))){if(t.isLocalizable&&t.serializationProperty&&e.createCustomLocalizableObj){e.createCustomLocalizableObj(t.name).defaultValue=t.getDefaultValue(e),Object.defineProperty(e,t.serializationProperty,{get:function(){return e.getLocalizableString(t.name)}});var s={get:function(){return e.getLocalizableStringText(t.name)},set:function(s){e.setLocalizableStringText(t.name,s)}};Object.defineProperty(e,t.name,s)}else{var i=t.isArray||"multiplevalues"===t.type;if("function"==typeof e.createNewArray&&(E.isDescendantOf(t.className,"itemvalue")?(e.createNewArray(t.name,function(s){s.locOwner=e,s.ownerPropertyName=t.name}),i=!0):i&&e.createNewArray(t.name),i)){let s=t.getDefaultValue(e);Array.isArray(s)&&e.setPropertyValue(t.name,s)}if(e.getPropertyValue&&e.setPropertyValue){var s={get:()=>t.onGetValue?t.onGetValue(e):e.getPropertyValue(t.name,void 0),set:function(s){t.onSetValue?t.onSetValue(e,s,null):e.setPropertyValue(t.name,s)}};Object.defineProperty(e,t.name,s)}}("condition"===t.type||"expression"===t.type)&&t.onExecuteExpression&&e.addExpressionProperty(t.name,t.onExecuteExpression)}}static checkIsPropertyExists(e,t){return e.hasOwnProperty(t)||e[t]}}v.properties={},v.parentClasses={};class y{constructor(e,t,s=null,i=null){this.name=e,this.creator=s,this.parentName=i,e=e.toLowerCase(),this.isCustomValue=!s&&"survey"!==e,this.parentName&&(this.parentName=this.parentName.toLowerCase(),v.addClass(e,this.parentName),s&&this.makeParentRegularClass()),this.properties=[];for(var r=0;r<t.length;r++)this.createProperty(t[r],this.isCustom)}find(e){for(var t=0;t<this.properties.length;t++)if(this.properties[t].name==e)return this.properties[t];return null}findProperty(e){return this.fillAllProperties(),this.hashProperties[e]}getAllProperties(){return this.fillAllProperties(),this.allProperties}getRequiredProperties(){if(this.requiredProperties)return this.requiredProperties;this.requiredProperties=[];let e=this.getAllProperties();for(let t=0;t<e.length;t++)e[t].isRequired&&this.requiredProperties.push(e[t]);return this.requiredProperties}resetAllProperties(){this.allProperties=void 0,this.requiredProperties=void 0,this.hashProperties=void 0;for(var e=E.getChildrenClasses(this.name),t=0;t<e.length;t++)e[t].resetAllProperties()}get isCustom(){return this.isCustomValue}fillAllProperties(){if(this.allProperties)return;this.allProperties=[],this.hashProperties={};let e={};this.properties.forEach(t=>e[t.name]=t);let t=this.parentName?E.findClass(this.parentName):null;t&&t.getAllProperties().forEach(t=>{let s=e[t.name];s?(s.mergeWith(t),this.addPropCore(s)):this.addPropCore(t)}),this.properties.forEach(e=>{this.hashProperties[e.name]||this.addPropCore(e)})}addPropCore(e){this.allProperties.push(e),this.hashProperties[e.name]=e,e.alternativeName&&(this.hashProperties[e.alternativeName]=e)}isOverridedProp(e){return!!this.parentName&&!!E.findProperty(this.parentName,e)}hasRegularChildClass(){if(this.isCustom){this.isCustomValue=!1;for(var e=0;e<this.properties.length;e++)this.properties[e].isCustom=!1;v.removeAllProperties(this.name),this.makeParentRegularClass()}}makeParentRegularClass(){if(!this.parentName)return;let e=E.findClass(this.parentName);e&&e.hasRegularChildClass()}createProperty(e,t=!1){var s="string"==typeof e?e:e.name;if(s){var i=null,r=s.indexOf(y.typeSymbol);r>-1&&(i=s.substring(r+1),s=s.substring(0,r));var n=this.getIsPropertyNameRequired(s)||!!e.isRequired,o=new m(this,s=this.getPropertyName(s),n);if(i&&(o.type=i),"object"==typeof e){if(e.type&&(o.type=e.type),void 0!==e.default&&(o.defaultValue=e.default),void 0!==e.defaultFunc&&(o.defaultValueFunc=e.defaultFunc),a.isValueEmpty(e.isSerializable)||(o.isSerializable=e.isSerializable),a.isValueEmpty(e.isSerializableFunc)||(o.isSerializableFunc=e.isSerializableFunc),a.isValueEmpty(e.isLightSerializable)||(o.isLightSerializable=e.isLightSerializable),a.isValueEmpty(e.maxLength)||(o.maxLength=e.maxLength),void 0!==e.displayName&&(o.displayName=e.displayName),a.isValueEmpty(e.category)||(o.category=e.category),a.isValueEmpty(e.categoryIndex)||(o.categoryIndex=e.categoryIndex),a.isValueEmpty(e.nextToProperty)||(o.nextToProperty=e.nextToProperty),a.isValueEmpty(e.overridingProperty)||(o.overridingProperty=e.overridingProperty),a.isValueEmpty(e.visibleIndex)||(o.visibleIndex=e.visibleIndex),a.isValueEmpty(e.showMode)||(o.showMode=e.showMode),a.isValueEmpty(e.locationInTable)||(o.locationInTable=e.locationInTable),a.isValueEmpty(e.maxValue)||(o.maxValue=e.maxValue),a.isValueEmpty(e.minValue)||(o.minValue=e.minValue),a.isValueEmpty(e.dataList)||(o.dataList=e.dataList),a.isValueEmpty(e.isDynamicChoices)||(o.isDynamicChoices=e.isDynamicChoices),a.isValueEmpty(e.isBindable)||(o.isBindable=e.isBindable),a.isValueEmpty(e.isUnique)||(o.isUnique=e.isUnique),a.isValueEmpty(e.uniqueProperty)||(o.uniquePropertyName=e.uniqueProperty),a.isValueEmpty(e.isArray)||(o.isArray=e.isArray),(!0===e.visible||!1===e.visible)&&(o.visible=e.visible),e.visibleIf&&(o.visibleIf=e.visibleIf),e.enableIf&&(o.enableIf=e.enableIf),e.onExecuteExpression&&(o.onExecuteExpression=e.onExecuteExpression),e.onPropertyEditorUpdate&&(o.onPropertyEditorUpdate=e.onPropertyEditorUpdate),!0===e.readOnly&&(o.readOnly=!0),!0===e.availableInMatrixColumn&&(o.availableInMatrixColumn=!0),e.choices){var l="function"==typeof e.choices?e.choices:null,h="function"!=typeof e.choices?e.choices:null;o.setChoices(h,l)}e.baseValue&&o.setBaseValue(e.baseValue),e.onSerializeValue&&(o.onSerializeValue=e.onSerializeValue),e.onGetValue&&(o.onGetValue=e.onGetValue),e.onSetValue&&(o.onSetValue=e.onSetValue),e.onSettingValue&&(o.onSettingValue=e.onSettingValue),e.isLocalizable&&(e.serializationProperty="loc"+o.name),e.serializationProperty&&(o.serializationProperty=e.serializationProperty,o.serializationProperty&&0==o.serializationProperty.indexOf("loc")&&(o.isLocalizable=!0)),e.isLocalizable&&(o.isLocalizable=e.isLocalizable),e.className&&(o.className=e.className),e.baseClassName&&(o.baseClassName=e.baseClassName,o.isArray=!0),!0===o.isArray&&(o.isArray=!0),e.classNamePart&&(o.classNamePart=e.classNamePart),e.alternativeName&&(o.alternativeName=e.alternativeName),e.oldName&&(o.oldName=e.oldName),e.layout&&(o.layout=e.layout),e.version&&(o.version=e.version),e.dependsOn&&this.addDependsOnProperties(o,e.dependsOn)}return this.properties.push(o),t&&!this.isOverridedProp(o.name)&&(o.isCustom=!0,v.addProperty(this.name,o)),o}}addDependsOnProperties(e,t){let s=Array.isArray(t)?t:[t];e.dependsOn=s;for(var i=0;i<s.length;i++)this.addDependsOnProperty(e,s[i])}addDependsOnProperty(e,t){var s=this.find(t);s||(s=E.findProperty(this.parentName,t)),s&&s.addDependedProperty(e.name)}getIsPropertyNameRequired(e){return e.length>0&&e[0]==y.requiredSymbol}getPropertyName(e){return this.getIsPropertyNameRequired(e)?e=e.slice(1):e}}y.requiredSymbol="!",y.typeSymbol=":";class C{constructor(){this.classes={},this.alternativeNames={},this.childrenClasses={},this.dynamicPropsCache={}}getObjPropertyValue(e,t){if(this.isObjWrapper(e)&&this.isNeedUseObjWrapper(e,t)){let s=e.getOriginalObj(),i=E.findProperty(s.getType(),t);if(i)return this.getObjPropertyValueCore(s,i)}let s=E.findProperty(e.getType(),t);return s?this.getObjPropertyValueCore(e,s):e[t]}setObjPropertyValue(e,t,s){if(e[t]!==s){if(e[t]&&e[t].setJson)e[t].setJson(s,!0);else{if(Array.isArray(s)){let e=[];for(var i=0;i<s.length;i++)e.push(s[i]);s=e}e[t]=s}}}getObjPropertyValueCore(e,t){if(!t.isPropertySerializable(e))return e[t.name];if(t.isLocalizable){if(t.isArray)return e[t.name];if(t.serializationProperty)return e[t.serializationProperty].text}return e.getPropertyValue(t.name)}isObjWrapper(e){return!!e.getOriginalObj&&!!e.getOriginalObj()}isNeedUseObjWrapper(e,t){if(!e.getDynamicProperties)return!0;let s=e.getDynamicProperties();if(!Array.isArray(s))return!1;for(let e=0;e<s.length;e++)if(s[e].name===t)return!0;return!1}addClass(e,t,s=null,i=null){var r=new y(e=e.toLowerCase(),t,s,i);return this.classes[e]=r,i&&(i=i.toLowerCase(),this.childrenClasses[i]||(this.childrenClasses[i]=[]),this.childrenClasses[i].push(r)),r}removeClass(e){var t=this.findClass(e);if(t&&(delete this.classes[t.name],t.parentName)){var s=this.childrenClasses[t.parentName].indexOf(t);s>-1&&this.childrenClasses[t.parentName].splice(s,1)}}overrideClassCreatore(e,t){this.overrideClassCreator(e,t)}overrideClassCreator(e,t){e=e.toLowerCase();var s=this.findClass(e);s&&(s.creator=t)}getProperties(e){var t=this.findClass(e);return t?t.getAllProperties():[]}getPropertiesByObj(e){let t=e&&e.getType?e.getType():void 0;if(!t)return[];let s=this.getProperties(t),i=this.getDynamicPropertiesByObj(e);for(let e=i.length-1;e>=0;e--)this.findProperty(t,i[e].name)&&i.splice(e,1);return 0===i.length?s:[].concat(s).concat(i)}addDynamicPropertiesIntoObj(e,t,s){s.forEach(s=>{this.addDynamicPropertyIntoObj(e,t,s.name,!1),s.serializationProperty&&this.addDynamicPropertyIntoObj(e,t,s.serializationProperty,!0),s.alternativeName&&this.addDynamicPropertyIntoObj(e,t,s.alternativeName,!1)})}addDynamicPropertyIntoObj(e,t,s,i){var r={configurable:!0,get:function(){return t[s]}};i||(r.set=function(e){t[s]=e}),Object.defineProperty(e,s,r)}getDynamicPropertiesByObj(e,t=null){if(!e||!e.getType)return[];if(e.getDynamicProperties)return e.getDynamicProperties();if(!e.getDynamicType&&!t)return[];let s=t||e.getDynamicType();return this.getDynamicPropertiesByTypes(e.getType(),s)}getDynamicPropertiesByTypes(e,t,s){if(!t)return[];let i=t+"-"+e;if(this.dynamicPropsCache[i])return this.dynamicPropsCache[i];var r=this.getProperties(t);if(!r||0==r.length)return[];let n={},a=this.getProperties(e);for(var o=0;o<a.length;o++)n[a[o].name]=a[o];let l=[];s||(s=[]);for(let e=0;e<r.length;e++){let t=r[e];0>s.indexOf(t.name)&&this.canAddDybamicProp(t,n[t.name])&&l.push(t)}return this.dynamicPropsCache[i]=l,l}canAddDybamicProp(e,t){if(!t)return!0;if(e===t)return!1;let s=e.classInfo;for(;s&&s.parentName;){if((e=this.findProperty(s.parentName,e.name))&&e===t)return!0;s=e?e.classInfo:void 0}return!1}hasOriginalProperty(e,t){return!!this.getOriginalProperty(e,t)}getOriginalProperty(e,t){var s=this.findProperty(e.getType(),t);return s||(this.isObjWrapper(e)?this.findProperty(e.getOriginalObj().getType(),t):null)}getProperty(e,t){let s=this.findProperty(e,t);if(!s)return s;let i=this.findClass(e);if(s.classInfo===i)return s;let r=new m(i,s.name,s.isRequired);return r.mergeWith(s),r.isArray=s.isArray,i.properties.push(r),i.resetAllProperties(),r}findProperty(e,t){let s=this.findClass(e);return s?s.findProperty(t):null}findProperties(e,t){var s=[];let i=this.findClass(e);if(!i)return s;for(var r=0;r<t.length;r++){var n=i.findProperty(t[r]);n&&s.push(n)}return s}getAllPropertiesByName(e){for(var t=[],s=this.getAllClasses(),i=0;i<s.length;i++)for(var r=this.findClass(s[i]),n=0;n<r.properties.length;n++)if(r.properties[n].name==e){t.push(r.properties[n]);break}return t}getAllClasses(){var e=[];for(var t in this.classes)e.push(t);return e}createClass(e,t){e=e.toLowerCase();var s=this.findClass(e);if(!s)return null;if(s.creator)return s.creator(t);for(var i=s.parentName;i&&(s=this.findClass(i));)if(i=s.parentName,s.creator)return this.createCustomType(e,s.creator,t);return null}createCustomType(e,t,s){e=e.toLowerCase();var i=t(s),r=e,n=i.getTemplate?i.getTemplate():i.getType();return i.getType=function(){return r},i.getTemplate=function(){return n},v.createProperties(i),i}getChildrenClasses(e,t=!1){e=e.toLowerCase();var s=[];return this.fillChildrenClasses(e,t,s),s}getRequiredProperties(e){let t=this.findClass(e);if(!t)return[];let s=t.getRequiredProperties();for(var i=[],r=0;r<s.length;r++)i.push(s[r].name);return i}addProperties(e,t){e=e.toLowerCase();for(var s=this.findClass(e),i=0;i<t.length;i++)this.addCustomPropertyCore(s,t[i])}addProperty(e,t){return this.addCustomPropertyCore(this.findClass(e),t)}addCustomPropertyCore(e,t){if(!e)return null;var s=e.createProperty(t,!0);return s&&(this.clearDynamicPropsCache(e),e.resetAllProperties()),s}removeProperty(e,t){var s=this.findClass(e);if(!s)return!1;var i=s.find(t);i&&(this.clearDynamicPropsCache(s),this.removePropertyFromClass(s,i),s.resetAllProperties(),v.removeProperty(s.name,t))}clearDynamicPropsCache(e){this.dynamicPropsCache={}}removePropertyFromClass(e,t){var s=e.properties.indexOf(t);s<0||e.properties.splice(s,1)}fillChildrenClasses(e,t,s){var i=this.childrenClasses[e];if(i)for(var r=0;r<i.length;r++)(!t||i[r].creator)&&s.push(i[r]),this.fillChildrenClasses(i[r].name,t,s)}findClass(e){e=e.toLowerCase();var t=this.classes[e];if(!t){var s=this.alternativeNames[e];if(s&&s!=e)return this.findClass(s)}return t}isDescendantOf(e,t){if(!e||!t)return!1;e=e.toLowerCase(),t=t.toLowerCase();var s=this.findClass(e);if(!s)return!1;var i=s;do{if(i.name===t)return!0;i=this.classes[i.parentName]}while(!!i);return!1}addAlterNativeClassName(e,t){this.alternativeNames[t.toLowerCase()]=e.toLowerCase()}generateSchema(e){e||(e="survey");var t=this.findClass(e);if(!t)return null;var s={$schema:"http://json-schema.org/draft-07/schema#",title:"SurveyJS Library json schema",type:"object",properties:{},definitions:{locstring:this.generateLocStrClass()}};return this.generateSchemaProperties(t,s,s.definitions,!0),s}generateLocStrClass(){let e={},t=E.findProperty("survey","locale");if(t){let s=t.getChoices(null);Array.isArray(s)&&(0>s.indexOf("en")&&s.splice(0,0,"en"),s.splice(0,0,"default"),s.forEach(t=>{t&&(e[t]={type:"string"})}))}return{$id:"locstring",type:"object",properties:e}}generateSchemaProperties(e,t,s,i){if(!e)return;let r=t.properties,n=[];"question"===e.name&&(r.type={type:"string"},n.push("type"));for(let t=0;t<e.properties.length;t++){let a=e.properties[t];!1!==a.isSerializable&&!(e.parentName&&E.findProperty(e.parentName,a.name))&&(r[a.name]=this.generateSchemaProperty(a,s,i),a.isRequired&&n.push(a.name))}n.length>0&&(t.required=n)}generateSchemaProperty(e,t,s){if(e.isLocalizable)return{oneOf:[{type:"string"},{$ref:this.getChemeRefName("locstring",s)}]};let i=e.schemaType(),r=e.schemaRef();var n={};if(i&&(n.type=i),e.hasChoices){let t=e.getChoices(null);Array.isArray(t)&&t.length>0&&(n.enum=this.getChoicesValues(t))}if(r&&("array"===i?"string"===e.className?n.items={type:e.className}:n.items={$ref:this.getChemeRefName(e.className,s)}:n.$ref=this.getChemeRefName(r,s),this.generateChemaClass(e.className,t,!1)),e.baseClassName){var a=this.getChildrenClasses(e.baseClassName,!0);"question"==e.baseClassName&&a.push(this.findClass("panel")),n.items={anyOf:[]};for(var o=0;o<a.length;o++){var l=a[o].name;n.items.anyOf.push({$ref:this.getChemeRefName(l,s)}),this.generateChemaClass(l,t,!1)}}return n}getChemeRefName(e,t){return t?"#/definitions/"+e:e}generateChemaClass(e,t,s){if(t[e])return;var i=this.findClass(e);if(!i)return;var r=!!i.parentName&&"base"!=i.parentName;r&&this.generateChemaClass(i.parentName,t,s);let n={type:"object",$id:e};t[e]=n;let a={properties:{}};this.generateSchemaProperties(i,a,t,s),r?n.allOf=[{$ref:this.getChemeRefName(i.parentName,s)},{properties:a.properties}]:n.properties=a.properties,Array.isArray(a.required)&&(n.required=a.required)}getChoicesValues(e){let t=[];return e.forEach(e=>{"object"==typeof e&&void 0!==e.value?t.push(e.value):t.push(e)}),t}}class f{constructor(e,t){this.type=e,this.message=t,this.description="",this.at=-1,this.end=-1}getFullDescription(){return this.message+(this.description?"\n"+this.description:"")}}class b extends f{constructor(e,t){super("unknownproperty","Unknown property in class '"+t+"': '"+e+"'."),this.propertyName=e,this.className=t}}class V extends f{constructor(e,t,s){super(t,s),this.baseClassName=e,this.type=t,this.message=s}}class w extends V{constructor(e,t){super(t,"missingtypeproperty","The property type is missing in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=t}}class x extends V{constructor(e,t){super(t,"incorrecttypeproperty","The property type is incorrect in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=t}}class P extends f{constructor(e,t){super("requiredproperty","The property '"+e+"' is required in class '"+t+"'."),this.propertyName=e,this.className=t}}class T extends f{constructor(e,t){super("arrayproperty","The property '"+e+"' should be an array in '"+t+"'."),this.propertyName=e,this.className=t}}class S extends f{constructor(e,t){super("incorrectvalue","The property value: '"+t+"' is incorrect for property '"+e.name+"'."),this.property=e,this.value=t}}class I{constructor(){this.errors=[],this.lightSerializing=!1}static get metaData(){return I.metaDataValue}toJsonObject(e,t){return this.toJsonObjectCore(e,null,t)}toObject(e,t,s){this.toObjectCore(e,t,s);var i=this.getRequiredError(t,e);i&&this.addNewError(i,e,t)}toObjectCore(e,t,s){if(!e)return;var i=null,r=void 0,n=!0;if(t.getType&&(r=t.getType(),i=E.getProperties(r),n=!!r&&!E.isDescendantOf(r,"itemvalue")),!i)return;t.startLoadingFromJson&&t.startLoadingFromJson(e),i=this.addDynamicProperties(t,e,i),this.options=s;let a={};a[I.typePropertyName]=!0;let o={};for(var l in e)this.setPropertyValueToObj(e,t,l,i,a,o,r,n,s);this.options=void 0,t.endLoadingFromJson&&t.endLoadingFromJson()}setPropertyValueToObj(e,t,s,i,r,n,a,o,l){if(r[s])return;if(s===I.positionPropertyName){t[s]=e[s];return}let h=this.findProperty(i,s);if(!h&&o&&this.addNewError(new b(s.toString(),a),e,t),h){let o=h.dependsOn;Array.isArray(o)&&(n[s]=!0,o.forEach(s=>{n[s]||this.setPropertyValueToObj(e,t,s,i,r,n,a,!1,l)})),this.valueToObj(e[s],t,h,e,l),r[s]=!0}}toJsonObjectCore(e,t,s){if(!e||!e.getType)return e;if(!e.isSurvey&&"function"==typeof e.getData)return e.getData();var i={};null==t||t.className||(i[I.typePropertyName]=t.getObjType(e.getType()));let r=!0===s;return s&&!0!==s||(s={}),r&&(s.storeDefaults=r),this.propertiesToJson(e,E.getProperties(e.getType()),i,s),this.propertiesToJson(e,this.getDynamicProperties(e),i,s),i}getDynamicProperties(e){return E.getDynamicPropertiesByObj(e)}addDynamicProperties(e,t,s){if(!e.getDynamicPropertyName&&!e.getDynamicProperties)return s;if(e.getDynamicPropertyName){let i=e.getDynamicPropertyName();if(!i)return s;i&&t[i]&&(e[i]=t[i])}let i=this.getDynamicProperties(e);return 0===i.length?s:[].concat(s).concat(i)}propertiesToJson(e,t,s,i){for(var r=0;r<t.length;r++)this.valueToJson(e,s,t[r],i)}valueToJson(e,t,s,i){i||(i={}),s.isPropertySerializable(e)&&(!1!==s.isLightSerializable||!this.lightSerializing)&&(!i.version||s.isAvailableInVersion(i.version))&&this.valueToJsonCore(e,t,s,i)}valueToJsonCore(e,t,s,i){let r=s.getSerializedProperty(e,i.version);if(r&&r!==s){this.valueToJsonCore(e,t,r,i);return}var n=s.getSerializableValue(e,i.storeDefaults);if(void 0===n)return;if(this.isValueArray(n)){for(var a=[],o=0;o<n.length;o++)a.push(this.toJsonObjectCore(n[o],s,i));n=a.length>0?a:null}else n=this.toJsonObjectCore(n,s,i);if(null==n)return;let l=s.getSerializedName(i.version);var h="function"==typeof e.getPropertyValue&&null!==e.getPropertyValue(l,null);(!i.storeDefaults||!h)&&s.isDefaultValueByObj(e,n)||E.onSerializingProperty&&E.onSerializingProperty(e,s,n,t)||(t[l]=this.removePosOnValueToJson(s,n))}valueToObj(e,t,s,i,r){if(null!=e){if(this.removePos(s,e),null!=s&&s.hasToUseSetValue){s.setValue(t,e,this);return}if(s.isArray&&!Array.isArray(e)&&e){e=[e];let r=i&&s.alternativeName&&i[s.alternativeName]?s.alternativeName:s.name;this.addNewError(new T(r,t.getType()),i||e,t)}if(this.isValueArray(e)){this.valueToArray(e,t,s.name,s,r);return}var n=this.createNewObj(e,s);n.newObj&&(this.toObjectCore(e,n.newObj,r),e=n.newObj),!n.error&&(null!=s?(s.setValue(t,e,this),r&&r.validatePropertyValues&&!s.validateValue(e)&&this.addNewError(new S(s,e),i,t)):t[s.name]=e)}}removePosOnValueToJson(e,t){return e.isCustom&&t&&this.removePosFromObj(t),t}removePos(e,t){!e||!e.type||0>e.type.indexOf("value")||this.removePosFromObj(t)}removePosFromObj(e){if(e&&"function"!=typeof e.getType){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.removePosFromObj(e[t]);if("object"==typeof e)for(let t in e[I.positionPropertyName]&&delete e[I.positionPropertyName],e)this.removePosFromObj(e[t])}}isValueArray(e){return e&&Array.isArray(e)}createNewObj(e,t){var s={newObj:null,error:null};let i=this.getClassNameForNewObj(e,t);return s.newObj=i?E.createClass(i,e):null,s.error=this.checkNewObjectOnErrors(s.newObj,e,t,i),s}getClassNameForNewObj(e,t){var s=null!=t&&t.className?t.className:void 0;if(s||(s=e[I.typePropertyName]),!s)return s;s=s.toLowerCase();let i=t.classNamePart;return i&&0>s.indexOf(i)&&(s+=i),s}checkNewObjectOnErrors(e,t,s,i){var r=null;return e?r=this.getRequiredError(e,t):s.baseClassName&&(r=i?new x(s.name,s.baseClassName):new w(s.name,s.baseClassName)),r&&this.addNewError(r,t,e),r}getRequiredError(e,t){if(!e.getType||"function"==typeof e.getData)return null;let s=E.findClass(e.getType());if(!s)return null;let i=s.getRequiredProperties();if(!Array.isArray(i))return null;for(var r=0;r<i.length;r++){let s=i[r];if(a.isValueEmpty(s.defaultValue)&&!t[s.name])return new P(s.name,e.getType())}return null}addNewError(e,t,s){if(e.jsonObj=t,e.element=s,this.errors.push(e),!t)return;let i=t[I.positionPropertyName];i&&(e.at=i.start,e.end=i.end)}valueToArray(e,t,s,i,r){if(!t[s]||this.isValueArray(t[s])){t[s]&&e.length>0&&t[s].splice(0,t[s].length);var n=t[s]?t[s]:[];this.addValuesIntoArray(e,n,i,r),t[s]||(t[s]=n)}}addValuesIntoArray(e,t,s,i){for(var r=0;r<e.length;r++){var n=this.createNewObj(e[r],s);n.newObj?(e[r].name&&(n.newObj.name=e[r].name),e[r].valueName&&(n.newObj.valueName=e[r].valueName.toString()),t.push(n.newObj),this.toObjectCore(e[r],n.newObj,i)):n.error||t.push(e[r])}}findProperty(e,t){if(!e)return null;for(var s=0;s<e.length;s++){var i=e[s];if(i.name==t||i.alternativeName==t)return i}return null}}I.typePropertyName="type",I.positionPropertyName="pos",I.metaDataValue=new C;var E=I.metaData;let R="@survey";class A{constructor(){this.values=null,this.properties=null,this.asyncValues={}}getFirstName(e,t=null){if(!e)return e;var s="";if(t&&(s=this.getFirstPropertyName(e,t)))return s;for(var i=0;i<e.length;i++){var r=e[i];if("."==r||"["==r)break;s+=r}return s}hasValue(e,t=null){return t||(t=this.values),this.getValueCore(e,t).hasValue}getValue(e,t=null){return t||(t=this.values),this.getValueCore(e,t).value}setValue(e,t,s){if(t){var i=this.getNonNestedObject(e,t,!0);i&&(e=i.value,t=i.text,e&&t&&(e[t]=s))}}getValueInfo(e){if(e.path){e.value=this.getValueFromPath(e.path,this.values),e.hasValue=null!==e.value&&!a.isValueEmpty(e.value),!e.hasValue&&e.path.length>1&&"length"==e.path[e.path.length-1]&&(e.hasValue=!0,e.value=0);return}var t=this.getValueCore(e.name,this.values);e.value=t.value,e.hasValue=t.hasValue,e.path=t.hasValue?t.path:null,e.sctrictCompare=t.sctrictCompare}isAnyKeyChanged(e,t){for(var s=0;s<t.length;s++){let h=t[s];if(!h)continue;let u=h.toLowerCase();if(e.hasOwnProperty(h)||h!==u&&e.hasOwnProperty(u))return!0;var i=this.getFirstName(h);if(e.hasOwnProperty(i)){if(h===i)return!0;var r=e[i];if(void 0!=r){if(!r.hasOwnProperty("oldValue")||!r.hasOwnProperty("newValue"))return!0;var n={};n[i]=r.oldValue;var o=this.getValue(h,n);n[i]=r.newValue;var l=this.getValue(h,n);if(!a.isTwoValueEquals(o,l,!1,!1,!1))return!0}}}return!1}getValueFromPath(e,t){if(2===e.length&&e[0]===R)return this.getValueFromSurvey(e[1]);for(var s=0;t&&s<e.length;){var i=e[s];if(a.isNumber(i)&&Array.isArray(t)&&i>=t.length)return null;t=t[i],s++}return t}getValueCore(e,t){let s=this.getQuestionDirectly(e);if(s)return{hasValue:!0,value:s.value,path:[e],sctrictCompare:s.requireStrictCompare};let i=this.getValueFromValues(e,t);if(e&&!i.hasValue){let t=this.getValueFromSurvey(e);void 0!==t&&(i.hasValue=!0,i.value=t,i.path=[R,e])}return i}getQuestionDirectly(e){if(this.properties&&this.properties.survey)return this.properties.survey.getQuestionByValueName(e)}getValueFromSurvey(e){if(this.properties&&this.properties.survey)return this.properties.survey.getBuiltInVariableValue(e.toLocaleLowerCase())}getValueFromValues(e,t){var s={hasValue:!1,value:null,path:null};if(!t&&0!==t&&!1!==t)return s;e&&e.lastIndexOf(".length")>-1&&e.lastIndexOf(".length")===e.length-7&&(s.value=0,s.hasValue=!0);var i=this.getNonNestedObject(t,e,!1);return i&&(s.path=i.path,s.value=i.text?this.getObjectValue(i.value,i.text):i.value,s.hasValue=!a.isValueEmpty(s.value)),s}getNonNestedObject(e,t,s){let i=[],r=0,n=this.getNonNestedObjectCore(e,t,s,i);for(;!n&&r<i.length;)r=i.length,n=this.getNonNestedObjectCore(e,t,s,i);return n}getNonNestedObjectCore(e,t,s,i){var r=this.getFirstPropertyName(t,e,s,i);r&&i.push(r);for(var n=r?[r]:null;t!=r&&e;){if("["==t[0]){var o=this.getObjInArray(e,t);if(!o)return null;e=o.value,t=o.text,n.push(o.index)}else{if(!r&&t==this.getFirstName(t))return{value:e,text:t,path:n};if(e=this.getObjectValue(e,r),a.isValueEmpty(e)&&!s)return null;t=t.substring(r.length)}t&&"."==t[0]&&(t=t.substring(1)),(r=this.getFirstPropertyName(t,e,s,i))&&n.push(r)}return{value:e,text:t,path:n}}getObjInArray(e,t){if(!Array.isArray(e))return null;for(var s=1,i="";s<t.length&&"]"!=t[s];)i+=t[s],s++;return(t=s<t.length?t.substring(s+1):"",(s=this.getIntValue(i))<0||s>=e.length)?null:{value:e[s],text:t,index:s}}getFirstPropertyName(e,t,s=!1,i){if(!e||(t||(t={}),t.hasOwnProperty(e)))return e;var r=e.toLowerCase(),n=r[0],a=n.toUpperCase();for(var o in t)if(!(Array.isArray(i)&&i.indexOf(o)>-1)){var l=o[0];if(l===a||l===n){var h=o.toLowerCase();if(h==r)return o;if(r.length<=h.length)continue;var u=r[h.length];if("."!=u&&"["!=u)continue;if(h==r.substring(0,h.length))return o}}if(s&&"["!==e[0]){var d=e.indexOf(".");return d>-1&&(t[e=e.substring(0,d)]={}),e}return""}getObjectValue(e,t){return t?e[t]:null}getIntValue(e){return"0"==e||(0|e)>0&&e%1==0?Number(e):-1}}class D{static disposedObjectChangedProperty(e,t){D.warn('An attempt to set a property "'+e+'" of a disposed object "'+t+'"')}static inCorrectQuestionValue(e,t){let s=JSON.stringify(t,null,3);D.warn("An attempt to assign an incorrect value"+s+' to the following question: "'+e+'"')}static warn(e){console.warn(e)}static error(e){console.error(e)}}class O{constructor(){this.functionHash={},this.isAsyncHash={}}register(e,t,s=!1){this.functionHash[e]=t,s&&(this.isAsyncHash[e]=!0)}unregister(e){delete this.functionHash[e],delete this.isAsyncHash[e]}hasFunction(e){return!!this.functionHash[e]}isAsyncFunction(e){return!!this.isAsyncHash[e]}clear(){this.functionHash={}}getAll(){var e=[];for(var t in this.functionHash)e.push(t);return e.sort()}run(e,t,s=null,i){var r=this.functionHash[e];if(!r)return D.warn("Unknown function name: "+e),null;let n={func:r};if(s)for(var a in s)n[a]=s[a];return n.func(t,i)}}function L(e,t){if(null!=e){if(Array.isArray(e))for(var s=0;s<e.length;s++)L(e[s],t);else a.isNumber(e)&&(e=a.getNumber(e)),t.push(e)}}function N(e){var t=[];L(e,t);for(var s=0,i=0;i<t.length;i++)s=a.correctAfterPlusMinis(s,t[i],s+t[i]);return s}function k(e,t){var s=[];L(e,s);for(var i=void 0,r=0;r<s.length;r++)void 0===i&&(i=s[r]),t?i>s[r]&&(i=s[r]):i<s[r]&&(i=s[r]);return i}function F(e,t,s,i,r,n){var o;return!e||a.isValueEmpty(e[t])||n&&!n.run(e)?s:i(s,r?"string"==typeof(o=e[t])?a.isNumber(o)?a.getNumber(o):void 0:o:1)}function M(e,t,s,i=!0){var r=function(e,t){if(e.length<2||e.length>3)return null;let s=e[0];if(!s||!Array.isArray(s)&&!Array.isArray(Object.keys(s)))return null;let i=e[1];if("string"!=typeof i&&!(i instanceof String))return null;let r=e.length>2?e[2]:void 0;if("string"==typeof r||r instanceof String||(r=void 0),!r){let e=Array.isArray(t)&&t.length>2?t[2]:void 0;e&&e.toString()&&(r=e.toString())}return{data:s,name:i,expression:r}}(e,t);if(!r)return;let n=r.expression?new el(r.expression):void 0;n&&n.isAsync&&(n=void 0);var a=void 0;if(Array.isArray(r.data))for(var o=0;o<r.data.length;o++)a=F(r.data[o],r.name,a,s,i,n);else for(var l in r.data)a=F(r.data[l],r.name,a,s,i,n);return a}function _(e,t){var s=M(e,t,function(e,t){return(void 0==e&&(e=0),void 0==t||null==t)?e:a.correctAfterPlusMinis(e,t,e+t)});return void 0!==s?s:0}function q(e,t){var s=M(e,t,function(e,t){return(void 0==e&&(e=0),void 0==t||null==t)?e:e+1},!1);return void 0!==s?s:0}function B(e,t,s){if("days"===s)return H([e,t]);let i=n("function-dateDiffMonths",e),r=n("function-dateDiffMonths",t),a=r.getFullYear()-i.getFullYear();s=s||"years";let o=12*a+r.getMonth()-i.getMonth();return r.getDate()<i.getDate()&&(o-=1),"months"===s?o:~~(o/12)}function Q(e){if(!e)return!1;for(var t=e.questions,s=0;s<t.length;s++)if(!t[s].validate(!1))return!1;return!0}function z(e){var t=n("function-today");return tp.localization.useLocalTimeZone?t.setHours(0,0,0,0):t.setUTCHours(0,0,0,0),Array.isArray(e)&&1==e.length&&t.setDate(t.getDate()+e[0]),t}function H(e){if(!Array.isArray(e)||2!==e.length||!e[0]||!e[1])return 0;let t=n("function-diffDays",e[0]);return Math.ceil(Math.abs(n("function-diffDays",e[1])-t)/864e5)}function W(e,t){let s=z(void 0);return t&&t[0]&&(s=n("function-"+e,t[0])),s}function U(e,t){if(!e||!t)return;let s=e.question;for(;s&&s.parent;){let e=s.parent.getQuestionByName(t);if(e)return e;s=s.parentQuestion}let i=["row","panel","survey"];for(let s=0;s<i.length;s++){let r=e[i[s]];if(r&&r.getQuestionByName){let e=r.getQuestionByName(t);if(e)return e}}return null}function j(e,t){return t.length>1&&!a.isValueEmpty(t[1])?e.getDisplayValue(!0,t[1]):e.displayValue}O.Instance=new O,O.Instance.register,O.Instance.register("sum",N),O.Instance.register("min",function(e){return k(e,!0)}),O.Instance.register("max",function(e){return k(e,!1)}),O.Instance.register("count",function(e){var t=[];return L(e,t),t.length}),O.Instance.register("avg",function(e){var t=[];L(e,t);let s=N(e);return t.length>0?s/t.length:0}),O.Instance.register("sumInArray",_),O.Instance.register("minInArray",function(e,t){return M(e,t,function(e,t){return void 0==e?t:void 0==t||null==t?e:e<t?e:t})}),O.Instance.register("maxInArray",function(e,t){return M(e,t,function(e,t){return void 0==e?t:void 0==t||null==t?e:e>t?e:t})}),O.Instance.register("countInArray",q),O.Instance.register("avgInArray",function(e,t){var s=q(e,t);return 0==s?0:_(e,t)/s}),O.Instance.register("iif",function(e){return e||3===e.length?e[0]?e[1]:e[2]:""}),O.Instance.register("getDate",function(e){return(e||!(e.length<1))&&e[0]?n("function-getDate",e[0]):null}),O.Instance.register("age",function(e){return Array.isArray(e)&&!(e.length<1)&&e[0]?B(e[0],void 0,(e.length>1?e[1]:"")||"years"):null}),O.Instance.register("dateDiff",function(e){return Array.isArray(e)&&!(e.length<2)&&e[0]&&e[1]?B(e[0],e[1],(e.length>2?e[2]:"")||"days"):null}),O.Instance.register("dateAdd",function(e){if(!Array.isArray(e)||e.length<2||!e[0]||!e[1])return null;let t=n("function-dateAdd",e[0]),s=e[1],i=e[2]||"days";return"days"===i&&t.setDate(t.getDate()+s),"months"===i&&t.setMonth(t.getMonth()+s),"years"===i&&t.setFullYear(t.getFullYear()+s),t}),O.Instance.register("isContainerReady",function(e){if(!e&&e.length<1||!e[0]||!this.survey)return!1;let t=e[0],s=this.survey.getPageByName(t);if(s||(s=this.survey.getPanelByName(t)),!s){let i=this.survey.getQuestionByName(t);if(!i||!Array.isArray(i.panels))return!1;if(e.length>1)e[1]<i.panels.length&&(s=i.panels[e[1]]);else{for(let e=0;e<i.panels.length;e++)if(!Q(i.panels[e]))return!1;return!0}}return Q(s)}),O.Instance.register("isDisplayMode",function(){return this.survey&&this.survey.isDisplayMode}),O.Instance.register("currentDate",function(){return n("function-currentDate")}),O.Instance.register("today",z),O.Instance.register("getYear",function(e){if(1===e.length&&e[0])return n("function-getYear",e[0]).getFullYear()}),O.Instance.register("currentYear",function(){return n("function-currentYear").getFullYear()}),O.Instance.register("diffDays",H),O.Instance.register("year",function(e){return W("year",e).getFullYear()}),O.Instance.register("month",function(e){return W("month",e).getMonth()+1}),O.Instance.register("day",function(e){return W("day",e).getDate()}),O.Instance.register("weekday",function(e){return W("weekday",e).getDay()}),O.Instance.register("displayValue",function(e){let t=U(this,e[0]);if(!t)return"";if(t.isReady)this.returnResult(j(t,e));else{let s=(t,i)=>{t.isReady&&(t.onReadyChanged.remove(s),this.returnResult(j(t,e)))};t.onReadyChanged.add(s)}},!0),O.Instance.register("propertyValue",function(e){if(2!==e.length||!e[0]||!e[1])return;let t=U(this,e[0]);return t?t[e[1]]:void 0}),O.Instance.register("substring",function(e){if(e.length<2)return"";let t=e[0];if(!t||"string"!=typeof t)return"";let s=e[1];if(!a.isNumber(s))return"";let i=e.length>2?e[2]:void 0;return a.isNumber(i)?t.substring(s,i):t.substring(s)});class J{constructor(){this._id=J.counter++}get id(){return this._id}toString(e){return""}hasFunction(){return!1}hasAsyncFunction(){return!1}addToAsyncList(e){}isEqual(e){return!!e&&e.getType()===this.getType()&&this.isContentEqual(e)}areOperatorsEquals(e,t){return!e&&!t||!!e&&e.isEqual(t)}}J.counter=1;class G extends J{constructor(e,t=null,s=null,i=!1){super(),this.operatorName=e,this.left=t,this.right=s,this.isArithmeticValue=i,i?this.consumer=ee.binaryFunctions.arithmeticOp(e):this.consumer=ee.binaryFunctions[e],null==this.consumer&&ee.throwInvalidOperatorError(e)}get requireStrictCompare(){return this.getIsOperandRequireStrict(this.left)||this.getIsOperandRequireStrict(this.right)}getIsOperandRequireStrict(e){return!!e&&e.requireStrictCompare}getType(){return"binary"}get isArithmetic(){return this.isArithmeticValue}get isConjunction(){return"or"==this.operatorName||"and"==this.operatorName}get conjunction(){return this.isConjunction?this.operatorName:""}get operator(){return this.operatorName}get leftOperand(){return this.left}get rightOperand(){return this.right}isContentEqual(e){return e.operator===this.operator&&this.areOperatorsEquals(this.left,e.left)&&this.areOperatorsEquals(this.right,e.right)}evaluateParam(e,t){return null==e?null:e.evaluate(t)}evaluate(e){return this.consumer.call(this,this.evaluateParam(this.left,e),this.evaluateParam(this.right,e),this.requireStrictCompare)}toString(e){if(e){var t=e(this);if(t)return t}return"("+ee.safeToString(this.left,e)+" "+ee.operatorToString(this.operatorName)+" "+ee.safeToString(this.right,e)+")"}setVariables(e){null!=this.left&&this.left.setVariables(e),null!=this.right&&this.right.setVariables(e)}hasFunction(){return!!this.left&&this.left.hasFunction()||!!this.right&&this.right.hasFunction()}hasAsyncFunction(){return!!this.left&&this.left.hasAsyncFunction()||!!this.right&&this.right.hasAsyncFunction()}addToAsyncList(e){this.left&&this.left.addToAsyncList(e),this.right&&this.right.addToAsyncList(e)}}class K extends J{constructor(e,t){super(),this.expressionValue=e,this.operatorName=t,this.consumer=ee.unaryFunctions[t],null==this.consumer&&ee.throwInvalidOperatorError(t)}get operator(){return this.operatorName}get expression(){return this.expressionValue}getType(){return"unary"}toString(e){if(e){var t=e(this);if(t)return t}return ee.operatorToString(this.operatorName)+" "+this.expression.toString(e)}isContentEqual(e){return e.operator==this.operator&&this.areOperatorsEquals(this.expression,e.expression)}hasFunction(){return this.expression.hasFunction()}hasAsyncFunction(){return this.expression.hasAsyncFunction()}addToAsyncList(e){this.expression.addToAsyncList(e)}evaluate(e){let t=this.expression.evaluate(e);return this.consumer.call(this,t)}setVariables(e){this.expression.setVariables(e)}}class Y extends J{constructor(e){super(),this.values=e}getType(){return"array"}toString(e){if(e){var t=e(this);if(t)return t}return"["+this.values.map(function(t){return t.toString(e)}).join(", ")+"]"}evaluate(e){return this.values.map(function(t){return t.evaluate(e)})}setVariables(e){this.values.forEach(t=>{t.setVariables(e)})}hasFunction(){return this.values.some(e=>e.hasFunction())}hasAsyncFunction(){return this.values.some(e=>e.hasAsyncFunction())}addToAsyncList(e){this.values.forEach(t=>t.addToAsyncList(e))}isContentEqual(e){if(e.values.length!==this.values.length)return!1;for(var t=0;t<this.values.length;t++)if(!e.values[t].isEqual(this.values[t]))return!1;return!0}}class X extends J{constructor(e){super(),this.value=e}getType(){return"const"}toString(e){if(e){var t=e(this);if(t)return t}return this.value.toString()}get correctValue(){return this.getCorrectValue(this.value)}get requireStrictCompare(){return!1}evaluate(){return this.getCorrectValue(this.value)}setVariables(e){}getCorrectValue(e){if(!e||"string"!=typeof e)return e;if(ee.isBooleanValue(e))return"true"===e.toLowerCase();if(e.length>1&&this.isQuote(e[0])&&this.isQuote(e[e.length-1]))return e.substring(1,e.length-1);if(a.isNumber(e)){if("0"===e[0]&&0!=e.indexOf("0x")){let t=e.length,s=t>1&&("."===e[1]||","===e[1]);if(!s&&t>1||s&&t<2)return e}return a.getNumber(e)}return e}isContentEqual(e){return e.value==this.value}isQuote(e){return"'"==e||'"'==e}}class $ extends X{static get DisableConversionChar(){return tp.expressionDisableConversionChar}static set DisableConversionChar(e){tp.expressionDisableConversionChar=e}constructor(e){super(e),this.variableName=e,this.valueInfo={},this.useValueAsItIs=!1,this.variableName&&this.variableName.length>1&&this.variableName[0]===$.DisableConversionChar&&(this.variableName=this.variableName.substring(1),this.useValueAsItIs=!0)}get requireStrictCompare(){return!0===this.valueInfo.sctrictCompare}getType(){return"variable"}toString(e){if(e){var t=e(this);if(t)return t}return"{"+(this.useValueAsItIs?$.DisableConversionChar:"")+this.variableName+"}"}get variable(){return this.variableName}evaluate(e){return this.valueInfo.name=this.variableName,e.getValueInfo(this.valueInfo),this.valueInfo.hasValue?this.getCorrectValue(this.valueInfo.value):null}setVariables(e){e.push(this.variableName)}getCorrectValue(e){return this.useValueAsItIs?e:super.getCorrectValue(e)}isContentEqual(e){return e.variable==this.variable}}class Z extends J{constructor(e,t){super(),this.originalValue=e,this.parameters=t,Array.isArray(t)&&0===t.length&&(this.parameters=new Y([]))}getType(){return"function"}evaluate(e){let t=this.getAsynValue(e);return t?t.value:this.evaluateCore(e)}evaluateCore(e){let t=e.properties;if(this.isAsyncFunction){t=a.createCopy(e.properties);let s=this.id,i=e.asyncValues,r=e.onCompleteAsyncFunc,n=this;t.returnResult=e=>{i[s]={value:e},r(n)}}return O.Instance.run(this.originalValue,this.parameters.evaluate(e),t,this.parameters.values)}toString(e){if(e){var t=e(this);if(t)return t}return this.originalValue+"("+this.parameters.toString(e)+")"}setVariables(e){this.parameters.setVariables(e)}isReady(e){return!!this.getAsynValue(e)}getAsynValue(e){return e.asyncValues[this.id]}hasFunction(){return!0}hasAsyncFunction(){return this.isAsyncFunction()||this.parameters.hasAsyncFunction()}isAsyncFunction(){return O.Instance.isAsyncFunction(this.originalValue)}addToAsyncList(e){let t;if(this.isAsyncFunction()&&(t={operand:this}),this.parameters.hasAsyncFunction()){let e=[];this.parameters.addToAsyncList(e),e.forEach(e=>e.parent=t),t||(t={}),t.children=e}t&&e.push(t)}isContentEqual(e){return e.originalValue==this.originalValue&&this.areOperatorsEquals(e.parameters,this.parameters)}}class ee{static throwInvalidOperatorError(e){throw Error("Invalid operator: '"+e+"'")}static safeToString(e,t){return null==e?"":e.toString(t)}static toOperandString(e){return!e||a.isNumber(e)||ee.isBooleanValue(e)||(e="'"+e+"'"),e}static isBooleanValue(e){return!!e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())}static countDecimals(e){if(a.isNumber(e)&&Math.floor(e)!==e){let t=e.toString().split(".");return t.length>1&&t[1].length||0}return 0}static plusMinus(e,t,s){let i=ee.countDecimals(e),r=ee.countDecimals(t);if(i>0||r>0){let e=Math.max(i,r);s=parseFloat(s.toFixed(e))}return s}static isTwoValueEquals(e,t,s=!0){return"undefined"===e&&(e=void 0),"undefined"===t&&(t=void 0),a.isTwoValueEquals(e,t,s)}static operatorToString(e){let t=ee.signs[e];return null==t?e:t}static convertValForDateCompare(e,t){if(t instanceof Date&&"string"==typeof e){let t=n("expression-operand",e);return t.setHours(0,0,0),t}return e}}ee.unaryFunctions={empty:function(e){return a.isValueEmpty(e)},notempty:function(e){return!ee.unaryFunctions.empty(e)},negate:function(e){return!e}},ee.binaryFunctions={arithmeticOp(e){let t=(e,t)=>a.isValueEmpty(e)?"number"==typeof t?0:"string"==typeof e?e:"string"==typeof t?"":Array.isArray(t)?[]:0:e;return function(s,i){s=t(s,i),i=t(i,s);let r=ee.binaryFunctions[e];return null==r?null:r.call(this,s,i)}},and:function(e,t){return e&&t},or:function(e,t){return e||t},plus:function(e,t){return a.sumAnyValues(e,t)},minus:function(e,t){return a.correctAfterPlusMinis(e,t,e-t)},mul:function(e,t){return a.correctAfterMultiple(e,t,e*t)},div:function(e,t){return t?e/t:null},mod:function(e,t){return t?e%t:null},power:function(e,t){return Math.pow(e,t)},greater:function(e,t){return null!=e&&null!=t&&(e=ee.convertValForDateCompare(e,t),t=ee.convertValForDateCompare(t,e),e>t)},less:function(e,t){return null!=e&&null!=t&&(e=ee.convertValForDateCompare(e,t),t=ee.convertValForDateCompare(t,e),e<t)},greaterorequal:function(e,t){return!!ee.binaryFunctions.equal(e,t)||ee.binaryFunctions.greater(e,t)},lessorequal:function(e,t){return!!ee.binaryFunctions.equal(e,t)||ee.binaryFunctions.less(e,t)},equal:function(e,t,s){return e=ee.convertValForDateCompare(e,t),t=ee.convertValForDateCompare(t,e),ee.isTwoValueEquals(e,t,!0!==s)},notequal:function(e,t,s){return!ee.binaryFunctions.equal(e,t,s)},contains:function(e,t){return ee.binaryFunctions.containsCore(e,t,!0)},notcontains:function(e,t){return!(e||a.isValueEmpty(t))||ee.binaryFunctions.containsCore(e,t,!1)},anyof:function(e,t){if(a.isValueEmpty(e)&&a.isValueEmpty(t))return!0;if(a.isValueEmpty(e)||!Array.isArray(e)&&0===e.length)return!1;if(a.isValueEmpty(t))return!0;if(!Array.isArray(e))return ee.binaryFunctions.contains(t,e);if(!Array.isArray(t))return ee.binaryFunctions.contains(e,t);for(var s=0;s<t.length;s++)if(ee.binaryFunctions.contains(e,t[s]))return!0;return!1},allof:function(e,t){if(!e&&!a.isValueEmpty(t))return!1;if(!Array.isArray(t))return ee.binaryFunctions.contains(e,t);for(var s=0;s<t.length;s++)if(!ee.binaryFunctions.contains(e,t[s]))return!1;return!0},containsCore:function(e,t,s){if(!e&&0!==e&&!1!==e)return!1;if(!e.length&&(e=e.toString(),("string"==typeof t||t instanceof String)&&(e=e.toUpperCase(),t=t.toUpperCase())),"string"==typeof e||e instanceof String){if(!t)return!1;t=t.toString();var i=e.indexOf(t)>-1;return s?i:!i}for(var r=Array.isArray(t)?t:[t],n=0;n<r.length;n++){var a=0;for(t=r[n];a<e.length&&!ee.isTwoValueEquals(e[a],t);a++);if(a==e.length)return!s}return s}},ee.signs={less:"<",lessorequal:"<=",greater:">",greaterorequal:">=",equal:"==",notequal:"!=",plus:"+",minus:"-",mul:"*",div:"/",and:"and",or:"or",power:"^",mod:"%",negate:"!"};class et extends Error{static buildMessage(e,t){function s(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,e=>"\\x0"+s(e)).replace(/[\x10-\x1F\x7F-\x9F]/g,e=>"\\x"+s(e))}function r(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,e=>"\\x0"+s(e)).replace(/[\x10-\x1F\x7F-\x9F]/g,e=>"\\x"+s(e))}function n(e){switch(e.type){case"literal":return'"'+i(e.text)+'"';case"class":let t=e.parts.map(e=>Array.isArray(e)?r(e[0])+"-"+r(e[1]):r(e));return"["+(e.inverted?"^":"")+t+"]";case"any":return"any character";case"end":return"end of input";case"other":return e.description}}return"Expected "+function(e){let t,s;let i=e.map(n);if(i.sort(),i.length>0){for(t=1,s=1;t<i.length;t++)i[t-1]!==i[t]&&(i[s]=i[t],s++);i.length=s}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+(t?'"'+i(t)+'"':"end of input")+" found."}constructor(e,t,s,i){super(),this.message=e,this.expected=t,this.found=s,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,et)}}let es=function(e,t){var s,i,r;let n;t=void 0!==t?t:{};let a={},o={Expression:e2},l=e2,h=function(e,t){return tv(e,t,!0)},u=e$("||",!1),d=e$("or",!0),c=e$("&&",!1),g=e$("and",!0),p=function(e,t){return tv(e,t)},m=e$("<=",!1),v=e$("lessorequal",!0),y=e$(">=",!1),C=e$("greaterorequal",!0),f=e$("==",!1),b="equal",V=e$("equal",!0),w=function(){return"equal"},x=e$("=",!1),P=e$("!=",!1),T=e$("notequal",!0),S=e$("<",!1),I=e$("less",!0),E=e$(">",!1),R=e$("greater",!0),A=e$("+",!1),D=e$("-",!1),O=e$("*",!1),L=e$("/",!1),N=e$("%",!1),k=e$("^",!1),F=e$("power",!0),M=e$("*=",!1),_=e$("contains",!0),q=e$("contain",!0),B=e$("notcontains",!0),Q=e$("notcontain",!0),z=e$("anyof",!0),H=e$("allof",!0),W=e$("(",!1),U=e$(")",!1),j=e$("!",!1),J=e$("negate",!0),ee=e$("empty",!0),es=e$("notempty",!0),ei="undefined",er=e$("undefined",!1),en="null",ea=e$("null",!1),eo=e$("{",!1),el=e$("}",!1),eh=function(e){return e},eu=e$("''",!1),ed=function(){return""},ec=e$('""',!1),eg=e$("'",!1),ep=function(e){return"'"+e+"'"},em=e$('"',!1),ev=e$("[",!1),ey=e$("]",!1),eC=e$(",",!1),ef=function(e,t){if(null==e)return new Y([]);var s=[e];if(Array.isArray(t)){for(var i,r=(i=t,[].concat.apply([],i)),n=3;n<r.length;n+=4)s.push(r[n])}return new Y(s)},eb=e$("true",!0),eV=e$("false",!0),ew=e$("0x",!1),ex=/^[\-]/,eP=eZ(["-"],!1,!1),eT=e$(".",!1),eS=e$("0",!1),eI=function(e){return e.join("")},eE=e$("\\'",!1),eR=e$('\\"',!1),eA=/^[^"']/,eD=eZ(['"',"'"],!0,!1),eO=function(){return eX()},eL=/^[^{}]/,eN=eZ(["{","}"],!0,!1),ek=/^[0-9]/,eF=eZ([["0","9"]],!1,!1),eM=/^[1-9]/,e_=eZ([["1","9"]],!1,!1),eq=/^[a-zA-Z_]/,eB=eZ([["a","z"],["A","Z"],"_"],!1,!1),eQ={type:"other",description:"whitespace"},ez=/^[ \t\n\r]/,eH=eZ([" ","	","\n","\r"],!1,!1),eW=0,eU=0,ej=[{line:1,column:1}],eJ=0,eG=[],eK=0,eY={};if(void 0!==t.startRule){if(!(t.startRule in o))throw Error("Can't start parsing from rule \""+t.startRule+'".');l=o[t.startRule]}function eX(){return e.substring(eU,eW)}function e$(e,t){return{type:"literal",text:e,ignoreCase:t}}function eZ(e,t,s){return{type:"class",parts:e,inverted:t,ignoreCase:s}}function e0(t){let s,i=ej[t];if(i)return i;for(s=t-1;!ej[s];)s--;for(i={line:(i=ej[s]).line,column:i.column};s<t;)10===e.charCodeAt(s)?(i.line++,i.column=1):i.column++,s++;return ej[t]=i,i}function e1(e){!(eW<eJ)&&(eW>eJ&&(eJ=eW,eG=[]),eG.push(e))}function e2(){let e,t,s,i,r,n,o,l,u;let d=34*eW+0,c=eY[d];if(c)return eW=c.nextPos,c.result;if(e=eW,tm()!==a){if((s=e3())!==a){for(i=[],r=eW,(n=tm())!==a&&(o=e4())!==a&&(l=tm())!==a&&(u=e3())!==a?r=n=[n,o,l,u]:(eW=r,r=a);r!==a;)i.push(r),r=eW,(n=tm())!==a&&(o=e4())!==a&&(l=tm())!==a&&(u=e3())!==a?r=n=[n,o,l,u]:(eW=r,r=a);i!==a&&(r=tm())!==a?(eU=e,e=h(s,i)):(eW=e,e=a)}else eW=e,e=a}else eW=e,e=a;return eY[d]={nextPos:eW,result:e},e}function e4(){let t,s;let i=34*eW+1,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,"||"===e.substr(eW,2)?(s="||",eW+=2):(s=a,0===eK&&e1(u)),s===a&&("or"===e.substr(eW,2).toLowerCase()?(s=e.substr(eW,2),eW+=2):(s=a,0===eK&&e1(d))),s!==a&&(eU=t,s="or"),t=s,eY[i]={nextPos:eW,result:t},t)}function e3(){let e,t,s,i,r,n,o,l;let u=34*eW+2,d=eY[u];if(d)return eW=d.nextPos,d.result;if(e=eW,(t=e5())!==a){for(s=[],i=eW,(r=tm())!==a&&(n=e6())!==a&&(o=tm())!==a&&(l=e5())!==a?i=r=[r,n,o,l]:(eW=i,i=a);i!==a;)s.push(i),i=eW,(r=tm())!==a&&(n=e6())!==a&&(o=tm())!==a&&(l=e5())!==a?i=r=[r,n,o,l]:(eW=i,i=a);s!==a?(eU=e,e=t=h(t,s)):(eW=e,e=a)}else eW=e,e=a;return eY[u]={nextPos:eW,result:e},e}function e6(){let t,s;let i=34*eW+3,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,"&&"===e.substr(eW,2)?(s="&&",eW+=2):(s=a,0===eK&&e1(c)),s===a&&("and"===e.substr(eW,3).toLowerCase()?(s=e.substr(eW,3),eW+=3):(s=a,0===eK&&e1(g))),s!==a&&(eU=t,s="and"),t=s,eY[i]={nextPos:eW,result:t},t)}function e5(){let e,t,s,i,r,n,o,l;let h=34*eW+4,u=eY[h];if(u)return eW=u.nextPos,u.result;if(e=eW,(t=e8())!==a){for(s=[],i=eW,(r=tm())!==a&&(n=e9())!==a&&(o=tm())!==a&&(l=e8())!==a?i=r=[r,n,o,l]:(eW=i,i=a);i!==a;)s.push(i),i=eW,(r=tm())!==a&&(n=e9())!==a&&(o=tm())!==a&&(l=e8())!==a?i=r=[r,n,o,l]:(eW=i,i=a);s!==a?(eU=e,e=t=p(t,s)):(eW=e,e=a)}else eW=e,e=a;return eY[h]={nextPos:eW,result:e},e}function e9(){let t,s;let i=34*eW+5,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,"<="===e.substr(eW,2)?(s="<=",eW+=2):(s=a,0===eK&&e1(m)),s===a&&("lessorequal"===e.substr(eW,11).toLowerCase()?(s=e.substr(eW,11),eW+=11):(s=a,0===eK&&e1(v))),s!==a&&(eU=t,s="lessorequal"),(t=s)===a&&(t=eW,">="===e.substr(eW,2)?(s=">=",eW+=2):(s=a,0===eK&&e1(y)),s===a&&("greaterorequal"===e.substr(eW,14).toLowerCase()?(s=e.substr(eW,14),eW+=14):(s=a,0===eK&&e1(C))),s!==a&&(eU=t,s="greaterorequal"),(t=s)===a&&(t=eW,"=="===e.substr(eW,2)?(s="==",eW+=2):(s=a,0===eK&&e1(f)),s===a&&(e.substr(eW,5).toLowerCase()===b?(s=e.substr(eW,5),eW+=5):(s=a,0===eK&&e1(V))),s!==a&&(eU=t,s=w()),(t=s)===a&&(t=eW,61===e.charCodeAt(eW)?(s="=",eW++):(s=a,0===eK&&e1(x)),s===a&&(e.substr(eW,5).toLowerCase()===b?(s=e.substr(eW,5),eW+=5):(s=a,0===eK&&e1(V))),s!==a&&(eU=t,s=w()),(t=s)===a&&(t=eW,"!="===e.substr(eW,2)?(s="!=",eW+=2):(s=a,0===eK&&e1(P)),s===a&&("notequal"===e.substr(eW,8).toLowerCase()?(s=e.substr(eW,8),eW+=8):(s=a,0===eK&&e1(T))),s!==a&&(eU=t,s="notequal"),(t=s)===a&&(t=eW,60===e.charCodeAt(eW)?(s="<",eW++):(s=a,0===eK&&e1(S)),s===a&&("less"===e.substr(eW,4).toLowerCase()?(s=e.substr(eW,4),eW+=4):(s=a,0===eK&&e1(I))),s!==a&&(eU=t,s="less"),(t=s)===a&&(t=eW,62===e.charCodeAt(eW)?(s=">",eW++):(s=a,0===eK&&e1(E)),s===a&&("greater"===e.substr(eW,7).toLowerCase()?(s=e.substr(eW,7),eW+=7):(s=a,0===eK&&e1(R))),s!==a&&(eU=t,s="greater"),t=s)))))),eY[i]={nextPos:eW,result:t},t)}function e8(){let e,t,s,i,r,n,o,l;let u=34*eW+6,d=eY[u];if(d)return eW=d.nextPos,d.result;if(e=eW,(t=te())!==a){for(s=[],i=eW,(r=tm())!==a&&(n=e7())!==a&&(o=tm())!==a&&(l=te())!==a?i=r=[r,n,o,l]:(eW=i,i=a);i!==a;)s.push(i),i=eW,(r=tm())!==a&&(n=e7())!==a&&(o=tm())!==a&&(l=te())!==a?i=r=[r,n,o,l]:(eW=i,i=a);s!==a?(eU=e,e=t=h(t,s)):(eW=e,e=a)}else eW=e,e=a;return eY[u]={nextPos:eW,result:e},e}function e7(){let t,s;let i=34*eW+7,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,43===e.charCodeAt(eW)?(s="+",eW++):(s=a,0===eK&&e1(A)),s!==a&&(eU=t,s="plus"),(t=s)===a&&(t=eW,45===e.charCodeAt(eW)?(s="-",eW++):(s=a,0===eK&&e1(D)),s!==a&&(eU=t,s="minus"),t=s),eY[i]={nextPos:eW,result:t},t)}function te(){let e,t,s,i,r,n,o,l;let u=34*eW+8,d=eY[u];if(d)return eW=d.nextPos,d.result;if(e=eW,(t=ts())!==a){for(s=[],i=eW,(r=tm())!==a&&(n=tt())!==a&&(o=tm())!==a&&(l=ts())!==a?i=r=[r,n,o,l]:(eW=i,i=a);i!==a;)s.push(i),i=eW,(r=tm())!==a&&(n=tt())!==a&&(o=tm())!==a&&(l=ts())!==a?i=r=[r,n,o,l]:(eW=i,i=a);s!==a?(eU=e,e=t=h(t,s)):(eW=e,e=a)}else eW=e,e=a;return eY[u]={nextPos:eW,result:e},e}function tt(){let t,s;let i=34*eW+9,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,42===e.charCodeAt(eW)?(s="*",eW++):(s=a,0===eK&&e1(O)),s!==a&&(eU=t,s="mul"),(t=s)===a&&(t=eW,47===e.charCodeAt(eW)?(s="/",eW++):(s=a,0===eK&&e1(L)),s!==a&&(eU=t,s="div"),(t=s)===a&&(t=eW,37===e.charCodeAt(eW)?(s="%",eW++):(s=a,0===eK&&e1(N)),s!==a&&(eU=t,s="mod"),t=s)),eY[i]={nextPos:eW,result:t},t)}function ts(){let e,t,s,i,r,n,o,l;let u=34*eW+10,d=eY[u];if(d)return eW=d.nextPos,d.result;if(e=eW,(t=tr())!==a){for(s=[],i=eW,(r=tm())!==a&&(n=ti())!==a&&(o=tm())!==a&&(l=tr())!==a?i=r=[r,n,o,l]:(eW=i,i=a);i!==a;)s.push(i),i=eW,(r=tm())!==a&&(n=ti())!==a&&(o=tm())!==a&&(l=tr())!==a?i=r=[r,n,o,l]:(eW=i,i=a);s!==a?(eU=e,e=t=h(t,s)):(eW=e,e=a)}else eW=e,e=a;return eY[u]={nextPos:eW,result:e},e}function ti(){let t,s;let i=34*eW+11,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,94===e.charCodeAt(eW)?(s="^",eW++):(s=a,0===eK&&e1(k)),s===a&&("power"===e.substr(eW,5).toLowerCase()?(s=e.substr(eW,5),eW+=5):(s=a,0===eK&&e1(F))),s!==a&&(eU=t,s="power"),t=s,eY[i]={nextPos:eW,result:t},t)}function tr(){let e,t,s,i,r,n,o,l;let h=34*eW+12,u=eY[h];if(u)return eW=u.nextPos,u.result;if(e=eW,(t=ta())!==a){for(s=[],i=eW,(r=tm())!==a&&(n=tn())!==a&&(o=tm())!==a?((l=ta())===a&&(l=null),l!==a?i=r=[r,n,o,l]:(eW=i,i=a)):(eW=i,i=a);i!==a;)s.push(i),i=eW,(r=tm())!==a&&(n=tn())!==a&&(o=tm())!==a?((l=ta())===a&&(l=null),l!==a?i=r=[r,n,o,l]:(eW=i,i=a)):(eW=i,i=a);s!==a?(eU=e,e=t=p(t,s)):(eW=e,e=a)}else eW=e,e=a;return eY[h]={nextPos:eW,result:e},e}function tn(){let t,s;let i=34*eW+13,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,"*="===e.substr(eW,2)?(s="*=",eW+=2):(s=a,0===eK&&e1(M)),s===a&&("contains"===e.substr(eW,8).toLowerCase()?(s=e.substr(eW,8),eW+=8):(s=a,0===eK&&e1(_)),s===a&&("contain"===e.substr(eW,7).toLowerCase()?(s=e.substr(eW,7),eW+=7):(s=a,0===eK&&e1(q)))),s!==a&&(eU=t,s="contains"),(t=s)===a&&(t=eW,"notcontains"===e.substr(eW,11).toLowerCase()?(s=e.substr(eW,11),eW+=11):(s=a,0===eK&&e1(B)),s===a&&("notcontain"===e.substr(eW,10).toLowerCase()?(s=e.substr(eW,10),eW+=10):(s=a,0===eK&&e1(Q))),s!==a&&(eU=t,s="notcontains"),(t=s)===a&&(t=eW,"anyof"===e.substr(eW,5).toLowerCase()?(s=e.substr(eW,5),eW+=5):(s=a,0===eK&&e1(z)),s!==a&&(eU=t,s="anyof"),(t=s)===a&&(t=eW,"allof"===e.substr(eW,5).toLowerCase()?(s=e.substr(eW,5),eW+=5):(s=a,0===eK&&e1(H)),s!==a&&(eU=t,s="allof"),t=s))),eY[i]={nextPos:eW,result:t},t)}function ta(){let t,s,i,r;let n=34*eW+14,o=eY[n];return o?(eW=o.nextPos,o.result):((t=eW,40===e.charCodeAt(eW)?(s="(",eW++):(s=a,0===eK&&e1(W)),s!==a&&tm()!==a&&(i=e2())!==a&&tm()!==a&&(41===e.charCodeAt(eW)?(r=")",eW++):(r=a,0===eK&&e1(U)),r===a&&(r=null),r!==a))?(eU=t,t=s=i):(eW=t,t=a),t===a&&(t=function(){let t,s,i,r,n;let o=34*eW+15,l=eY[o];return l?(eW=l.nextPos,l.result):((t=eW,(s=tc())!==a&&(40===e.charCodeAt(eW)?(i="(",eW++):(i=a,0===eK&&e1(W)),i!==a&&(r=tl())!==a&&(41===e.charCodeAt(eW)?(n=")",eW++):(n=a,0===eK&&e1(U)),n===a&&(n=null),n!==a)))?(eU=t,t=s=new Z(s,r)):(eW=t,t=a),eY[o]={nextPos:eW,result:t},t)}())===a&&(t=function(){let t,s,i,r;let n=34*eW+16,o=eY[n];return o?(eW=o.nextPos,o.result):((t=eW,33===e.charCodeAt(eW)?(s="!",eW++):(s=a,0===eK&&e1(j)),s===a&&("negate"===e.substr(eW,6).toLowerCase()?(s=e.substr(eW,6),eW+=6):(s=a,0===eK&&e1(J))),s!==a&&tm()!==a&&(r=e2())!==a)?(eU=t,t=s=new K(r,"negate")):(eW=t,t=a),t===a&&((t=eW,(s=to())!==a&&tm()!==a&&(r=function(){let t,s;let i=34*eW+17,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,"empty"===e.substr(eW,5).toLowerCase()?(s=e.substr(eW,5),eW+=5):(s=a,0===eK&&e1(ee)),s!==a&&(eU=t,s="empty"),(t=s)===a&&(t=eW,"notempty"===e.substr(eW,8).toLowerCase()?(s=e.substr(eW,8),eW+=8):(s=a,0===eK&&e1(es)),s!==a&&(eU=t,s="notempty"),t=s),eY[i]={nextPos:eW,result:t},t)}())!==a)?(eU=t,t=s=new K(s,r)):(eW=t,t=a)),eY[n]={nextPos:eW,result:t},t)}())===a&&(t=to())===a&&(t=function(){let t,s,i,r;let n=34*eW+20,o=eY[n];return o?(eW=o.nextPos,o.result):((t=eW,91===e.charCodeAt(eW)?(s="[",eW++):(s=a,0===eK&&e1(ev)),s!==a&&(i=tl())!==a&&(93===e.charCodeAt(eW)?(r="]",eW++):(r=a,0===eK&&e1(ey)),r!==a))?(eU=t,t=s=i):(eW=t,t=a),eY[n]={nextPos:eW,result:t},t)}()),eY[n]={nextPos:eW,result:t},t)}function to(){let t,s,i,r,n;let o=34*eW+18,l=eY[o];return l?(eW=l.nextPos,l.result):(t=eW,tm()!==a?(e.substr(eW,9)===ei?(i=ei,eW+=9):(i=a,0===eK&&e1(er)),i===a&&(e.substr(eW,4)===en?(i=en,eW+=4):(i=a,0===eK&&e1(ea))),i!==a?(eU=t,t=null):(eW=t,t=a)):(eW=t,t=a),t===a&&((t=eW,tm()!==a&&(i=function(){let t,s,i,r;let n=34*eW+19,o=eY[n];return o?(eW=o.nextPos,o.result):(t=eW,(s=function(){let t,s;let i=34*eW+22,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,"true"===e.substr(eW,4).toLowerCase()?(s=e.substr(eW,4),eW+=4):(s=a,0===eK&&e1(eb)),s!==a&&(eU=t,s=!0),(t=s)===a&&(t=eW,"false"===e.substr(eW,5).toLowerCase()?(s=e.substr(eW,5),eW+=5):(s=a,0===eK&&e1(eV)),s!==a&&(eU=t,s=!1),t=s),eY[i]={nextPos:eW,result:t},t)}())!==a&&(eU=t,s=eh(s)),(t=s)===a&&(t=eW,(s=function(){let t,s,i;let r=34*eW+23,n=eY[r];if(n)return eW=n.nextPos,n.result;if(t=eW,"0x"===e.substr(eW,2)?(s="0x",eW+=2):(s=a,0===eK&&e1(ew)),s!==a&&(i=tg())!==a?(eU=t,t=s=parseInt(eX(),16)):(eW=t,t=a),t===a){if(t=eW,ex.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eP)),s===a&&(s=null),s!==a){if((i=function(){let t,s,i;let r=34*eW+24,n=eY[r];return n?(eW=n.nextPos,n.result):(t=eW,(s=tg())!==a?(46===e.charCodeAt(eW)?(i=".",eW++):(i=a,0===eK&&e1(eT)),i!==a&&tg()!==a?(eU=t,t=s=parseFloat(eX())):(eW=t,t=a)):(eW=t,t=a),t===a&&(t=eW,(s=function(){let t,s;let i=34*eW+31,r=eY[i];if(r)return eW=r.nextPos,r.result;if(t=[],eM.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(e_)),s!==a)for(;s!==a;)t.push(s),eM.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(e_));else t=a;return eY[i]={nextPos:eW,result:t},t}())!==a?((i=tg())===a&&(i=null),i!==a?(eU=t,t=s=parseInt(eX(),10)):(eW=t,t=a)):(eW=t,t=a),t===a&&(t=eW,48===e.charCodeAt(eW)?(s="0",eW++):(s=a,0===eK&&e1(eS)),s!==a&&(eU=t,s=0),t=s)),eY[r]={nextPos:eW,result:t},t)}())!==a){var o,l;eU=t,o=s,l=i,t=s=null==o?l:-l}else eW=t,t=a}else eW=t,t=a}return eY[r]={nextPos:eW,result:t},t}())!==a&&(eU=t,s=eh(s)),(t=s)===a&&(t=eW,(s=tc())!==a&&(eU=t,s=eh(s)),(t=s)===a&&(t=eW,"''"===e.substr(eW,2)?(s="''",eW+=2):(s=a,0===eK&&e1(eu)),s!==a&&(eU=t,s=ed()),(t=s)===a&&(t=eW,'""'===e.substr(eW,2)?(s='""',eW+=2):(s=a,0===eK&&e1(ec)),s!==a&&(eU=t,s=ed()),(t=s)===a&&(t=eW,39===e.charCodeAt(eW)?(s="'",eW++):(s=a,0===eK&&e1(eg)),s!==a&&(i=th())!==a?(39===e.charCodeAt(eW)?(r="'",eW++):(r=a,0===eK&&e1(eg)),r!==a?(eU=t,t=s=ep(i)):(eW=t,t=a)):(eW=t,t=a),t===a&&(t=eW,34===e.charCodeAt(eW)?(s='"',eW++):(s=a,0===eK&&e1(em)),s!==a&&(i=th())!==a?(34===e.charCodeAt(eW)?(r='"',eW++):(r=a,0===eK&&e1(em)),r!==a?(eU=t,t=s=ep(i)):(eW=t,t=a)):(eW=t,t=a))))))),eY[n]={nextPos:eW,result:t},t)}())!==a)?(eU=t,t=new X(i)):(eW=t,t=a),t===a&&((t=eW,tm()!==a&&(123===e.charCodeAt(eW)?(i="{",eW++):(i=a,0===eK&&e1(eo)),i!==a&&(r=function(){let e,t,s;let i=34*eW+25,r=eY[i];if(r)return eW=r.nextPos,r.result;if(e=eW,t=[],(s=td())!==a)for(;s!==a;)t.push(s),s=td();else t=a;return t!==a&&(eU=e,t=eI(t)),e=t,eY[i]={nextPos:eW,result:e},e}())!==a&&(125===e.charCodeAt(eW)?(n="}",eW++):(n=a,0===eK&&e1(el)),n!==a)))?(eU=t,t=new $(r)):(eW=t,t=a))),eY[o]={nextPos:eW,result:t},t)}function tl(){let t,s,i,r,n,o,l,h;let u=34*eW+21,d=eY[u];if(d)return eW=d.nextPos,d.result;if(t=eW,(s=e2())===a&&(s=null),s!==a){for(i=[],r=eW,(n=tm())!==a?(44===e.charCodeAt(eW)?(o=",",eW++):(o=a,0===eK&&e1(eC)),o!==a&&(l=tm())!==a&&(h=e2())!==a?r=n=[n,o,l,h]:(eW=r,r=a)):(eW=r,r=a);r!==a;)i.push(r),r=eW,(n=tm())!==a?(44===e.charCodeAt(eW)?(o=",",eW++):(o=a,0===eK&&e1(eC)),o!==a&&(l=tm())!==a&&(h=e2())!==a?r=n=[n,o,l,h]:(eW=r,r=a)):(eW=r,r=a);i!==a?(eU=t,t=s=ef(s,i)):(eW=t,t=a)}else eW=t,t=a;return eY[u]={nextPos:eW,result:t},t}function th(){let e,t,s;let i=34*eW+26,r=eY[i];if(r)return eW=r.nextPos,r.result;if(e=eW,t=[],(s=tu())!==a)for(;s!==a;)t.push(s),s=tu();else t=a;return t!==a&&(eU=e,t=eI(t)),e=t,eY[i]={nextPos:eW,result:e},e}function tu(){let t,s;let i=34*eW+27,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,"\\'"===e.substr(eW,2)?(s="\\'",eW+=2):(s=a,0===eK&&e1(eE)),s!==a&&(eU=t,s="'"),(t=s)===a&&(t=eW,'\\"'===e.substr(eW,2)?(s='\\"',eW+=2):(s=a,0===eK&&e1(eR)),s!==a&&(eU=t,s='"'),(t=s)===a&&(t=eW,eA.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eD)),s!==a&&(eU=t,s=eO()),t=s)),eY[i]={nextPos:eW,result:t},t)}function td(){let t,s;let i=34*eW+28,r=eY[i];return r?(eW=r.nextPos,r.result):(t=eW,eL.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eN)),s!==a&&(eU=t,s=eO()),t=s,eY[i]={nextPos:eW,result:t},t)}function tc(){let e,t,s,i,r,n,o;let l=34*eW+29,h=eY[l];if(h)return eW=h.nextPos,h.result;if(e=eW,tp()!==a){if(s=[],i=eW,(r=tg())!==a){for(n=[],o=tp();o!==a;)n.push(o),o=tp();n!==a?i=r=[r,n]:(eW=i,i=a)}else eW=i,i=a;for(;i!==a;)if(s.push(i),i=eW,(r=tg())!==a){for(n=[],o=tp();o!==a;)n.push(o),o=tp();n!==a?i=r=[r,n]:(eW=i,i=a)}else eW=i,i=a;s!==a?(eU=e,e=eO()):(eW=e,e=a)}else eW=e,e=a;return eY[l]={nextPos:eW,result:e},e}function tg(){let t,s;let i=34*eW+30,r=eY[i];if(r)return eW=r.nextPos,r.result;if(t=[],ek.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eF)),s!==a)for(;s!==a;)t.push(s),ek.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eF));else t=a;return eY[i]={nextPos:eW,result:t},t}function tp(){let t,s;let i=34*eW+32,r=eY[i];if(r)return eW=r.nextPos,r.result;if(t=[],eq.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eB)),s!==a)for(;s!==a;)t.push(s),eq.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eB));else t=a;return eY[i]={nextPos:eW,result:t},t}function tm(){let t,s;let i=34*eW+33,r=eY[i];if(r)return eW=r.nextPos,r.result;for(eK++,t=[],ez.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eH));s!==a;)t.push(s),ez.test(e.charAt(eW))?(s=e.charAt(eW),eW++):(s=a,0===eK&&e1(eH));return eK--,t===a&&(s=a,0===eK&&e1(eQ)),eY[i]={nextPos:eW,result:t},t}function tv(e,t,s=!1){return t.reduce(function(e,t){return new G(t[1],e,t[3],s)},e)}if((n=l())!==a&&eW===e.length)return n;throw n!==a&&eW<e.length&&e1({type:"end"}),s=eG,i=eJ<e.length?e.charAt(eJ):null,r=function(e,t){let s=e0(e),i=e0(t);return{start:{offset:e,line:s.line,column:s.column},end:{offset:t,line:i.line,column:i.column}}}(eJ,eJ<e.length?eJ+1:eJ),new et(et.buildMessage(s,i),s,i,r)};class ei{constructor(e,t){this.at=e,this.code=t}}class er{patchExpression(e){return e.replace(/=>/g,">=").replace(/=</g,"<=").replace(/<>/g,"!=").replace(/equals/g,"equal ").replace(/notequals/g,"notequal ")}createCondition(e){return this.parseExpression(e)}parseExpression(e){try{var t=er.parserCache[e];return void 0!==t||(t=es(this.patchExpression(e))).hasAsyncFunction()||(er.parserCache[e]=t),t}catch(e){e instanceof et&&(this.conditionError=new ei(e.location.start.offset,e.message))}}get error(){return this.conditionError}}er.parserCache={};class en{constructor(e,t,s,i,r){this.operand=e,this.id=t,this.onComplete=s,this.processValue=new A,this.processValue.values=i,this.processValue.properties=r}run(e){if(!e)return this.runValues();this.processValue.values=a.createCopy(this.processValue.values),this.processValue.onCompleteAsyncFunc=e=>{let t=this.getAsyncItemByOperand(e,this.asyncFuncList);t&&this.doAsyncFunctionReady(t)},this.asyncFuncList=[],this.operand.addToAsyncList(this.asyncFuncList);for(var t=0;t<this.asyncFuncList.length;t++)this.runAsyncItem(this.asyncFuncList[t]);return!1}getAsyncItemByOperand(e,t){if(!Array.isArray(t))return null;for(let s=0;s<t.length;s++){if(t[s].operand===e)return t[s];let i=this.getAsyncItemByOperand(e,t[s].children);if(i)return i}return null}runAsyncItem(e){e.children?e.children.forEach(e=>this.runAsyncItem(e)):this.runAsyncItemCore(e)}runAsyncItemCore(e){e.operand?e.operand.evaluate(this.processValue):this.doAsyncFunctionReady(e)}doAsyncFunctionReady(e){if(e.parent&&this.isAsyncChildrenReady(e)){this.runAsyncItemCore(e.parent);return}for(var t=0;t<this.asyncFuncList.length;t++)if(!this.isAsyncFuncReady(this.asyncFuncList[t]))return;this.runValues()}isAsyncFuncReady(e){return(!e.operand||!!e.operand.isReady(this.processValue))&&this.isAsyncChildrenReady(e)}isAsyncChildrenReady(e){if(e.children){for(let t=0;t<e.children.length;t++)if(!this.isAsyncFuncReady(e.children[t]))return!1}return!0}runValues(){var e=this.operand.evaluate(this.processValue);return this.onComplete&&this.onComplete(e,this.id),e}}class ea{constructor(e){this.parser=new er,this.isAsyncValue=!1,this.hasFunctionValue=!1,this.setExpression(e)}get expression(){return this.expressionValue}setExpression(e){this.expression!==e&&(this.expressionValue=e,this.operand=this.parser.parseExpression(e),this.hasFunctionValue=!!this.canRun()&&this.operand.hasFunction(),this.isAsyncValue=!!this.hasFunction()&&this.operand.hasAsyncFunction())}getVariables(){if(!this.operand)return[];var e=[];return this.operand.setVariables(e),e}hasFunction(){return this.hasFunctionValue}get isAsync(){return this.isAsyncValue}canRun(){return!!this.operand}run(e,t=null,s){return this.operand?new en(this.operand,s,this.onComplete,e,t).run(this.isAsync):(this.expression&&D.warn("Invalid expression: "+this.expression),null)}}ea.createExpressionExecutor=e=>new ea(e);class eo{constructor(e){this.expression=e}get expression(){return this.expressionExecutor?this.expressionExecutor.expression:""}set expression(e){this.expressionExecutor&&e===this.expression||(this.expressionExecutor=ea.createExpressionExecutor(e),this.expressionExecutor.onComplete=(e,t)=>{this.doOnComplete(e,t)},this.variables=void 0,this.containsFunc=void 0)}getVariables(){return void 0===this.variables&&(this.variables=this.expressionExecutor.getVariables()),this.variables}hasFunction(){return void 0===this.containsFunc&&(this.containsFunc=this.expressionExecutor.hasFunction()),this.containsFunc}get isAsync(){return this.expressionExecutor.isAsync}canRun(){return this.expressionExecutor.canRun()}runCore(e,t=null){let s=eo.IdRunnerCounter++;return this.onBeforeAsyncRun&&this.isAsync&&this.onBeforeAsyncRun(s),this.expressionExecutor.run(e,t,s)}doOnComplete(e,t){this.onAfterAsyncRun&&this.isAsync&&this.onAfterAsyncRun(t)}}eo.IdRunnerCounter=1;class el extends eo{run(e,t=null){return!0==this.runCore(e,t)}doOnComplete(e,t){this.onRunComplete&&this.onRunComplete(!0==e),super.doOnComplete(e,t)}}class eh extends eo{run(e,t=null){return this.runCore(e,t)}doOnComplete(e,t){this.onRunComplete&&this.onRunComplete(e),super.doOnComplete(e,t)}}class eu{constructor(e){this.obj=e,this.properties=null,this.values=null}getType(){return"bindings"}get isSurveyObj(){return!0}getNames(){var e=[];this.fillProperties();for(var t=0;t<this.properties.length;t++)this.properties[t].isVisible("",this.obj)&&e.push(this.properties[t].name);return e}getProperties(){var e=[];this.fillProperties();for(var t=0;t<this.properties.length;t++)e.push(this.properties[t]);return e}setBinding(e,t){this.values||(this.values={});let s=this.getJson();s!==t&&(t?this.values[e]=t:(delete this.values[e],0==Object.keys(this.values).length&&(this.values=null)),this.onChangedJSON(s))}clearBinding(e){this.setBinding(e,"")}isEmpty(){if(!this.values)return!0;for(var e in this.values)return!1;return!0}getValueNameByPropertyName(e){if(this.values)return this.values[e]}getPropertiesByValueName(e){if(!this.values)return[];var t=[];for(var s in this.values)this.values[s]==e&&t.push(s);return t}getJson(){if(!this.isEmpty()){var e={};for(var t in this.values)e[t]=this.values[t];return e}}setJson(e,t){let s=this.getJson();if(this.values=null,e)for(var i in this.values={},e)this.values[i]=e[i];t||this.onChangedJSON(s)}fillProperties(){if(null===this.properties){this.properties=[];for(var e=E.getPropertiesByObj(this.obj),t=0;t<e.length;t++)e[t].isBindable&&this.properties.push(e[t])}}onChangedJSON(e){this.obj&&this.obj.onBindingChanged(e,this.getJson())}}class ed{constructor(e,t,s){this.currentDependency=e,this.target=t,this.property=s,this.dependencies=[],this.id=""+ ++ed.DependenciesCount}addDependency(e,t){(this.target!==e||this.property!==t)&&(this.dependencies.some(s=>s.obj===e&&s.prop===t)||(this.dependencies.push({obj:e,prop:t,id:this.id}),e.registerPropertyChangedHandlers([t],this.currentDependency,this.id)))}dispose(){this.dependencies.forEach(e=>{e.obj.unregisterPropertyChangedHandlers([e.prop],e.id)})}}ed.DependenciesCount=0;class ec{constructor(e){this._updater=e,this.dependencies=void 0,this.type=ec.ComputedUpdaterType}get updater(){return this._updater}setDependencies(e){this.clearDependencies(),this.dependencies=e}getDependencies(){return this.dependencies}clearDependencies(){this.dependencies&&(this.dependencies.dispose(),this.dependencies=void 0)}dispose(){this.clearDependencies(),this._updater=void 0}}ec.ComputedUpdaterType="__dependency_computed";class eg{static finishCollectDependencies(){let e=eg.currentDependencis;return eg.currentDependencis=void 0,e}static startCollectDependencies(e,t,s){if(void 0!==eg.currentDependencis)throw Error("Attempt to collect nested dependencies. Nested dependencies are not supported.");eg.currentDependencis=new ed(e,t,s)}static collectDependency(e,t){void 0!==eg.currentDependencis&&eg.currentDependencis.addDependency(e,t)}static get commentSuffix(){return tp.commentSuffix}static set commentSuffix(e){tp.commentSuffix=e}static get commentPrefix(){return eg.commentSuffix}static set commentPrefix(e){eg.commentSuffix=e}isValueEmpty(e,t=!0){return t&&(e=this.trimValue(e)),a.isValueEmpty(e)}equals(e){return!!e&&!this.isDisposed&&!e.isDisposed&&this.getType()==e.getType()&&this.equalsCore(e)}equalsCore(e){return this.name===e.name&&a.isTwoValueEquals(this.toJSON(),e.toJSON(),!1,!0,!1)}trimValue(e){return e&&("string"==typeof e||e instanceof String)?e.trim():e}static createPropertiesHash(){return{}}constructor(){this.dependencies={},this.propertyHash=eg.createPropertiesHash(),this.eventList=[],this.isLoadingFromJsonValue=!1,this.loadingOwner=null,this.onPropertyChanged=this.addEvent(),this.onItemValuePropertyChanged=this.addEvent(),this.isCreating=!0,this.animationAllowedLock=0,this.supportOnElementRerenderedEvent=!0,this.onElementRerenderedEventEnabled=!1,this._onElementRerendered=new ev,v.createProperties(this),this.onBaseCreating(),this.isCreating=!1}dispose(){for(var e=0;e<this.eventList.length;e++)this.eventList[e].clear();this.onPropertyValueChangedCallback=void 0,this.isDisposedValue=!0,Object.keys(this.dependencies).forEach(e=>this.dependencies[e].dispose()),Object.keys(this.propertyHash).forEach(e=>{let t=this.getPropertyValueCore(this.propertyHash,e);t&&t.type==ec.ComputedUpdaterType&&t.dispose()})}get isDisposed(){return!0===this.isDisposedValue}get isSurveyObj(){return!0}addEvent(){let e=new ev;return this.eventList.push(e),e}onBaseCreating(){}getType(){return"base"}isDescendantOf(e){return E.isDescendantOf(this.getType(),e)}getSurvey(e=!1){return null}get isDesignMode(){let e=this.getSurvey();return!!e&&e.isDesignMode}get inSurvey(){return!!this.getSurvey(!0)}get bindings(){return this.bindingsValue||(this.bindingsValue=new eu(this)),this.bindingsValue}isBindingEmpty(){return!this.bindingsValue||this.bindingsValue.isEmpty()}checkBindings(e,t){}updateBindings(e,t){if(this.bindingsValue){var s=this.bindings.getValueNameByPropertyName(e);s&&this.updateBindingValue(s,t)}}updateBindingValue(e,t){}getTemplate(){return this.getType()}get isLoadingFromJson(){return this.isLoadingFromJsonValue||this.getIsLoadingFromJson()}getIsLoadingFromJson(){return!!this.loadingOwner&&!!this.loadingOwner.isLoadingFromJson||this.isLoadingFromJsonValue}startLoadingFromJson(e){this.isLoadingFromJsonValue=!0,this.jsonObj=e}endLoadingFromJson(){this.isLoadingFromJsonValue=!1}toJSON(e){return new I().toJsonObject(this,e)}fromJSON(e,t){new I().toObject(e,this,t),this.onSurveyLoad()}onSurveyLoad(){}clone(){var e=E.createClass(this.getType());return e.fromJSON(this.toJSON()),e}getPropertyByName(e){let t=this.getType();return this.classMetaData&&this.classMetaData.name===t||(this.classMetaData=E.findClass(t)),this.classMetaData?this.classMetaData.findProperty(e):null}isPropertyVisible(e){let t=this.getPropertyByName(e);return!!t&&t.isVisible("",this)}static createProgressInfo(){return{questionCount:0,answeredQuestionCount:0,requiredQuestionCount:0,requiredAnsweredQuestionCount:0}}getProgressInfo(){return eg.createProgressInfo()}localeChanged(){}locStrsChanged(){if(this.arraysInfo)for(let t in this.arraysInfo){let s=this.arraysInfo[t];if(s&&s.isItemValues){var e=this.getPropertyValue(t);e&&eg.itemValueLocStrChanged&&eg.itemValueLocStrChanged(e)}}if(this.localizableStrings)for(let e in this.localizableStrings){let t=this.getLocalizableString(e);t&&t.strChanged()}}getPropertyValue(e,t,s){let i=this.getPropertyValueWithoutDefault(e);if(this.isValueUndefined(i)){let i=this.localizableStrings?this.localizableStrings[e]:void 0;if(i)return i.text;if(!this.isValueUndefined(t))return t;if(s){let t=s();if(void 0!==t){if(!Array.isArray(t))return this.setPropertyValueDirectly(e,t),t;{let s=this.createNewArray(e);return s.splice(0,0,...t),s}}}let r=this.getDefaultPropertyValue(e);if(void 0!==r)return r}return i}isValueUndefined(e){return a.isValueUndefined(e)}getDefaultPropertyValue(e){let t=this.getPropertyByName(e);if(!t||t.isCustom&&this.isCreating)return;if(t.defaultValueFunc)return t.defaultValueFunc(this);let s=t.getDefaultValue(this);if(!this.isValueUndefined(s)&&!Array.isArray(s))return s;let i=this.localizableStrings?this.localizableStrings[e]:void 0;return i&&i.localizationName?this.getLocalizationString(i.localizationName):"boolean"!=t.type&&"switch"!=t.type&&(t.isCustom&&t.onGetValue?t.onGetValue(this):void 0)}hasDefaultPropertyValue(e){return void 0!==this.getDefaultPropertyValue(e)}resetPropertyValue(e){let t=this.localizableStrings?this.localizableStrings[e]:void 0;t?(this.setLocalizableStringText(e,void 0),t.clear()):this.setPropertyValue(e,void 0)}getPropertyValueWithoutDefault(e){return this.getPropertyValueCore(this.propertyHash,e)}getPropertyValueCore(e,t){return(this.isLoadingFromJson||eg.collectDependency(this,t),this.getPropertyValueCoreHandler)?this.getPropertyValueCoreHandler(e,t):e[t]}geValueFromHash(){return this.propertyHash.value}setPropertyValueCore(e,t,s){this.setPropertyValueCoreHandler?this.isDisposedValue?D.disposedObjectChangedProperty(t,this.getType()):this.setPropertyValueCoreHandler(e,t,s):e[t]=s}get isEditingSurveyElement(){var e=this.getSurvey();return!!e&&e.isEditingSurveyElement}iteratePropertiesHash(e){var t=[];for(var s in this.propertyHash)"value"===s&&this.isEditingSurveyElement&&Array.isArray(this.value)||t.push(s);t.forEach(t=>e(this.propertyHash,t))}setPropertyValue(e,t){if(!this.isDisposedValue){if(!this.isLoadingFromJson){let s=this.getPropertyByName(e);s&&(t=s.settingValue(this,t))}var s=this.getPropertyValue(e);s&&Array.isArray(s)&&this.arraysInfo&&(!t||Array.isArray(t))?this.isTwoValueEquals(s,t)||this.setArrayPropertyDirectly(e,t):t===s||(this.setPropertyValueDirectly(e,t),this.isTwoValueEquals(s,t)||this.propertyValueChanged(e,s,t))}}setArrayPropertyDirectly(e,t,s=!0){var i=this.arraysInfo[e];this.setArray(e,this.getPropertyValue(e),t,!!i&&i.isItemValues,i?s&&i.onPush:null)}setPropertyValueDirectly(e,t){this.setPropertyValueCore(this.propertyHash,e,t)}clearPropertyValue(e){this.setPropertyValueCore(this.propertyHash,e,null),delete this.propertyHash[e]}onPropertyValueChangedCallback(e,t,s,i,r){}itemValuePropertyChanged(e,t,s,i){this.onItemValuePropertyChanged.fire(this,{obj:e,name:t,oldValue:s,newValue:i,propertyName:e.ownerPropertyName})}onPropertyValueChanged(e,t,s){}propertyValueChanged(e,t,s,i,r){if(!this.isLoadingFromJson&&(this.updateBindings(e,s),this.onPropertyValueChanged(e,t,s),this.onPropertyChanged.fire(this,{name:e,oldValue:t,newValue:s,arrayChanges:i,target:r}),this.doPropertyValueChangedCallback(e,t,s,i,this),this.checkConditionPropertyChanged(e),this.onPropChangeFunctions))for(var n=0;n<this.onPropChangeFunctions.length;n++)this.onPropChangeFunctions[n].name==e&&this.onPropChangeFunctions[n].func(s,i)}onBindingChanged(e,t){this.isLoadingFromJson||this.doPropertyValueChangedCallback("bindings",e,t)}get isInternal(){return!1}doPropertyValueChangedCallback(e,t,s,i,r){let n=n=>{n&&n.onPropertyValueChangedCallback&&n.onPropertyValueChangedCallback(e,t,s,r,i)};if(this.isInternal){n(this);return}r||(r=this);var a=this.getSurvey();a||(a=this),n(a),a!==this&&n(this)}addExpressionProperty(e,t,s){this.expressionInfo||(this.expressionInfo={}),this.expressionInfo[e]={onExecute:t,canRun:s}}getDataFilteredValues(){return{}}getDataFilteredProperties(){return{}}runConditionCore(e,t){if(this.expressionInfo)for(var s in this.expressionInfo)this.runConditionItemCore(s,e,t)}canRunConditions(){return!this.isDesignMode}checkConditionPropertyChanged(e){this.expressionInfo&&this.expressionInfo[e]&&this.canRunConditions()&&this.runConditionItemCore(e,this.getDataFilteredValues(),this.getDataFilteredProperties())}runConditionItemCore(e,t,s){let i=this.expressionInfo[e],r=this.getPropertyValue(e);r&&(!i.canRun||i.canRun(this))&&(i.runner||(i.runner=this.createExpressionRunner(r),i.runner.onRunComplete=e=>{i.onExecute(this,e)}),i.runner.expression=r,i.runner.run(t,s))}doBeforeAsynRun(e){this.asynExpressionHash||(this.asynExpressionHash={});let t=!this.isAsyncExpressionRunning;this.asynExpressionHash[e]=!0,t&&this.onAsyncRunningChanged()}doAfterAsynRun(e){this.asynExpressionHash&&(delete this.asynExpressionHash[e],this.isAsyncExpressionRunning||this.onAsyncRunningChanged())}onAsyncRunningChanged(){}get isAsyncExpressionRunning(){return!!this.asynExpressionHash&&Object.keys(this.asynExpressionHash).length>0}createExpressionRunner(e){let t=new eh(e);return t.onBeforeAsyncRun=e=>{this.doBeforeAsynRun(e)},t.onAfterAsyncRun=e=>{this.doAfterAsynRun(e)},t}registerPropertyChangedHandlers(e,t,s=null){for(var i=0;i<e.length;i++)this.registerFunctionOnPropertyValueChanged(e[i],t,s)}unregisterPropertyChangedHandlers(e,t=null){for(var s=0;s<e.length;s++)this.unRegisterFunctionOnPropertyValueChanged(e[s],t)}registerFunctionOnPropertyValueChanged(e,t,s=null){if(this.onPropChangeFunctions||(this.onPropChangeFunctions=[]),s)for(var i=0;i<this.onPropChangeFunctions.length;i++){var r=this.onPropChangeFunctions[i];if(r.name==e&&r.key==s){r.func=t;return}}this.onPropChangeFunctions.push({name:e,func:t,key:s})}registerFunctionOnPropertiesValueChanged(e,t,s=null){this.registerPropertyChangedHandlers(e,t,s)}unRegisterFunctionOnPropertyValueChanged(e,t=null){if(this.onPropChangeFunctions)for(var s=0;s<this.onPropChangeFunctions.length;s++){var i=this.onPropChangeFunctions[s];if(i.name==e&&i.key==t){this.onPropChangeFunctions.splice(s,1);return}}}unRegisterFunctionOnPropertiesValueChanged(e,t=null){this.unregisterPropertyChangedHandlers(e,t)}createCustomLocalizableObj(e){let t=this.getLocalizableString(e);return t||this.createLocalizableString(e,this,!1,!0)}getLocale(){let e=this.getSurvey();return e?e.getLocale():""}getLocalizationString(e){return u(e,this.getLocale())}getLocalizationFormatString(e,...t){let s=this.getLocalizationString(e);return s&&s.format?s.format(...t):""}createLocalizableString(e,t,s=!1,i=!1){let r;i&&(r=!0===i?e:i);let n=new ej(t,s,e,r);n.onStrChanged=(t,s)=>{this.propertyValueChanged(e,t,s)},this.localizableStrings||(this.localizableStrings={}),this.localizableStrings[e]=n;let a=this.getPropertyByName(e);return n.disableLocalization=a&&!1===a.isLocalizable,n}removeLocalizableString(e){this.localizableStrings&&delete this.localizableStrings[e]}getLocalizableString(e){return this.localizableStrings?this.localizableStrings[e]:null}getLocalizableStringText(e,t=""){eg.collectDependency(this,e);var s=this.getLocalizableString(e);return s?s.text||t:""}setLocalizableStringText(e,t){let s=this.getLocalizableString(e);s&&s.text!=t&&(s.text=t)}addUsedLocales(e){if(this.localizableStrings)for(let t in this.localizableStrings){let s=this.getLocalizableString(t);s&&this.AddLocStringToUsedLocales(s,e)}if(this.arraysInfo)for(let t in this.arraysInfo){let s=this.getPropertyByName(t);if(!s||!s.isPropertySerializable(this))continue;let i=this.getPropertyValue(t);if(i&&i.length)for(let t=0;t<i.length;t++){let s=i[t];s&&s.addUsedLocales&&s.addUsedLocales(e)}}}searchText(e,t){var s=[];this.getSearchableLocalizedStrings(s);for(var i=0;i<s.length;i++)s[i].setFindText(e)&&t.push({element:this,str:s[i]})}getSearchableLocalizedStrings(e){if(this.localizableStrings){let s=[];this.getSearchableLocKeys(s);for(var t=0;t<s.length;t++){let i=this.getLocalizableString(s[t]);i&&e.push(i)}}if(!this.arraysInfo)return;let s=[];this.getSearchableItemValueKeys(s);for(var t=0;t<s.length;t++){var i=this.getPropertyValue(s[t]);if(i)for(var r=0;r<i.length;r++)e.push(i[r].locText)}}getSearchableLocKeys(e){}getSearchableItemValueKeys(e){}AddLocStringToUsedLocales(e,t){for(var s=e.getLocales(),i=0;i<s.length;i++)0>t.indexOf(s[i])&&t.push(s[i])}createItemValues(e){var t=this,s=this.createNewArray(e,function(s){if(s.locOwner=t,s.ownerPropertyName=e,"function"==typeof s.getSurvey){let e=s.getSurvey();e&&"function"==typeof e.makeReactive&&e.makeReactive(s)}});return this.arraysInfo[e].isItemValues=!0,s}notifyArrayChanged(e,t){e.onArrayChanged&&e.onArrayChanged(t)}createNewArrayCore(e){var t=null;return this.createArrayCoreHandler&&(t=this.createArrayCoreHandler(this.propertyHash,e)),t||(t=[],this.setPropertyValueCore(this.propertyHash,e,t)),t}ensureArray(e,t=null,s=null){if(!this.arraysInfo||!this.arraysInfo[e])return this.createNewArray(e,t,s)}createNewArray(e,t=null,s=null){var i=this.createNewArrayCore(e);this.arraysInfo||(this.arraysInfo={}),this.arraysInfo[e]={onPush:t,isItemValues:!1};var r=this;return i.push=function(s){var n=Object.getPrototypeOf(i).push.call(i,s);if(!r.isDisposedValue){t&&t(s,i.length-1);let n=new ep(i.length-1,0,[s],[]);r.propertyValueChanged(e,i,i,n),r.notifyArrayChanged(i,n)}return n},i.shift=function(){var t=Object.getPrototypeOf(i).shift.call(i);if(!r.isDisposedValue&&t){s&&s(t);let n=new ep(i.length-1,1,[],[]);r.propertyValueChanged(e,i,i,n),r.notifyArrayChanged(i,n)}return t},i.unshift=function(s){var n=Object.getPrototypeOf(i).unshift.call(i,s);if(!r.isDisposedValue){t&&t(s,i.length-1);let n=new ep(0,0,[s],[]);r.propertyValueChanged(e,i,i,n),r.notifyArrayChanged(i,n)}return n},i.pop=function(){var t=Object.getPrototypeOf(i).pop.call(i);if(!r.isDisposedValue){s&&s(t);let n=new ep(i.length-1,1,[],[]);r.propertyValueChanged(e,i,i,n),r.notifyArrayChanged(i,n)}return t},i.splice=function(n,a,...o){n||(n=0),a||(a=0);var l=Object.getPrototypeOf(i).splice.call(i,n,a,...o);if(o||(o=[]),!r.isDisposedValue){if(s&&l)for(var h=0;h<l.length;h++)s(l[h]);if(t)for(var h=0;h<o.length;h++)t(o[h],n+h);let u=new ep(n,a,o,l);r.propertyValueChanged(e,i,i,u),r.notifyArrayChanged(i,u)}return l},i}getItemValueType(){}setArray(e,t,s,i,r){var n=[].concat(t);if(Object.getPrototypeOf(t).splice.call(t,0,t.length),s)for(var a=0;a<s.length;a++){var o=s[a];i&&eg.createItemValue&&(o=eg.createItemValue(o,this.getItemValueType())),Object.getPrototypeOf(t).push.call(t,o),r&&r(t[a])}let l=new ep(0,n.length,t,n);this.propertyValueChanged(e,n,t,l),this.notifyArrayChanged(t,l)}isTwoValueEquals(e,t,s=!1,i=!1){return a.isTwoValueEquals(e,t,!1,!s,i)}static copyObject(e,t){for(var s in t){var i=t[s];"object"==typeof i&&(i={},this.copyObject(i,t[s])),e[s]=i}}copyCssClasses(e,t){t&&("string"==typeof t||t instanceof String?e.root=t:eg.copyObject(e,t))}getValueInLowCase(e){return e&&"string"==typeof e?e.toLowerCase():e}getElementsInDesign(e=!1){return[]}get animationAllowed(){return this.getIsAnimationAllowed()}getIsAnimationAllowed(){return tp.animationEnabled&&this.animationAllowedLock>=0&&!this.isLoadingFromJson&&!this.isDisposed&&(!!this.onElementRerendered||!this.supportOnElementRerenderedEvent)}blockAnimations(){this.animationAllowedLock--}releaseAnimations(){this.animationAllowedLock++}enableOnElementRerenderedEvent(){this.onElementRerenderedEventEnabled=!0}disableOnElementRerenderedEvent(){var e;null===(e=this.onElementRerendered)||void 0===e||e.fire(this,{isCancel:!0}),this.onElementRerenderedEventEnabled=!1}get onElementRerendered(){return this.supportOnElementRerenderedEvent&&this.onElementRerenderedEventEnabled?this._onElementRerendered:void 0}afterRerender(){var e;null===(e=this.onElementRerendered)||void 0===e||e.fire(this,{isCancel:!1})}}eg.currentDependencis=void 0;class ep{constructor(e,t,s,i){this.index=e,this.deleteCount=t,this.itemsToAdd=s,this.deletedItems=i}}class em{get isEmpty(){return 0===this.length}get length(){return this.callbacks?this.callbacks.length:0}fireByCreatingOptions(e,t){if(this.callbacks){for(var s=0;s<this.callbacks.length;s++)if(this.callbacks[s](e,t()),!this.callbacks)return}}fire(e,t){if(!this.callbacks)return;let s=[].concat(this.callbacks);for(var i=0;i<s.length;i++)if(s[i](e,t),!this.callbacks)return}clear(){this.callbacks=void 0}add(e){this.hasFunc(e)||(this.callbacks||(this.callbacks=[]),this.callbacks.push(e),this.fireCallbackChanged())}remove(e){if(this.hasFunc(e)){var t=this.callbacks.indexOf(e,0);this.callbacks.splice(t,1),this.fireCallbackChanged()}}hasFunc(e){return null!=this.callbacks&&this.callbacks.indexOf(e,0)>-1}fireCallbackChanged(){this.onCallbacksChanged&&this.onCallbacksChanged()}}class ev extends em{}function ey(e,t,s,i){var r,n=arguments.length,a=n<3?t:i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(n<3?r(a):n>3?r(t,s,a):r(t,s))||a);return n>3&&a&&Object.defineProperty(t,s,a),a}function eC(e){let t,s=!1,i=!1;return{run:(...r)=>{i=!1,t=r,s||(s=!0,queueMicrotask(()=>{i||e.apply(this,t),i=!1,s=!1}))},cancel:()=>{i=!0}}}class ef{constructor(e,t){if(this.container=e,this.model=t,this.resizeObserver=void 0,this.isInitialized=!1,this.getComputedStyle=e=>r.getComputedStyle(e),this.debouncedProcess=eC(()=>{this.process()}),this.isDisposed=!1,this.model.updateCallback=e=>{e&&(this.isInitialized=!1),this.debouncedProcess.run()},"undefined"!=typeof ResizeObserver){let e=!0;this.resizeObserver=new ResizeObserver(t=>{if(e){e=!1;return}i.requestAnimationFrame(()=>{this.process()})}),this.resizeObserver.observe(this.container.parentElement),this.shouldProcessResponsiveness()?this.process():e=!1}}getDimensions(e){return{scroll:e.scrollWidth,offset:e.offsetWidth}}getAvailableSpace(){let e=this.getComputedStyle(this.container),t=this.container.offsetWidth;return"border-box"===e.boxSizing&&(t-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)),t}getGap(){let e=this.getComputedStyle(this.container);if("flex"==e.display){let t=parseFloat(e.rowGap);return isNaN(t)?0:t}return 0}calcItemSize(e){return e.offsetWidth||e.getBoundingClientRect().width}updateItemsDimensions(e){if(!this.container)return;let t=this.isInitialized?this.model.renderedActions.filter(e=>e.needUpdateMaxDimension||e.needUpdateMinDimension):this.model.renderedActions,s=t.length;0==s&&e();let i=()=>{--s<=0&&e()};t.forEach(e=>{let t=!this.isInitialized||e.needUpdateMaxDimension,s=!this.isInitialized||e.needUpdateMinDimension;e.updateDimensions(e=>this.calcItemSize(e),()=>{e.needUpdateMaxDimension=!1,e.needUpdateMinDimension=!1,i()},s?t?void 0:"small":"large")})}get isContainerVisible(){return!!this.container&&ta(this.container)}shouldProcessResponsiveness(){return this.isContainerVisible&&!this.model.isResponsivenessDisabled&&!this.isDisposed}process(){this.shouldProcessResponsiveness()&&this.updateItemsDimensions(()=>{this.shouldProcessResponsiveness()&&this.model.fit({availableSpace:this.getAvailableSpace(),gap:this.getGap()}),this.isInitialized=!0})}dispose(){this.isDisposed=!0,this.model.updateCallback=void 0,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=void 0,this.container=void 0}}class eb extends ef{constructor(e,t){super(e,t)}getDimensions(){return{scroll:this.container.scrollHeight,offset:this.container.offsetHeight}}getAvailableSpace(){let e=this.getComputedStyle(this.container),t=this.container.offsetHeight;return"border-box"===e.boxSizing&&(t-=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)),t}calcItemSize(e){return e.offsetHeight}}class eV{constructor(){this.classes=[]}isEmpty(){return""===this.toString()}append(e,t=!0){return e&&t&&("string"==typeof e&&(e=e.trim()),this.classes.push(e)),this}toString(){return this.classes.join(" ")}}let ew={root:"sv-action-bar",defaultSizeMode:"sv-action-bar--default-size-mode",smallSizeMode:"sv-action-bar--small-size-mode",item:"sv-action-bar-item",itemWithTitle:"",itemAsIcon:"sv-action-bar-item--icon",itemActive:"sv-action-bar-item--active",itemPressed:"sv-action-bar-item--pressed",itemIcon:"sv-action-bar-item__icon",itemTitle:"sv-action-bar-item__title",itemTitleWithIcon:"sv-action-bar-item__title--with-icon"};class ex extends eg{constructor(){super(...arguments),this.sizeMode="default"}getMarkdownHtml(e,t){return this.locOwner?this.locOwner.getMarkdownHtml(e,t):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getRenderedActions(){return this.actions}locStrsChanged(){super.locStrsChanged(),this.actions.forEach(e=>{e.locTitle&&e.locTitle.strChanged(),e.locStrsChanged()})}raiseUpdate(e){this.isEmpty=!this.actions.some(e=>e.visible),this.updateCallback&&this.updateCallback(e)}onSet(){this.actions.forEach(e=>{this.setActionCssClasses(e)}),this.raiseUpdate(!0)}onPush(e){this.setActionCssClasses(e),e.owner=this,this.raiseUpdate(!0)}onRemove(e){e.owner=null,this.raiseUpdate(!0)}setActionCssClasses(e){e.cssClasses=this.cssClasses}get hasActions(){return(this.actions||[]).length>0}get renderedActions(){return this.getRenderedActions()}get visibleActions(){return this.actions.filter(e=>!1!==e.visible)}getRootCss(){let e="small"===this.sizeMode?this.cssClasses.smallSizeMode:this.cssClasses.defaultSizeMode;return new eV().append(this.cssClasses.root+(e?" "+e:"")+(this.containerCss?" "+this.containerCss:"")).append(this.cssClasses.root+"--empty",this.isEmpty).toString()}getDefaultCssClasses(){return ew}set cssClasses(e){this.cssClassesValue={},this.copyCssClasses(this.cssClassesValue,this.getDefaultCssClasses()),to(e,this.cssClasses),this.actions.forEach(e=>{this.setActionCssClasses(e)})}get cssClasses(){return this.cssClassesValue||(this.cssClassesValue=this.getDefaultCssClasses()),this.cssClassesValue}createAction(e){return e instanceof eO?e:new eL(e)}addAction(e,t=!0){let s=this.createAction(e);if(t&&!this.isActionVisible(s))return s;let i=[].concat(this.actions,s);return this.sortItems(i),this.actions=i,s}setItems(e,t=!0){let s=[];e.forEach(e=>{(!t||this.isActionVisible(e))&&s.push(this.createAction(e))}),t&&this.sortItems(s),this.actions=s}sortItems(e){this.hasSetVisibleIndex(e)&&e.sort(this.compareByVisibleIndex)}hasSetVisibleIndex(e){for(let t=0;t<e.length;t++){let s=e[t].visibleIndex;if(void 0!==s&&s>=0)return!0}return!1}compareByVisibleIndex(e,t){return e.visibleIndex-t.visibleIndex}isActionVisible(e){return e.visibleIndex>=0||void 0===e.visibleIndex}popupAfterShowCallback(e){}mouseOverHandler(e){e.isHovered=!0,this.actions.forEach(t=>{t===e&&e.popupModel&&(e.showPopupDelayed(this.subItemsShowDelay),this.popupAfterShowCallback(e))})}initResponsivityManager(e,t){}resetResponsivityManager(){}getActionById(e){for(var t=0;t<this.actions.length;t++)if(this.actions[t].id===e)return this.actions[t];return null}dispose(){super.dispose(),this.resetResponsivityManager(),this.actions.forEach(e=>e.dispose()),this.actions.length=0}}ey([p({onSet:(e,t)=>{t.onSet()},onPush:(e,t,s)=>{s.onPush(e)},onRemove:(e,t,s)=>{s.onRemove(e)}})],ex.prototype,"actions",void 0),ey([c({})],ex.prototype,"containerCss",void 0),ey([c({defaultValue:!1})],ex.prototype,"isEmpty",void 0),ey([c({defaultValue:300})],ex.prototype,"subItemsShowDelay",void 0),ey([c({defaultValue:300})],ex.prototype,"subItemsHideDelay",void 0);class eP{static focusElement(e){e&&e.focus()}static visibility(e){var t=r.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&(!e.parentElement||this.visibility(e.parentElement))}static getNextElementPreorder(e){let t=e.nextElementSibling?e.nextElementSibling:e.parentElement.firstElementChild;return this.visibility(t)?t:this.getNextElementPreorder(t)}static getNextElementPostorder(e){let t=e.previousElementSibling?e.previousElementSibling:e.parentElement.lastElementChild;return this.visibility(t)?t:this.getNextElementPostorder(t)}static hasHorizontalScroller(e){return!!e&&e.scrollWidth>e.offsetWidth}static hasVerticalScroller(e){return!!e&&e.scrollHeight>e.offsetHeight}}let eT={root:"sv-list__container",item:"sv-list__item",searchClearButtonIcon:"sv-list__filter-clear-button",loadingIndicator:"sv-list__loading-indicator",itemSelected:"sv-list__item--selected",itemGroup:"sv-list__item--group",itemGroupSelected:"sv-list__item--group-selected",itemWithIcon:"sv-list__item--with-icon",itemDisabled:"sv-list__item--disabled",itemFocused:"sv-list__item--focused",itemHovered:"sv-list__item--hovered",itemTextWrap:"sv-list__item-text--wrap",itemIcon:"sv-list__item-icon",itemMarkerIcon:"sv-list-item__marker-icon",itemSeparator:"sv-list__item-separator",itemBody:"sv-list__item-body",itemsContainer:"sv-list",itemsContainerFiltering:"sv-list--filtering",filter:"sv-list__filter",filterIcon:"sv-list__filter-icon",filterInput:"sv-list__input",emptyContainer:"sv-list__empty-container",emptyText:"sv-list__empty-text"};class eS extends ex{hasText(e,t){if(!t)return!0;let s=e.title||"";if(this.onTextSearchCallback)return this.onTextSearchCallback(e,t);let i=s.toLocaleLowerCase();return(i=tp.comparator.normalizeTextCallback(i,"filter")).indexOf(t.toLocaleLowerCase())>-1}isItemVisible(e){return e.visible&&(!this.shouldProcessFilter||this.hasText(e,this.filterString))}getRenderedActions(){let e=super.getRenderedActions();if(this.filterString){let t=[];return e.forEach(e=>{t.push(e),e.items&&e.items.forEach(s=>{let i=new eL(s);i.iconName||(i.iconName=e.iconName),t.push(i)})}),t}return e}get visibleItems(){return this.visibleActions.filter(e=>this.isItemVisible(e))}get shouldProcessFilter(){return!this.onFilterStringChangedCallback}onFilterStringChanged(e){this.onFilterStringChangedCallback&&this.onFilterStringChangedCallback(e),this.updateIsEmpty()}updateIsEmpty(){this.isEmpty=0===this.renderedActions.filter(e=>this.isItemVisible(e)).length}scrollToItem(e,t=0){setTimeout(()=>{if(!this.listContainerHtmlElement)return;let s=this.listContainerHtmlElement.querySelector(tr(e));s&&setTimeout(()=>{s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})},t)},t)}constructor(e,t,s,i,r){super(),this.onSelectionChanged=t,this.allowSelection=s,this.elementId=r,this.onItemClick=e=>{if(this.isItemDisabled(e))return;this.isExpanded=!1,this.allowSelection&&(this.selectedItem=e),this.onSelectionChanged&&this.onSelectionChanged(e);let t=e.action;t&&t(e)},this.onItemHover=e=>{this.mouseOverHandler(e)},this.isItemDisabled=e=>void 0!==e.enabled&&!e.enabled,this.isItemSelected=e=>this.areSameItems(this.selectedItem,e),this.isItemFocused=e=>this.areSameItems(this.focusedItem,e),this.getListClass=()=>new eV().append(this.cssClasses.itemsContainer).append(this.cssClasses.itemsContainerFiltering,!!this.filterString&&this.visibleActions.length!==this.visibleItems.length).toString(),this.getItemClass=e=>{let t=this.isItemSelected(e);return new eV().append(this.cssClasses.item).append(this.cssClasses.itemWithIcon,!!e.iconName).append(this.cssClasses.itemDisabled,this.isItemDisabled(e)).append(this.cssClasses.itemFocused,this.isItemFocused(e)).append(this.cssClasses.itemSelected,!e.hasSubItems&&t).append(this.cssClasses.itemGroup,e.hasSubItems).append(this.cssClasses.itemGroupSelected,e.hasSubItems&&t).append(this.cssClasses.itemHovered,e.isHovered).append(this.cssClasses.itemTextWrap,this.textWrapEnabled).append(e.css).toString()},this.getItemStyle=e=>({"--sjs-list-item-level":(e.level||0)+1}),-1!==Object.keys(e).indexOf("items")?(Object.keys(e).forEach(t=>{switch(t){case"items":this.setItems(e.items);break;case"onFilterStringChangedCallback":this.setOnFilterStringChangedCallback(e.onFilterStringChangedCallback);break;case"onTextSearchCallback":this.setOnTextSearchCallback(e.onTextSearchCallback);break;default:this[t]=e[t]}}),this.updateActionsIds()):(this.setItems(e),this.selectedItem=i)}setOnFilterStringChangedCallback(e){this.onFilterStringChangedCallback=e}setOnTextSearchCallback(e){this.onTextSearchCallback=e}setItems(e,t=!0){super.setItems(e,t),this.updateActionsIds(),!this.isAllDataLoaded&&this.actions.length&&this.actions.push(this.loadingIndicator)}updateActionsIds(){this.elementId&&this.renderedActions.forEach(e=>{e.elementId=this.elementId+e.id})}setSearchEnabled(e){this.searchEnabled=e,this.showSearchClearButton=e}onSet(){this.showFilter=this.searchEnabled&&(this.forceShowFilter||(this.actions||[]).length>eS.MINELEMENTCOUNT),super.onSet()}getDefaultCssClasses(){return eT}popupAfterShowCallback(e){this.addScrollEventListener(()=>{e.hidePopup()})}onItemLeave(e){e.hidePopupDelayed(this.subItemsHideDelay)}areSameItems(e,t){return this.areSameItemsCallback?this.areSameItemsCallback(e,t):!!e&&!!t&&e.id==t.id}get filterStringPlaceholder(){return this.getLocalizationString("filterStringPlaceholder")}get emptyMessage(){return this.isAllDataLoaded?this.getLocalizationString("emptyMessage"):this.loadingText}get scrollableContainer(){return this.listContainerHtmlElement.querySelector(tr(this.cssClasses.itemsContainer))}get loadingText(){return this.getLocalizationString("loadingFile")}get loadingIndicator(){return this.loadingIndicatorValue||(this.loadingIndicatorValue=new eL({id:"loadingIndicator",title:this.loadingText,action:()=>{},css:this.cssClasses.loadingIndicator})),this.loadingIndicatorValue}goToItems(e){if("ArrowDown"===e.key||40===e.keyCode){let t=e.target.parentElement.parentElement.querySelector("ul"),s=function(e){let t;for(let s=0;s<e.children.length;s++)t||"none"===getComputedStyle(e.children[s]).display||(t=e.children[s]);return t}(t);t&&s&&(eP.focusElement(s),e.preventDefault())}}onMouseMove(e){this.resetFocusedItem()}onKeyDown(e){let t=e.target;"ArrowDown"===e.key||40===e.keyCode?(eP.focusElement(eP.getNextElementPreorder(t)),e.preventDefault()):("ArrowUp"===e.key||38===e.keyCode)&&(eP.focusElement(eP.getNextElementPostorder(t)),e.preventDefault())}onPointerDown(e,t){}refresh(){""!==this.filterString?this.filterString="":this.updateIsEmpty(),this.resetFocusedItem()}onClickSearchClearButton(e){e.currentTarget.parentElement.querySelector("input").focus(),this.refresh()}resetFocusedItem(){this.focusedItem=void 0}focusFirstVisibleItem(){this.focusedItem=this.visibleItems[0]}focusLastVisibleItem(){this.focusedItem=this.visibleItems[this.visibleItems.length-1]}initFocusedItem(){this.focusedItem=this.visibleItems.filter(e=>e.visible&&this.isItemSelected(e))[0],this.focusedItem||this.focusFirstVisibleItem()}focusNextVisibleItem(){if(this.focusedItem){let e=this.visibleItems,t=e.indexOf(this.focusedItem),s=e[t+1];s?this.focusedItem=s:this.focusFirstVisibleItem()}else this.initFocusedItem()}focusPrevVisibleItem(){if(this.focusedItem){let e=this.visibleItems,t=e.indexOf(this.focusedItem),s=e[t-1];s?this.focusedItem=s:this.focusLastVisibleItem()}else this.initFocusedItem()}selectFocusedItem(){this.focusedItem&&this.onItemClick(this.focusedItem)}initListContainerHtmlElement(e){this.listContainerHtmlElement=e}onLastItemRended(e){!this.isAllDataLoaded&&e===this.actions[this.actions.length-1]&&this.listContainerHtmlElement&&(this.hasVerticalScroller=eP.hasVerticalScroller(this.scrollableContainer))}scrollToFocusedItem(){this.scrollToItem(this.cssClasses.itemFocused)}scrollToSelectedItem(){this.selectedItem&&this.selectedItem.items&&this.selectedItem.items.length>0?this.scrollToItem(this.cssClasses.itemGroupSelected,110):this.scrollToItem(this.cssClasses.itemSelected,110)}addScrollEventListener(e){e&&(this.removeScrollEventListener(),this.scrollHandler=e),this.scrollHandler&&this.scrollableContainer.addEventListener("scroll",this.scrollHandler)}removeScrollEventListener(){this.scrollHandler&&this.scrollableContainer.removeEventListener("scroll",this.scrollHandler)}dispose(){super.dispose(),this.loadingIndicatorValue&&this.loadingIndicatorValue.dispose(),this.listContainerHtmlElement=void 0}}eS.INDENT=16,eS.MINELEMENTCOUNT=10,ey([c({defaultValue:!0,onSet:(e,t)=>{t.onSet()}})],eS.prototype,"searchEnabled",void 0),ey([c({defaultValue:!1})],eS.prototype,"showFilter",void 0),ey([c({defaultValue:!1})],eS.prototype,"forceShowFilter",void 0),ey([c({defaultValue:!1})],eS.prototype,"isExpanded",void 0),ey([c({})],eS.prototype,"selectedItem",void 0),ey([c()],eS.prototype,"focusedItem",void 0),ey([c({onSet:(e,t)=>{t.onFilterStringChanged(t.filterString)}})],eS.prototype,"filterString",void 0),ey([c({defaultValue:!1})],eS.prototype,"hasVerticalScroller",void 0),ey([c({defaultValue:!0})],eS.prototype,"isAllDataLoaded",void 0),ey([c({defaultValue:!1})],eS.prototype,"showSearchClearButton",void 0),ey([c({defaultValue:!0})],eS.prototype,"renderElements",void 0),ey([c({defaultValue:!1})],eS.prototype,"textWrapEnabled",void 0),ey([c({defaultValue:"sv-list-item-content"})],eS.prototype,"itemComponent",void 0);class eI extends eg{refreshInnerModel(){let e=this.contentComponentData.model;e&&e.refresh&&e.refresh()}constructor(e,t,s){if(super(),this.focusFirstInputSelector="",this.onCancel=()=>{},this.onApply=()=>!0,this.onHide=()=>{},this.onShow=()=>{},this.onDispose=()=>{},this.onVisibilityChanged=this.addEvent(),this.onFooterActionsCreated=this.addEvent(),this.onRecalculatePosition=this.addEvent(),this.contentComponentName=e,this.contentComponentData=t,s)for(var i in s)this[i]=s[i]}get isVisible(){return this.getPropertyValue("isVisible",!1)}set isVisible(e){this.isVisible!==e&&(this.setPropertyValue("isVisible",e),this.onVisibilityChanged.fire(this,{model:this,isVisible:e}))}toggleVisibility(){this.isVisible=!this.isVisible}show(){this.isVisible||(this.isVisible=!0)}hide(){this.isVisible&&(this.isVisible=!1)}recalculatePosition(e){this.onRecalculatePosition.fire(this,{isResetHeight:e})}updateFooterActions(e){let t={actions:e};return this.onFooterActionsCreated.fire(this,t),t.actions}updateDisplayMode(e){if(this.displayMode!==e){let t="dropdown"===e;this.setWidthByTarget=t,this.isFocusedContent=!t}switch(e){case"dropdown":this.displayMode="popup";break;case"popup":this.displayMode="overlay",this.overlayDisplayMode="tablet-dropdown-overlay";break;case"overlay":this.displayMode="overlay",this.overlayDisplayMode="dropdown-overlay"}}onHiding(){this.refreshInnerModel(),this.onHide()}dispose(){super.dispose(),this.onDispose()}}function eE(e,t,s){return t.locOwner=s,eR(e,t,t)}function eR(e,t,s){var i;let r=t.onSelectionChanged;t.onSelectionChanged=(e,...t)=>{a.hasTitle&&(a.title=e.title),r&&r(e,t)};let n=eA(t,s);n.getTargetCallback=eD;let a=new eL(Object.assign({},e,{component:"sv-action-bar-item-dropdown",popupModel:n,action:(t,s)=>{e.action&&e.action(),n.isFocusedContent=n.isFocusedContent||!s,n.show()}}));return a.data=null===(i=n.contentComponentData)||void 0===i?void 0:i.model,a}function eA(e,t){let s=new eS(e);s.onSelectionChanged=t=>{e.onSelectionChanged&&e.onSelectionChanged(t),r.hide()};let i=t||{};i.onDispose=()=>{s.dispose()};let r=new eI("sv-list",{model:s},i);return r.isFocusedContent=s.showFilter,r.onShow=()=>{i.onShow&&i.onShow(),s.scrollToSelectedItem()},r}function eD(e){return null==e?void 0:e.previousElementSibling}ey([c()],eI.prototype,"contentComponentName",void 0),ey([c()],eI.prototype,"contentComponentData",void 0),ey([c({defaultValue:"bottom"})],eI.prototype,"verticalPosition",void 0),ey([c({defaultValue:"left"})],eI.prototype,"horizontalPosition",void 0),ey([c({defaultValue:!0})],eI.prototype,"showPointer",void 0),ey([c({defaultValue:!1})],eI.prototype,"isModal",void 0),ey([c({defaultValue:!0})],eI.prototype,"canShrink",void 0),ey([c({defaultValue:!0})],eI.prototype,"isFocusedContent",void 0),ey([c({defaultValue:!0})],eI.prototype,"isFocusedContainer",void 0),ey([c({defaultValue:""})],eI.prototype,"cssClass",void 0),ey([c({defaultValue:""})],eI.prototype,"title",void 0),ey([c({defaultValue:"auto"})],eI.prototype,"overlayDisplayMode",void 0),ey([c({defaultValue:"popup"})],eI.prototype,"displayMode",void 0),ey([c({defaultValue:"flex"})],eI.prototype,"positionMode",void 0);class eO extends eg{constructor(){super(...arguments),this.rendredIdValue=eO.getNextRendredId()}static getNextRendredId(){return eO.renderedId++}get renderedId(){return this.rendredIdValue}get owner(){return this.ownerValue}set owner(e){e!==this.owner&&(this.ownerValue=e,this.locStrsChanged())}get visible(){return this.getVisible()}set visible(e){this.setVisible(e)}get enabled(){return this.getEnabled()}set enabled(e){this.setEnabled(e)}get component(){return this.getComponent()}set component(e){this.setComponent(e)}get locTitle(){return this.getLocTitle()}set locTitle(e){this.setLocTitle(e)}get title(){return this.getTitle()}set title(e){this.setTitle(e)}set cssClasses(e){this.cssClassesValue=e}get cssClasses(){return this.cssClassesValue||ew}get isVisible(){return this.visible&&"popup"!==this.mode&&"removed"!==this.mode}get disabled(){return void 0!==this.enabled&&!this.enabled}get canShrink(){return!this.disableShrink&&!!this.iconName}get hasTitle(){return("small"!=this.mode&&(this.showTitle||void 0===this.showTitle)||!this.iconName)&&!!this.title}get hasSubItems(){return!!this.items&&this.items.length>0}getActionBarItemTitleCss(){return new eV().append(this.cssClasses.itemTitle).append(this.cssClasses.itemTitleWithIcon,!!this.iconName).toString()}getActionBarItemCss(){let e=this.hasTitle;return new eV().append(this.cssClasses.item).append(this.cssClasses.itemWithTitle,e).append(this.cssClasses.itemAsIcon,!e).append(this.cssClasses.itemActive,!!this.active).append(this.cssClasses.itemPressed,!!this.pressed).append(this.innerCss).toString()}getActionRootCss(){return new eV().append("sv-action").append(this.css).append("sv-action--space",this.needSpace).append("sv-action--hidden",!this.isVisible).toString()}getTooltip(){return this.tooltip||this.title}getIsTrusted(e){return e.originalEvent?e.originalEvent.isTrusted:e.isTrusted}showPopup(){this.popupModel&&this.popupModel.show()}hidePopup(){this.popupModel&&this.popupModel.hide()}clearPopupTimeouts(){this.showPopupTimeout&&clearTimeout(this.showPopupTimeout),this.hidePopupTimeout&&clearTimeout(this.hidePopupTimeout)}showPopupDelayed(e){this.clearPopupTimeouts(),this.showPopupTimeout=setTimeout(()=>{this.clearPopupTimeouts(),this.showPopup()},e)}hidePopupDelayed(e){var t;(null===(t=this.popupModel)||void 0===t?void 0:t.isVisible)?(this.clearPopupTimeouts(),this.hidePopupTimeout=setTimeout(()=>{this.clearPopupTimeouts(),this.hidePopup(),this.isHovered=!1},e)):(this.clearPopupTimeouts(),this.isHovered=!1)}}eO.renderedId=1,ey([c()],eO.prototype,"tooltip",void 0),ey([c()],eO.prototype,"showTitle",void 0),ey([c()],eO.prototype,"innerCss",void 0),ey([c()],eO.prototype,"active",void 0),ey([c()],eO.prototype,"pressed",void 0),ey([c()],eO.prototype,"popupModel",void 0),ey([c()],eO.prototype,"needSeparator",void 0),ey([c()],eO.prototype,"template",void 0),ey([c({defaultValue:"large"})],eO.prototype,"mode",void 0),ey([c()],eO.prototype,"visibleIndex",void 0),ey([c()],eO.prototype,"disableTabStop",void 0),ey([c()],eO.prototype,"disableShrink",void 0),ey([c()],eO.prototype,"disableHide",void 0),ey([c({defaultValue:!1})],eO.prototype,"needSpace",void 0),ey([c()],eO.prototype,"ariaChecked",void 0),ey([c()],eO.prototype,"ariaExpanded",void 0),ey([c({defaultValue:"button"})],eO.prototype,"ariaRole",void 0),ey([c()],eO.prototype,"iconName",void 0),ey([c({defaultValue:24})],eO.prototype,"iconSize",void 0),ey([c()],eO.prototype,"markerIconName",void 0),ey([c()],eO.prototype,"css",void 0),ey([c({defaultValue:!1})],eO.prototype,"isPressed",void 0),ey([c({defaultValue:!1})],eO.prototype,"isHovered",void 0);class eL extends eO{raiseUpdate(e=!1){this.updateCallback&&this.updateCallback(e)}constructor(e){super(),this.locTitleChanged=()=>{let e=this.locTitle.renderedHtml;this.setPropertyValue("_title",e||void 0)},this.needUpdateMaxDimension=!1,this.needUpdateMinDimension=!1;let t=e instanceof eL?e.innerItem:e;if(this.innerItem=t,this.locTitle=t?t.locTitle:null,t)for(var s in t)"locTitle"===s||"title"===s&&this.locTitle&&this.title||(this[s]=t[s]);this.locTitleName&&this.locTitleChanged(),this.registerFunctionOnPropertyValueChanged("_title",()=>{this.needUpdateMaxDimension=!0,this.raiseUpdate()}),this.locStrChangedInPopupModel()}createLocTitle(){return this.createLocalizableString("title",this,!0)}setSubItems(e){this.markerIconName="icon-next_16x16",this.component="sv-list-item-group",this.items=[...e.items];let t=Object.assign({},e);t.searchEnabled=!1;let s=eA(t,{horizontalPosition:"right",showPointer:!1,canShrink:!1});s.cssClass="sv-popup-inner",this.popupModel=s}getLocTitle(){return this.locTitleValue}setLocTitle(e){e||this.locTitleValue||(e=this.createLocTitle()),this.locTitleValue&&this.locTitleValue.onStringChanged.remove(this.locTitleChanged),this.locTitleValue=e,this.locTitleValue.onStringChanged.add(this.locTitleChanged),this.locTitleChanged()}getTitle(){return this._title}setTitle(e){this._title=e}get locTitleName(){return this.locTitle.localizationName}set locTitleName(e){this.locTitle.localizationName=e}locStrsChanged(){super.locStrsChanged(),this.locTooltipChanged(),this.locStrChangedInPopupModel()}doAction(e){let t=e.originalEvent?e.originalEvent:e;return this.action(this,t.isTrusted),t.preventDefault(),t.stopPropagation(),!0}doMouseDown(e){this.isMouseDown=!0}doFocus(e){if(this.onFocus){let t=e.originalEvent?e.originalEvent:e;this.onFocus(this.isMouseDown,t)}this.isMouseDown=!1}locStrChangedInPopupModel(){if(!this.popupModel||!this.popupModel.contentComponentData||!this.popupModel.contentComponentData.model)return;let e=this.popupModel.contentComponentData.model;Array.isArray(e.actions)&&e.actions.forEach(e=>{e.locStrsChanged&&e.locStrsChanged()})}locTooltipChanged(){this.locTooltipName&&(this.tooltip=u(this.locTooltipName,this.locTitle.locale))}getLocale(){return this.owner?this.owner.getLocale():""}getMarkdownHtml(e,t){return this.owner?this.owner.getMarkdownHtml(e,t):void 0}getProcessedText(e){return this.owner?this.owner.getProcessedText(e):e}getRenderer(e){return this.owner?this.owner.getRenderer(e):null}getRendererContext(e){return this.owner?this.owner.getRendererContext(e):e}setVisible(e){this.visible!==e&&(this._visible=e)}getVisible(){return this._visible}setEnabled(e){this._enabled=e}getEnabled(){return this.enabledIf?this.enabledIf():this._enabled}setComponent(e){this._component=e}getComponent(){return this._component}dispose(){this.updateCallback=void 0,this.locTitleValue&&this.locTitleValue.onStringChanged.remove(this.locTitleChanged),this.locTitleChanged=void 0,this.action=void 0,super.dispose(),this.popupModel&&this.popupModel.dispose()}updateDimension(e,t,s){let i="small"==e?"minDimension":"maxDimension";t&&(t.classList.contains("sv-action--hidden")?(t.classList.remove("sv-action--hidden"),this[i]=s(t),t.classList.add("sv-action--hidden")):this[i]=s(t))}afterRender(){this.afterRenderCallback&&this.afterRenderCallback()}updateMode(e,t){this.updateModeCallback?this.updateModeCallback(e,t):this.afterRenderCallback=()=>{this.updateModeCallback(e,t),this.afterRenderCallback=void 0}}updateDimensions(e,t,s){let i=s&&("large"!=s||"small"===this.mode)?s:this.mode;this.updateMode(i,(i,r)=>{this.updateDimension(i,r,e),s?t():this.updateMode("small"!==i?"small":"large",(s,i)=>{this.updateDimension(s,i,e),t()})})}}ey([c()],eL.prototype,"id",void 0),ey([c({defaultValue:!0,onSet:(e,t)=>{t.raiseUpdate()}})],eL.prototype,"_visible",void 0),ey([c({onSet:(e,t)=>{t.locTooltipChanged()}})],eL.prototype,"locTooltipName",void 0),ey([c()],eL.prototype,"_enabled",void 0),ey([c()],eL.prototype,"action",void 0),ey([c()],eL.prototype,"onFocus",void 0),ey([c()],eL.prototype,"_component",void 0),ey([c()],eL.prototype,"items",void 0),ey([c({onSet:(e,t)=>{t.locTitleValue.text!==e&&(t.locTitleValue.text=e)}})],eL.prototype,"_title",void 0);class eN{constructor(e){this.item=e,this.funcKey="sv-dropdown-action",this.setupPopupCallbacks()}setupPopupCallbacks(){let e=this.popupModel=this.item.popupModel;e&&e.registerPropertyChangedHandlers(["isVisible"],()=>{e.isVisible?this.item.pressed=!0:this.item.pressed=!1},this.funcKey)}removePopupCallbacks(){this.popupModel&&this.popupModel.unregisterPropertyChangedHandlers(["isVisible"],this.funcKey)}dispose(){this.removePopupCallbacks()}}class ek extends ex{hideItemsGreaterN(e){let t=this.getActionsToHide();e=Math.max(e,this.minVisibleItemsCount-(this.visibleActions.length-t.length));let s=[];t.forEach(t=>{e<=0&&(t.mode="popup",s.push(t.innerItem)),e--}),this.hiddenItemsListModel.setItems(s)}getActionsToHide(){return this.visibleActions.filter(e=>!e.disableHide)}updateItemMode(e,t){let s=this.visibleActions;for(let i=s.length-1;i>=0;i--)t>e&&!s[i].disableShrink?(t-=s[i].maxDimension-s[i].minDimension,s[i].mode="small"):s[i].mode="large"}constructor(){super(),this.minVisibleItemsCount=0,this.isResponsivenessDisabled=!1,this.dotsItem=eR({id:"dotsItem-id"+ek.ContainerID++,css:"sv-dots",innerCss:"sv-dots__item",iconName:"icon-more",visible:!1,tooltip:u("more")},{items:[],allowSelection:!1})}get hiddenItemsListModel(){return this.dotsItem.data}onSet(){this.actions.forEach(e=>e.updateCallback=e=>this.raiseUpdate(e)),super.onSet()}onPush(e){e.updateCallback=e=>this.raiseUpdate(e),super.onPush(e)}getRenderedActions(){return 1===this.actions.length&&this.actions[0].iconName?this.actions:this.actions.concat([this.dotsItem])}raiseUpdate(e){this.isResponsivenessDisabled||super.raiseUpdate(e)}getActionMinDimension(e){return e.disableShrink?e.maxDimension:e.minDimension}getVisibleItemsCount(e){let{availableSpace:t,gap:s}=e;t-=this.dotsItem.minDimension+s;let i=0;this.visibleActions[0].disableHide?t+=s:i-=s,this.visibleActions.filter(e=>e.disableHide).forEach(e=>t-=this.getActionMinDimension(e)+s);let r=this.getActionsToHide();if(1===r.length&&r[0].iconName)return 1;for(let e=0;e<r.length;e++)if((i+=this.getActionMinDimension(r[e])+s)>t)return e}fit(e){var t;if(e.availableSpace<=0)return;e.gap=null!==(t=e.gap)&&void 0!==t?t:0;let{availableSpace:s,gap:i}=e;this.dotsItem.visible=!1;let r=this.visibleActions,n=-1*e.gap,a=-1*e.gap;r.forEach(e=>{n+=this.getActionMinDimension(e)+i,a+=e.maxDimension+i}),s>=a?this.setActionsMode("large"):s<n?(this.setActionsMode("small"),this.hideItemsGreaterN(this.getVisibleItemsCount(e)),this.dotsItem.visible=!!this.hiddenItemsListModel.actions.length):this.updateItemMode(e.availableSpace,a)}initResponsivityManager(e){if(this.responsivityManager){if(this.responsivityManager.container==e)return;this.responsivityManager.dispose()}this.responsivityManager=new ef(e,this)}resetResponsivityManager(){this.responsivityManager&&(this.responsivityManager.dispose(),this.responsivityManager=void 0)}setActionsMode(e){this.actions.forEach(t=>{"small"==e&&t.disableShrink?t.mode="large":t.mode=e})}dispose(){super.dispose(),this.dotsItem.data.dispose(),this.dotsItem.dispose(),this.resetResponsivityManager()}}ek.ContainerID=1;class eF{constructor(){this.cancelQueue=[]}getMsFromRule(e){return"auto"===e?0:1e3*Number(e.slice(0,-1).replace(",","."))}reflow(e){return e.offsetHeight}getAnimationsCount(e){let t="";return getComputedStyle&&(t=getComputedStyle(e).animationName),t&&"none"!=t?t.split(", ").length:0}getAnimationDuration(e){let t=getComputedStyle(e),s=t.animationDelay.split(", "),i=t.animationDuration.split(", "),r=0;for(let e=0;e<Math.max(i.length,s.length);e++)r=Math.max(r,this.getMsFromRule(i[e%i.length])+this.getMsFromRule(s[e%s.length]));return r}addCancelCallback(e){this.cancelQueue.push(e)}removeCancelCallback(e){this.cancelQueue.indexOf(e)>=0&&this.cancelQueue.splice(this.cancelQueue.indexOf(e),1)}onAnimationEnd(e,t,s){let i;let r=this.getAnimationsCount(e),n=(s=!0)=>{t(s),clearTimeout(i),this.removeCancelCallback(n),e.removeEventListener("animationend",a)},a=e=>{e.target==e.currentTarget&&--r<=0&&n(!1)};r>0?(e.addEventListener("animationend",a),this.addCancelCallback(n),i=setTimeout(()=>{n(!1)},this.getAnimationDuration(e)+10)):t(!0)}afterAnimationRun(e,t){e&&t&&t.onAfterRunAnimation&&t.onAfterRunAnimation(e)}beforeAnimationRun(e,t){e&&t&&t.onBeforeRunAnimation&&t.onBeforeRunAnimation(e)}getCssClasses(e){return e.cssClass.replace(/\s+$/,"").split(/\s+/)}runAnimation(e,t,s){e&&(null==t?void 0:t.cssClass)?(this.reflow(e),this.getCssClasses(t).forEach(t=>{e.classList.add(t)}),this.onAnimationEnd(e,s,t)):s(!0)}clearHtmlElement(e,t){e&&t.cssClass&&this.getCssClasses(t).forEach(t=>{e.classList.remove(t)}),this.afterAnimationRun(e,t)}onNextRender(e,t=!1){if(!t&&i.isAvailable()){let t;let s=()=>{e(!0),cancelAnimationFrame(t)};t=i.requestAnimationFrame(()=>{t=i.requestAnimationFrame(()=>{e(!1),this.removeCancelCallback(s)})}),this.addCancelCallback(s)}else e(!0)}cancel(){[].concat(this.cancelQueue).forEach(e=>e()),this.cancelQueue=[]}}class eM extends eF{onEnter(e){let t=e.getAnimatedElement(),s=e.getEnterOptions?e.getEnterOptions():{};this.beforeAnimationRun(t,s),this.runAnimation(t,s,()=>{this.clearHtmlElement(t,s)})}onLeave(e,t){let s=e.getAnimatedElement(),i=e.getLeaveOptions?e.getLeaveOptions():{};this.beforeAnimationRun(s,i),this.runAnimation(s,i,e=>{t(),this.onNextRender(()=>{this.clearHtmlElement(s,i)},e)})}}class e_ extends eF{runGroupAnimation(e,t,s,i,r){let n={isAddingRunning:t.length>0,isDeletingRunning:s.length>0,isReorderingRunning:i.length>0},a=t.map(t=>e.getAnimatedElement(t)),o=t.map(t=>e.getEnterOptions?e.getEnterOptions(t,n):{}),l=s.map(t=>e.getAnimatedElement(t)),h=s.map(t=>e.getLeaveOptions?e.getLeaveOptions(t,n):{}),u=i.map(t=>e.getAnimatedElement(t.item)),d=i.map(t=>e.getReorderOptions?e.getReorderOptions(t.item,t.movedForward,n):{});t.forEach((e,t)=>{this.beforeAnimationRun(a[t],o[t])}),s.forEach((e,t)=>{this.beforeAnimationRun(l[t],h[t])}),i.forEach((e,t)=>{this.beforeAnimationRun(u[t],d[t])});let c=t.length+s.length+u.length,g=e=>{--c<=0&&(r&&r(),this.onNextRender(()=>{t.forEach((e,t)=>{this.clearHtmlElement(a[t],o[t])}),s.forEach((e,t)=>{this.clearHtmlElement(l[t],h[t])}),i.forEach((e,t)=>{this.clearHtmlElement(u[t],d[t])})},e))};t.forEach((e,t)=>{this.runAnimation(a[t],o[t],g)}),s.forEach((e,t)=>{this.runAnimation(l[t],h[t],g)}),i.forEach((e,t)=>{this.runAnimation(u[t],d[t],g)})}}class eq{constructor(e,t,s){this.animationOptions=e,this.update=t,this.getCurrentValue=s,this._debouncedSync=eC(e=>{this.cancelAnimations();try{this._sync(e)}catch(t){this.update(e)}})}onNextRender(e,t){let s=this.animationOptions.getRerenderEvent();if(s){let i=()=>{s.remove(r),this.cancelCallback=void 0},r=(s,r)=>{r.isCancel?t&&t():e(),i()};this.cancelCallback=()=>{t&&t(),i()},s.add(r)}else if(i.isAvailable()){let s=i.requestAnimationFrame(()=>{e(),this.cancelCallback=void 0});this.cancelCallback=()=>{t&&t(),cancelAnimationFrame(s),this.cancelCallback=void 0}}else throw Error("Can't get next render")}sync(e){this.animationOptions.isAnimationEnabled()?this._debouncedSync.run(e):(this.cancel(),this.update(e))}cancel(){this._debouncedSync.cancel(),this.cancelAnimations()}cancelAnimations(){this.cancelCallback&&this.cancelCallback(),this.animation.cancel()}}class eB extends eq{constructor(){super(...arguments),this.animation=new eM}_sync(e){e!==this.getCurrentValue()?e?(this.onNextRender(()=>{this.animation.onEnter(this.animationOptions)}),this.update(e)):this.animation.onLeave(this.animationOptions,()=>{this.update(e)}):this.update(e)}}class eQ extends eq{constructor(){super(...arguments),this.animation=new e_}_sync(e){var t,s;e=[].concat(e);let i=[].concat(this.getCurrentValue()),r=null===(t=this.animationOptions.allowSyncRemovalAddition)||void 0===t||t,n=function(e,t,s){let i=new Map,r=new Map,n=new Map,a=new Map;e.forEach(e=>{let t=s(e);if(i.has(t))throw Error("keys must be unique");i.set(s(e),e)}),t.forEach(e=>{let t=s(e);if(r.has(t))throw Error("keys must be unique");r.set(t,e)});let o=[],l=[];r.forEach((e,t)=>{i.has(t)?n.set(t,n.size):o.push(e)}),i.forEach((e,t)=>{r.has(t)?a.set(t,a.size):l.push(e)});let h=[];n.forEach((e,t)=>{let s=a.get(t),i=r.get(t);s!==e&&h.push({item:i,movedForward:s<e})});let u=Array(e.length),d=0,c=Array.from(n.keys());e.forEach((e,t)=>{n.has(s(e))?(u[t]=r.get(c[d]),d++):u[t]=e});let g=new Map,p=[];u.forEach(e=>{let t=s(e);r.has(t)?p.length>0&&(g.set(t,p),p=[]):p.push(e)});let m=[];return r.forEach((e,t)=>{g.has(t)&&g.get(t).forEach(e=>{m.push(e)}),m.push(e)}),p.forEach(e=>{m.push(e)}),{reorderedItems:h,deletedItems:l,addedItems:o,mergedItems:m}}(i,e,null!==(s=this.animationOptions.getKey)&&void 0!==s?s:e=>e);!r&&(n.reorderedItems.length>0||n.addedItems.length>0)&&(n.deletedItems=[],n.mergedItems=e),this.animationOptions.onCompareArrays&&this.animationOptions.onCompareArrays(n);let{addedItems:a,reorderedItems:o,deletedItems:l,mergedItems:h}=n,u=()=>{this.animation.runGroupAnimation(this.animationOptions,a,l,o,()=>{l.length>0&&this.update(e)})};[a,l,o].some(e=>e.length>0)?l.length<=0||o.length>0||a.length>0?(this.onNextRender(u,()=>{this.update(e)}),this.update(h)):u():this.update(e)}}class ez extends eq{constructor(e,t,s,i){super(e,t,s),this.mergeValues=i,this.animation=new e_}_sync(e){let t=[].concat(this.getCurrentValue());if(t[0]!==e[0]){let s=this.mergeValues?this.mergeValues(e,t):[].concat(t,e);this.onNextRender(()=>{this.animation.runGroupAnimation(this.animationOptions,e,t,[],()=>{this.update(e)})},()=>this.update(e)),this.update(s,!0)}else this.update(e)}}class eH extends eg{constructor(){super(),this.createLocTitleProperty()}createLocTitleProperty(){return this.createLocalizableString("title",this,!0)}get isPage(){return!1}get isPanel(){return!1}get isQuestion(){return!1}get isSurvey(){return!1}get title(){return this.getLocalizableStringText("title",this.getDefaultTitleValue())}set title(e){this.setTitleValue(e)}get locTitle(){return this.getLocalizableString("title")}getDefaultTitleValue(){}setTitleValue(e){this.setLocalizableStringText("title",e)}get hasDescription(){return this.getPropertyValue("hasDescription",void 0,()=>this.calcDescriptionVisibility())}set hasDescription(e){this.setPropertyValue("hasDescription",e)}calcDescriptionVisibility(){let e=this.description,t=!1;if(this.isDesignMode){let e=E.findProperty(this.getType(),"description");t=!!(null==e?void 0:e.placeholder)}return!!e||t&&this.isDesignMode}resetDescriptionVisibility(){this.resetPropertyValue("hasDescription")}get locDescription(){return this.getLocalizableString("description")}get titleTagName(){let e=this.getDefaultTitleTagName(),t=this.getSurvey();return t?t.getElementTitleTagName(this,e):e}getDefaultTitleTagName(){return tp.titleTags[this.getType()]}get hasTitle(){return this.title.length>0}get hasTitleActions(){return!1}get hasTitleEvents(){return this.hasTitleActions}getTitleToolbar(){return null}getTitleOwner(){}get isTitleOwner(){return!!this.getTitleOwner()}get isTitleRenderedAsString(){return this.getIsTitleRenderedAsString()}toggleState(){}get cssClasses(){return{}}get cssTitle(){return""}get ariaTitleId(){}get ariaDescriptionId(){}get titleTabIndex(){}get titleAriaExpanded(){}get titleAriaRole(){}get ariaLabel(){return this.locTitle.renderedHtml}get titleAriaLabel(){return this.ariaLabel}getIsTitleRenderedAsString(){return!this.isTitleOwner}}ey([c({localizable:!0,onSet:(e,t)=>{t.resetDescriptionVisibility()}})],eH.prototype,"description",void 0),function(e){e[e.InsideEmptyPanel=1]="InsideEmptyPanel",e[e.MultilineRight=2]="MultilineRight",e[e.MultilineLeft=3]="MultilineLeft",e[e.Top=4]="Top",e[e.Right=5]="Right",e[e.Bottom=6]="Bottom",e[e.Left=7]="Left"}(o||(o={}));class eW extends eH{static getProgressInfoByElements(e,t){let s=eg.createProgressInfo();for(let t=0;t<e.length;t++){if(!e[t].isVisible)continue;let i=e[t].getProgressInfo();s.questionCount+=i.questionCount,s.answeredQuestionCount+=i.answeredQuestionCount,s.requiredQuestionCount+=i.requiredQuestionCount,s.requiredAnsweredQuestionCount+=i.requiredAnsweredQuestionCount}return t&&s.questionCount>0&&(0==s.requiredQuestionCount&&(s.requiredQuestionCount=1),s.answeredQuestionCount>0&&(s.requiredAnsweredQuestionCount=1)),s}static IsNeedScrollIntoView(e,t,s){let r=s?-1:e.getBoundingClientRect().top,n=r<0,a=-1;if(!n&&t&&(n=(a=e.getBoundingClientRect().left)<0),!n&&i.isAvailable()){let e=i.getInnerHeight();if(!(n=e>0&&e<r)&&t){let e=i.getInnerWidth();n=e>0&&e<a}}return n}static ScrollIntoView(e,t,s){if(e.scrollIntoView(t),"function"==typeof s){let t=null,r=0,n=()=>{let i=e.getBoundingClientRect().top;if(i===t){if(r++>2){s();return}}else t=i,r=0;requestAnimationFrame(n)};i.requestAnimationFrame(n)}}static ScrollElementToTop(e,t,s,i){let{root:r}=tp.environment;if(!e||void 0===r)return!1;let n=r.getElementById(e);return eW.ScrollElementToViewCore(n,!1,t,s,i)}static ScrollElementToViewCore(e,t,s,i,r){if(!e||!e.scrollIntoView)return r&&r(),!1;let n=eW.IsNeedScrollIntoView(e,t,s);return n?eW.ScrollIntoView(e,i,r):r&&r(),n}static GetFirstNonTextElement(e,t=!1){if(!e||!e.length||0==e.length)return null;if(t){let t=e[0];"#text"===t.nodeName&&(t.data=""),"#text"===(t=e[e.length-1]).nodeName&&(t.data="")}for(let t=0;t<e.length;t++)if("#text"!=e[t].nodeName&&"#comment"!=e[t].nodeName)return e[t];return null}static FocusElement(e,t,s){if(!e||!r.isAvailable())return!1;let i=!t&&eW.focusElementCore(e,s);return i||setTimeout(()=>{eW.focusElementCore(e,s)},t?100:10),i}static focusElementCore(e,t){let{root:s}=tp.environment;if(!s&&!t)return!1;let i=t?t.querySelector(`#${CSS.escape(e)}`):s.getElementById(e);return!!i&&!i.disabled&&"none"!==i.style.display&&null!==i.offsetParent&&(eW.ScrollElementToViewCore(i,!0,!1),i.focus(),!0)}get effectiveColSpan(){let e=this.getPropertyValueWithoutDefault("effectiveColSpan");return void 0!==e?e:(this.setRootStyle(),this.getPropertyValue("effectiveColSpan"))}get colSpan(){return this.getPropertyValue("colSpan",1)}set colSpan(e){this.setPropertyValue("colSpan",e)}constructor(e){super(),this.selectedElementInDesignValue=this,this.disableDesignActions=eW.CreateDisabledDesignElements,this.parentQuestionValue=null,this.isContentElement=!1,this.isEditableTemplateElement=!1,this.isInteractiveDesignElement=!0,this.isSingleInRow=!0,this._renderedIsExpanded=!0,this._isAnimatingCollapseExpand=!1,this.animationCollapsed=new eB(this.getExpandCollapseAnimationOptions(),e=>{this._renderedIsExpanded=e,this.animationAllowed&&(e?this.isAnimatingCollapseExpand=!0:this.updateElementCss(!1))},()=>this.renderedIsExpanded),this.onAfterRenderElement=this.addEvent(),this.setPropertyValueDirectly("name",this.getValidName(e)),this.createNewArray("errors"),this.createNewArray("titleActions"),this.registerPropertyChangedHandlers(["isReadOnly"],()=>{this.onReadOnlyChanged()}),this.registerPropertyChangedHandlers(["errors"],()=>{this.updateVisibleErrors()}),this.registerPropertyChangedHandlers(["isSingleInRow"],()=>{this.updateElementCss(!1)}),this.registerPropertyChangedHandlers(["minWidth","maxWidth","renderWidth","allowRootStyle","parent"],()=>{this.updateRootStyle()}),this.registerPropertyChangedHandlers(["effectiveColSpan"],e=>{this.colSpan=e})}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),"state"===e&&(this.updateElementCss(!1),this.notifyStateChanged(t),this.stateChangedCallback&&this.stateChangedCallback())}getSkeletonComponentNameCore(){return this.survey?this.survey.getSkeletonComponentName(this):"sv-skeleton"}get parentQuestion(){return this.parentQuestionValue}setParentQuestion(e){this.parentQuestionValue=e,this.onParentQuestionChanged()}onParentQuestionChanged(){}updateElementVisibility(){this.setPropertyValue("isVisible",this.isVisible)}get skeletonComponentName(){return this.getSkeletonComponentNameCore()}get state(){return this.getPropertyValue("state")}set state(e){this.setPropertyValue("state",e),this.renderedIsExpanded=!this.isCollapsed}notifyStateChanged(e){this.survey&&this.survey.elementContentVisibilityChanged(this)}get isCollapsed(){return"collapsed"===this.state&&!this.isDesignMode}get isExpanded(){return"expanded"===this.state}collapse(){this.isDesignMode||(this.state="collapsed")}expand(){this.state="expanded"}toggleState(){return this.isCollapsed?(this.expand(),!0):!this.isExpanded||(this.collapse(),!1)}get hasStateButton(){return this.isExpanded||this.isCollapsed}get shortcutText(){return this.title||this.name}getTitleToolbar(){return this.titleToolbarValue||(this.titleToolbarValue=this.createActionContainer(!0),this.titleToolbarValue.locOwner=this,this.titleToolbarValue.containerCss=(this.isPanel?this.cssClasses.panel.titleBar:this.cssClasses.titleBar)||"sv-action-title-bar",this.titleToolbarValue.setItems(this.getTitleActions())),this.titleToolbarValue}createActionContainer(e){let t=e?new ek:new ex;return this.survey&&this.survey.getCss().actionBar&&(t.cssClasses=this.survey.getCss().actionBar),t}get titleActions(){return this.getPropertyValue("titleActions")}getTitleActions(){return this.isTitleActionRequested||(this.updateTitleActions(),this.isTitleActionRequested=!0),this.titleActions}getDefaultTitleActions(){return[]}updateTitleActions(){let e=this.getDefaultTitleActions();this.survey&&(e=this.survey.getUpdatedElementTitleActions(this,e)),this.setPropertyValue("titleActions",e)}locStrsChanged(){super.locStrsChanged(),this.titleToolbarValue&&this.titleToolbarValue.locStrsChanged()}get hasTitleActions(){return this.getTitleActions().length>0}get hasTitleEvents(){return void 0!==this.state&&"default"!==this.state}get titleTabIndex(){return this.isPage||"default"===this.state?void 0:0}get titleAriaExpanded(){if(!this.isPage&&"default"!==this.state)return"expanded"===this.state?"true":"false"}get titleAriaRole(){if(!this.isPage&&"default"!==this.state)return"button"}setSurveyImpl(e,t){this.surveyImplValue=e,this.surveyImplValue?(this.surveyDataValue=this.surveyImplValue.getSurveyData(),this.setSurveyCore(this.surveyImplValue.getSurvey()),this.textProcessorValue=this.surveyImplValue.getTextProcessor(),this.onSetData()):(this.setSurveyCore(null),this.surveyDataValue=null),this.survey&&(this.resetDescriptionVisibility(),this.clearCssClasses()),this.blockAnimations(),this.renderedIsExpanded=!this.isCollapsed,this.releaseAnimations()}canRunConditions(){return super.canRunConditions()&&!!this.data}getDataFilteredValues(){return this.data?this.data.getFilteredValues():{}}getDataFilteredProperties(){var e=this.data?this.data.getFilteredProperties():{};return e.question=this,e}get surveyImpl(){return this.surveyImplValue}__setData(e){this.surveyDataValue=e}get data(){return this.surveyDataValue}get survey(){return this.getSurvey()}getSurvey(e=!1){return this.surveyValue||this.surveyImplValue&&this.setSurveyCore(this.surveyImplValue.getSurvey()),this.surveyValue}setSurveyCore(e){this.surveyValue=e,this.surveyChangedCallback&&this.surveyChangedCallback()}get skeletonHeight(){let e;return this.survey&&this.survey.skeletonHeight&&(e=this.survey.skeletonHeight+"px"),e}get isInternal(){return this.isContentElement}get areInvisibleElementsShowing(){return!!this.survey&&this.survey.areInvisibleElementsShowing&&!this.isContentElement}get isVisible(){return!0}get isReadOnly(){return this.readOnly}get readOnly(){return this.getPropertyValue("readOnly")}set readOnly(e){this.readOnly==e||(this.setPropertyValue("readOnly",e),this.isLoadingFromJson||this.setPropertyValue("isReadOnly",this.isReadOnly))}onReadOnlyChanged(){this.readOnlyChangedCallback&&this.readOnlyChangedCallback()}get css(){return this.survey?this.survey.getCss():{}}get cssClassesValue(){let e=this.getPropertyValueWithoutDefault("cssClassesValue");return e||this.isCssValueCalculating||(this.isCssValueCalculating=!0,e=this.createCssClassesValue(),this.isCssValueCalculating=!1),e}createCssClassesValue(){let e=this.calcCssClasses(this.css);return this.setPropertyValue("cssClassesValue",e),this.onCalcCssClasses(e),this.updateElementCssCore(this.cssClassesValue),e}onCalcCssClasses(e){}get cssClasses(){return(this.cssClassesValue,this.survey)?(this.cssClassesValue||this.createCssClassesValue(),this.cssClassesValue):this.calcCssClasses(this.css)}get cssTitleNumber(){let e=this.cssClasses;return e.number?e.number:e.panel?e.panel.number:void 0}get cssRequiredMark(){let e=this.cssClasses;return e.requiredMark||e.panel&&e.panel.requiredMark}getCssTitleExpandableSvg(){return"default"===this.state?null:this.cssClasses.titleExpandableSvg}calcCssClasses(e){}updateElementCssCore(e){}get cssError(){return""}updateElementCss(e){this.clearCssClasses()}clearCssClasses(){this.resetPropertyValue("cssClassesValue")}getIsLoadingFromJson(){return!!super.getIsLoadingFromJson()||!!this.surveyValue&&this.surveyValue.isLoadingFromJson}get name(){return this.getPropertyValue("name","")}set name(e){var t=this.name;this.setPropertyValue("name",this.getValidName(e)),!this.isLoadingFromJson&&t&&this.onNameChanged(t)}getValidName(e){return e}onNameChanged(e){}updateBindingValue(e,t){this.data&&!this.isTwoValueEquals(t,this.data.getValue(e))&&this.data.setValue(e,t,!1)}get errors(){return this.getPropertyValue("errors")}set errors(e){this.setPropertyValue("errors",e)}updateVisibleErrors(){for(var e=0,t=0;t<this.errors.length;t++)this.errors[t].visible&&e++;this.hasVisibleErrors=e>0}get containsErrors(){return this.getPropertyValue("containsErrors",!1)}updateContainsErrors(){this.setPropertyValue("containsErrors",this.getContainsErrors())}getContainsErrors(){return this.errors.length>0}get selectedElementInDesign(){return this.selectedElementInDesignValue}set selectedElementInDesign(e){this.selectedElementInDesignValue=e}updateCustomWidgets(){}onSurveyLoad(){}get wasRendered(){return!!this.wasRenderedValue}onFirstRendering(){this.wasRendered||(this.wasRenderedValue=!0,this.onFirstRenderingCore())}onFirstRenderingCore(){}endLoadingFromJson(){super.endLoadingFromJson(),this.survey||this.onSurveyLoad()}setVisibleIndex(e){return 0}delete(e){}getLocale(){return this.survey?this.survey.getLocale():this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t){return this.survey?this.survey.getSurveyMarkdownHtml(this,e,t):this.locOwner?this.locOwner.getMarkdownHtml(e,t):void 0}getRenderer(e){return this.survey&&"function"==typeof this.survey.getRendererForString?this.survey.getRendererForString(this,e):this.locOwner&&"function"==typeof this.locOwner.getRenderer?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.survey&&"function"==typeof this.survey.getRendererContextForString?this.survey.getRendererContextForString(this,e):this.locOwner&&"function"==typeof this.locOwner.getRendererContext?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.isLoadingFromJson?e:this.textProcessor?this.textProcessor.processText(e,this.getUseDisplayValuesInDynamicTexts()):this.locOwner?this.locOwner.getProcessedText(e):e}getUseDisplayValuesInDynamicTexts(){return!0}removeSelfFromList(e){if(!e||!Array.isArray(e))return;let t=e.indexOf(this);t>-1&&e.splice(t,1)}get textProcessor(){return this.textProcessorValue}getProcessedHtml(e){return e&&this.textProcessor?this.textProcessor.processText(e,!0):e}onSetData(){}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.setPropertyValue("parent",e)}getPage(e){for(;e&&e.parent;)e=e.parent;return e&&e.isPage?e:null}moveToBase(e,t,s=null){if(!t)return!1;e.removeElement(this);let i=-1;return a.isNumber(s)&&(i=parseInt(s)),-1==i&&s&&s.getType&&(i=t.indexOf(s)),t.addElement(this,i),!0}setPage(e,t){let s=this.getPage(e);this.prevSurvey=this.survey,"string"==typeof t&&this.getSurvey().pages.forEach(e=>{t===e.name&&(t=e)}),s!==t&&(e&&e.removeElement(this),t&&t.addElement(this,-1),this.prevSurvey=void 0)}getSearchableLocKeys(e){e.push("title"),e.push("description")}get isDefaultV2Theme(){return this.survey&&-1!==this.survey.getCss().root.indexOf("sd-root-modern")}get hasParent(){return this.parent&&!this.parent.isPage||void 0===this.parent}shouldAddRunnerStyles(){return!this.isDesignMode&&this.isDefaultV2Theme}get isCompact(){return this.survey&&this.survey.isCompact}canHaveFrameStyles(){var e;return null!==(e=this.survey)&&void 0!==e&&!!e.currentSingleQuestion||void 0!==this.parent&&(!this.hasParent||this.parent&&this.parent.showPanelAsPage)}getHasFrameV2(){return this.shouldAddRunnerStyles()&&this.canHaveFrameStyles()}getIsNested(){return this.shouldAddRunnerStyles()&&!this.canHaveFrameStyles()}getCssRoot(e){let t=!!this.isCollapsed||!!this.isExpanded;return new eV().append(e.withFrame,this.getHasFrameV2()&&!this.isCompact).append(e.compact,this.isCompact&&this.getHasFrameV2()).append(e.collapsed,!!this.isCollapsed).append(e.expandableAnimating,t&&this.isAnimatingCollapseExpand).append(e.expanded,!!this.isExpanded&&this.renderedIsExpanded).append(e.expandable,t).append(e.nested,this.getIsNested()).toString()}get width(){return this.getPropertyValue("width","")}set width(e){this.setPropertyValue("width",e)}get minWidth(){return this.getPropertyValue("minWidth")}set minWidth(e){this.setPropertyValue("minWidth",e)}get maxWidth(){return this.getPropertyValue("maxWidth")}set maxWidth(e){this.setPropertyValue("maxWidth",e)}get renderWidth(){return this.getPropertyValue("renderWidth","")}set renderWidth(e){this.setPropertyValue("renderWidth",e)}get indent(){return this.getPropertyValue("indent")}set indent(e){this.setPropertyValue("indent",e)}get rightIndent(){return this.getPropertyValue("rightIndent",0)}set rightIndent(e){this.setPropertyValue("rightIndent",e)}getRootStyle(){let e={};return this.paddingLeft&&(e["--sv-element-add-padding-left"]=this.paddingLeft),this.paddingRight&&(e["--sv-element-add-padding-right"]=this.paddingRight),e}get paddingLeft(){return this.getPropertyValue("paddingLeft",void 0,()=>this.calcPaddingLeft())}calcPaddingLeft(){return""}get paddingRight(){return this.getPropertyValue("paddingRight",void 0,()=>this.calcPaddingRight())}set paddingRight(e){this.setPropertyValue("paddingRight",e)}calcPaddingRight(){return""}resetIndents(){this.resetPropertyValue("paddingLeft"),this.resetPropertyValue("paddingRight")}get rootStyle(){return this.getPropertyValue("rootStyle",void 0,()=>this.calcRootStyle())}set rootStyle(e){this.setPropertyValue("rootStyle",e)}updateRootStyle(){this.getPropertyValueWithoutDefault("rootStyle")?this.setRootStyle():this.resetPropertyValue("effectiveColSpan")}setRootStyle(){this.rootStyle=this.calcRootStyle()}calcRootStyle(){let e;let t={};if(this.parent&&(e=this.parent.getColumsForElement(this).reduce((e,t)=>t.effectiveWidth+e,0))&&100!==e&&(t.flexGrow=1,t.flexShrink=0,t.flexBasis=e+"%",t.minWidth=void 0,t.maxWidth=this.maxWidth),0==Object.keys(t).length){let e=""+this.minWidth;if(e&&"auto"!=e){if(-1!=e.indexOf("px")&&this.survey){let t=parseFloat(e=e.replace("px",""));isNaN(t)||(e=""+(e=t*this.survey.widthScale/100)+"px")}e="min(100%, "+e+")"}this.allowRootStyle&&this.renderWidth&&(t.flexGrow=1,t.flexShrink=1,t.flexBasis=this.renderWidth,t.minWidth=e,t.maxWidth=this.maxWidth)}return t}isContainsSelection(e){let t;let s=r.getDocument();if(r.isAvailable()&&s&&s.selection)t=s.selection.createRange().parentElement();else{var n=i.getSelection();if(n&&n.rangeCount>0){let e=n.getRangeAt(0);e.startOffset!==e.endOffset&&(t=e.startContainer.parentNode)}}return t==e}get clickTitleFunction(){if(this.needClickTitleFunction())return e=>{if(!(e&&this.isContainsSelection(e.target)))return this.processTitleClick()}}needClickTitleFunction(){return"default"!==this.state}processTitleClick(){"default"!==this.state&&this.toggleState()}get hasAdditionalTitleToolbar(){return!1}get additionalTitleToolbar(){return this.getAdditionalTitleToolbar()}getAdditionalTitleToolbar(){return null}getCssTitle(e){if(!e)return"";let t="default"!==this.state;return new eV().append(e.title).append(e.titleNumInline,(this.no||"").length>4||t).append(e.titleExpandable,t).append(e.titleExpanded,this.isExpanded).append(e.titleCollapsed,this.isCollapsed).append(e.titleDisabled,this.isDisabledStyle).append(e.titleReadOnly,this.isReadOnly).append(e.titleOnError,this.containsErrors).toString()}get isDisabledStyle(){return this.getIsDisableAndReadOnlyStyles(!1)[1]}get isReadOnlyStyle(){return this.getIsDisableAndReadOnlyStyles(!1)[0]}getIsDisableAndReadOnlyStyles(e){let t=this.isPreviewStyle,s=e||this.isReadOnly,i=!this.isDefaultV2Theme&&(s||t);return[s&&!t,i]}get isPreviewStyle(){return!!this.survey&&"preview"===this.survey.state}localeChanged(){super.localeChanged(),this.resetDescriptionVisibility(),this.errors.length>0&&this.errors.forEach(e=>{e.updateText()})}setWrapperElement(e){this.wrapperElement=e}getWrapperElement(){return this.wrapperElement}set isAnimatingCollapseExpand(e){e!==this._isAnimatingCollapseExpand&&(this._isAnimatingCollapseExpand=e,this.updateElementCss(!1))}get isAnimatingCollapseExpand(){return this._isAnimatingCollapseExpand||this._renderedIsExpanded!=this.isExpanded}onElementExpanded(e){}getExpandCollapseAnimationOptions(){let e=e=>{this.isAnimatingCollapseExpand=!0,td(e)},t=e=>{this.isAnimatingCollapseExpand=!1,tc(e)};return{getRerenderEvent:()=>this.onElementRerendered,getEnterOptions:()=>({cssClass:(this.isPanel?this.cssClasses.panel:this.cssClasses).contentEnter,onBeforeRunAnimation:e,onAfterRunAnimation:e=>{t(e),this.onElementExpanded(!0)}}),getLeaveOptions:()=>({cssClass:(this.isPanel?this.cssClasses.panel:this.cssClasses).contentLeave,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getAnimatedElement:()=>{var e;let t=this.isPanel?this.cssClasses.panel:this.cssClasses;if(t.content){let s=tr(t.content);if(s)return null===(e=this.getWrapperElement())||void 0===e?void 0:e.querySelector(`:scope ${s}`)}},isAnimationEnabled:()=>this.isExpandCollapseAnimationEnabled}}get isExpandCollapseAnimationEnabled(){return this.animationAllowed&&!this.isDesignMode}set renderedIsExpanded(e){let t=this._renderedIsExpanded;this.animationCollapsed.sync(e),this.isExpandCollapseAnimationEnabled||t||!this.renderedIsExpanded||this.onElementExpanded(!1)}get renderedIsExpanded(){return!!this._renderedIsExpanded}getIsAnimationAllowed(){return super.getIsAnimationAllowed()&&!!this.survey&&!this.survey.isEndLoadingFromJson}afterRenderCore(e){this.onAfterRenderElement.fire(this,{htmlElement:e})}dispose(){super.dispose(),this.titleToolbarValue&&this.titleToolbarValue.dispose()}}eW.CreateDisabledDesignElements=!1,ey([c({defaultValue:null})],eW.prototype,"dragTypeOverMe",void 0),ey([c({defaultValue:!1})],eW.prototype,"isDragMe",void 0),ey([c({defaultValue:!1})],eW.prototype,"hasVisibleErrors",void 0),ey([c({defaultValue:!0})],eW.prototype,"isSingleInRow",void 0),ey([c({defaultValue:!0})],eW.prototype,"allowRootStyle",void 0),ey([c()],eW.prototype,"_renderedIsExpanded",void 0);class eU{constructor(e,t,s=100){this._elements=e,this._renderedHandler=t,this._elementsToRenderCount=0,this._elementsToRenderTimer=void 0,this._elementRenderedHandler=(e,t)=>{var s;null===(s=e.onAfterRenderElement)||void 0===s||s.remove(this._elementRenderedHandler),this._elementsToRenderCount--,this._elementsToRenderCount<=0&&this.visibleElementsRendered()},this._elements.forEach(e=>{e.onAfterRenderElement&&(e.onAfterRenderElement.add(this._elementRenderedHandler),this._elementsToRenderCount++)}),this._elementsToRenderCount>0?this._elementsToRenderTimer=setTimeout(()=>{this._elementsToRenderCount>0&&this.visibleElementsRendered()},s):this.visibleElementsRendered()}stopWaitingForElementsRendering(){this._elementsToRenderTimer&&(clearTimeout(this._elementsToRenderTimer),this._elementsToRenderTimer=void 0),this._elements.forEach(e=>{var t;null===(t=e.onAfterRenderElement)||void 0===t||t.remove(this._elementRenderedHandler)}),this._elementsToRenderCount=0}visibleElementsRendered(){let e=this._renderedHandler;this.dispose(),"function"==typeof e&&e()}dispose(){this.stopWaitingForElementsRendering(),this._elements=void 0,this._renderedHandler=void 0}}class ej{static get defaultLocale(){return tp.localization.defaultLocaleName}static set defaultLocale(e){tp.localization.defaultLocaleName=e}get localizationName(){return this._localizationName}set localizationName(e){this._localizationName!=e&&(this._localizationName=e,this.strChanged())}get allowLineBreaks(){var e;return void 0===this._allowLineBreaks&&(this._allowLineBreaks=!1,this.name&&this.owner instanceof eH&&(this._allowLineBreaks=(null===(e=E.findProperty(this.owner.getType(),this.name))||void 0===e?void 0:e.type)=="text")),this._allowLineBreaks}constructor(e,t=!1,s,i){this.owner=e,this.useMarkdown=t,this.name=s,this.values={},this.htmlValues={},this.onStringChanged=new ev,this._localizationName=i,this.onCreating()}getIsMultiple(){return!1}get locale(){if(this.owner&&this.owner.getLocale){let e=this.owner.getLocale();if(e||!this.sharedData)return e}return this.sharedData?this.sharedData.locale:""}strChanged(){this.isTextRequested&&(this.searchableText=void 0,(void 0!==this.renderedText||!this.isEmpty||this.onGetTextCallback||this.localizationName)&&(this.calculatedTextValue=this.calcText(),this.renderedText!==this.calculatedTextValue&&(this.renderedText=void 0,this.calculatedTextValue=void 0),this.htmlValues={},this.onChanged(),this.onStringChanged.fire(this,{})))}get text(){return this.pureText}set text(e){this.setLocaleText(this.locale,e)}get calculatedText(){return this.renderedText=void 0!==this.calculatedTextValue?this.calculatedTextValue:this.calcText(),this.calculatedTextValue=void 0,this.renderedText}calcText(){let e=this.pureText,t=e;return t&&this.owner&&this.owner.getProcessedText&&t.indexOf("{")>-1&&(t=this.owner.getProcessedText(t)),this.onGetTextCallback&&(t=this.onGetTextCallback(t,e)),t}get pureText(){this.isTextRequested=!0;var e=this.locale;e||(e=this.defaultLoc);var t=this.getValue(e);if(this.isValueEmpty(t)&&e===this.defaultLoc&&(t=this.getValue(h.defaultLocale)),this.isValueEmpty(t)){let s=this.getRootDialect(e);s&&(t=this.getValue(s))}return this.isValueEmpty(t)&&e!==this.defaultLoc&&(t=this.getValue(this.defaultLoc)),this.isValueEmpty(t)&&this.getLocalizationName()&&(t=this.getLocalizationStr(),this.onGetLocalizationTextCallback&&(t=this.onGetLocalizationTextCallback(t))),t||(t=this.defaultValue||""),t}getRootDialect(e){if(!e)return e;let t=e.indexOf("-");return t>-1?e.substring(0,t):""}getLocalizationName(){return this.sharedData?this.sharedData.localizationName:this.localizationName}getLocalizationStr(){let e=this.getLocalizationName();return e?u(e,this.locale):""}get hasHtml(){return this.hasHtmlValue()}get html(){return this.hasHtml?this.getHtmlValue():""}get isEmpty(){return 0==this.getValuesKeys().length}get textOrHtml(){return this.hasHtml?this.getHtmlValue():this.calculatedText}get renderedHtml(){return this.textOrHtml}getLocaleText(e){return this.getLocaleTextCore(e)||""}getLocaleTextCore(e){return e||(e=this.defaultLoc),this.getValue(e)}isLocaleTextEqualsWithDefault(e,t){let s=this.getLocaleTextCore(e);return s===t||this.isValueEmpty(s)&&this.isValueEmpty(t)}clear(){this.setJson(void 0)}clearLocale(e){this.setLocaleText(e,void 0)}setLocaleText(e,t){if((e=this.getValueLoc(e))&&void 0===t){let t=this.getValue(e);void 0!==t&&(this.deleteValue(e),this.fireStrChanged(e,t));return}if(!this.storeDefaultText&&this.isLocaleTextEqualsWithDefault(e,t)){if(!this.isValueEmpty(t)||e&&e!==this.defaultLoc)return;let s=h.defaultLocale,i=this.getValue(s);s&&!this.isValueEmpty(i)&&(this.setValue(s,t),this.fireStrChanged(s,i));return}if(tp.localization.storeDuplicatedTranslations||this.isValueEmpty(t)||!e||e==this.defaultLoc||this.getValue(e)||t!=this.getLocaleText(this.defaultLoc)){var s=this.curLocale;e||(e=this.defaultLoc);var i=this.onStrChanged&&e===s?this.pureText:void 0;delete this.htmlValues[e],this.isValueEmpty(t)?this.deleteValue(e):"string"==typeof t&&(this.canRemoveLocValue(e,t)?this.setLocaleText(e,null):(this.setValue(e,t),e==this.defaultLoc&&this.deleteValuesEqualsToDefault(t))),this.fireStrChanged(e,i)}}isValueEmpty(e){return null==e||!this.localizationName&&""===e}get curLocale(){return this.locale?this.locale:this.defaultLoc}canRemoveLocValue(e,t){if(tp.localization.storeDuplicatedTranslations||e===this.defaultLoc)return!1;let s=this.getRootDialect(e);if(!s)return t==this.getLocaleText(this.defaultLoc);{let e=this.getLocaleText(s);return e?e==t:this.canRemoveLocValue(s,t)}}fireStrChanged(e,t){if(this.strChanged(),!this.onStrChanged)return;let s=this.pureText;(e!==this.curLocale||t!==s)&&this.onStrChanged(t,s)}hasNonDefaultText(){var e=this.getValuesKeys();return 0!=e.length&&(e.length>1||e[0]!=this.defaultLoc)}getLocales(){var e=this.getValuesKeys();return 0==e.length?[]:e}getJson(){if(this.sharedData)return this.sharedData.getJson();let e=this.getValuesKeys();if(0==e.length){if(this.serializeCallBackText){let e=this.calcText();if(e)return e}return null}if(1==e.length&&e[0]==tp.localization.defaultLocaleName&&!tp.serialization.localizableStringSerializeAsObject)return this.values[e[0]];let t={};for(let e in this.values)t[e]=this.values[e];return t}setJson(e,t){if(this.sharedData){this.sharedData.setJson(e,t);return}if(this.values={},this.htmlValues={},null!=e){if(t)"string"==typeof e?this.values[tp.defaultLocaleName]=e:(this.values=e,delete this.values.pos);else{if("string"==typeof e)this.setLocaleText(null,e);else for(var s in e)this.setLocaleText(s,e[s]);this.strChanged()}}}get renderAs(){return this.owner&&"function"==typeof this.owner.getRenderer&&this.owner.getRenderer(this.name)||ej.defaultRenderer}get renderAsData(){return this.owner&&"function"==typeof this.owner.getRendererContext&&this.owner.getRendererContext(this)||this}equals(e){return this.sharedData?this.sharedData.equals(e):!!e&&!!e.values&&a.isTwoValueEquals(this.values,e.values,!1,!0,!1)}setFindText(e){if(this.searchText!=e){if(this.searchText=e,!this.searchableText){let e=this.textOrHtml;this.searchableText=e?e.toLowerCase():""}var t=this.searchableText,s=t&&e?t.indexOf(e):void 0;return s<0&&(s=void 0),(void 0!=s||this.searchIndex!=s)&&(this.searchIndex=s,this.onSearchChanged&&this.onSearchChanged()),void 0!=this.searchIndex}}onChanged(){}onCreating(){}hasHtmlValue(){if(!this.owner||!this.useMarkdown)return!1;let e=this.locale;if(e||(e=this.defaultLoc),void 0!==this.htmlValues[e])return!!this.htmlValues[e];let t=this.calculatedText;if(!t||this.getLocalizationName()&&t===this.getLocalizationStr())return this.setHtmlValue(e,""),!1;let s=this.owner.getMarkdownHtml(t,this.name);return this.setHtmlValue(e,s),!!s}setHtmlValue(e,t){this.htmlValues[e]=t}getHtmlValue(){var e=this.locale;return e||(e=this.defaultLoc),this.htmlValues[e]}deleteValuesEqualsToDefault(e){if(!tp.localization.storeDuplicatedTranslations)for(var t=this.getValuesKeys(),s=0;s<t.length;s++)t[s]!=this.defaultLoc&&this.getValue(t[s])==e&&this.deleteValue(t[s])}getValue(e){return this.sharedData?this.sharedData.getValue(e):this.values[this.getValueLoc(e)]}setValue(e,t){this.sharedData?this.sharedData.setValue(e,t):this.values[this.getValueLoc(e)]=t}deleteValue(e){this.sharedData?this.sharedData.deleteValue(e):delete this.values[this.getValueLoc(e)]}getValueLoc(e){return this.disableLocalization?tp.localization.defaultLocaleName:e}getValuesKeys(){return this.sharedData?this.sharedData.getValuesKeys():Object.keys(this.values)}get defaultLoc(){return tp.localization.defaultLocaleName}}ej.SerializeAsObject=!1,ej.defaultRenderer="sv-string-viewer",ej.editableRenderer="sv-string-editor";class eJ{constructor(e){this.owner=e,this.values={}}getIsMultiple(){return!0}get locale(){return this.owner&&this.owner.getLocale?this.owner.getLocale():""}get value(){return this.getValue("")}set value(e){this.setValue("",e)}get text(){return Array.isArray(this.value)?this.value.join("\n"):""}set text(e){this.value=e?e.split("\n"):[]}getLocaleText(e){var t=this.getValueCore(e,!e||e===this.locale);return t&&Array.isArray(t)&&0!=t.length?t.join("\n"):""}setLocaleText(e,t){var s=t?t.split("\n"):null;this.setValue(e,s)}getValue(e){return this.getValueCore(e)}getValueCore(e,t=!0){if(e=this.getLocale(e),this.values[e])return this.values[e];if(t){var s=tp.localization.defaultLocaleName;if(e!==s&&this.values[s])return this.values[s]}return[]}setValue(e,t){e=this.getLocale(e);let s=a.createCopy(this.values);t&&0!=t.length?this.values[e]=t:delete this.values[e],this.onValueChanged&&this.onValueChanged(s,this.values)}hasValue(e=""){return!this.isEmpty&&this.getValue(e).length>0}get isEmpty(){return 0==this.getValuesKeys().length}getLocale(e){return e||(e=this.locale)||tp.localization.defaultLocaleName}getLocales(){var e=this.getValuesKeys();return 0==e.length?[]:e}getJson(){var e=this.getValuesKeys();return 0==e.length?null:1!=e.length||e[0]!=tp.localization.defaultLocaleName||tp.serialization.localizableStringSerializeAsObject?a.createCopy(this.values):this.values[e[0]]}setJson(e){if(this.values={},e){if(Array.isArray(e))this.setValue(null,e);else for(var t in e)this.setValue(t,e[t])}}getValuesKeys(){return Object.keys(this.values)}}function eG(e){var t;let s=t=>{t?e.funcOnYes():e.funcOnNo&&e.funcOnNo()};!(tp&&tp.confirmActionAsync&&tp.confirmActionAsync(e.message,s,e))&&s((t=e.message,tp&&tp.confirmActionFunc?tp.confirmActionFunc(t):confirm(t)))}function eK(){if(void 0===eK.isIEOrEdge){let e=navigator.userAgent,t=e.indexOf("MSIE "),s=e.indexOf("Trident/");eK.isIEOrEdge=e.indexOf("Edge/")>0||s>0||t>0}return eK.isIEOrEdge}let eY=e=>!!e&&!!("host"in e&&e.host),eX=e=>{let{root:t}=tp.environment;return"string"==typeof e?t.getElementById(e):e};function e$(e){let{root:t}=tp.environment;return e?e.scrollHeight>e.clientHeight&&("scroll"===getComputedStyle(e).overflowY||"auto"===getComputedStyle(e).overflowY)||e.scrollWidth>e.clientWidth&&("scroll"===getComputedStyle(e).overflowX||"auto"===getComputedStyle(e).overflowX)?e:e$(e.parentElement):eY(t)?t.host:t.documentElement}function eZ(e){let t=tp.environment;if(!t)return;let{root:s}=t,i=s.getElementById(e);if(!i)return;let r=e$(i);r&&setTimeout(()=>r.dispatchEvent(new CustomEvent("scroll")),10)}function e0(e){return e?["url(",e,")"].join(""):""}let e1={changecamera:"flip-24x24",clear:"clear-24x24",cancel:"cancel-24x24",closecamera:"close-24x24",defaultfile:"file-72x72",choosefile:"folder-24x24",file:"toolbox-file-24x24",left:"chevronleft-16x16",modernbooleancheckchecked:"plus-32x32",modernbooleancheckunchecked:"minus-32x32",more:"more-24x24",navmenu_24x24:"navmenu-24x24",removefile:"error-24x24",takepicture:"camera-32x32",takepicture_24x24:"camera-24x24",v2check:"check-16x16",checked:"check-16x16",v2check_24x24:"check-24x24","back-to-panel_16x16":"restoredown-16x16",clear_16x16:"clear-16x16",close_16x16:"close-16x16",collapsedetail:"collapsedetails-16x16",expanddetail:"expanddetails-16x16","full-screen_16x16":"maximize-16x16",loading:"loading-48x48",minimize_16x16:"minimize-16x16",next_16x16:"chevronright-16x16",previous_16x16:"chevronleft-16x16","no-image":"noimage-48x48","ranking-dash":"rankingundefined-16x16","drag-n-drop":"drag-24x24","ranking-arrows":"reorder-24x24",restore_16x16:"fullsize-16x16",reset:"restore-24x24",search:"search-24x24",average:"smiley-rate5-24x24",excellent:"smiley-rate9-24x24",good:"smiley-rate7-24x24",normal:"smiley-rate6-24x24","not-good":"smiley-rate4-24x24",perfect:"smiley-rate10-24x24",poor:"smiley-rate3-24x24",terrible:"smiley-rate1-24x24","very-good":"smiley-rate8-24x24","very-poor":"smiley-rate2-24x24",add_16x16:"add-16x16",add_24x24:"add-24x24",alert_24x24:"warning-24x24",apply:"apply-24x24","arrow-down":"arrowdown-24x24","arrow-left":"arrowleft-24x24","arrow-left_16x16":"arrowleft-16x16",arrowleft:"arrowleft-16x16","arrow-right":"arrowright-24x24","arrow-right_16x16":"arrowright-16x16",arrowright:"arrowright-16x16","arrow-up":"arrowup-24x24",boolean:"toolbox-boolean-24x24","change-question-type_16x16":"speechbubble-16x16",checkbox:"toolbox-checkbox-24x24","collapse-detail_16x16":"minusbox-16x16","collapse-panel":"collapse-pg-24x24",collapse_16x16:"collapse-16x16","color-picker":"dropper-16x16",comment:"toolbox-longtext-24x24",config:"wrench-24x24",copy:"copy-24x24",default:"toolbox-customquestion-24x24",delete_16x16:"delete-16x16",delete_24x24:"delete-24x24",delete:"delete-24x24","description-hide":"hidehint-16x16",description:"hint-16x16","device-desktop":"desktop-24x24","device-phone":"phone-24x24","device-rotate":"rotate-24x24","device-tablet":"tablet-24x24",download:"download-24x24","drag-area-indicator":"drag-24x24","drag-area-indicator_24x16":"draghorizontal-24x16",v2dragelement_16x16:"draghorizontal-24x16","drop-down-arrow":"chevrondown-24x24","drop-down-arrow_16x16":"chevrondown-16x16",chevron_16x16:"chevrondown-16x16",dropdown:"toolbox-dropdown-24x24",duplicate_16x16:"copy-16x16",edit:"edit-24x24",edit_16x16:"edit-16x16","editing-finish":"finishedit-24x24",error:"error-16x16","expand-detail_16x16":"plusbox-16x16","expand-panel":"expand-pg-24x24",expand_16x16:"expand-16x16",expression:"toolbox-expression-24x24","fast-entry":"textedit-24x24",fix:"fix-24x24",html:"toolbox-html-24x24",image:"toolbox-image-24x24",imagepicker:"toolbox-imagepicker-24x24",import:"import-24x24","invisible-items":"invisible-24x24",language:"language-24x24",load:"import-24x24","logic-collapse":"collapse-24x24","logic-expand":"expand-24x24",logo:"image-48x48",matrix:"toolbox-matrix-24x24",matrixdropdown:"toolbox-multimatrix-24x24",matrixdynamic:"toolbox-dynamicmatrix-24x24",multipletext:"toolbox-multipletext-24x24",panel:"toolbox-panel-24x24",paneldynamic:"toolbox-dynamicpanel-24x24",preview:"preview-24x24",radiogroup:"toolbox-radiogroup-24x24",ranking:"toolbox-ranking-24x24",rating:"toolbox-rating-24x24",redo:"redo-24x24",remove_16x16:"remove-16x16",required:"required-16x16",save:"save-24x24","select-page":"selectpage-24x24",settings:"settings-24x24",settings_16x16:"settings-16x16",signaturepad:"toolbox-signature-24x24","switch-active_16x16":"switchon-16x16","switch-inactive_16x16":"switchoff-16x16",tagbox:"toolbox-tagbox-24x24",text:"toolbox-singleline-24x24",theme:"theme-24x24",toolbox:"toolbox-24x24",undo:"undo-24x24",visible:"visible-24x24",wizard:"wand-24x24",searchclear:"clear-16x16","chevron-16x16":"chevrondown-16x16",chevron:"chevrondown-24x24",progressbuttonv2:"arrowleft-16x16",right:"chevronright-16x16","add-lg":"add-24x24",add:"add-24x24"};function e2(e){var t;let s;return t=e,((s=tp.customIcons[t])?e4(s):(t=e4(t),s=tp.customIcons[t])?s:null)||e4(e)}function e4(e){let t="icon-",s=e.replace(t,"");return t+(e1[s]||s)}function e3(e,t,s,i,n,a){if(!n)return;"auto"!==e&&(n.style.width=(e||t||16)+"px",n.style.height=(e||s||16)+"px");let o=n.childNodes[0],l=e2(i);o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+l);let h=n.getElementsByTagName("title")[0];if(a)h||(h=r.getDocument().createElementNS("http://www.w3.org/2000/svg","title"),n.appendChild(h));else{h&&n.removeChild(h);return}h.textContent=a}function e6(e){return"function"!=typeof e?e:e()}function e5(e){if("string"==typeof e){if(!isNaN(Number(e)))return Number(e);if(e.includes("px"))return parseFloat(e)}if("number"==typeof e)return e}function e9(e){if(void 0===e5(e))return e}let e8="sv-focused--by-key";function e7(e){let t=e.target;t&&t.classList&&t.classList.remove(e8)}function te(e,t){if(e.target&&"true"===e.target.contentEditable)return;let s=e.target;if(!s)return;let i=e.which||e.keyCode;if(9===i){s.classList&&!s.classList.contains(e8)&&s.classList.add(e8);return}if(t){if(!t.__keyDownReceived)return;t.__keyDownReceived=!1}13===i||32===i?s.click&&s.click():(!t||t.processEsc)&&27===i&&s.blur&&s.blur()}function tt(e,t={processEsc:!0}){if(t&&(t.__keyDownReceived=!0),e.target&&"true"===e.target.contentEditable)return;var s=e.which||e.keyCode;let i=[13,32];t.processEsc&&i.push(27),-1!==i.indexOf(s)&&e.preventDefault()}function ts(e,t){if(!e)return;t||(t=e=>r.getComputedStyle(e));let s=t(e);e.style.height="auto",e.scrollHeight&&(e.style.height=e.scrollHeight+parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth)+"px")}function ti(e){e.preventDefault(),e.stopPropagation()}function tr(e){return e?e.replace(/\s*?([\w-]+)\s*?/g,".$1"):e}function tn(e){return getComputedStyle?Number.parseFloat(getComputedStyle(e).width):e.offsetWidth}function ta(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}function to(e,t){if(t&&e&&"object"==typeof t)for(var s in e){var i=e[s];!Array.isArray(i)&&i&&"object"==typeof i?(t[s]&&"object"==typeof t[s]||(t[s]={}),to(i,t[s])):t[s]=i}}function tl(e,t){let s={};to(t.list,s),to(e.list,s),e.list=s}function th(e,t){i.isFileReaderAvailable()&&(e.value="",e.onchange=s=>{if(!i.isFileReaderAvailable()||!e||!e.files||e.files.length<1)return;let r=[];for(let t=0;t<e.files.length;t++)r.push(e.files[t]);t(r)},e.click())}function tu(e,t,s="--animation-"){var i;e.__sv_created_properties=null!==(i=e.__sv_created_properties)&&void 0!==i?i:[],Object.keys(t).forEach(i=>{let r=`${s}${i.split(/\.?(?=[A-Z])/).join("-").toLowerCase()}`;e.style.setProperty(r,t[i]),e.__sv_created_properties.push(r)})}function td(e){tu(e,function(e){if(r.isAvailable()){let{paddingTop:t,paddingBottom:s,borderTopWidth:i,borderBottomWidth:n,marginTop:a,marginBottom:o,boxSizing:l}=r.getComputedStyle(e),h=e.offsetHeight+"px";if("content-box"==l){let r=e.offsetHeight;[n,i,s,t].forEach(e=>{r-=parseFloat(e)}),h=r+"px"}return{paddingTop:t,paddingBottom:s,borderTopWidth:i,borderBottomWidth:n,marginTop:a,marginBottom:o,heightFrom:"0px",heightTo:h}}}(e))}function tc(e){Array.isArray(e.__sv_created_properties)&&(e.__sv_created_properties.forEach(t=>{e.style.removeProperty(t)}),delete e.__sv_created_properties)}let tg="undefined"!=typeof globalThis?globalThis.document:(void 0).document;var tp={version:"",designMode:{showEmptyDescriptions:!0,showEmptyTitles:!0},get allowShowEmptyDescriptionInDesignMode(){return this.designMode.showEmptyDescriptions},set allowShowEmptyDescriptionInDesignMode(val){this.designMode.showEmptyDescriptions=val},get allowShowEmptyTitleInDesignMode(){return this.designMode.showEmptyTitles},set allowShowEmptyTitleInDesignMode(val){this.designMode.showEmptyTitles=val},localization:{useLocalTimeZone:!0,storeDuplicatedTranslations:!1,defaultLocaleName:"default"},get useLocalTimeZone(){return this.localization.useLocalTimeZone},set useLocalTimeZone(val){this.localization.useLocalTimeZone=val},get storeDuplicatedTranslations(){return this.localization.storeDuplicatedTranslations},set storeDuplicatedTranslations(val){this.localization.storeDuplicatedTranslations=val},get defaultLocaleName(){return this.localization.defaultLocaleName},set defaultLocaleName(val){this.localization.defaultLocaleName=val},web:{onBeforeRequestChoices:(e,t)=>{},encodeUrlParams:!0,cacheLoadedChoices:!0,disableQuestionWhileLoadingChoices:!1},get webserviceEncodeParameters(){return this.web.encodeUrlParams},set webserviceEncodeParameters(val){this.web.encodeUrlParams=val},get useCachingForChoicesRestful(){return this.web.cacheLoadedChoices},set useCachingForChoicesRestful(val){this.web.cacheLoadedChoices=val},get useCachingForChoicesRestfull(){return this.web.cacheLoadedChoices},set useCachingForChoicesRestfull(val){this.web.cacheLoadedChoices=val},get disableOnGettingChoicesFromWeb(){return this.web.disableQuestionWhileLoadingChoices},set disableOnGettingChoicesFromWeb(val){this.web.disableQuestionWhileLoadingChoices=val},triggers:{changeNavigationButtonsOnComplete:!0,executeCompleteOnValueChanged:!1,executeSkipOnValueChanged:!0},get executeCompleteTriggerOnValueChanged(){return this.triggers.executeCompleteOnValueChanged},set executeCompleteTriggerOnValueChanged(val){this.triggers.executeCompleteOnValueChanged=val},get changeNavigationButtonsOnCompleteTrigger(){return this.triggers.changeNavigationButtonsOnComplete},set changeNavigationButtonsOnCompleteTrigger(val){this.triggers.changeNavigationButtonsOnComplete=val},get executeSkipTriggerOnValueChanged(){return this.triggers.executeSkipOnValueChanged},set executeSkipTriggerOnValueChanged(val){this.triggers.executeSkipOnValueChanged=val},serialization:{itemValueSerializeAsObject:!1,itemValueSerializeDisplayText:!1,localizableStringSerializeAsObject:!1,matrixDropdownColumnSerializeTitle:!1},get itemValueAlwaysSerializeAsObject(){return this.serialization.itemValueSerializeAsObject},set itemValueAlwaysSerializeAsObject(val){this.serialization.itemValueSerializeAsObject=val},get itemValueAlwaysSerializeText(){return this.serialization.itemValueSerializeDisplayText},set itemValueAlwaysSerializeText(val){this.serialization.itemValueSerializeDisplayText=val},get serializeLocalizableStringAsObject(){return this.serialization.localizableStringSerializeAsObject},set serializeLocalizableStringAsObject(val){this.serialization.localizableStringSerializeAsObject=val},lazyRender:{enabled:!1,firstBatchSize:3},get lazyRowsRendering(){return this.lazyRender.enabled},set lazyRowsRendering(val){this.lazyRender.enabled=val},get lazyRowsRenderingStartRow(){return this.lazyRender.firstBatchSize},set lazyRowsRenderingStartRow(val){this.lazyRender.firstBatchSize=val},matrix:{defaultCellType:"dropdown",defaultRowName:"default",totalsSuffix:"-total",maxRowCount:1e3,maxRowCountInCondition:1,renderRemoveAsIcon:!0,columnWidthsByType:{file:{minWidth:"240px"},comment:{minWidth:"200px"}},rateSize:"small"},get matrixDefaultRowName(){return this.matrix.defaultRowName},set matrixDefaultRowName(val){this.matrix.defaultRowName=val},get matrixDefaultCellType(){return this.matrix.defaultCellType},set matrixDefaultCellType(val){this.matrix.defaultCellType=val},get matrixTotalValuePostFix(){return this.matrix.totalsSuffix},set matrixTotalValuePostFix(val){this.matrix.totalsSuffix=val},get matrixMaximumRowCount(){return this.matrix.maxRowCount},set matrixMaximumRowCount(val){this.matrix.maxRowCount=val},get matrixMaxRowCountInCondition(){return this.matrix.maxRowCountInCondition},set matrixMaxRowCountInCondition(val){this.matrix.maxRowCountInCondition=val},get matrixRenderRemoveAsIcon(){return this.matrix.renderRemoveAsIcon},set matrixRenderRemoveAsIcon(val){this.matrix.renderRemoveAsIcon=val},panel:{maxPanelCount:100,maxPanelCountInCondition:1},get panelDynamicMaxPanelCountInCondition(){return this.panel.maxPanelCountInCondition},set panelDynamicMaxPanelCountInCondition(val){this.panel.maxPanelCountInCondition=val},get panelMaximumPanelCount(){return this.panel.maxPanelCount},set panelMaximumPanelCount(val){this.panel.maxPanelCount=val},readOnly:{enableValidation:!1,commentRenderMode:"textarea",textRenderMode:"input"},get readOnlyCommentRenderMode(){return this.readOnly.commentRenderMode},set readOnlyCommentRenderMode(val){this.readOnly.commentRenderMode=val},get readOnlyTextRenderMode(){return this.readOnly.textRenderMode},set readOnlyTextRenderMode(val){this.readOnly.textRenderMode=val},numbering:{includeQuestionsWithHiddenNumber:!1,includeQuestionsWithHiddenTitle:!1},get setQuestionVisibleIndexForHiddenTitle(){return this.numbering.includeQuestionsWithHiddenTitle},set setQuestionVisibleIndexForHiddenTitle(val){this.numbering.includeQuestionsWithHiddenTitle=val},get setQuestionVisibleIndexForHiddenNumber(){return this.numbering.includeQuestionsWithHiddenNumber},set setQuestionVisibleIndexForHiddenNumber(val){this.numbering.includeQuestionsWithHiddenNumber=val},enterKeyAction:"default",comparator:{trimStrings:!0,caseSensitive:!1,normalizeTextCallback:(e,t)=>e},expressionDisableConversionChar:"#",get commentPrefix(){return tp.commentSuffix},set commentPrefix(val){tp.commentSuffix=val},commentSuffix:"-Comment",itemValueSeparator:"|",ratingMaximumRateValueCount:20,tagboxCloseOnSelect:!1,dropdownSearchDelay:500,confirmActionFunc:function(e){return confirm(e)},confirmActionAsync:function(e,t,s){return function(e,t,s={}){let i=new ej(void 0),r=tp.showDialog({componentName:"sv-string-viewer",data:{locStr:i,locString:i,model:i},onApply:()=>(t(!0),!0),onCancel:()=>(t(!1),!1),title:e||s.message,displayMode:"popup",isFocusedContent:!1,cssClass:s.cssClass||"sv-popup--confirm"},s.rootElement),n=r.footerToolbar,a=n.getActionById("apply"),o=n.getActionById("cancel");return o.title=u("cancel",s.locale),o.innerCss="sv-popup__body-footer-item sv-popup__button sd-btn sd-btn--small",a.title=s.applyTitle||u("ok",s.locale),a.innerCss="sv-popup__body-footer-item sv-popup__button sv-popup__button--danger sd-btn sd-btn--small sd-btn--danger",r.width="min-content",!0}(e,t,s)},minWidth:"300px",maxWidth:"100%",maxConditionRunCountOnValueChanged:10,notifications:{lifetime:2e3},autoAdvanceDelay:300,itemFlowDirection:"column",get showItemsInOrder(){return tp.itemFlowDirection},set showItemsInOrder(val){tp.itemFlowDirection=val},noneItemValue:"none",refuseItemValue:"refused",dontKnowItemValue:"dontknow",specialChoicesOrder:{selectAllItem:[-1],noneItem:[1],refuseItem:[2],dontKnowItem:[3],otherItem:[4]},choicesSeparator:", ",supportedValidators:{question:["expression"],comment:["text","regex"],text:["numeric","text","regex","email"],checkbox:["answercount"],imagepicker:["answercount"]},minDate:"",maxDate:"",showDialog:void 0,showDefaultItemsInCreator:!0,customIcons:{},rankingDragHandleArea:"entireItem",environment:tg?{root:tg,_rootElement:r.getBody(),get rootElement(){var tm;return null!==(tm=this._rootElement)&&void 0!==tm?tm:r.getBody()},set rootElement(rootElement){this._rootElement=rootElement},_popupMountContainer:r.getBody(),get popupMountContainer(){var tv;return null!==(tv=this._popupMountContainer)&&void 0!==tv?tv:r.getBody()},set popupMountContainer(popupMountContainer){this._popupMountContainer=popupMountContainer},svgMountContainer:tg.head,stylesSheetsMountContainer:tg.head}:void 0,showMaxLengthIndicator:!0,animationEnabled:!0,titleTags:{survey:"h3",page:"h4",panel:"h4",question:"h5"},questions:{inputTypes:["color","date","datetime-local","email","month","number","password","range","tel","text","time","url","week"],dataList:["","name","honorific-prefix","given-name","additional-name","family-name","honorific-suffix","nickname","organization-title","username","new-password","current-password","organization","street-address","address-line1","address-line2","address-line3","address-level4","address-level3","address-level2","address-level1","country","country-name","postal-code","cc-name","cc-given-name","cc-additional-name","cc-family-name","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc","cc-type","transaction-currency","transaction-amount","language","bday","bday-day","bday-month","bday-year","sex","url","photo","tel","tel-country-code","tel-national","tel-area-code","tel-local","tel-local-prefix","tel-local-suffix","tel-extension","email","impp"]},legacyProgressBarView:!1,maskSettings:{patternPlaceholderChar:"_",patternEscapeChar:"\\",patternDefinitions:{9:/[0-9]/,a:/[a-zA-Z]/,"#":/[a-zA-Z0-9]/}},storeUtcDates:!1,onDateCreated:(e,t,s)=>e,parseNumber:(e,t)=>t};class ty{constructor(e=null,t=null){this.text=e,this.errorOwner=t,this.visible=!0,this.onUpdateErrorTextCallback=void 0}equals(e){return!!e&&!!e.getErrorType&&this.getErrorType()===e.getErrorType()&&this.text===e.text&&this.visible===e.visible}get locText(){return this.locTextValue||(this.locTextValue=new ej(this.errorOwner,!0),this.locTextValue.storeDefaultText=!0,this.locTextValue.text=this.getText()),this.locTextValue}getText(){var e=this.text;return e||(e=this.getDefaultText()),this.errorOwner&&(e=this.errorOwner.getErrorCustomText(e,this)),e}getErrorType(){return"base"}getDefaultText(){return""}getLocale(){return this.errorOwner?this.errorOwner.getLocale():""}getLocalizationString(e){return u(e,this.getLocale())}updateText(){this.onUpdateErrorTextCallback&&this.onUpdateErrorTextCallback(this),this.locText.text=this.getText()}}class tC extends ty{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"required"}getDefaultText(){return this.getLocalizationString("requiredError")}}class tf extends ty{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"requireoneanswer"}getDefaultText(){return this.getLocalizationString("requiredErrorInPanel")}}class tb extends ty{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"requirenumeric"}getDefaultText(){return this.getLocalizationString("numericError")}}class tV extends ty{constructor(e,t=null){super(null,t),this.maxSize=e,this.locText.text=this.getText()}getErrorType(){return"exceedsize"}getDefaultText(){return this.getLocalizationString("exceedMaxSize").format(this.getTextSize())}getTextSize(){if(0===this.maxSize)return"0 Byte";var e=Math.floor(Math.log(this.maxSize)/Math.log(1024));return(this.maxSize/Math.pow(1024,e)).toFixed([0,0,2,3,3][e])+" "+["Bytes","KB","MB","GB","TB"][e]}}class tw extends ty{constructor(e,t,s=null){super(null,s),this.status=e,this.response=t}getErrorType(){return"webrequest"}getDefaultText(){let e=this.getLocalizationString("urlRequestError");return e?e.format(this.status,this.response):""}}class tx extends ty{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"webrequestempty"}getDefaultText(){return this.getLocalizationString("urlGetChoicesError")}}class tP extends ty{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"otherempty"}getDefaultText(){return this.getLocalizationString("otherRequiredError")}}class tT extends ty{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"uploadingfile"}getDefaultText(){return this.getLocalizationString("uploadingFile")}}class tS extends ty{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"requiredinallrowserror"}getDefaultText(){return this.getLocalizationString("requiredInAllRowsError")}}class tI extends ty{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"eachrowuniqueeerror"}getDefaultText(){return this.getLocalizationString("eachRowUniqueError")}}class tE extends ty{constructor(e,t=null){super(null,t),this.minRowCount=e}getErrorType(){return"minrowcounterror"}getDefaultText(){return this.getLocalizationString("minRowCountError").format(this.minRowCount)}}class tR extends ty{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"keyduplicationerror"}getDefaultText(){return this.getLocalizationString("keyDuplicationError")}}class tA extends ty{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"custom"}}class tD{constructor(e,t=null){this.value=e,this.error=t}}class tO extends eg{constructor(){super(),this.createLocalizableString("text",this,!0)}get isValidator(){return!0}getSurvey(e=!1){return this.errorOwner&&this.errorOwner.getSurvey?this.errorOwner.getSurvey():null}get text(){return this.getLocalizableStringText("text")}set text(e){this.setLocalizableStringText("text",e)}get isValidateAllValues(){return!1}get locText(){return this.getLocalizableString("text")}getErrorText(e){return this.text?this.text:this.getDefaultErrorText(e)}getDefaultErrorText(e){return""}validate(e,t=null,s=null,i=null){return null}get isRunning(){return!1}get isAsync(){return!1}getLocale(){return this.errorOwner?this.errorOwner.getLocale():""}getMarkdownHtml(e,t){return this.errorOwner?this.errorOwner.getMarkdownHtml(e,t):void 0}getRenderer(e){return this.errorOwner?this.errorOwner.getRenderer(e):null}getRendererContext(e){return this.errorOwner?this.errorOwner.getRendererContext(e):e}getProcessedText(e){return this.errorOwner?this.errorOwner.getProcessedText(e):e}createCustomError(e){let t=new tA(this.getErrorText(e),this.errorOwner);return t.onUpdateErrorTextCallback=t=>t.text=this.getErrorText(e),t}toString(){var e=this.getType().replace("validator","");return this.text&&(e+=", "+this.text),e}}class tL{run(e){var t=[],s=null,i=null;this.prepareAsyncValidators();for(var r=[],n=e.getValidators(),a=0;a<n.length;a++){var o=n[a];!s&&o.isValidateAllValues&&(s=e.getDataFilteredValues(),i=e.getDataFilteredProperties()),o.isAsync&&(this.asyncValidators.push(o),o.onAsyncCompleted=e=>{if(e&&e.error&&r.push(e.error),this.onAsyncCompleted){for(var t=0;t<this.asyncValidators.length;t++)if(this.asyncValidators[t].isRunning)return;this.onAsyncCompleted(r)}})}n=e.getValidators();for(var a=0;a<n.length;a++){var o=n[a],l=o.validate(e.validatedValue,e.getValidatorTitle(),s,i);l&&l.error&&t.push(l.error)}return 0==this.asyncValidators.length&&this.onAsyncCompleted&&this.onAsyncCompleted([]),t}prepareAsyncValidators(){if(this.asyncValidators)for(var e=0;e<this.asyncValidators.length;e++)this.asyncValidators[e].onAsyncCompleted=null;this.asyncValidators=[]}}class tN extends tO{constructor(e=null,t=null){super(),this.minValue=e,this.maxValue=t}getType(){return"numericvalidator"}validate(e,t=null,s=null,i=null){if(this.isValueEmpty(e))return null;if(!a.isNumber(e))return new tD(null,new tb(this.text,this.errorOwner));var r=new tD(a.getNumber(e));return null!==this.minValue&&this.minValue>r.value||null!==this.maxValue&&this.maxValue<r.value?(r.error=this.createCustomError(t),r):"number"==typeof e?null:r}getDefaultErrorText(e){var t=e||this.getLocalizationString("value");return null!==this.minValue&&null!==this.maxValue?this.getLocalizationFormatString("numericMinMax",t,this.minValue,this.maxValue):null!==this.minValue?this.getLocalizationFormatString("numericMin",t,this.minValue):this.getLocalizationFormatString("numericMax",t,this.maxValue)}get minValue(){return this.getPropertyValue("minValue")}set minValue(e){this.setPropertyValue("minValue",e)}get maxValue(){return this.getPropertyValue("maxValue")}set maxValue(e){this.setPropertyValue("maxValue",e)}}class tk extends tO{constructor(){super()}getType(){return"textvalidator"}validate(e,t=null,s=null,i=null){return this.isValueEmpty(e)?null:!this.allowDigits&&/\d+$/.test(e)?new tD(null,this.createCustomError("textNoDigitsAllow")):this.minLength>0&&e.length<this.minLength||this.maxLength>0&&e.length>this.maxLength?new tD(null,this.createCustomError(t)):null}getDefaultErrorText(e){return"textNoDigitsAllow"===e?this.getLocalizationString(e):this.minLength>0&&this.maxLength>0?this.getLocalizationFormatString("textMinMaxLength",this.minLength,this.maxLength):this.minLength>0?this.getLocalizationFormatString("textMinLength",this.minLength):this.getLocalizationFormatString("textMaxLength",this.maxLength)}get minLength(){return this.getPropertyValue("minLength")}set minLength(e){this.setPropertyValue("minLength",e)}get maxLength(){return this.getPropertyValue("maxLength")}set maxLength(e){this.setPropertyValue("maxLength",e)}get allowDigits(){return this.getPropertyValue("allowDigits")}set allowDigits(e){this.setPropertyValue("allowDigits",e)}}class tF extends tO{constructor(e=null,t=null){super(),this.minCount=e,this.maxCount=t}getType(){return"answercountvalidator"}validate(e,t=null,s=null,i=null){if(null==e||e.constructor!=Array)return null;var r=e.length;return 0==r?null:this.minCount&&r<this.minCount?new tD(null,this.createCustomError(this.getLocalizationFormatString("minSelectError",this.minCount))):this.maxCount&&r>this.maxCount?new tD(null,this.createCustomError(this.getLocalizationFormatString("maxSelectError",this.maxCount))):null}getDefaultErrorText(e){return e}get minCount(){return this.getPropertyValue("minCount")}set minCount(e){this.setPropertyValue("minCount",e)}get maxCount(){return this.getPropertyValue("maxCount")}set maxCount(e){this.setPropertyValue("maxCount",e)}}class tM extends tO{constructor(e=null){super(),this.regex=e}getType(){return"regexvalidator"}validate(e,t=null,s=null,i=null){if(!this.regex||this.isValueEmpty(e))return null;var r=this.createRegExp();if(Array.isArray(e))for(var n=0;n<e.length;n++){var a=this.hasError(r,e[n],t);if(a)return a}return this.hasError(r,e,t)}hasError(e,t,s){return e.test(t)?null:new tD(t,this.createCustomError(s))}get regex(){return this.getPropertyValue("regex")}set regex(e){this.setPropertyValue("regex",e)}get caseInsensitive(){return this.getPropertyValue("caseInsensitive")}set caseInsensitive(e){this.setPropertyValue("caseInsensitive",e)}get insensitive(){return this.caseInsensitive}set insensitive(e){this.caseInsensitive=e}createRegExp(){return new RegExp(this.regex,this.caseInsensitive?"i":"")}}class t_ extends tO{constructor(){super(),this.re=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()=[\]\.,;:\s@\"]+\.)+[^<>()=[\]\.,;:\s@\"]{2,})$/i}getType(){return"emailvalidator"}validate(e,t=null,s=null,i=null){return!e||this.re.test(e)?null:new tD(e,this.createCustomError(t))}getDefaultErrorText(e){return this.getLocalizationString("invalidEmail")}}class tq extends tO{constructor(e=null){super(),this.conditionRunner=null,this.isRunningValue=!1,this.expression=e}getType(){return"expressionvalidator"}get isValidateAllValues(){return!0}get isAsync(){return!!this.ensureConditionRunner(!1)&&this.conditionRunner.isAsync}get isRunning(){return this.isRunningValue}validate(e,t=null,s=null,i=null){if(!this.expression)return null;this.conditionRunner&&(this.conditionRunner.onRunComplete=null),this.ensureConditionRunner(!0),this.conditionRunner.onRunComplete=s=>{this.isRunningValue=!1,this.onAsyncCompleted&&this.onAsyncCompleted(this.generateError(s,e,t))},this.isRunningValue=!0;var r=this.conditionRunner.run(s,i);return this.conditionRunner.isAsync?null:(this.isRunningValue=!1,this.generateError(r,e,t))}generateError(e,t,s){return e?null:new tD(t,this.createCustomError(s))}getDefaultErrorText(e){return this.getLocalizationFormatString("invalidExpression",this.expression)}ensureConditionRunner(e){return!!this.expression&&(e||!this.conditionRunner?this.conditionRunner=new el(this.expression):this.conditionRunner.expression=this.expression,!0)}get expression(){return this.getPropertyValue("expression")}set expression(e){this.setPropertyValue("expression",e)}}E.addClass("surveyvalidator",[{name:"text",serializationProperty:"locText"}]),E.addClass("numericvalidator",["minValue:number","maxValue:number"],function(){return new tN},"surveyvalidator"),E.addClass("textvalidator",[{name:"minLength:number",default:0},{name:"maxLength:number",default:0},{name:"allowDigits:boolean",default:!0}],function(){return new tk},"surveyvalidator"),E.addClass("answercountvalidator",["minCount:number","maxCount:number"],function(){return new tF},"surveyvalidator"),E.addClass("regexvalidator",["regex",{name:"caseInsensitive:boolean",alternativeName:"insensitive"}],function(){return new tM},"surveyvalidator"),E.addClass("emailvalidator",[],function(){return new t_},"surveyvalidator"),E.addClass("expressionvalidator",["expression:condition"],function(){return new tq},"surveyvalidator");class tB{constructor(e,t){this.name=e,this.widgetJson=t,this.htmlTemplate=t.htmlTemplate?t.htmlTemplate:""}afterRender(e,t){this.widgetJson.afterRender&&(e.localeChangedCallback=()=>{this.widgetJson.willUnmount&&this.widgetJson.willUnmount(e,t),this.widgetJson.afterRender(e,t)},this.widgetJson.afterRender(e,t))}willUnmount(e,t){this.widgetJson.willUnmount&&this.widgetJson.willUnmount(e,t)}getDisplayValue(e,t){return this.widgetJson.getDisplayValue?this.widgetJson.getDisplayValue(e,t):null}validate(e){if(this.widgetJson.validate)return this.widgetJson.validate(e)}isFit(e){return!!this.isLibraryLoaded()&&!!this.widgetJson.isFit&&this.widgetJson.isFit(e)}get canShowInToolbox(){return!1!==this.widgetJson.showInToolbox&&"customtype"==tQ.Instance.getActivatedBy(this.name)&&(!this.widgetJson.widgetIsLoaded||this.widgetJson.widgetIsLoaded())}get showInToolbox(){return!1!==this.widgetJson.showInToolbox}set showInToolbox(e){this.widgetJson.showInToolbox=e}init(){this.widgetJson.init&&this.widgetJson.init()}activatedByChanged(e){this.isLibraryLoaded()&&this.widgetJson.activatedByChanged&&this.widgetJson.activatedByChanged(e)}isLibraryLoaded(){return!this.widgetJson.widgetIsLoaded||!0==this.widgetJson.widgetIsLoaded()}get isDefaultRender(){return this.widgetJson.isDefaultRender}get pdfQuestionType(){return this.widgetJson.pdfQuestionType}get pdfRender(){return this.widgetJson.pdfRender}}class tQ{constructor(){this.widgetsValues=[],this.widgetsActivatedBy={},this.onCustomWidgetAdded=new em}get widgets(){return this.widgetsValues}add(e,t="property"){this.addCustomWidget(e,t)}addCustomWidget(e,t="property"){var s=e.name;s||(s="widget_"+this.widgets.length+"1");var i=new tB(s,e);return this.widgetsValues.push(i),i.init(),this.widgetsActivatedBy[s]=t,i.activatedByChanged(t),this.onCustomWidgetAdded.fire(i,null),i}getActivatedBy(e){return this.widgetsActivatedBy[e]||"property"}setActivatedBy(e,t){if(e&&t){var s=this.getCustomWidgetByName(e);s&&(this.widgetsActivatedBy[e]=t,s.activatedByChanged(t))}}clear(){this.widgetsValues=[]}getCustomWidgetByName(e){for(var t=0;t<this.widgets.length;t++)if(this.widgets[t].name==e)return this.widgets[t];return null}getCustomWidget(e){for(var t=0;t<this.widgetsValues.length;t++)if(this.widgetsValues[t].isFit(e))return this.widgetsValues[t];return null}}tQ.Instance=new tQ;class tz{constructor(){this.renderersHash={},this.defaultHash={}}unregisterRenderer(e,t){delete this.renderersHash[e][t],this.defaultHash[e]===t&&delete this.defaultHash[e]}registerRenderer(e,t,s,i=!1){this.renderersHash[e]||(this.renderersHash[e]={}),this.renderersHash[e][t]=s,i&&(this.defaultHash[e]=t)}getRenderer(e,t){let s=this.renderersHash[e];if(s){if(t&&s[t])return s[t];let i=this.defaultHash[e];if(i&&s[i])return s[i]}return"default"}getRendererByQuestion(e){return this.getRenderer(e.getType(),e.renderAs)}clear(){this.renderersHash={}}}tz.Instance=new tz;class tH{updateElement(){this.element&&this.autoGrow&&setTimeout(()=>ts(this.element),1)}constructor(e){this.options=e,this.onPropertyChangedCallback=()=>{this.element&&(this.element.value=this.getTextValue(),this.updateElement())},this.question.registerFunctionOnPropertyValueChanged(this.options.propertyName,this.onPropertyChangedCallback,"__textarea")}setElement(e){e&&(this.element=e,this.updateElement())}resetElement(){this.element=void 0}getTextValue(){return this.options.getTextValue&&this.options.getTextValue()||""}onTextAreaChange(e){this.options.onTextAreaChange&&this.options.onTextAreaChange(e)}onTextAreaInput(e){this.options.onTextAreaInput&&this.options.onTextAreaInput(e),this.element&&this.autoGrow&&ts(this.element)}onTextAreaKeyDown(e){this.options.onTextAreaKeyDown&&this.options.onTextAreaKeyDown(e)}onTextAreaBlur(e){this.onTextAreaChange(e),this.options.onTextAreaBlur&&this.options.onTextAreaBlur(e)}onTextAreaFocus(e){this.options.onTextAreaFocus&&this.options.onTextAreaFocus(e)}get question(){return this.options.question}get id(){return this.options.id()}get placeholder(){return this.options.placeholder()}get className(){return this.options.className()}get maxLength(){if(this.options.maxLength)return this.options.maxLength()}get autoGrow(){if(this.options.autoGrow)return this.options.autoGrow()}get rows(){if(this.options.rows)return this.options.rows()}get cols(){if(this.options.cols)return this.options.cols()}get isDisabledAttr(){return this.options.isDisabledAttr()}get isReadOnlyAttr(){if(this.options.isReadOnlyAttr)return this.options.isReadOnlyAttr()}get ariaRequired(){if(this.options.ariaRequired)return this.options.ariaRequired()}get ariaLabel(){if(this.options.ariaLabel)return this.options.ariaLabel()}get ariaInvalid(){if(this.options.ariaInvalid)return this.options.ariaInvalid()}get ariaLabelledBy(){if(this.options.ariaLabelledBy)return this.options.ariaLabelledBy()}get ariaDescribedBy(){if(this.options.ariaDescribedBy)return this.options.ariaDescribedBy()}get ariaErrormessage(){if(this.options.ariaErrormessage)return this.options.ariaErrormessage()}dispose(){this.question&&this.question.unRegisterFunctionOnPropertyValueChanged(this.options.propertyName,"__textarea"),this.resetElement()}}class tW{constructor(e,t,s){this.name=e,this.canRun=t,this.doComplete=s,this.getSecondRunner=()=>void 0}}class tU extends eW{static getQuestionId(){return"sq_"+tU.questionCounter++}isReadOnlyRenderDiv(){return this.isReadOnly&&"div"===tp.readOnly.commentRenderMode}allowMobileInDesignMode(){return!1}updateIsMobileFromSurvey(){this.setIsMobile(this.survey._isMobile)}setIsMobile(e){let t=e&&(this.allowMobileInDesignMode()||!this.isDesignMode);this.isMobile=t}getIsMobile(){return this._isMobile}get isMobile(){return this.getIsMobile()}set isMobile(e){this._isMobile=e}themeChanged(e){}get _isMobile(){return this.getPropertyValue("_isMobile",!1)}set _isMobile(e){this.setPropertyValue("_isMobile",e)}get forceIsInputReadOnly(){return this.getPropertyValue("forceIsInputReadOnly")}set forceIsInputReadOnly(e){this.setPropertyValue("forceIsInputReadOnly",e)}get ariaExpanded(){return this.getPropertyValue("ariaExpanded")}set ariaExpanded(e){this.setPropertyValue("ariaExpanded",e)}constructor(e){super(e),this.customWidgetData={isNeedRender:!0},this.hasCssErrorCallback=()=>!1,this.isReadyValue=!0,this.dependedQuestions=[],this.onReadyChanged=this.addEvent(),this.triggersInfo=[],this.isRunningValidatorsValue=!1,this.isValueChangedInSurvey=!1,this.allowNotifyValueChanged=!0,this.setPropertyValueDirectly("id",tU.getQuestionId()),this.onCreating(),this.createNewArray("validators",e=>{e.errorOwner=this}),this.addExpressionProperty("visibleIf",(e,t)=>{this.visible=!0===t}),this.addExpressionProperty("enableIf",(e,t)=>{this.readOnly=!1===t}),this.addExpressionProperty("requiredIf",(e,t)=>{this.isRequired=!0===t}),this.createLocalizableString("commentText",this,!0,"otherItemText"),this.createLocalizableString("requiredErrorText",this),this.createLocalizableString("commentPlaceholder",this),this.createLocalizableString("defaultDisplayValue",this),this.addTriggerInfo("resetValueIf",()=>!this.isEmpty(),()=>{this.startSetValueOnExpression(),this.clearValue(),this.updateValueWithDefaults(),this.finishSetValueOnExpression()}),this.addTriggerInfo("setValueIf",()=>!0,()=>this.runSetValueExpression()).getSecondRunner=()=>this.getSetValueExpressionRunner(),this.registerPropertyChangedHandlers(["width"],()=>{this.updateQuestionCss(),this.parent&&this.parent.elementWidthChanged(this)}),this.registerPropertyChangedHandlers(["isRequired"],()=>{!this.isRequired&&this.errors.length>0&&this.validate(),this.locTitle.strChanged(),this.clearCssClasses()}),this.registerPropertyChangedHandlers(["indent","rightIndent"],()=>{this.resetIndents()}),this.registerPropertyChangedHandlers(["showCommentArea","showOtherItem"],()=>{this.initCommentFromSurvey()}),this.registerPropertyChangedHandlers(["commentPlaceholder"],()=>{this.resetRenderedCommentPlaceholder()}),this.registerFunctionOnPropertiesValueChanged(["no","readOnly","hasVisibleErrors","containsErrors"],()=>{this.updateQuestionCss()}),this.registerPropertyChangedHandlers(["_isMobile"],()=>{this.onMobileChanged()}),this.registerPropertyChangedHandlers(["colSpan"],()=>{var e;null===(e=this.parent)||void 0===e||e.updateColumns()})}getDefaultTitle(){return this.name}createLocTitleProperty(){let e=super.createLocTitleProperty();return e.storeDefaultText=!0,e.onGetTextCallback=(e,t)=>(e||t||(e=this.getDefaultTitle()),this.survey)?this.survey.getUpdatedQuestionTitle(this,e):e,this.locProcessedTitle=new ej(this,!0),this.locProcessedTitle.sharedData=e,e}get commentTextAreaModel(){return this.commentTextAreaModelValue||(this.commentTextAreaModelValue=new tH(this.getCommentTextAreaOptions())),this.commentTextAreaModelValue}getCommentTextAreaOptions(){return{question:this,id:()=>this.commentId,propertyName:"comment",className:()=>this.cssClasses.comment,placeholder:()=>this.renderedCommentPlaceholder,isDisabledAttr:()=>this.isInputReadOnly||!1,rows:()=>this.commentAreaRows,autoGrow:()=>this.autoGrowComment,maxLength:()=>this.getOthersMaxLength(),ariaRequired:()=>this.a11y_input_ariaRequired,ariaLabel:()=>this.a11y_input_ariaLabel,getTextValue:()=>this.comment,onTextAreaChange:e=>{this.onCommentChange(e)},onTextAreaInput:e=>{this.onCommentInput(e)}}}getSurvey(e=!1){return e?this.parent?this.parent.getSurvey(e):null:this.onGetSurvey?this.onGetSurvey():super.getSurvey()}getValueName(){return this.valueName?this.valueName.toString():this.name}get valueName(){return this.getPropertyValue("valueName","")}set valueName(e){var t=this.getValueName();this.setPropertyValue("valueName",e),this.onValueNameChanged(t)}onValueNameChanged(e){this.survey&&(this.survey.questionRenamed(this,this.name,e||this.name),this.initDataFromSurvey())}onNameChanged(e){this.locTitle.strChanged(),this.survey&&this.survey.questionRenamed(this,e,this.valueName?this.valueName:e)}get isReady(){return this.isReadyValue}onAsyncRunningChanged(){this.updateIsReady()}updateIsReady(){let e=this.getIsQuestionReady();if(e){let t=this.getIsReadyDependsOn();for(let s=0;s<t.length;s++)if(!t[s].getIsQuestionReady()){e=!1;break}}this.setIsReady(e)}getIsQuestionReady(){return!this.isAsyncExpressionRunning&&this.getAreNestedQuestionsReady()}getAreNestedQuestionsReady(){let e=this.getIsReadyNestedQuestions();if(!Array.isArray(e))return!0;for(let t=0;t<e.length;t++)if(!e[t].isReady)return!1;return!0}getIsReadyNestedQuestions(){return this.getNestedQuestions()}setIsReady(e){let t=this.isReadyValue;this.isReadyValue=e,t!=e&&(this.getIsReadyDependends().forEach(e=>e.updateIsReady()),this.onReadyChanged.fire(this,{question:this,isReady:e,oldIsReady:t}))}getIsReadyDependsOn(){return this.getIsReadyDependendCore(!0)}getIsReadyDependends(){return this.getIsReadyDependendCore(!1)}getIsReadyDependendCore(e){if(!this.survey)return[];let t=this.survey.questionsByValueName(this.getValueName()),s=[];return t.forEach(e=>{e!==this&&s.push(e)}),!e&&(this.parentQuestion&&s.push(this.parentQuestion),this.dependedQuestions.length>0&&this.dependedQuestions.forEach(e=>s.push(e))),s}choicesLoaded(){}get page(){return this.parentQuestion?this.parentQuestion.page:this.getPage(this.parent)}set page(e){this.setPage(this.parent,e)}getPanel(){return null}delete(e=!0){this.removeFromParent(),e?this.dispose():this.resetDependedQuestions()}removeFromParent(){this.parent&&this.removeSelfFromList(this.parent.elements)}addDependedQuestion(e){!e||this.dependedQuestions.indexOf(e)>-1||this.dependedQuestions.push(e)}removeDependedQuestion(e){if(e){var t=this.dependedQuestions.indexOf(e);t>-1&&this.dependedQuestions.splice(t,1)}}updateDependedQuestions(){for(var e=0;e<this.dependedQuestions.length;e++)this.dependedQuestions[e].updateDependedQuestion()}updateDependedQuestion(){}resetDependedQuestion(){}get isFlowLayout(){return"flow"===this.getLayoutType()}getLayoutType(){return this.parent?this.parent.getChildrenLayoutType():"row"}isLayoutTypeSupported(e){return"flow"!==e}get visible(){return this.getPropertyValue("visible",!0)}set visible(e){e!=this.visible&&(this.setPropertyValue("visible",e),this.onVisibleChanged(),this.notifySurveyVisibilityChanged())}onVisibleChanged(){this.updateIsVisibleProp(),!this.isVisible&&this.errors&&this.errors.length>0&&(this.errors=[])}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed&&this.onHidingContent()}updateElementVisibility(){this.updateIsVisibleProp()}updateIsVisibleProp(){let e=this.getPropertyValue("isVisible"),t=this.isVisible;e===t||(this.setPropertyValue("isVisible",t),t||this.onHidingContent()),t!==this.visible&&this.areInvisibleElementsShowing&&this.updateQuestionCss(!0)}get useDisplayValuesInDynamicTexts(){return this.getPropertyValue("useDisplayValuesInDynamicTexts")}set useDisplayValuesInDynamicTexts(e){this.setPropertyValue("useDisplayValuesInDynamicTexts",e)}getUseDisplayValuesInDynamicTexts(){return this.useDisplayValuesInDynamicTexts}get visibleIf(){return this.getPropertyValue("visibleIf","")}set visibleIf(e){this.setPropertyValue("visibleIf",e)}get isVisible(){return!(this.survey&&this.survey.areEmptyElementsHidden&&this.isEmpty())&&(!!this.areInvisibleElementsShowing||this.isVisibleCore())}get isVisibleInSurvey(){return this.isVisible&&this.isParentVisible}isVisibleCore(){return this.visible}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}onHidingContent(){}get showNumber(){return this.getPropertyValue("showNumber")}set showNumber(e){this.setPropertyValue("showNumber",e),this.notifySurveyVisibilityChanged()}get hideNumber(){return!this.showNumber}set hideNumber(e){this.showNumber=!e}get isAllowTitleLeft(){return!0}getType(){return"question"}get isQuestion(){return!0}moveTo(e,t=null){return this.moveToBase(this.parent,e,t)}getProgressInfo(){return this.hasInput?{questionCount:1,answeredQuestionCount:+!this.isEmpty(),requiredQuestionCount:+!!this.isRequired,requiredAnsweredQuestionCount:!this.isEmpty()&&this.isRequired?1:0}:super.getProgressInfo()}ensureSetValueExpressionRunner(){this.setValueExpressionRunner?this.setValueExpressionRunner.expression=this.setValueExpression:(this.setValueExpressionRunner=new eh(this.setValueExpression),this.setValueExpressionRunner.onRunComplete=e=>{this.runExpressionSetValue(e)})}runSetValueExpression(){this.setValueExpression?(this.ensureSetValueExpressionRunner(),this.setValueExpressionRunner.run(this.getDataFilteredValues(),this.getDataFilteredProperties())):this.clearValue()}getSetValueExpressionRunner(){return this.ensureSetValueExpressionRunner(),this.setValueExpressionRunner}addTriggerInfo(e,t,s){let i=new tW(e,t,s);return this.triggersInfo.push(i),i}runTriggerInfo(e,t){let s=this[e.name];(s||e.getSecondRunner())&&!e.isRunning&&e.canRun()&&(e.runner?e.runner.expression=s:(e.runner=new eh(s),e.runner.onRunComplete=t=>{!0===t&&e.doComplete(),e.isRunning=!1}),this.canExecuteTriggerByKeys(t,e.runner,e.getSecondRunner())&&(e.isRunning=!0,!s&&e.getSecondRunner()?(e.doComplete(),e.isRunning=!1):e.runner.run(this.getDataFilteredValues(),this.getDataFilteredProperties())))}canExecuteTriggerByKeys(e,t,s){!t&&s&&(t=s,s=void 0);let i=this.canExecuteTriggerByKeysCore(e,t);return"var"===i||(s?""!==this.canExecuteTriggerByKeysCore(e,s):"func"===i)}canExecuteTriggerByKeysCore(e,t){let s=t.getVariables();return(!s||0===s.length)&&t.hasFunction()?"func":new A().isAnyKeyChanged(e,s)?"var":""}runTriggers(e,t,s){this.isSettingQuestionValue||this.parentQuestion&&this.parentQuestion.getValueName()===e||(s||((s={})[e]=t),this.triggersInfo.forEach(e=>{this.runTriggerInfo(e,s)}))}runConditions(){this.data&&!this.isLoadingFromJson&&(this.isDesignMode||this.runCondition(this.getDataFilteredValues(),this.getDataFilteredProperties()),this.locStrsChanged())}setSurveyImpl(e,t){super.setSurveyImpl(e),this.survey&&(this.survey.questionCreated(this),!0!==t&&this.runConditions(),this.visible||this.updateIsVisibleProp(),this.updateIsMobileFromSurvey())}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.parent!==e&&(this.removeFromParent(),this.setPropertyValue("parent",e),e&&this.updateQuestionCss(),this.onParentChanged())}onParentChanged(){}get hasTitle(){return"hidden"!==this.getTitleLocation()}get titleLocation(){return this.getPropertyValue("titleLocation")}set titleLocation(e){var t="hidden"==this.titleLocation||"hidden"==e;this.setPropertyValue("titleLocation",e.toLowerCase()),this.updateQuestionCss(),t&&this.notifySurveyVisibilityChanged()}getTitleOwner(){return this}getIsTitleRenderedAsString(){return"hidden"===this.titleLocation}notifySurveyOnChildrenVisibilityChanged(){return!1}notifySurveyVisibilityChanged(){if(!this.survey||this.isLoadingFromJson)return;this.survey.questionVisibilityChanged(this,this.isVisible,!this.parentQuestion||this.parentQuestion.notifySurveyOnChildrenVisibilityChanged());let e=this.isClearValueOnHidden;this.visible||this.clearValueOnHidding(e),e&&this.isVisibleInSurvey&&this.updateValueWithDefaults()}clearValueOnHidding(e){e&&this.clearValueIfInvisible()}get titleWidth(){if(this.parent&&"left"===this.getTitleLocation()){let e=this.parent.getColumsForElement(this),t=e.length;if(0!==t&&e[0].questionTitleWidth)return e[0].questionTitleWidth;let s=this.getPercentQuestionTitleWidth();if(!s&&this.parent){let e=this.parent.getQuestionTitleWidth();return e&&!isNaN(e)&&(e+="px"),e}return s/(t||1)+"%"}}getPercentQuestionTitleWidth(){let e=!!this.parent&&this.parent.getQuestionTitleWidth();if(e&&"%"===e[e.length-1])return parseInt(e)}getTitleLocation(){if(this.isFlowLayout)return"hidden";var e=this.getTitleLocationCore();return"left"!==e||this.isAllowTitleLeft||(e="top"),e}getTitleLocationCore(){return"default"!==this.titleLocation?this.titleLocation:this.parent?this.parent.getQuestionTitleLocation():this.survey?this.survey.questionTitleLocation:"top"}get hasTitleOnLeft(){return this.hasTitle&&"left"===this.getTitleLocation()}get hasTitleOnTop(){return this.hasTitle&&"top"===this.getTitleLocation()}get hasTitleOnBottom(){return this.hasTitle&&"bottom"===this.getTitleLocation()}get hasTitleOnLeftTop(){if(!this.hasTitle)return!1;let e=this.getTitleLocation();return"left"===e||"top"===e}get errorLocation(){return this.getPropertyValue("errorLocation")}set errorLocation(e){this.setPropertyValue("errorLocation",e)}getErrorLocation(){return"default"!==this.errorLocation?this.errorLocation:this.parentQuestion?this.parentQuestion.getChildErrorLocation(this):this.parent?this.parent.getQuestionErrorLocation():this.survey?this.survey.questionErrorLocation:"top"}getChildErrorLocation(e){return this.getErrorLocation()}get hasInput(){return!0}get hasSingleInput(){return this.hasInput}get inputId(){return this.id+"i"}getDefaultTitleValue(){return this.name}getDefaultTitleTagName(){return tp.titleTags.question}get descriptionLocation(){return this.getPropertyValue("descriptionLocation")}set descriptionLocation(e){this.setPropertyValue("descriptionLocation",e),this.updateQuestionCss()}get hasDescriptionUnderTitle(){return"underTitle"==this.getDescriptionLocation()&&this.hasDescription}get hasDescriptionUnderInput(){return"underInput"==this.getDescriptionLocation()&&this.hasDescription}getDescriptionLocation(){return"default"!==this.descriptionLocation?this.descriptionLocation:this.survey?this.survey.questionDescriptionLocation:"underTitle"}needClickTitleFunction(){return super.needClickTitleFunction()||this.hasInput}processTitleClick(){if(super.processTitleClick(),!this.isCollapsed)return setTimeout(()=>{this.focus()},1),!0}get requiredErrorText(){return this.getLocalizableStringText("requiredErrorText")}set requiredErrorText(e){this.setLocalizableStringText("requiredErrorText",e)}get locRequiredErrorText(){return this.getLocalizableString("requiredErrorText")}get commentText(){return this.getLocalizableStringText("commentText")}set commentText(e){this.setLocalizableStringText("commentText",e)}get locCommentText(){return this.getLocalizableString("commentText")}get commentPlaceholder(){return this.getLocalizableStringText("commentPlaceholder")}set commentPlaceholder(e){this.setLocalizableStringText("commentPlaceholder",e)}get locCommentPlaceholder(){return this.getLocalizableString("commentPlaceholder")}get commentPlaceHolder(){return this.commentPlaceholder}set commentPlaceHolder(e){this.commentPlaceholder=e}get renderedCommentPlaceholder(){var e;return null!==(e=this.getPropertyValue("renderedCommentPlaceholder"))&&void 0!==e?e:this.isReadOnly?void 0:this.commentPlaceHolder}resetRenderedCommentPlaceholder(){this.resetPropertyValue("renderedCommentPlaceholder")}get defaultDisplayValue(){return this.getLocalizableStringText("defaultDisplayValue")}set defaultDisplayValue(e){this.setLocalizableStringText("defaultDisplayValue",e)}get locDefaultDisplayValue(){return this.getLocalizableString("defaultDisplayValue")}getAllErrors(){return this.errors.slice()}getErrorByType(e){for(let t=0;t<this.errors.length;t++)if(this.errors[t].getErrorType()===e)return this.errors[t];return null}get customWidget(){return this.isCustomWidgetRequested||this.customWidgetValue||(this.isCustomWidgetRequested=!0,this.updateCustomWidget()),this.customWidgetValue}updateCustomWidget(){this.customWidgetValue=tQ.Instance.getCustomWidget(this)}localeChanged(){super.localeChanged(),this.resetRenderedCommentPlaceholder(),this.localeChangedCallback&&this.localeChangedCallback()}get isCompositeQuestion(){return!1}get isContainer(){return!1}updateCommentElements(){}onCommentInput(e){this.isInputTextUpdate?e.target&&(this.comment=e.target.value):this.updateCommentElements()}onCommentChange(e){this.comment=e.target.value,this.comment!==e.target.value&&(e.target.value=this.comment)}afterRenderQuestionElement(e){this.survey&&this.hasSingleInput&&this.survey.afterRenderQuestionInput(this,e)}afterRender(e){this.afterRenderCore(e),this.survey&&(this.survey.afterRenderQuestion(this,e),this.afterRenderQuestionCallback&&this.afterRenderQuestionCallback(this,e),(this.supportComment()||this.supportOther())&&(this.commentElements=[],this.getCommentElementsId().forEach(e=>{let{root:t}=tp.environment,s=t.getElementById(e);s&&this.commentElements.push(s)}),this.updateCommentElements()),this.checkForResponsiveness(e))}afterRenderCore(e){super.afterRenderCore(e)}getCommentElementsId(){return[this.commentId]}beforeDestroyQuestionElement(e){this.commentElements=void 0}get processedTitle(){return this.locProcessedTitle.textOrHtml||this.name}get fullTitle(){return this.locTitle.renderedHtml}get titlePattern(){return this.survey?this.survey.questionTitlePattern:"numTitleRequire"}get isRequireTextOnStart(){return this.isRequired&&"requireNumTitle"==this.titlePattern}get isRequireTextBeforeTitle(){return this.isRequired&&"numRequireTitle"==this.titlePattern&&""!==this.requiredMark}get isRequireTextAfterTitle(){return this.isRequired&&"numTitleRequire"==this.titlePattern&&""!==this.requiredMark}get startWithNewLine(){return this.getPropertyValue("startWithNewLine")}set startWithNewLine(e){this.startWithNewLine!=e&&this.setPropertyValue("startWithNewLine",e)}calcCssClasses(e){let t={error:{}};return this.copyCssClasses(t,e.question),this.copyCssClasses(t.error,e.error),this.updateCssClasses(t,e),t}onCalcCssClasses(e){super.onCalcCssClasses(e),this.survey&&this.survey.updateQuestionCssClasses(this,e),this.onUpdateCssClassesCallback&&this.onUpdateCssClassesCallback(e)}get cssRoot(){return this.ensureElementCss(),this.getPropertyValue("cssRoot","")}setCssRoot(e){this.setPropertyValue("cssRoot",e)}getCssRoot(e){let t=this.hasCssError();return new eV().append(super.getCssRoot(e)).append(this.isFlowLayout&&!this.isDesignMode?e.flowRoot:e.mainRoot).append(e.titleLeftRoot,!this.isFlowLayout&&this.hasTitleOnLeft).append(e.titleTopRoot,!this.isFlowLayout&&this.hasTitleOnTop).append(e.titleBottomRoot,!this.isFlowLayout&&this.hasTitleOnBottom).append(e.descriptionUnderInputRoot,!this.isFlowLayout&&this.hasDescriptionUnderInput).append(e.hasError,t).append(e.hasErrorTop,t&&"top"==this.getErrorLocation()).append(e.hasErrorBottom,t&&"bottom"==this.getErrorLocation()).append(e.small,!this.width).append(e.answered,this.isAnswered).append(e.noPointerEventsMode,this.isReadOnlyAttr).toString()}get cssHeader(){return this.ensureElementCss(),this.getPropertyValue("cssHeader","")}setCssHeader(e){this.setPropertyValue("cssHeader",e)}getCssHeader(e){return new eV().append(e.header).append(e.headerTop,this.hasTitleOnTop).append(e.headerLeft,this.hasTitleOnLeft).append(e.headerBottom,this.hasTitleOnBottom).toString()}supportContainerQueries(){return!1}get cssContent(){return this.ensureElementCss(),this.getPropertyValue("cssContent","")}setCssContent(e){this.setPropertyValue("cssContent",e)}getCssContent(e){return new eV().append(e.content).append(e.contentSupportContainerQueries,this.supportContainerQueries()).append(e.contentLeft,this.hasTitleOnLeft).toString()}get cssTitle(){return this.ensureElementCss(),this.getPropertyValue("cssTitle","")}setCssTitle(e){this.setPropertyValue("cssTitle",e)}getCssTitle(e){return new eV().append(super.getCssTitle(e)).append(e.titleOnAnswer,!this.containsErrors&&this.isAnswered).append(e.titleEmpty,!this.title.trim()).toString()}get cssDescription(){return this.ensureElementCss(),this.getPropertyValue("cssDescription","")}setCssDescription(e){this.setPropertyValue("cssDescription",e)}getCssDescription(e){return new eV().append(e.description).append(e.descriptionUnderInput,"underInput"==this.getDescriptionLocation()).toString()}showErrorOnCore(e){return!this.showErrorsAboveQuestion&&!this.showErrorsBelowQuestion&&this.getErrorLocation()===e}get showErrorOnTop(){return this.showErrorOnCore("top")}get showErrorOnBottom(){return this.showErrorOnCore("bottom")}get showErrorsOutsideQuestion(){return this.isDefaultV2Theme}get showErrorsAboveQuestion(){return this.showErrorsOutsideQuestion&&"top"===this.getErrorLocation()}get showErrorsBelowQuestion(){return this.showErrorsOutsideQuestion&&"bottom"===this.getErrorLocation()}get cssError(){return this.ensureElementCss(),this.getPropertyValue("cssError","")}setCssError(e){this.setPropertyValue("cssError",e)}getCssError(e){return new eV().append(e.error.root).append(e.errorsContainer,this.showErrorsBelowQuestion||this.showErrorsAboveQuestion).append(e.errorsContainerTop,this.showErrorsAboveQuestion).append(e.errorsContainerBottom,this.showErrorsBelowQuestion).append(e.error.locationTop,this.showErrorOnTop).append(e.error.locationBottom,this.showErrorOnBottom).toString()}hasCssError(){return this.errors.length>0||this.hasCssErrorCallback()}getRootCss(){return new eV().append(this.cssRoot).append(this.cssClasses.mobile,this.isMobile).append(this.cssClasses.readOnly,this.isReadOnlyStyle).append(this.cssClasses.disabled,this.isDisabledStyle).append(this.cssClasses.preview,this.isPreviewStyle).append(this.cssClasses.invisible,!this.isDesignMode&&this.areInvisibleElementsShowing&&!this.visible).toString()}getQuestionRootCss(){return new eV().append(this.cssClasses.root).append(this.cssClasses.rootMobile,this.isMobile).toString()}updateElementCss(e){this.wasRendered?(super.updateElementCss(e),e&&this.updateQuestionCss(!0)):this.clearCssClasses(),this.resetIndents()}updateQuestionCss(e){!this.isLoadingFromJson&&this.survey&&(this.wasRendered?this.updateElementCssCore(this.cssClasses):this.isRequireUpdateElements=!0)}ensureElementCss(){this.cssClassesValue||this.updateQuestionCss(!0)}updateElementCssCore(e){this.setCssRoot(this.getCssRoot(e)),this.setCssHeader(this.getCssHeader(e)),this.setCssContent(this.getCssContent(e)),this.setCssTitle(this.getCssTitle(e)),this.setCssDescription(this.getCssDescription(e)),this.setCssError(this.getCssError(e))}updateCssClasses(e,t){if(!t.question)return;let s=t[this.getCssType()],i=new eV().append(e.title).append(t.question.titleRequired,this.isRequired);e.title=i.toString();let r=new eV().append(e.root).append(s,this.isRequired&&!!t.question.required);if(null==s)e.root=r.toString();else if("string"==typeof s||s instanceof String)e.root=r.append(s.toString()).toString();else for(let t in e.root=r.toString(),s)e[t]=s[t]}getCssType(){return this.getType()}get renderCssRoot(){return this.cssClasses.root||void 0}calcPaddingLeft(){return this.getIndentSize(this.indent)}calcPaddingRight(){return this.getIndentSize(this.rightIndent)}getIndentSize(e){return!(e<1)&&this.getSurvey()&&this.cssClasses&&this.cssClasses.indent?e*this.cssClasses.indent+"px":""}focus(e=!1,t){if(this.isDesignMode||!this.isVisible||!this.survey)return;let s=this.page;if(s&&this.survey.activePage!==s)this.survey.focusQuestionByInstance(this,e);else if(this.survey){this.expandAllParents();let s=this.survey.isSmoothScrollEnabled?{behavior:"smooth"}:void 0;this.survey.scrollElementToTop(this,this,null,this.id,t,s,void 0,()=>{this.focusInputElement(e)})}else this.focusInputElement(e)}focusInputElement(e){var t;let s=e?this.getFirstErrorInputElementId():this.getFirstInputElementId(),i=null===(t=this.survey)||void 0===t?void 0:t.rootElement;eW.FocusElement(s,!1,i)&&this.fireCallback(this.focusCallback)}get isValidateVisitedEmptyFields(){return this.supportEmptyValidation()&&!!this.survey&&this.survey.getValidateVisitedEmptyFields()&&this.isEmpty()}supportEmptyValidation(){return!1}onBlur(e){this.onBlurCore(e)}onFocus(e){this.onFocusCore(e)}onBlurCore(e){this.isFocusEmpty&&this.isEmpty()&&this.validate(!0)}onFocusCore(e){this.isFocusEmpty=this.isValidateVisitedEmptyFields}expandAllParents(){this.expandAllParentsCore(this)}expandAllParentsCore(e){e&&(e.isCollapsed&&e.expand(),this.expandAllParentsCore(e.parent),this.expandAllParentsCore(e.parentQuestion))}focusIn(){!this.survey||this.isDisposed||this.isContainer||this.survey.whenQuestionFocusIn(this)}fireCallback(e){e&&e()}getOthersMaxLength(){return this.survey&&this.survey.maxCommentLength>0?this.survey.maxCommentLength:null}onCreating(){}getFirstQuestionToFocus(e){return this.hasInput&&(!e||this.currentErrorCount>0)?this:null}getFirstInputElementId(){return this.inputId}getFirstErrorInputElementId(){return this.getFirstInputElementId()}getProcessedTextValue(e){var t=e.name.toLocaleLowerCase();e.isExists=-1!==Object.keys(tU.TextPreprocessorValuesMap).indexOf(t)||void 0!==this[e.name],e.value=this[tU.TextPreprocessorValuesMap[t]||e.name]}supportComment(){let e=this.getPropertyByName("showCommentArea");return!e||e.visible}supportOther(){return!1}get isRequired(){return this.getPropertyValue("isRequired")}set isRequired(e){this.setPropertyValue("isRequired",e)}get requiredIf(){return this.getPropertyValue("requiredIf","")}set requiredIf(e){this.setPropertyValue("requiredIf",e)}get showCommentArea(){return this.getPropertyValue("showCommentArea",!1)}set showCommentArea(e){this.supportComment()&&this.setPropertyValue("showCommentArea",e)}get hasComment(){return this.showCommentArea}set hasComment(e){this.showCommentArea=e}get id(){return this.getPropertyValue("id")}set id(e){this.setPropertyValue("id",e)}get ariaTitleId(){return this.id+"_ariaTitle"}get ariaDescriptionId(){return this.id+"_ariaDescription"}get commentId(){return this.id+"_comment"}get showOtherItem(){return this.getPropertyValue("showOtherItem",!1)}set showOtherItem(e){this.supportOther()&&this.showOtherItem!=e&&(this.setPropertyValue("showOtherItem",e),this.hasOtherChanged())}get hasOther(){return this.showOtherItem}set hasOther(e){this.showOtherItem=e}hasOtherChanged(){}get requireUpdateCommentValue(){return this.hasComment||this.hasOther}get isReadOnly(){let e=!!this.parent&&this.parent.isReadOnly,t=!!this.parentQuestion&&this.parentQuestion.isReadOnly,s=!!this.survey&&this.survey.isDisplayMode,i=!!this.readOnlyCallback&&this.readOnlyCallback();return this.readOnly||e||s||t||i}get isInputReadOnly(){return void 0!==this.forceIsInputReadOnly?this.forceIsInputReadOnly:this.isReadOnly||this.isDesignMode}get renderedInputReadOnly(){return this.isInputReadOnly?"":void 0}get renderedInputDisabled(){return this.isInputReadOnly?"":void 0}get isReadOnlyAttr(){return this.isReadOnly}get isDisabledAttr(){return this.isDesignMode||!!this.readOnlyCallback&&this.readOnlyCallback()}onReadOnlyChanged(){this.setPropertyValue("isInputReadOnly",this.isInputReadOnly),super.onReadOnlyChanged(),this.isReadOnly&&this.clearErrors(),this.updateQuestionCss(),this.resetRenderedCommentPlaceholder()}get enableIf(){return this.getPropertyValue("enableIf","")}set enableIf(e){this.setPropertyValue("enableIf",e)}surveyChoiceItemVisibilityChange(){}runCondition(e,t){this.isDesignMode||(t||(t={}),t.question=this,this.runConditionCore(e,t),this.isValueChangedDirectly||this.isClearValueOnHidden&&!this.isVisibleInSurvey||(this.defaultValueRunner=this.getDefaultRunner(this.defaultValueRunner,this.defaultValueExpression),this.runDefaultValueExpression(this.defaultValueRunner,e,t)))}get isInDesignMode(){return!this.isContentElement&&this.isDesignMode}get no(){return this.getPropertyValue("no")}calcNo(){if(!this.hasTitle||!this.showNumber)return"";let e=null===(t=this.parent)||void 0===t?void 0:t.visibleIndex;var t,s=a.getNumberByIndex(this.visibleIndex,this.getStartIndex(),e);return this.survey&&(s=this.survey.getUpdatedQuestionNo(this,s)),s}getStartIndex(){return this.parent?this.parent.getQuestionStartIndex():this.survey?this.survey.questionStartIndex:""}onSurveyLoad(){this.isCustomWidgetRequested=!1,this.fireCallback(this.surveyLoadCallback),this.updateValueWithDefaults(),this.isEmpty()&&this.initDataFromSurvey()}onSetData(){super.onSetData(),this.isDesignMode||!this.survey||this.isLoadingFromJson||(this.initDataFromSurvey(),this.onSurveyValueChanged(this.value),this.updateValueWithDefaults(),this.updateIsAnswered())}initDataFromSurvey(){if(this.data){let e=this.data.getValue(this.getValueName());a.isValueEmpty(e)&&this.isLoadingFromJson||this.updateValueFromSurvey(e),this.initCommentFromSurvey()}}initCommentFromSurvey(){this.data&&this.requireUpdateCommentValue?this.updateCommentFromSurvey(this.data.getComment(this.getValueName())):this.updateCommentFromSurvey("")}runExpression(e){if(this.survey&&e)return this.survey.runExpression(e)}get commentAreaRows(){return this.survey&&this.survey.commentAreaRows}get autoGrowComment(){return this.survey&&this.survey.autoGrowComment}get allowResizeComment(){return this.survey&&this.survey.allowResizeComment}get questionValue(){return this.getPropertyValueWithoutDefault("value")}set questionValue(e){this.setPropertyValue("value",e)}get questionComment(){return this.getPropertyValueWithoutDefault("comment")}set questionComment(e){this.setPropertyValue("comment",e),this.fireCallback(this.commentChangedCallback)}get isValueArray(){return!1}get value(){return this.getValueCore()}set value(e){this.setNewValue(e)}get hasFilteredValue(){return!1}getFilteredValue(){return this.value}getFilteredName(){return this.getValueName()}get valueForSurvey(){return this.valueForSurveyCore(this.value)}valueForSurveyCore(e){return this.valueToDataCallback?this.valueToDataCallback(e):e}valueFromDataCore(e){return this.valueFromDataCallback?this.valueFromDataCallback(e):e}clearValue(e){void 0!==this.value&&(this.value=void 0),this.comment&&!0!==e&&(this.comment=void 0),this.setValueChangedDirectly(!1)}clearValueOnly(){this.clearValue(!0)}unbindValue(){this.clearValue()}createValueCopy(){return this.getUnbindValue(this.value)}initDataUI(){}getUnbindValue(e){return this.isValueSurveyElement(e)?e:a.getUnbindValue(e)}isValueSurveyElement(e){return!!e&&(Array.isArray(e)?e.length>0&&this.isValueSurveyElement(e[0]):!0===e.isSurveyObj)}canClearValueAsInvisible(e){return"onHiddenContainer"===e&&!this.isParentVisible||!this.isVisibleInSurvey&&(!this.page||!this.page.isStartPage)&&(!this.survey||!this.survey.hasVisibleQuestionByValueName(this.getValueName()))}get isParentVisible(){if(this.parentQuestion&&!this.parentQuestion.isVisible)return!1;for(var e=this.parent;e;){if(!e.isVisible)return!1;e=e.parent}return!0}clearValueIfInvisible(e="onHidden"){let t=this.getClearIfInvisible();"none"!==t&&("onHidden"!==e||"onComplete"!==t)&&("onHiddenContainer"!==e||t===e)&&this.clearValueIfInvisibleCore(e)}clearValueIfInvisibleCore(e){this.canClearValueAsInvisible(e)&&this.clearValue()}get clearIfInvisible(){return this.getPropertyValue("clearIfInvisible")}set clearIfInvisible(e){this.setPropertyValue("clearIfInvisible",e)}getClearIfInvisible(){let e=this.clearIfInvisible;return this.survey?this.survey.getQuestionClearIfInvisible(e):"default"!==e?e:"onComplete"}get displayValue(){return this.isLoadingFromJson?"":this.getDisplayValue(!0)}getDisplayValue(e,t){var s=this.calcDisplayValue(e,t);return this.survey&&(s=this.survey.getQuestionDisplayValue(this,s)),this.displayValueCallback?this.displayValueCallback(s):s}calcDisplayValue(e,t){if(this.customWidget){var s=this.customWidget.getDisplayValue(this,t);if(s)return s}return(t=void 0==t?this.createValueCopy():t,this.isValueEmpty(t)&&!this.locDefaultDisplayValue.isEmpty&&(t=this.defaultDisplayValue),this.isValueEmpty(t,!this.allowSpaceAsAnswer))?this.getDisplayValueEmpty():this.getDisplayValueCore(e,t)}getDisplayValueCore(e,t){return t}getDisplayValueEmpty(){return""}get defaultValue(){return this.getPropertyValue("defaultValue")}set defaultValue(e){if(this.isValueExpression(e)){this.defaultValueExpression=e.substring(1);return}this.setPropertyValue("defaultValue",this.convertDefaultValue(e)),this.updateValueWithDefaults()}get defaultValueExpression(){return this.getPropertyValue("defaultValueExpression")}set defaultValueExpression(e){this.setPropertyValue("defaultValueExpression",e),this.defaultValueRunner=void 0,this.updateValueWithDefaults()}get resetValueIf(){return this.getPropertyValue("resetValueIf")}set resetValueIf(e){this.setPropertyValue("resetValueIf",e)}get setValueIf(){return this.getPropertyValue("setValueIf")}set setValueIf(e){this.setPropertyValue("setValueIf",e)}get setValueExpression(){return this.getPropertyValue("setValueExpression")}set setValueExpression(e){this.setPropertyValue("setValueExpression",e)}get resizeStyle(){return this.allowResizeComment?"both":"none"}getPlainData(e){if(e||(e={includeEmpty:!0,includeQuestionTypes:!1}),e.includeEmpty||!this.isEmpty()){var t={name:this.name,title:this.locTitle.renderedHtml,value:this.value,displayValue:this.displayValue,isNode:!1,getString:e=>"object"==typeof e?JSON.stringify(e):e};return!0===e.includeQuestionTypes&&(t.questionType=this.getType()),(e.calculations||[]).forEach(e=>{t[e.propertyName]=this.getPlainDataCalculatedValue(e.propertyName)}),this.hasComment&&(t.isNode=!0,t.data=[{name:0,isComment:!0,title:"Comment",value:tp.commentSuffix,displayValue:this.comment,getString:e=>"object"==typeof e?JSON.stringify(e):e,isNode:!1}]),t}}getPlainDataCalculatedValue(e){return this[e]}get correctAnswer(){return this.getPropertyValue("correctAnswer")}set correctAnswer(e){this.setPropertyValue("correctAnswer",this.convertDefaultValue(e))}convertDefaultValue(e){return e}get quizQuestionCount(){return this.isVisible&&this.hasInput&&!this.isValueEmpty(this.correctAnswer)?this.getQuizQuestionCount():0}get correctAnswerCount(){return this.isEmpty()||this.isValueEmpty(this.correctAnswer)?0:this.getCorrectAnswerCount()}getQuizQuestionCount(){return 1}getCorrectAnswerCount(){return+!!this.checkIfAnswerCorrect()}checkIfAnswerCorrect(){let e=a.isTwoValueEquals(this.value,this.correctAnswer,this.getAnswerCorrectIgnoreOrder(),tp.comparator.caseSensitive,!0),t=+!!e,s=this.quizQuestionCount-t,i={result:e,correctAnswers:t,correctAnswerCount:t,incorrectAnswers:s,incorrectAnswerCount:s};return this.survey&&this.survey.onCorrectQuestionAnswer(this,i),i.result}getAnswerCorrectIgnoreOrder(){return!1}isAnswerCorrect(){return this.correctAnswerCount==this.quizQuestionCount}updateValueWithDefaults(){!(this.isLoadingFromJson||!this.isDesignMode&&this.isDefaultValueEmpty()||!this.isDesignMode&&!this.isEmpty()||this.isEmpty()&&this.isDefaultValueEmpty())&&(!this.isClearValueOnHidden||this.isVisible)&&(this.isDesignMode&&this.isContentElement&&this.isDefaultValueEmpty()||this.setDefaultValue())}get isValueDefault(){return!this.isEmpty()&&(this.isTwoValueEquals(this.defaultValue,this.value)||!this.isValueChangedDirectly&&!!this.defaultValueExpression)}get isClearValueOnHidden(){let e=this.getClearIfInvisible();return"none"!==e&&"onComplete"!==e&&("onHidden"===e||"onHiddenContainer"===e)}getQuestionFromArray(e,t){return null}getDefaultValue(){return this.defaultValue}isDefaultValueEmpty(){return!this.defaultValueExpression&&this.isValueEmpty(this.defaultValue,!this.allowSpaceAsAnswer)}getDefaultRunner(e,t){return!e&&t&&(e=this.createExpressionRunner(t)),e&&(e.expression=t),e}setDefaultValue(){this.setDefaultValueCore(e=>{this.isTwoValueEquals(this.value,e)||(this.value=e)})}setDefaultValueCore(e){this.defaultValueRunner=this.getDefaultRunner(this.defaultValueRunner,this.defaultValueExpression),this.setValueAndRunExpression(this.defaultValueRunner,this.getUnbindValue(this.defaultValue),t=>e(t))}isValueExpression(e){return!!e&&"string"==typeof e&&e.length>0&&"="==e[0]}setValueAndRunExpression(e,t,s,i=null,r=null){let n=e=>{this.runExpressionSetValueCore(e,s)};this.runDefaultValueExpression(e,i,r,n)||n(t)}convertFuncValuetoQuestionValue(e){return a.convertValToQuestionVal(e)}runExpressionSetValueCore(e,t){t(this.convertFuncValuetoQuestionValue(e))}runExpressionSetValue(e){this.runExpressionSetValueCore(e,e=>{this.isTwoValueEquals(this.value,e)||(this.startSetValueOnExpression(),this.value=e,this.finishSetValueOnExpression())})}startSetValueOnExpression(){var e;null===(e=this.survey)||void 0===e||e.startSetValueOnExpression()}finishSetValueOnExpression(){var e;null===(e=this.survey)||void 0===e||e.finishSetValueOnExpression()}runDefaultValueExpression(e,t=null,s=null,i){return!!e&&!!this.data&&(i||(i=e=>{this.runExpressionSetValue(e)}),t||(t=this.defaultValueExpression?this.data.getFilteredValues():{}),s||((s=this.defaultValueExpression?this.data.getFilteredProperties():{}).question=this),e&&e.canRun&&(e.onRunComplete=e=>{void 0==e&&(e=this.defaultValue),this.isChangingViaDefaultValue=!0,i(e),this.isChangingViaDefaultValue=!1},e.run(t,s)),!0)}get comment(){return this.getQuestionComment()}set comment(e){if(e){let t=e.toString().trim();t!==e&&(e=t)===this.comment&&this.setPropertyValueDirectly("comment",e)}this.comment!=e&&(this.setQuestionComment(e),this.updateCommentElements())}getCommentAreaCss(e=!1){return new eV().append("form-group",e).append(this.cssClasses.formGroup,!e).append(this.cssClasses.commentArea).toString()}getQuestionComment(){return this.questionComment}setQuestionComment(e){this.setNewComment(e)}isEmpty(){return this.isValueEmpty(this.value,!this.allowSpaceAsAnswer)}get isAnswered(){return this.getPropertyValue("isAnswered")||!1}set isAnswered(e){this.setPropertyValue("isAnswered",e)}updateIsAnswered(){let e=this.isAnswered;this.setPropertyValue("isAnswered",this.getIsAnswered()),e!==this.isAnswered&&this.updateQuestionCss()}getIsAnswered(){return!this.isEmpty()}get validators(){return this.getPropertyValue("validators")}set validators(e){this.setPropertyValue("validators",e)}getValidators(){return this.validators}getSupportedValidators(){for(var e=[],t=this.getType();t;){var s=tp.supportedValidators[t];if(s)for(var i=s.length-1;i>=0;i--)e.splice(0,0,s[i]);t=E.findClass(t).parentName}return e}addConditionObjectsByContext(e,t){e.push({name:this.getFilteredName(),text:this.processedTitle,question:this})}getNestedQuestions(e=!1){let t=[];return(this.collectNestedQuestions(t,e),1===t.length&&t[0]===this)?[]:t}collectNestedQuestions(e,t=!1){(!t||this.isVisible)&&this.collectNestedQuestionsCore(e,t)}collectNestedQuestionsCore(e,t){e.push(this)}getConditionJson(e=null,t=null){let s=new I().toJsonObject(this);return s.type=this.getType(),s}hasErrors(e=!0,t=null){let s=this.checkForErrors(!!t&&!0===t.isOnValueChanged,e);return e&&(this.errors=s,this.errors!==s&&this.errors.forEach(e=>e.locText.strChanged())),this.updateContainsErrors(),this.isCollapsed&&t&&e&&s.length>0&&this.expand(),s.length>0}validate(e=!0,t=null){return t&&t.isOnValueChanged&&this.parent&&this.parent.validateContainerOnly(),!this.hasErrors(e,t)}get currentErrorCount(){return this.errors.length}get requiredMark(){return null!=this.survey&&this.isRequired?this.survey.requiredMark:""}get requiredText(){return this.requiredMark}addError(e){if(!e)return;let t=null;t="string"==typeof e||e instanceof String?this.addCustomError(e):e,this.errors.push(t)}addCustomError(e){return new tA(e,this.survey)}removeError(e){if(!e)return!1;let t=this.errors,s=t.indexOf(e);return -1!==s&&t.splice(s,1),-1!==s}checkForErrors(e,t){var s=[];if(this.isVisible&&this.canCollectErrors()&&this.collectErrors(s,e,t),this.survey){if(this.validateValueCallback&&0===s.length){let e=this.validateValueCallback();e&&s.push(e)}this.survey.validateQuestion(this,s,t)}return s}canCollectErrors(){return!this.isReadOnly||tp.readOnly.enableValidation}collectErrors(e,t,s){if(this.onCheckForErrors(e,t,s),!(e.length>0)&&this.canRunValidators(t)){var i=this.runValidators();if(i.length>0){e.length=0;for(var r=0;r<i.length;r++)e.push(i[r])}}}canRunValidators(e){return!0}onCheckForErrors(e,t,s){if((!t||this.isOldAnswered)&&this.hasRequiredError()){let t=new tC(this.requiredErrorText,this);t.onUpdateErrorTextCallback=e=>{e.text=this.requiredErrorText},e.push(t)}if(!this.isEmpty()&&this.customWidget){let t=this.customWidget.validate(this);t&&e.push(this.addCustomError(t))}}hasRequiredError(){return this.isRequired&&this.isEmpty()}get isRunningValidators(){return this.getIsRunningValidators()}getIsRunningValidators(){return this.isRunningValidatorsValue}runValidators(){return this.validatorRunner&&(this.validatorRunner.onAsyncCompleted=null),this.validatorRunner=new tL,this.isRunningValidatorsValue=!0,this.validatorRunner.onAsyncCompleted=e=>{this.doOnAsyncCompleted(e)},this.validatorRunner.run(this)}doOnAsyncCompleted(e){for(var t=0;t<e.length;t++)this.errors.push(e[t]);this.isRunningValidatorsValue=!1,this.raiseOnCompletedAsyncValidators()}raiseOnCompletedAsyncValidators(){this.onCompletedAsyncValidators&&!this.isRunningValidators&&(this.onCompletedAsyncValidators(this.getAllErrors().length>0),this.onCompletedAsyncValidators=null)}setNewValue(e){!this.isNewValueEqualsToValue(e)&&this.checkIsValueCorrect(e)&&(this.isOldAnswered=this.isAnswered,this.isSettingQuestionValue=!0,this.setNewValueInData(e),this.allowNotifyValueChanged&&this.onValueChanged(),this.isSettingQuestionValue=!1,this.isAnswered!==this.isOldAnswered&&this.updateQuestionCss(),this.isOldAnswered=void 0,this.parent&&this.parent.onQuestionValueChanged(this))}checkIsValueCorrect(e){let t=this.isValueEmpty(e,!this.allowSpaceAsAnswer)||this.isNewValueCorrect(e);return t||D.inCorrectQuestionValue(this.name,e),t}isNewValueCorrect(e){return!0}isNewValueEqualsToValue(e){let t=this.value;return!!this.isTwoValueEquals(e,t,!1,!1)&&!(e===t&&t&&(Array.isArray(t)||"object"==typeof t))}isTextValue(){return!1}getIsInputTextUpdate(){return!!this.survey&&this.survey.isUpdateValueTextOnTyping}get requireStrictCompare(){return!1}getDataLocNotification(){return!!this.isInputTextUpdate&&"text"}get isInputTextUpdate(){return this.getIsInputTextUpdate()&&this.isTextValue()}setNewValueInData(e){e=this.valueToData(e),this.isValueChangedInSurvey||this.setValueCore(e)}getValueCore(){return this.questionValue}setValueCore(e){this.setQuestionValue(e),null!=this.data&&this.canSetValueToSurvey()&&(e=this.valueForSurvey,this.data.setValue(this.getValueName(),e,this.getDataLocNotification(),this.allowNotifyValueChanged,this.name)),this.isMouseDown=!1}canSetValueToSurvey(){return!0}valueFromData(e){return e}valueToData(e){return e}convertToCorrectValue(e){return e}onValueChanged(){}onMouseDown(){this.isMouseDown=!0}setNewComment(e){this.questionComment!==e&&(this.questionComment=e,this.setCommentIntoData(e))}setCommentIntoData(e){null!=this.data&&this.data.setComment(this.getValueName(),e,!!this.getIsInputTextUpdate()&&"text")}getValidName(e){return tj(e)}updateValueFromSurvey(e,t=!1){if(e=this.getUnbindValue(e),e=this.valueFromDataCore(e),!this.checkIsValueCorrect(e))return;let s=this.isValueEmpty(e);!s&&this.defaultValueExpression?this.setDefaultValueCore(t=>{this.updateValueFromSurveyCore(e,this.isTwoValueEquals(e,t))}):(this.updateValueFromSurveyCore(e,this.data!==this.getSurvey()),t&&s&&(this.isValueChangedDirectly=!1)),this.updateDependedQuestions(),this.updateIsAnswered()}updateValueFromSurveyCore(e,t){this.isChangingViaDefaultValue=t,this.setQuestionValue(this.valueFromData(e)),this.isChangingViaDefaultValue=!1}updateCommentFromSurvey(e){this.questionComment=e}onChangeQuestionValue(e){}setValueChangedDirectly(e){this.isValueChangedDirectly=e,this.setValueChangedDirectlyCallback&&this.setValueChangedDirectlyCallback(e)}setQuestionValue(e,t=!0){e=this.convertToCorrectValue(e);let s=this.isTwoValueEquals(this.questionValue,e);s||this.isChangingViaDefaultValue||this.isParentChangingViaDefaultValue||this.setValueChangedDirectly(!0),this.questionValue=e,s||this.onChangeQuestionValue(e),!s&&this.allowNotifyValueChanged&&this.fireCallback(this.valueChangedCallback),t&&this.updateIsAnswered()}get isParentChangingViaDefaultValue(){var e;return(null===(e=this.data)||void 0===e?void 0:e.isChangingViaDefaultValue)===!0}onSurveyValueChanged(e){}setVisibleIndex(e){return!(e>-1)||this.isVisible&&(this.hasTitle||tp.numbering.includeQuestionsWithHiddenTitle)&&(this.showNumber||tp.numbering.includeQuestionsWithHiddenNumber)||(e=-1),this.setPropertyValue("visibleIndex",e),this.setPropertyValue("no",this.calcNo()),e<0?0:1}removeElement(e){return!1}supportGoNextPageAutomatic(){return this.supportAutoAdvance()}supportAutoAdvance(){return!1}supportGoNextPageError(){return!0}clearIncorrectValues(){}clearOnDeletingContainer(){}clearErrors(){this.errors=[]}clearUnusedValues(){}onAnyValueChanged(e,t){}checkBindings(e,t){if(!this.bindings.isEmpty()&&this.data)for(var s=this.bindings.getPropertiesByValueName(e),i=0;i<s.length;i++){let e=s[i];this.isValueEmpty(t)&&a.isNumber(this[e])&&(t=0),this.updateBindingProp(e,t)}}updateBindingProp(e,t){this[e]=t}getComponentName(){return tz.Instance.getRendererByQuestion(this)}isDefaultRendering(){return!!this.customWidget||"default"===this.getComponentName()}get renderAs(){return this.getPropertyValue("renderAs")}set renderAs(e){this.setPropertyValue("renderAs",e)}get inMatrixMode(){return this.getPropertyValue("inMatrixMode",!1)}set inMatrixMode(e){this.setPropertyValue("inMatrixMode",e)}getErrorCustomText(e,t){return this.survey?this.survey.getSurveyErrorCustomText(this,e,t):e}getValidatorTitle(){return null}get validatedValue(){return this.value}set validatedValue(e){this.value=e}getAllValues(){return this.data?this.data.getAllValues():null}processPopupVisiblilityChanged(e,t){this.survey.processPopupVisiblityChanged(this,e,t)}processOpenDropdownMenu(e){this.survey.processOpenDropdownMenu(this,e)}onTextKeyDownHandler(e){13===e.keyCode&&this.survey.questionEditFinishCallback(this,e)}transformToMobileView(){}transformToDesktopView(){}needResponsiveWidth(){return!1}supportResponsiveness(){return!1}needResponsiveness(){return this.supportResponsiveness()&&this.isDefaultV2Theme&&!this.isDesignMode}checkForResponsiveness(e){this.needResponsiveness()&&(this.isCollapsed?this.registerPropertyChangedHandlers(["state"],()=>{this.isExpanded&&(this.initResponsiveness(e),this.unregisterPropertyChangedHandlers(["state"],"for-responsiveness"))},"for-responsiveness"):this.initResponsiveness(e))}getObservedElementSelector(){return".sd-scrollable-container"}onMobileChanged(){this.onMobileChangedCallback&&this.onMobileChangedCallback()}triggerResponsiveness(e=!0){this.triggerResponsivenessCallback&&this.triggerResponsivenessCallback(e)}initResponsiveness(e){if(this.destroyResizeObserver(),e&&this.isDefaultRendering()){let t;let s=this.getObservedElementSelector();if(!s||!e.querySelector(s))return;let r=!1;this.triggerResponsivenessCallback=i=>{i&&(t=void 0,this.renderAs="default",r=!1);let n=()=>{let i=e.querySelector(s);!t&&this.isDefaultRendering()&&(t=i.scrollWidth),r=!r&&!!ta(i)&&this.processResponsiveness(t,tn(i))};i?setTimeout(n,1):n()},this.resizeObserver=new ResizeObserver(e=>{i.requestAnimationFrame(()=>{this.triggerResponsiveness(!1)})}),this.onMobileChangedCallback=()=>{setTimeout(()=>{let i=e.querySelector(s);this.processResponsiveness(t,tn(i))},0)},this.resizeObserver.observe(e)}}getCompactRenderAs(){return"default"}getDesktopRenderAs(){return"default"}onBeforeSetCompactRenderer(){}onBeforeSetDesktopRenderer(){}processResponsiveness(e,t){if(Math.abs(e-(t=Math.round(t)))>2){let s=this.renderAs;return e>t?(this.onBeforeSetCompactRenderer(),this.renderAs=this.getCompactRenderAs()):(this.onBeforeSetDesktopRenderer(),this.renderAs=this.getDesktopRenderAs()),s!==this.renderAs}return!1}destroyResizeObserver(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0,this.onMobileChangedCallback=void 0,this.triggerResponsivenessCallback=void 0,this.renderAs=this.getDesktopRenderAs())}dispose(){super.dispose(),this.resetDependedQuestions(),this.destroyResizeObserver()}resetDependedQuestions(){for(var e=0;e<this.dependedQuestions.length;e++)this.dependedQuestions[e].resetDependedQuestion()}get isNewA11yStructure(){return!1}get ariaLabel(){return this.isNewA11yStructure?null:this.locTitle.renderedHtml}get ariaRole(){return this.isNewA11yStructure?null:"textbox"}get ariaRequired(){return this.isNewA11yStructure?null:this.isRequired?"true":"false"}get ariaInvalid(){return this.isNewA11yStructure?null:this.hasCssError()?"true":"false"}get ariaLabelledBy(){return this.isNewA11yStructure?null:this.hasTitle?this.ariaTitleId:null}get ariaDescribedBy(){return this.isNewA11yStructure?null:this.hasTitle&&this.hasDescription?this.ariaDescriptionId:null}get ariaErrormessage(){return this.isNewA11yStructure?null:this.hasCssError()?this.id+"_errors":null}get a11y_input_ariaRole(){return null}get a11y_input_ariaRequired(){return this.isRequired?"true":"false"}get a11y_input_ariaInvalid(){return this.hasCssError()?"true":"false"}get a11y_input_ariaLabel(){return this.hasTitle&&!this.parentQuestion?null:this.locTitle.renderedHtml}get a11y_input_ariaLabelledBy(){return this.hasTitle&&!this.parentQuestion?this.ariaTitleId:null}get a11y_input_ariaDescribedBy(){return this.hasTitle&&!this.parentQuestion&&this.hasDescription?this.ariaDescriptionId:null}get a11y_input_ariaErrormessage(){return this.hasCssError()?this.id+"_errors":null}}function tj(e){if(!e)return e;for(e=e.trim().replace(/[\{\}]+/g,"");e&&e[0]===tp.expressionDisableConversionChar;)e=e.substring(1);return e}tU.TextPreprocessorValuesMap={title:"processedTitle",require:"requiredMark"},tU.questionCounter=100,E.addClass("question",[{name:"!name",onSettingValue:(e,t)=>tj(t)},{name:"state",default:"default",choices:["default","collapsed","expanded"]},{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},{name:"useDisplayValuesInDynamicTexts:boolean",alternativeName:"useDisplayValuesInTitle",default:!0,layout:"row"},"visibleIf:condition",{name:"width"},{name:"minWidth",defaultFunc:()=>tp.minWidth},{name:"maxWidth",defaultFunc:()=>tp.maxWidth},{name:"colSpan:number",visible:!1,onSerializeValue:e=>e.getPropertyValue("colSpan")},{name:"effectiveColSpan:number",minValue:1,isSerializable:!1,visibleIf:function(e){return!!e&&!!e.survey&&e.survey.gridLayoutEnabled}},{name:"startWithNewLine:boolean",default:!0,layout:"row"},{name:"indent:number",default:0,choices:[0,1,2,3],layout:"row"},{name:"page",isSerializable:!1,visibleIf:function(e){var t=e?e.survey:null;return!t||!t.pages||t.pages.length>1},choices:function(e){var t=e?e.survey:null;return t?t.pages.map(e=>({value:e.name,text:e.title})):[]}},{name:"title:text",serializationProperty:"locTitle",layout:"row",dependsOn:"name",onPropertyEditorUpdate:function(e,t){e&&t&&(t.placeholder=e.getDefaultTitle())}},{name:"titleLocation",default:"default",choices:["default","top","bottom","left","hidden"],layout:"row"},{name:"description:text",serializationProperty:"locDescription",layout:"row"},{name:"descriptionLocation",default:"default",choices:["default","underInput","underTitle"]},{name:"showNumber:boolean",dependsOn:"titleLocation",default:!0,visibleIf:function(e){if(!e)return!0;if("hidden"===e.titleLocation)return!1;var t=e?e.parent:null;if(!(!t||"off"!==t.showQuestionNumbers))return!1;var s=e?e.survey:null;return!s||"off"!==s.showQuestionNumbers||!!t&&"onpanel"===t.showQuestionNumbers}},{name:"hideNumber:boolean",visible:!1,isSerializable:!1},{name:"valueName",onSettingValue:(e,t)=>tj(t)},"enableIf:condition","resetValueIf:condition","setValueIf:condition","setValueExpression:expression","defaultValue:value",{name:"defaultValueExpression:expression",category:"logic"},"correctAnswer:value",{name:"clearIfInvisible",default:"default",choices:["default","none","onComplete","onHidden","onHiddenContainer"]},{name:"isRequired:switch",overridingProperty:"requiredIf"},"requiredIf:condition",{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"errorLocation",default:"default",choices:["default","top","bottom"]},{name:"readOnly:switch",overridingProperty:"enableIf"},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"},{name:"bindings:bindings",serializationProperty:"bindings",isSerializableFunc:e=>!e.isBindingEmpty(),visibleIf:function(e){return e.bindings.getNames().length>0}},{name:"renderAs",default:"default",visible:!1},{name:"showCommentArea",visible:!1,default:!1,alternativeName:"hasComment",category:"general"},{name:"commentText",dependsOn:"showCommentArea",visibleIf:function(e){return e.showCommentArea},serializationProperty:"locCommentText"},{name:"commentPlaceholder",alternativeName:"commentPlaceHolder",serializationProperty:"locCommentPlaceholder",dependsOn:"showCommentArea",visibleIf:function(e){return e.hasComment}},{name:"defaultDisplayValue",serializationProperty:"locDefaultDisplayValue"}]),E.addAlterNativeClassName("question","questionbase");class tJ extends eO{getMarkdownHtml(e,t){return this.locOwner?this.locOwner.getMarkdownHtml(e,t):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}static get Separator(){return tp.itemValueSeparator}static set Separator(e){tp.itemValueSeparator=e}static setData(e,t,s){e.length=0;for(let i=0;i<t.length;i++){let r=t[i],n=r&&"function"==typeof r.getType?r.getType():null!=s?s:"itemvalue",a=E.createClass(n);a.setData(r),r.originalItem&&(a.originalItem=r.originalItem),e.push(a)}}static getData(e){for(var t=[],s=0;s<e.length;s++)t.push(e[s].getData());return t}static getItemByValue(e,t){if(!Array.isArray(e))return null;let s=a.isValueEmpty(t);for(var i=0;i<e.length;i++)if(s&&a.isValueEmpty(e[i].value)||a.isTwoValueEquals(e[i].value,t,!1,!0,!1))return e[i];return null}static getTextOrHtmlByValue(e,t){var s=tJ.getItemByValue(e,t);return null!==s?s.textOrHtml:""}static locStrsChanged(e){for(var t=0;t<e.length;t++)e[t].locStrsChanged()}static runConditionsForItems(e,t,s,i,r,n=!0,a){return tJ.runConditionsForItemsCore(e,t,s,i,r,!0,n,a)}static runEnabledConditionsForItems(e,t,s,i,r){return tJ.runConditionsForItemsCore(e,null,t,s,i,!1,!0,r)}static runConditionsForItemsCore(e,t,s,i,r,n,a=!0,o){i||(i={});for(var l=i.item,h=i.choice,u=!1,d=0;d<e.length;d++){var c=e[d];i.item=c.value,i.choice=c.value;var g=!!a&&!!c.getConditionRunner&&c.getConditionRunner(n);g||(g=s);var p=!0;g&&(p=g.run(i,r)),o&&(p=o(c,p)),t&&p&&t.push(c),p!=(n?c.isVisible:c.isEnabled)&&(u=!0,n?c.setIsVisible&&c.setIsVisible(p):c.setIsEnabled&&c.setIsEnabled(p))}return l?i.item=l:delete i.item,h?i.choice=h:delete i.choice,u}constructor(e,t=null,s="itemvalue"){super(),this.typeName=s,this.ownerPropertyName="",t&&(this.locText.text=t),e&&"object"==typeof e?this.setData(e,!0):this.setValue(e,!0),"itemvalue"!=this.getType()&&v.createProperties(this),this.data=this,this.onCreating()}onCreating(){}getType(){return this.typeName?this.typeName:"itemvalue"}getSurvey(e=!1){return this.locOwner&&this.locOwner.getSurvey?this.locOwner.getSurvey():null}getLocale(){return this.locOwner&&this.locOwner.getLocale?this.locOwner.getLocale():""}get isInternal(){return!0===this.isGhost}createLocText(){let e=new ej(this,!0,"text");return e.onStrChanged=(e,t)=>{this.propertyValueChanged("text",e,t)},e.onGetTextCallback=e=>e||this.getValueText(),e}getValueText(){let e=this.value;return a.isValueEmpty(e)?null:e.toString()}get locText(){return this.locTextValue||(this.locTextValue=this.createLocText()),this.locTextValue}setLocText(e){this.locTextValue=e}get locOwner(){return this._locOwner}set locOwner(e){this._locOwner=e}get value(){return this.getPropertyValue("value")}set value(e){this.setValue(e,!1)}setValue(e,t){let s;if(!a.isValueEmpty(e)){var i=e.toString(),r=i.indexOf(tp.itemValueSeparator);r>-1&&(e=i.slice(0,r),s=i.slice(r+1))}t?this.setPropertyValueDirectly("value",e):this.setPropertyValue("value",e),s&&(this.text=s),this.id=this.value}get hasText(){return!!this.pureText}get pureText(){var e;return(null===(e=this.locTextValue)||void 0===e?void 0:e.pureText)||""}set pureText(e){this.text=e}get text(){return this.calculatedText}set text(e){this.locText.text=e}get textOrHtml(){return this.locTextValue?this.locText.textOrHtml:this.getValueText()}get calculatedText(){return this.locTextValue?this.locText.calculatedText:this.getValueText()}get shortcutText(){return this.text}canSerializeValue(){let e=this.value;return null!=e&&!Array.isArray(e)&&"object"!=typeof e}getData(){var e=this.toJSON();if(e.value&&e.value.pos&&delete e.value.pos,a.isValueEmpty(e.value))return e;let t=this.canSerializeValue();return t&&(tp.serialization.itemValueSerializeAsObject||tp.serialization.itemValueSerializeDisplayText)||1!=Object.keys(e).length?(tp.serialization.itemValueSerializeDisplayText&&void 0===e.text&&t&&(e.text=this.value.toString()),e):this.value}toJSON(){var e={},t=E.getProperties(this.getType());t&&0!=t.length||(t=E.getProperties("itemvalue"));for(var s=new I,i=0;i<t.length;i++){let r=t[i];"text"===r.name&&(!this.locTextValue||!this.locTextValue.hasNonDefaultText()&&a.isTwoValueEquals(this.value,this.locTextValue.getLocaleText(""),!1,!0,!1))||s.valueToJson(this,e,r)}return e}setData(e,t){var s;if(!a.isValueEmpty(e)){if(void 0===e.value&&void 0!==e.text&&1===Object.keys(e).length&&(e.value=e.text),void 0!==e.value){let t;t="function"==typeof e.toJSON?e.toJSON():e,new I().toObject(t,this)}else this.setValue(e,t);t||null===(s=this.locTextValue)||void 0===s||s.strChanged()}}get visibleIf(){return this.getPropertyValueWithoutDefault("visibleIf")||""}set visibleIf(e){this.setPropertyValue("visibleIf",e)}get enableIf(){return this.getPropertyValueWithoutDefault("enableIf")||""}set enableIf(e){this.setPropertyValue("enableIf",e)}get isVisible(){let e=this.getPropertyValueWithoutDefault("isVisible");return void 0===e||e}setIsVisible(e){this.setPropertyValue("isVisible",e)}get isEnabled(){let e=this.getPropertyValueWithoutDefault("isEnabled");return void 0===e||e}setIsEnabled(e){this.setPropertyValue("isEnabled",e)}addUsedLocales(e){this.locTextValue&&this.AddLocStringToUsedLocales(this.locTextValue,e)}locStrsChanged(){var e;super.locStrsChanged(),null===(e=this.locTextValue)||void 0===e||e.strChanged()}onPropertyValueChanged(e,t,s){"value"!==e||this.hasText||null===(i=this.locTextValue)||void 0===i||i.strChanged();var i,r="itemValuePropertyChanged";this.locOwner&&this.locOwner[r]&&this.locOwner[r](this,e,t,s)}getConditionRunner(e){return e?this.getVisibleConditionRunner():this.getEnableConditionRunner()}getVisibleConditionRunner(){return this.visibleIf?(this.visibleConditionRunner||(this.visibleConditionRunner=new el(this.visibleIf)),this.visibleConditionRunner.expression=this.visibleIf,this.visibleConditionRunner):null}getEnableConditionRunner(){return this.enableIf?(this.enableConditionRunner||(this.enableConditionRunner=new el(this.enableIf)),this.enableConditionRunner.expression=this.enableIf,this.enableConditionRunner):null}get selected(){let e=this._locOwner;return e instanceof tU&&e.isItemSelected&&void 0===this.selectedValue&&(this.selectedValue=new ec(()=>e.isItemSelected(this))),this.selectedValue}getComponent(){return this._locOwner instanceof tU?this.componentValue||this._locOwner.itemComponent:this.componentValue}setComponent(e){this.componentValue=e}setRootElement(e){this._htmlElement=e}getRootElement(){return this._htmlElement}getEnabled(){return this.isEnabled}setEnabled(e){this.setIsEnabled(e)}getVisible(){let e=void 0===this.isVisible||this.isVisible,t=void 0===this._visible||this._visible;return e&&t}setVisible(e){this.visible!==e&&(this._visible=e)}get _visible(){return this.getPropertyValue("visible",!0)}set _visible(e){this.setPropertyValue("visible",e)}getLocTitle(){return this.locText}getTitle(){return this.text}setLocTitle(e){}setTitle(e){}get icon(){return this.getPropertyValue("icon","")}set icon(e){this.setPropertyValue("icon",e)}}ey([c()],tJ.prototype,"selectedValue",void 0),eg.createItemValue=function(e,t){var s=null;return(s=t?I.metaData.createClass(t,{}):"function"==typeof e.getType?new tJ(null,void 0,e.getType()):new tJ(null)).setData(e),s},eg.itemValueLocStrChanged=function(e){tJ.locStrsChanged(e)},m.getItemValuesDefaultValue=(e,t)=>{let s=[];return tJ.setData(s,Array.isArray(e)?e:[],t),s},E.addClass("itemvalue",[{name:"!value",isUnique:!0},{name:"text",serializationProperty:"locText"},{name:"visibleIf:condition",locationInTable:"detail"},{name:"enableIf:condition",locationInTable:"detail",visibleIf:e=>!e||"rateValues"!==e.ownerPropertyName}],e=>new tJ(e));class tG extends eg{constructor(e=null,t=null){super(),this.expressionIsRunning=!1,this.isCalculated=!1,e&&(this.name=e),t&&(this.expression=t)}setOwner(e){this.data=e,this.rerunExpression()}getType(){return"calculatedvalue"}getSurvey(e=!1){return this.data&&this.data.getSurvey?this.data.getSurvey():null}get owner(){return this.data}get name(){return this.getPropertyValue("name")||""}set name(e){this.setPropertyValue("name",e)}get includeIntoResult(){return this.getPropertyValue("includeIntoResult")}set includeIntoResult(e){this.setPropertyValue("includeIntoResult",e)}get expression(){return this.getPropertyValue("expression")||""}set expression(e){this.setPropertyValue("expression",e),this.rerunExpression()}locCalculation(){this.expressionIsRunning=!0}unlocCalculation(){this.expressionIsRunning=!1}resetCalculation(){this.isCalculated=!1}doCalculation(e,t,s){this.isCalculated||(this.runExpressionCore(e,t,s),this.isCalculated=!0)}runExpression(e,t){this.runExpressionCore(null,e,t)}get value(){if(this.data)return this.data.getVariable(this.name)}setValue(e){this.data&&this.data.setVariable(this.name,e)}get canRunExpression(){return!!this.data&&!this.isLoadingFromJson&&!!this.expression&&!this.expressionIsRunning&&!!this.name}rerunExpression(){this.canRunExpression&&this.runExpression(this.data.getFilteredValues(),this.data.getFilteredProperties())}runExpressionCore(e,t,s){this.canRunExpression&&(this.ensureExpression(t),this.locCalculation(),e&&this.runDependentExpressions(e,t,s),this.expressionRunner.run(t,s))}runDependentExpressions(e,t,s){var i=this.expressionRunner.getVariables();if(i)for(var r=0;r<e.length;r++){var n=e[r];n===this||0>i.indexOf(n.name)||(n.doCalculation(e,t,s),t[n.name]=n.value)}}ensureExpression(e){this.expressionRunner||(this.expressionRunner=new eh(this.expression),this.expressionRunner.onRunComplete=e=>{a.isTwoValueEquals(e,this.value,!1,!0,!1)||this.setValue(e),this.unlocCalculation()})}}E.addClass("calculatedvalue",[{name:"!name",isUnique:!0},"expression:expression","includeIntoResult:boolean"],function(){return new tG},"base");class tK extends eg{constructor(e=null){super(),this.expression=e}getType(){return"expressionitem"}runCondition(e,t){return!!this.expression&&new el(this.expression).run(e,t)}get expression(){return this.getPropertyValue("expression","")}set expression(e){this.setPropertyValue("expression",e)}get locHtml(){return this.getLocalizableString("html")}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t){return this.locOwner?this.locOwner.getMarkdownHtml(e,t):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}getSurvey(e=!1){return this.locOwner}}class tY extends tK{constructor(e=null,t=null){super(e),this.createLocalizableString("html",this),this.html=t}getType(){return"htmlconditionitem"}get html(){return this.getLocalizableStringText("html")}set html(e){this.setLocalizableStringText("html",e)}get locHtml(){return this.getLocalizableString("html")}}class tX extends tK{constructor(e=null,t=null){super(e),this.createLocalizableString("url",this),this.url=t}getType(){return"urlconditionitem"}get url(){return this.getLocalizableStringText("url")}set url(e){this.setLocalizableStringText("url",e)}get locUrl(){return this.getLocalizableString("url")}}E.addClass("expressionitem",["expression:condition"],function(){return new tK},"base"),E.addClass("htmlconditionitem",[{name:"html:html",serializationProperty:"locHtml"}],function(){return new tY},"expressionitem"),E.addClass("urlconditionitem",[{name:"url:string",serializationProperty:"locUrl"}],function(){return new tX},"expressionitem");class t${constructor(){this.parser=new DOMParser}assignValue(e,t,s){Array.isArray(e[t])?e[t].push(s):void 0!==e[t]?e[t]=[e[t]].concat(s):"object"==typeof s&&1===Object.keys(s).length&&Object.keys(s)[0]===t?e[t]=s[t]:e[t]=s}xml2Json(e,t){if(e.children&&e.children.length>0)for(let s=0;s<e.children.length;s++){let i=e.children[s],r={};this.xml2Json(i,r),this.assignValue(t,i.nodeName,r)}else this.assignValue(t,e.nodeName,e.textContent)}parseXmlString(e){let t=this.parser.parseFromString(e,"text/xml"),s={};return this.xml2Json(t,s),s}}class tZ extends eg{static get EncodeParameters(){return tp.web.encodeUrlParams}static set EncodeParameters(e){tp.web.encodeUrlParams=e}static clearCache(){tZ.itemsResult={},tZ.sendingSameRequests={}}static addSameRequest(e){if(!e.isUsingCache)return!1;var t=e.objHash,s=tZ.sendingSameRequests[t];return s?(s.push(e),e.isRunningValue=!0,!0):(tZ.sendingSameRequests[e.objHash]=[],!1)}static unregisterSameRequests(e,t){if(e.isUsingCache){var s=tZ.sendingSameRequests[e.objHash];if(delete tZ.sendingSameRequests[e.objHash],s)for(var i=0;i<s.length;i++)s[i].isRunningValue=!1,s[i].getResultCallback&&s[i].getResultCallback(t)}}static get onBeforeSendRequest(){return tp.web.onBeforeRequestChoices}static set onBeforeSendRequest(e){tp.web.onBeforeRequestChoices=e}static getCachedItemsResult(e){var t=e.objHash,s=tZ.itemsResult[t];return!!s&&(e.getResultCallback&&e.getResultCallback(s),!0)}constructor(){super(),this.lastObjHash="",this.isRunningValue=!1,this.processedUrl="",this.processedPath="",this.isUsingCacheFromUrl=void 0,this.error=null,this.createItemValue=e=>new tJ(e),this.registerPropertyChangedHandlers(["url"],()=>{this.owner&&this.owner.setPropertyValue("isUsingRestful",!!this.url)})}getSurvey(e=!1){return this.owner?this.owner.survey:null}run(e=null){if(!!this.url&&!!this.getResultCallback){if(this.processedText(e),!this.processedUrl){this.doEmptyResultCallback({}),this.lastObjHash=this.objHash;return}if(this.lastObjHash!==this.objHash)this.lastObjHash=this.objHash,this.error=null,!this.useChangedItemsResults()&&(tZ.addSameRequest(this)||this.sendRequest())}}get isUsingCache(){return!0===this.isUsingCacheFromUrl||!1!==this.isUsingCacheFromUrl&&tp.web.cacheLoadedChoices}get isRunning(){return this.getIsRunning()}getIsRunning(){return this.isRunningValue}get isWaitingForParameters(){return this.url&&!this.processedUrl}useChangedItemsResults(){return tZ.getCachedItemsResult(this)}doEmptyResultCallback(e){var t=[];this.updateResultCallback&&(t=this.updateResultCallback(t,e)),this.getResultCallback(t)}processedText(e){var t=this.url;if(t&&(t=t.replace(tZ.cacheText,"").replace(tZ.noCacheText,"")),e){var s=e.processTextEx({text:t,runAtDesign:!0}),i=e.processTextEx({text:this.path,runAtDesign:!0});s.hasAllValuesOnLastRun&&i.hasAllValuesOnLastRun?(this.processedUrl=s.text,this.processedPath=i.text):(this.processedUrl="",this.processedPath="")}else this.processedUrl=t,this.processedPath=this.path;this.onProcessedUrlCallback&&this.onProcessedUrlCallback(this.processedUrl,this.processedPath)}parseResponse(e){let t;if(e&&"function"==typeof e.indexOf&&0===e.indexOf("<"))t=new t$().parseXmlString(e);else try{t=JSON.parse(e)}catch(s){t=(e||"").split("\n").map(e=>e.trim(" ")).filter(e=>!!e)}return t}sendRequest(){var e=new XMLHttpRequest;e.open("GET",this.processedUrl),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var t=this,s=this.objHash;e.onload=function(){t.beforeLoadRequest(),200===e.status?t.onLoad(t.parseResponse(e.response),s):t.onError(e.statusText,e.responseText)};var i={request:e};tp.web.onBeforeRequestChoices&&tp.web.onBeforeRequestChoices(this,i),this.beforeSendRequest(),i.request.send()}getType(){return"choicesByUrl"}get isEmpty(){return!this.url&&!this.path}getCustomPropertiesNames(){for(var e=this.getCustomProperties(),t=[],s=0;s<e.length;s++)t.push(this.getCustomPropertyName(e[s].name));return t}getCustomPropertyName(e){return e+"Name"}getCustomProperties(){for(var e=E.getProperties(this.itemValueType),t=[],s=0;s<e.length;s++)"value"!==e[s].name&&"text"!==e[s].name&&"visibleIf"!==e[s].name&&"enableIf"!==e[s].name&&t.push(e[s]);return t}getAllPropertiesNames(){let e=[];return E.getPropertiesByObj(this).forEach(t=>e.push(t.name)),this.getCustomPropertiesNames().forEach(t=>e.push(t)),e}setData(e){e||(e={}),this.getAllPropertiesNames().forEach(t=>{this[t]=e[t]})}getData(){let e={},t=!1;return this.getAllPropertiesNames().forEach(s=>{let i=this[s];this.isValueEmpty(i)||i===this.getDefaultPropertyValue(s)||(e[s]=i,t=!0)}),t?e:null}get url(){return this.getPropertyValue("url")||""}set url(e){this.setPropertyValue("url",e),this.isUsingCacheFromUrl=void 0,e&&(e.indexOf(tZ.cacheText)>-1?this.isUsingCacheFromUrl=!0:e.indexOf(tZ.noCacheText)>-1&&(this.isUsingCacheFromUrl=!1))}get path(){return this.getPropertyValue("path")||""}set path(e){this.setPropertyValue("path",e)}get valueName(){return this.getPropertyValue("valueName","")}set valueName(e){this.setPropertyValue("valueName",e)}get titleName(){return this.getPropertyValue("titleName","")}set titleName(e){this.setPropertyValue("titleName",e)}get imageLinkName(){return this.getPropertyValue("imageLinkName","")}set imageLinkName(e){this.setPropertyValue("imageLinkName",e)}get allowEmptyResponse(){return this.getPropertyValue("allowEmptyResponse")}set allowEmptyResponse(e){this.setPropertyValue("allowEmptyResponse",e)}get attachOriginalItems(){return this.getPropertyValue("attachOriginalItems")}set attachOriginalItems(e){this.setPropertyValue("attachOriginalItems",e)}get itemValueType(){if(!this.owner)return"itemvalue";var e=E.findProperty(this.owner.getType(),"choices");return e&&"itemvalue[]"!=e.type?e.type:"itemvalue"}clear(){this.setData(void 0)}beforeSendRequest(){this.isRunningValue=!0,this.beforeSendRequestCallback&&this.beforeSendRequestCallback()}beforeLoadRequest(){this.isRunningValue=!1}onLoad(e,t=null){t||(t=this.objHash);var s=[],i=this.getResultAfterPath(e);if(i&&i.length)for(var r=0;r<i.length;r++){var n=i[r];if(n){var a=this.getItemValueCallback?this.getItemValueCallback(n):this.getValue(n),o=this.createItemValue(a);this.setTitle(o,n),this.setCustomProperties(o,n),this.attachOriginalItems&&(o.originalItem=n);var l=this.getImageLink(n);l&&(o.imageLink=l),s.push(o)}}else this.allowEmptyResponse||(this.error=new tx(null,this.owner));this.updateResultCallback&&(s=this.updateResultCallback(s,e)),this.isUsingCache&&(tZ.itemsResult[t]=s),this.callResultCallback(s,t),tZ.unregisterSameRequests(this,s)}callResultCallback(e,t){t==this.objHash&&this.getResultCallback(e)}setCustomProperties(e,t){for(var s=this.getCustomProperties(),i=0;i<s.length;i++){var r=s[i],n=this.getValueCore(t,this.getPropertyBinding(r.name));this.isValueEmpty(n)||(e[r.name]=n)}}getPropertyBinding(e){return this[this.getCustomPropertyName(e)]?this[this.getCustomPropertyName(e)]:this[e]?this[e]:e}onError(e,t){this.error=new tw(e,t,this.owner),this.doEmptyResultCallback(t),tZ.unregisterSameRequests(this,[])}getResultAfterPath(e){if(!e||!this.processedPath)return e;for(var t=this.getPathes(),s=0;s<t.length;s++)if(!(e=e[t[s]]))return null;return e}getPathes(){var e=[];return 0==(e=this.processedPath.indexOf(";")>-1?this.path.split(";"):this.processedPath.indexOf(",")>-1?this.processedPath.split(","):this.processedPath.split(".")).length&&e.push(this.processedPath),e}getValue(e){return e?this.valueName?this.getValueCore(e,this.valueName):e instanceof Object?Object.keys(e).length<1?null:e[Object.keys(e)[0]]:e:null}setTitle(e,t){var s=this.titleName?this.titleName:"title",i=this.getValueCore(t,s);i&&("string"==typeof i?e.text=i:e.locText.setJson(i))}getImageLink(e){var t=this.imageLinkName?this.imageLinkName:"imageLink";return this.getValueCore(e,t)}getValueCore(e,t){if(!e)return null;if(0>t.indexOf("."))return e[t];for(var s=t.split("."),i=0;i<s.length;i++)if(!(e=e[s[i]]))return null;return e}get objHash(){return this.processedUrl+";"+this.processedPath+";"+this.valueName+";"+this.titleName+";"+this.imageLinkName}}tZ.cacheText="{CACHE}",tZ.noCacheText="{NOCACHE}",tZ.itemsResult={},tZ.sendingSameRequests={},E.addClass("choicesByUrl",["url","path","valueName","titleName",{name:"imageLinkName",visibleIf:function(e){return!!e&&!!e.owner&&"imagepicker"==e.owner.getType()}},{name:"allowEmptyResponse:boolean"},{name:"attachOriginalItems:boolean",visible:!1}],function(){return new tZ});class t0 extends tU{createColumnValues(){return this.createItemValues("columns")}constructor(e){super(e),this.generatedVisibleRows=null,this.generatedTotalRow=null,this.filteredRows=null,this.columns=this.createColumnValues(),this.rows=this.createItemValues("rows")}getType(){return"matrixbase"}endLoadingFromJson(){super.endLoadingFromJson(),this.updateVisibilityBasedOnRows()}get isCompositeQuestion(){return!0}get showHeader(){return this.getPropertyValue("showHeader")}set showHeader(e){this.setPropertyValue("showHeader",e)}get columns(){return this.getPropertyValue("columns")}set columns(e){this.setPropertyValue("columns",e)}get visibleColumns(){let e=[];return this.columns.forEach(t=>{this.isColumnVisible(t)&&e.push(t)}),e}isColumnVisible(e){return e.isVisible}get rows(){return this.getPropertyValue("rows")}set rows(e){var t=this.processRowsOnSet(e);this.setPropertyValue("rows",t)}processRowsOnSet(e){return e}getVisibleRows(){return[]}get visibleRows(){return this.getVisibleRows()}get rowsVisibleIf(){return this.getPropertyValue("rowsVisibleIf","")}set rowsVisibleIf(e){this.setPropertyValue("rowsVisibleIf",e),this.isLoadingFromJsonValue||this.runCondition(this.getDataFilteredValues(),this.getDataFilteredProperties())}get columnsVisibleIf(){return this.getPropertyValue("columnsVisibleIf","")}set columnsVisibleIf(e){this.setPropertyValue("columnsVisibleIf",e),this.isLoadingFromJson||this.runCondition(this.getDataFilteredValues(),this.getDataFilteredProperties())}runConditionCore(e,t){super.runConditionCore(e,t),this.runItemsCondition(e,t)}onColumnsChanged(){}onRowsChanged(){this.updateVisibilityBasedOnRows(),this.fireCallback(this.visibleRowsChangedCallback)}updateVisibilityBasedOnRows(){this.hideIfRowsEmpty&&this.onVisibleChanged()}isVisibleCore(){var e;let t=super.isVisibleCore();return t&&this.hideIfRowsEmpty?(null===(e=this.visibleRows)||void 0===e?void 0:e.length)>0:t}shouldRunColumnExpression(){return!this.survey||!this.survey.areInvisibleElementsShowing}hasRowsAsItems(){return!0}runItemsCondition(e,t){let s=this.hasRowsAsItems()&&this.runConditionsForRows(e,t),i=this.runConditionsForColumns(e,t);(s=i||s)&&(this.isClearValueOnHidden&&i&&this.clearInvisibleColumnValues(),this.clearGeneratedRows(),i&&this.onColumnsChanged(),this.onRowsChanged())}isRowsFiltered(){return!!this.filteredRows}clearGeneratedRows(){this.generatedVisibleRows=null}createRowsVisibleIfRunner(){return null}runConditionsForRows(e,t){let s=!!this.survey&&this.survey.areInvisibleElementsShowing,i=s?null:this.createRowsVisibleIfRunner();this.filteredRows=[];let r=tJ.runConditionsForItems(this.rows,this.filteredRows,i,e,t,!s);return tJ.runEnabledConditionsForItems(this.rows,void 0,e,t),this.filteredRows.length===this.rows.length&&(this.filteredRows=null),r}runConditionsForColumns(e,t){let s=this.survey&&!this.survey.areInvisibleElementsShowing&&this.columnsVisibleIf?new el(this.columnsVisibleIf):null;return tJ.runConditionsForItems(this.columns,void 0,s,e,t,this.shouldRunColumnExpression())}clearInvisibleColumnValues(){}clearInvisibleValuesInRows(){}needResponsiveWidth(){return!0}get columnsAutoWidth(){return!this.isMobile&&!this.columns.some(e=>!!e.width)}getTableCss(){var e;return new eV().append(this.cssClasses.root).append(this.cssClasses.columnsAutoWidth,this.columnsAutoWidth).append(this.cssClasses.noHeader,!this.showHeader).append(this.cssClasses.hasFooter,!!(null===(e=this.renderedTable)||void 0===e?void 0:e.showAddRowOnBottom)).append(this.cssClasses.rootAlternateRows,this.alternateRows).append(this.cssClasses.rootVerticalAlignTop,"top"===this.verticalAlign).append(this.cssClasses.rootVerticalAlignMiddle,"middle"===this.verticalAlign).toString()}get columnMinWidth(){return this.getPropertyValue("columnMinWidth")||""}set columnMinWidth(e){this.setPropertyValue("columnMinWidth",e)}get rowTitleWidth(){return this.getPropertyValue("rowTitleWidth")||""}set rowTitleWidth(e){this.setPropertyValue("rowTitleWidth",e)}set displayMode(e){this.setPropertyValue("displayMode",e)}get displayMode(){return this.getPropertyValue("displayMode")}getCellAriaLabel(e,t){let s=(this.getLocalizationString("matrix_row")||"row").toLocaleLowerCase(),i=(this.getLocalizationString("matrix_column")||"column").toLocaleLowerCase();return`${s} ${e}, ${i} ${t}`}get isNewA11yStructure(){return!0}getIsMobile(){return"auto"==this.displayMode?super.getIsMobile():"list"===this.displayMode}}ey([c()],t0.prototype,"verticalAlign",void 0),ey([c()],t0.prototype,"alternateRows",void 0),E.addClass("matrixbase",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},"columnsVisibleIf:condition","rowsVisibleIf:condition","columnMinWidth",{name:"showHeader:boolean",default:!0},{name:"verticalAlign",choices:["top","middle"],default:"middle"},{name:"alternateRows:boolean",default:!1},{name:"displayMode",default:"auto",choices:["auto","table","list"],visible:!1}],void 0,"question");class t1{}class t2{constructor(e,t){this.name=e,this.returnDisplayValue=t,this.isExists=!1,this.canProcess=!0}}class t4{constructor(){this._unObservableValues=[void 0]}get hasAllValuesOnLastRunValue(){return this._unObservableValues[0]}set hasAllValuesOnLastRunValue(e){this._unObservableValues[0]=e}process(e,t,s,i){if(this.hasAllValuesOnLastRunValue=!0,!e||!this.onProcess)return e;let r=this.getItems(e);for(let o=r.length-1;o>=0;o--){let l=r[o],h=this.getName(e.substring(l.start+1,l.end));if(h){let r=new t2(h,!0===t);if(this.onProcess(r),!r.isExists&&r.canProcess&&(this.hasAllValuesOnLastRunValue=!1),r.isExists||i){a.isValueEmpty(r.value)&&(this.hasAllValuesOnLastRunValue=!1);var n=a.isValueEmpty(r.value)?"":r.value;s&&(n=encodeURIComponent(n)),e=e.substring(0,l.start)+n+e.substring(l.end+1)}}}return e}processValue(e,t){var s=new t2(e,t);return this.onProcess&&this.onProcess(s),s}get hasAllValuesOnLastRun(){return!!this.hasAllValuesOnLastRunValue}processText(e,t){return this.process(e,t)}processTextEx(e){let t={hasAllValuesOnLastRun:!0,text:e.text};return t.text=this.process(e.text,e.returnDisplayValue,e.doEncoding,e.replaceUndefinedValues),t.hasAllValuesOnLastRun=this.hasAllValuesOnLastRun,t}getItems(e){for(var t=[],s=e.length,i=-1,r="",n=0;n<s;n++)if("{"==(r=e[n])&&(i=n),"}"==r){if(i>-1){var a=new t1;a.start=i,a.end=n,this.isValidItemName(e.substring(i+1,n-1))&&t.push(a)}i=-1}return t}isValidItemName(e){return!!e&&0>e.indexOf(":")}getName(e){if(e)return e.trim()}}class t3{constructor(e){this.variableName=e,this.textPreProcessor=new t4,this.textPreProcessor.onProcess=e=>{this.getProcessedTextValue(e)}}processValue(e,t){return this.textPreProcessor.processValue(e,t)}get survey(){return null}get panel(){return null}getValues(){return this.panel?this.panel.getValue():null}getQuestionByName(e){return this.panel?this.panel.getQuestionByValueName(e):null}getParentTextProcessor(){return null}onCustomProcessText(e){return!1}getQuestionDisplayText(e){return e.displayValue}getProcessedTextValue(e){if(!(!e||this.onCustomProcessText(e))){var t=new A().getFirstName(e.name);if(e.isExists=t==this.variableName,e.canProcess=e.isExists,e.canProcess){e.name=e.name.replace(this.variableName+".","");var t=new A().getFirstName(e.name),s=this.getQuestionByName(t),i={};if(s)i[t]=e.returnDisplayValue?this.getQuestionDisplayText(s):s.value;else{var r=this.panel?this.getValues():null;r&&(i[t]=r[t])}e.value=new A().getValue(e.name,i)}}}processText(e,t){return this.processTextEx({text:e,returnDisplayValue:t}).text}processTextEx(e){var t;let s={hasAllValuesOnLastRun:!0,text:e.text};if(!e.runAtDesign&&(null===(t=this.survey)||void 0===t?void 0:t.isDesignMode))return s;let i=[];this.addTextPreProcessor(i,this.textPreProcessor),this.addTextPreProcessor(i,this.getParentTextProcessor()),this.addTextPreProcessor(i,this.survey);for(let t=0;t<i.length;t++){let r=i[t];e.text=s.text;let n=r.processTextEx(e);s.text=n.text,s.hasAllValuesOnLastRun=s.hasAllValuesOnLastRun&&n.hasAllValuesOnLastRun}return s}addTextPreProcessor(e,t){!t||e.indexOf(t)>-1||e.push(t)}}class t6{constructor(e,t){this.name=e,this.json=t;var s=this;E.addClass(e,[],function(e){return t5.Instance.createQuestion(e?e.name:"",s)},"question"),this.onInit()}onInit(){this.json.onInit&&this.json.onInit()}onCreated(e){this.json.onCreated&&this.json.onCreated(e)}onLoaded(e){this.json.onLoaded&&this.json.onLoaded(e)}onAfterRender(e,t){this.json.onAfterRender&&this.json.onAfterRender(e,t)}onAfterRenderContentElement(e,t,s){this.json.onAfterRenderContentElement&&this.json.onAfterRenderContentElement(e,t,s)}onUpdateQuestionCssClasses(e,t,s){this.json.onUpdateQuestionCssClasses&&this.json.onUpdateQuestionCssClasses(e,t,s)}onSetQuestionValue(e,t){this.json.onSetQuestionValue&&this.json.onSetQuestionValue(e,t),this.json.onValueSet&&this.json.onValueSet(e,t)}onPropertyChanged(e,t,s){this.json.onPropertyChanged&&this.json.onPropertyChanged(e,t,s)}onValueChanged(e,t,s){this.json.onValueChanged&&this.json.onValueChanged(e,t,s)}onValueChanging(e,t,s){return this.json.onValueChanging?this.json.onValueChanging(e,t,s):s}onGetErrorText(e){if(this.json.getErrorText)return this.json.getErrorText(e)}onItemValuePropertyChanged(e,t,s,i,r){this.json.onItemValuePropertyChanged&&this.json.onItemValuePropertyChanged(e,{obj:t,propertyName:s,name:i,newValue:r})}getDisplayValue(e,t,s){return this.json.getDisplayValue?this.json.getDisplayValue(s):s.getDisplayValue(e,t)}get defaultQuestionTitle(){return this.json.defaultQuestionTitle}setValueToQuestion(e){let t=this.json.valueToQuestion||this.json.setValue;return t?t(e):e}getValueFromQuestion(e){let t=this.json.valueFromQuestion||this.json.getValue;return t?t(e):e}get isComposite(){return!!this.json.elementsJSON||!!this.json.createElements}getDynamicProperties(){return Array.isArray(this.dynamicProperties)||(this.dynamicProperties=this.calcDynamicProperties()),this.dynamicProperties}calcDynamicProperties(){let e=this.json.inheritBaseProps;if(!e||!this.json.questionJSON)return[];let t=this.json.questionJSON.type;if(!t)return[];if(Array.isArray(e)){let s=[];return e.forEach(e=>{let i=E.findProperty(t,e);i&&s.push(i)}),s}let s=[];for(let e in this.json.questionJSON)s.push(e);return E.getDynamicPropertiesByTypes(this.name,t,s)}}class t5{constructor(){this.customQuestionValues=[]}add(e){if(!e)return;let t=e.name;if(!t)throw"Attribute name is missed";if(t=t.toLowerCase(),this.getCustomQuestionByName(t))throw"There is already registered custom question with name '"+t+"'";if(E.findClass(t))throw"There is already class with name '"+t+"'";var s=new t6(t,e);this.onAddingJson&&this.onAddingJson(t,s.isComposite),this.customQuestionValues.push(s)}remove(e){if(!e)return!1;let t=this.getCustomQuestionIndex(e.toLowerCase());return!(t<0)&&(this.removeByIndex(t),!0)}get items(){return this.customQuestionValues}getCustomQuestionByName(e){let t=this.getCustomQuestionIndex(e);return t>=0?this.customQuestionValues[t]:void 0}getCustomQuestionIndex(e){for(var t=0;t<this.customQuestionValues.length;t++)if(this.customQuestionValues[t].name===e)return t;return -1}removeByIndex(e){E.removeClass(this.customQuestionValues[e].name),this.customQuestionValues.splice(e,1)}clear(e){for(let t=this.customQuestionValues.length-1;t>=0;t--)(e||!this.customQuestionValues[t].json.internal)&&this.removeByIndex(t)}createQuestion(e,t){return t.isComposite?this.createCompositeModel(e,t):this.createCustomModel(e,t)}createCompositeModel(e,t){return this.onCreateComposite?this.onCreateComposite(e,t):new se(e,t)}createCustomModel(e,t){return this.onCreateCustom?this.onCreateCustom(e,t):new t8(e,t)}}t5.Instance=new t5;class t9 extends tU{constructor(e,t){super(e),this.customQuestion=t,v.createProperties(this),eW.CreateDisabledDesignElements=!0,this.locQuestionTitle=this.createLocalizableString("questionTitle",this),this.locQuestionTitle.setJson(this.customQuestion.defaultQuestionTitle),this.createWrapper(),eW.CreateDisabledDesignElements=!1,this.customQuestion&&this.customQuestion.onCreated(this)}getType(){return this.customQuestion?this.customQuestion.name:"custom"}locStrsChanged(){super.locStrsChanged(),this.getElement()&&this.getElement().locStrsChanged()}localeChanged(){super.locStrsChanged(),this.getElement()&&this.getElement().localeChanged()}getDefaultTitle(){return this.locQuestionTitle.isEmpty?super.getDefaultTitle():this.getProcessedText(this.locQuestionTitle.textOrHtml)}addUsedLocales(e){super.addUsedLocales(e),this.getElement()&&this.getElement().addUsedLocales(e)}needResponsiveWidth(){let e=this.getElement();return!!e&&e.needResponsiveWidth()}createWrapper(){}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),this.customQuestion&&!this.isLoadingFromJson&&this.customQuestion.onPropertyChanged(this,e,s)}itemValuePropertyChanged(e,t,s,i){super.itemValuePropertyChanged(e,t,s,i),this.customQuestion&&!this.isLoadingFromJson&&this.customQuestion.onItemValuePropertyChanged(this,e,e.ownerPropertyName,t,i)}onFirstRenderingCore(){super.onFirstRenderingCore();let e=this.getElement();e&&e.onFirstRendering()}onHidingContent(){super.onHidingContent();let e=this.getElement();e&&e.onHidingContent()}getProgressInfo(){let e=super.getProgressInfo();return this.getElement()&&(e=this.getElement().getProgressInfo()),this.isRequired&&0==e.requiredQuestionCount&&(e.requiredQuestionCount=1,this.isEmpty()||(e.answeredQuestionCount=1)),e}initElement(e){e&&(e.setSurveyImpl(this),e.disableDesignActions=!0)}setSurveyImpl(e,t){this.isSettingValOnLoading=!0,super.setSurveyImpl(e,t),this.initElement(this.getElement()),this.isSettingValOnLoading=!1}onSurveyLoad(){super.onSurveyLoad(),this.getElement()&&(this.getElement().onSurveyLoad(),this.customQuestion.onLoaded(this))}afterRenderQuestionElement(e){}afterRenderCore(e){super.afterRenderCore(e),this.customQuestion&&this.customQuestion.onAfterRender(this,e)}onUpdateQuestionCssClasses(e,t){this.customQuestion&&this.customQuestion.onUpdateQuestionCssClasses(this,e,t)}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.updateElementCss(),this.customQuestion&&this.customQuestion.onSetQuestionValue(this,e)}setNewValue(e){super.setNewValue(e),this.updateElementCss()}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),this.customQuestion){let t=this.customQuestion.onGetErrorText(this);t&&e.push(new tA(t,this))}}getSurveyData(){return this}getTextProcessor(){return this.textProcessor}getValue(e){return this.value}setValue(e,t,s,i){if(!this.data)return;this.customQuestion&&this.customQuestion.onValueChanged(this,e,t);var r=this.convertDataName(e);let n=this.convertDataValue(e,t);this.valueToDataCallback&&(n=this.valueToDataCallback(n)),this.data.setValue(r,n,s,i),this.updateIsAnswered(),this.updateElementCss()}getQuestionByName(e){}isValueChanging(e,t){if(this.customQuestion){let s=t;if(t=this.customQuestion.onValueChanging(this,e,t),!a.isTwoValueEquals(t,s)){let s=this.getQuestionByName(e);if(s)return s.value=t,!0}}return!1}convertDataName(e){return this.getValueName()}convertDataValue(e,t){return t}getVariable(e){return this.data?this.data.getVariable(e):null}setVariable(e,t){this.data&&this.data.setVariable(e,t)}getComment(e){return this.data?this.data.getComment(this.getValueName()):""}setComment(e,t,s){this.data&&this.data.setComment(this.getValueName(),t,s)}getAllValues(){return this.data?this.data.getAllValues():{}}getFilteredValues(){return this.data?this.data.getFilteredValues():{}}getFilteredProperties(){return this.data?this.data.getFilteredProperties():{}}findQuestionByName(e){return this.data?this.data.findQuestionByName(e):null}getEditingSurveyElement(){}addElement(e,t){}removeElement(e){return!1}getQuestionTitleLocation(){return"left"}getQuestionTitleWidth(){}getColumsForElement(e){return[]}updateColumns(){}getQuestionStartIndex(){return this.getStartIndex()}getChildrenLayoutType(){return"row"}elementWidthChanged(e){}get elements(){return[]}indexOf(e){return -1}ensureRowsVisibility(){}validateContainerOnly(){}onQuestionValueChanged(e){}getQuestionErrorLocation(){return this.getErrorLocation()}getContentDisplayValueCore(e,t,s){return s?this.customQuestion.getDisplayValue(e,t,s):super.getDisplayValueCore(e,t)}}class t8 extends t9{getTemplate(){return"custom"}getDynamicProperties(){return this.customQuestion.getDynamicProperties()||[]}getDynamicType(){return this.questionWrapper?this.questionWrapper.getType():"question"}getOriginalObj(){return this.questionWrapper}createWrapper(){this.questionWrapper=this.createQuestion(),this.createDynamicProperties(this.questionWrapper),this.getDynamicProperties().length>0&&(this.questionWrapper.onPropertyValueChangedCallback=(e,t,s,i,r)=>{this.getDynamicProperty(e)&&this.propertyValueChanged(e,t,s,r)})}getDynamicProperty(e){let t=this.getDynamicProperties();for(let s=0;s<t.length;s++)if(t[s].name===e)return t[s];return null}getElement(){return this.contentQuestion}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t),this.contentQuestion&&this.contentQuestion.onAnyValueChanged(e,t)}getQuestionByName(e){return this.contentQuestion}getDefaultTitle(){return this.hasJSONTitle&&this.contentQuestion?this.getProcessedText(this.contentQuestion.title):super.getDefaultTitle()}setValue(e,t,s,i){this.isValueChanging(e,t)||super.setValue(e,t,s,i)}onSetData(){super.onSetData(),this.survey&&!this.isEmpty()&&this.setValue(this.name,this.value,!1,this.allowNotifyValueChanged)}hasErrors(e=!0,t=null){if(!this.contentQuestion)return!1;var s=this.contentQuestion.hasErrors(e,t);this.errors=[];for(var i=0;i<this.contentQuestion.errors.length;i++)this.errors.push(this.contentQuestion.errors[i]);return s||(s=super.hasErrors(e,t)),this.updateElementCss(),s}focus(e=!1){this.contentQuestion?this.contentQuestion.focus(e):super.focus(e)}afterRenderCore(e){super.afterRenderCore(e),this.contentQuestion&&this.contentQuestion.afterRender(e)}get contentQuestion(){return this.questionWrapper}createQuestion(){var e=this.customQuestion.json,t=null;if(e.questionJSON){this.hasJSONTitle=!!e.questionJSON.title;let s=e.questionJSON.type;if(!s||!E.findClass(s))throw"type attribute in questionJSON is empty or incorrect";(t=E.createClass(s)).fromJSON(e.questionJSON),t=this.checkCreatedQuestion(t)}else e.createQuestion&&(t=this.checkCreatedQuestion(e.createQuestion()));return this.initElement(t),t&&(t.isContentElement=!0,t.name||(t.name="question"),t.onUpdateCssClassesCallback=e=>{this.onUpdateQuestionCssClasses(t,e)},t.hasCssErrorCallback=()=>this.errors.length>0,t.setValueChangedDirectlyCallback=e=>{this.setValueChangedDirectly(e)}),t}checkCreatedQuestion(e){return e&&(e.isQuestion||(e=Array.isArray(e.questions)&&e.questions.length>0?e.questions[0]:E.createClass("text"),D.error("Could not create component: '"+this.getType()+"'. questionJSON should be a question."))),e}onSurveyLoad(){super.onSurveyLoad(),this.contentQuestion&&this.isEmpty()&&!this.contentQuestion.isEmpty()&&(this.value=this.getContentQuestionValue())}runConditionCore(e,t){super.runConditionCore(e,t),this.contentQuestion&&this.contentQuestion.runCondition(e,t)}convertDataName(e){let t=this.contentQuestion;if(!t||e===this.getValueName())return super.convertDataName(e);var s=e.replace(t.getValueName(),this.getValueName());return 0==s.indexOf(this.getValueName())?s:super.convertDataName(e)}convertDataValue(e,t){return this.convertDataName(e)==super.convertDataName(e)?this.getContentQuestionValue():t}getContentQuestionValue(){if(!this.contentQuestion)return;let e=this.contentQuestion.value;return this.customQuestion&&(e=this.customQuestion.getValueFromQuestion(e)),e}setContentQuestionValue(e){this.contentQuestion&&(this.customQuestion&&(e=this.customQuestion.setValueToQuestion(e)),this.contentQuestion.value=e)}canSetValueToSurvey(){return!1}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.isLoadingFromJson||!this.contentQuestion||this.isTwoValueEquals(this.getContentQuestionValue(),e)||this.setContentQuestionValue(this.getUnbindValue(e))}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.contentQuestion&&this.contentQuestion.onSurveyValueChanged(e)}getValueCore(){return this.contentQuestion?this.getContentQuestionValue():super.getValueCore()}setValueChangedDirectly(e){this.isSettingValueChanged||(this.isSettingValueChanged=!0,super.setValueChangedDirectly(e),this.contentQuestion&&this.contentQuestion.setValueChangedDirectly(e),this.isSettingValueChanged=!1)}createDynamicProperties(e){if(!e)return;let t=this.getDynamicProperties();Array.isArray(t)&&E.addDynamicPropertiesIntoObj(this,e,t)}initElement(e){super.initElement(e),e&&(e.parent=this,e.afterRenderQuestionCallback=(e,t)=>{this.customQuestion&&this.customQuestion.onAfterRenderContentElement(this,e,t)})}updateElementCss(e){this.contentQuestion&&this.questionWrapper.updateElementCss(e),super.updateElementCss(e)}updateElementCssCore(e){this.contentQuestion&&(e=this.contentQuestion.cssClasses),super.updateElementCssCore(e)}getDisplayValueCore(e,t){return super.getContentDisplayValueCore(e,t,this.contentQuestion)}}class t7 extends t3{constructor(e,t){super(t),this.composite=e,this.variableName=t}get survey(){return this.composite.survey}get panel(){return this.composite.contentPanel}}class se extends t9{constructor(e,t){super(e,t),this.customQuestion=t,this.settingNewValue=!1,this.textProcessing=new t7(this,se.ItemVariableName)}createWrapper(){this.panelWrapper=this.createPanel()}getTemplate(){return"composite"}getElement(){return this.contentPanel}getCssRoot(e){return new eV().append(super.getCssRoot(e)).append(e.composite).toString()}get contentPanel(){return this.panelWrapper}hasErrors(e=!0,t=null){var s=super.hasErrors(e,t);return this.contentPanel&&this.contentPanel.hasErrors(e,!1,t)||s}updateElementCss(e){super.updateElementCss(e),this.contentPanel&&this.contentPanel.updateElementCss(e)}dispose(){this.unConnectEditingObj(),super.dispose()}updateEditingObj(){var e;let t=null===(e=this.data)||void 0===e?void 0:e.getEditingSurveyElement();if(!t)return;let s=t[this.getValueName()];return s&&!s.onPropertyChanged&&(s=void 0),s!==this.editingObjValue&&(this.unConnectEditingObj(),this.editingObjValue=s,s&&(this.onEditingObjPropertyChanged=(e,t)=>{this.setNewValueIntoQuestion(t.name,this.editingObjValue[t.name])},s.onPropertyChanged.add(this.onEditingObjPropertyChanged))),this.editingObjValue}unConnectEditingObj(){this.editingObjValue&&!this.editingObjValue.isDisposed&&this.editingObjValue.onPropertyChanged.remove(this.onEditingObjPropertyChanged)}getEditingSurveyElement(){return this.editingObjValue}getTextProcessor(){return this.textProcessing}findQuestionByName(e){let t=this.getQuestionByName(e);return t||super.findQuestionByName(e)}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e);let t=this.contentPanel.questions;for(var s=0;s<t.length;s++)t[s].clearValueIfInvisible(e)}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t);for(var s=this.contentPanel.questions,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}get hasSingleInput(){return!1}get isContainer(){return!0}createPanel(){var e=E.createClass("panel");e.showQuestionNumbers="off",e.renderWidth="100%";var t=this.customQuestion.json;return t.elementsJSON&&e.fromJSON({elements:t.elementsJSON}),t.createElements&&t.createElements(e,this),this.initElement(e),e.readOnly=this.isReadOnly,e.questions.forEach(e=>{e.setParentQuestion(this),e.onUpdateCssClassesCallback=t=>{this.onUpdateQuestionCssClasses(e,t)}}),this.setAfterRenderCallbacks(e),e}onReadOnlyChanged(){this.contentPanel&&(this.contentPanel.readOnly=this.isReadOnly),super.onReadOnlyChanged()}updateValueFromSurvey(e,t=!1){this.updateEditingObj(),super.updateValueFromSurvey(e,t)}onSurveyLoad(){if(this.isSettingValOnLoading=!0,this.contentPanel&&(this.contentPanel.readOnly=this.isReadOnly,this.setIsContentElement(this.contentPanel)),super.onSurveyLoad(),this.contentPanel){let e=this.getContentPanelValue();a.isValueEmpty(e)||(this.value=e)}this.isSettingValOnLoading=!1}setIsContentElement(e){e.isContentElement=!0;for(var t=e.elements,s=0;s<t.length;s++){var i=t[s];i.isPanel?this.setIsContentElement(i):i.isContentElement=!0}}setVisibleIndex(e){var t=super.setVisibleIndex(e);return this.isVisible&&this.contentPanel&&(t+=this.contentPanel.setVisibleIndex(e)),t}runConditionCore(e,t){if(super.runConditionCore(e,t),this.contentPanel){var s=e[se.ItemVariableName];e[se.ItemVariableName]=this.contentPanel.getValue(),this.contentPanel.runCondition(e,t),delete e[se.ItemVariableName],s&&(e[se.ItemVariableName]=s)}}onSurveyValueChanged(e){super.onSurveyValueChanged(e);let t=e||{};this.contentPanel&&this.contentPanel.questions.forEach(e=>{e.onSurveyValueChanged(t[e.getValueName()])})}getValue(e){var t=this.value;return t?t[e]:null}getQuestionByName(e){return this.contentPanel?this.contentPanel.getQuestionByName(e):void 0}setValue(e,t,s,i){if(this.settingNewValue){this.setNewValueIntoQuestion(e,t);return}if(!this.isValueChanging(e,t)){if(this.settingNewValue=!0,!this.isEditingSurveyElement&&this.contentPanel){let e=0,t=this.contentPanel.questions.length+1;for(;e<t&&this.updateValueCoreWithPanelValue();)e++}this.setNewValueIntoQuestion(e,t),super.setValue(e,t,s,i),this.settingNewValue=!1,this.runPanelTriggers(se.ItemVariableName+"."+e,t)}}setComment(e,t,s){let i=this.getUnbindValue(this.value),r=this.getCommentName(e);if(!i&&!t||t&&i&&i[r]===t)return;t?(i||(i={}),i[r]=t):delete i[r];let n=this.getQuestionByName(e);n&&n.comment!==t&&(n.comment=t),this.value=i}getComment(e){let t=this.getQuestionByName(e);if(t)return t.comment;let s=this.value;return!!s&&s[this.getCommentName(e)]||""}getCommentName(e){return e+tp.commentSuffix}runPanelTriggers(e,t){this.contentPanel&&this.contentPanel.questions.forEach(s=>{s.runTriggers(e,t)})}getFilteredValues(){let e=this.data?this.data.getFilteredValues():{};return this.contentPanel&&(e[se.ItemVariableName]=this.contentPanel.getValue()),e}updateValueCoreWithPanelValue(){let e=this.getContentPanelValue();return!this.isTwoValueEquals(this.getValueCore(),e)&&(this.setValueCore(e),!0)}getContentPanelValue(e){return e||(e=this.contentPanel.getValue()),this.customQuestion.setValueToQuestion(e)}getValueForContentPanel(e){return this.customQuestion.getValueFromQuestion(e)}setNewValueIntoQuestion(e,t){var s=this.getQuestionByName(e);s&&!this.isTwoValueEquals(t,s.value)&&(s.value=t)}addConditionObjectsByContext(e,t){if(this.contentPanel)for(var s=this.contentPanel.questions,i=this.name,r=this.title,n=0;n<s.length;n++)e.push({name:i+"."+s[n].name,text:r+"."+s[n].title,question:s[n]})}collectNestedQuestionsCore(e,t){this.contentPanel&&this.contentPanel.questions.forEach(s=>s.collectNestedQuestions(e,t))}convertDataValue(e,t){var s=this.contentPanel&&!this.isEditingSurveyElement?this.contentPanel.getValue():this.getValueForContentPanel(this.value);return s||(s={}),s.getType||(s=a.getUnbindValue(s)),this.isValueEmpty(t)&&!this.isEditingSurveyElement?delete s[e]:s[e]=t,this.getContentPanelValue(s)}setQuestionValue(e,t=!0){this.setValuesIntoQuestions(e),!this.isEditingSurveyElement&&this.contentPanel&&(e=this.getContentPanelValue()),super.setQuestionValue(e,t)}setValuesIntoQuestions(e){if(!this.contentPanel||this.settingNewValue)return;e=this.getValueForContentPanel(e);let t=this.settingNewValue;this.settingNewValue=!0;let s=this.contentPanel.questions;for(var i=0;i<s.length;i++){let t=s[i],r=t.getValueName(),n=this.getCommentName(r),a=e?e[r]:void 0,o=!!e&&e[n]||"";this.isTwoValueEquals(t.value,a)||void 0===a&&t.isEmpty()||(t.value=a),t.comment!==o&&(t.comment=o)}this.settingNewValue=t}getDisplayValueCore(e,t){return super.getContentDisplayValueCore(e,t,this.contentPanel)}setAfterRenderCallbacks(e){if(e&&this.customQuestion)for(var t=e.questions,s=0;s<t.length;s++)t[s].afterRenderQuestionCallback=(e,t)=>{this.customQuestion.onAfterRenderContentElement(this,e,t)}}get ariaRole(){return"group"}}se.ItemVariableName="composite";class st{static get DefaultChoices(){let e=u("choices_Item");return[e+"1",e+"2",e+"3"]}static get DefaultColums(){var e=u("matrix_column")+" ";return[e+"1",e+"2",e+"3"]}static get DefaultRows(){var e=u("matrix_row")+" ";return[e+"1",e+"2"]}static get DefaultMutlipleTextItems(){var e=u("multipletext_itemname");return[e+"1",e+"2"]}registerQuestion(e,t,s=!0){ss.Instance.registerElement(e,t,s)}registerCustomQuestion(e){ss.Instance.registerCustomQuestion(e)}unregisterElement(e,t=!1){ss.Instance.unregisterElement(e,t)}clear(){ss.Instance.clear()}getAllTypes(){return ss.Instance.getAllTypes()}createQuestion(e,t){return ss.Instance.createElement(e,t)}}st.Instance=new st;class ss{constructor(){this.creatorHash={},this.registerCustomQuestion=(e,t=!0)=>{this.registerElement(e,t=>{let s=E.createClass(e);return s&&(s.name=t),s},t)}}registerElement(e,t,s=!0){this.creatorHash[e]={showInToolbox:s,creator:t}}clear(){this.creatorHash={}}unregisterElement(e,t=!1){delete this.creatorHash[e],t&&E.removeClass(e)}getAllToolboxTypes(){return this.getAllTypesCore(!0)}getAllTypes(){return this.getAllTypesCore(!1)}createElement(e,t){var s=this.creatorHash[e];if(s&&s.creator)return s.creator(t);let i=t5.Instance.getCustomQuestionByName(e);return i?t5.Instance.createQuestion(t,i):null}getAllTypesCore(e){var t=[];for(var s in this.creatorHash)(!e||this.creatorHash[s].showInToolbox)&&t.push(s);return t.sort()}}ss.Instance=new ss;class si extends tU{constructor(e){super(e),this.createLocalizableString("format",this),this.registerPropertyChangedHandlers(["expression"],()=>{this.expressionRunner&&(this.expressionRunner=this.createRunner())}),this.registerPropertyChangedHandlers(["format","currency","displayStyle"],()=>{this.updateFormatedValue()})}getType(){return"expression"}get hasInput(){return!1}get format(){return this.getLocalizableStringText("format","")}set format(e){this.setLocalizableStringText("format",e)}get locFormat(){return this.getLocalizableString("format")}get expression(){return this.getPropertyValue("expression","")}set expression(e){this.setPropertyValue("expression",e)}locCalculation(){this.expressionIsRunning=!0}unlocCalculation(){this.expressionIsRunning=!1}runConditionCore(e,t){super.runConditionCore(e,t),this.expression&&!this.expressionIsRunning&&(this.runIfReadOnly||!this.isReadOnly)&&(this.locCalculation(),this.expressionRunner||(this.expressionRunner=this.createRunner()),this.expressionRunner.run(e,t))}canCollectErrors(){return!0}hasRequiredError(){return!1}createRunner(){let e=this.createExpressionRunner(this.expression);return e.onRunComplete=e=>{this.value=this.roundValue(e),this.unlocCalculation()},e}get maximumFractionDigits(){return this.getPropertyValue("maximumFractionDigits")}set maximumFractionDigits(e){e<-1||e>20||this.setPropertyValue("maximumFractionDigits",e)}get minimumFractionDigits(){return this.getPropertyValue("minimumFractionDigits")}set minimumFractionDigits(e){e<-1||e>20||this.setPropertyValue("minimumFractionDigits",e)}get runIfReadOnly(){return!0===this.runIfReadOnlyValue}set runIfReadOnly(e){this.runIfReadOnlyValue=e}get formatedValue(){return this.getPropertyValue("formatedValue","")}updateFormatedValue(){this.setPropertyValue("formatedValue",this.getDisplayValueCore(!1,this.value))}onValueChanged(){this.updateFormatedValue()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),this.updateFormatedValue()}getDisplayValueCore(e,t){var s=null==t?this.defaultValue:t,i="";if(!this.isValueEmpty(s)){var r=this.getValueAsStr(s);i=this.format?this.format.format(r):r}return this.survey&&(i=this.survey.getExpressionDisplayValue(this,s,i)),i}get displayStyle(){return this.getPropertyValue("displayStyle")}set displayStyle(e){this.setPropertyValue("displayStyle",e)}get currency(){return this.getPropertyValue("currency")}set currency(e){0>sr().indexOf(e)||this.setPropertyValue("currency",e)}get useGrouping(){return this.getPropertyValue("useGrouping")}set useGrouping(e){this.setPropertyValue("useGrouping",e)}get precision(){return this.getPropertyValue("precision")}set precision(e){this.setPropertyValue("precision",e)}roundValue(e){if(e!==1/0)return this.precision<0||!a.isNumber(e)?e:parseFloat(e.toFixed(this.precision))}getValueAsStr(e){if("date"==this.displayStyle){let t=n("question-expression",e);if(t&&t.toLocaleDateString)return t.toLocaleDateString()}if("none"!=this.displayStyle&&a.isNumber(e)){var t=this.getLocale();t||(t="en");var s={style:this.displayStyle,currency:this.currency,useGrouping:this.useGrouping};return this.maximumFractionDigits>-1&&(s.maximumFractionDigits=this.maximumFractionDigits),this.minimumFractionDigits>-1&&(s.minimumFractionDigits=this.minimumFractionDigits),e.toLocaleString(t,s)}return e.toString()}}function sr(){return["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTN","BWP","BYN","BZD","CAD","CDF","CHE","CHF","CHW","CLF","CLP","CNY","COP","COU","CRC","CUC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRO","MUR","MVR","MWK","MXN","MXV","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","SSP","STD","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","USN","UYI","UYU","UZS","VEF","VND","VUV","WST","XAF","XAG","XAU","XBA","XBB","XBC","XBD","XCD","XDR","XOF","XPD","XPF","XPT","XSU","XTS","XUA","XXX","YER","ZAR","ZMW","ZWL"]}function sn(e,t,s,i){e.storeOthersAsComment=!!s&&s.storeOthersAsComment,(!e.choices||0==e.choices.length)&&e.choicesByUrl.isEmpty&&(e.choices=s.choices),e.choicesByUrl.isEmpty||e.choicesByUrl.run(i.getTextProcessor())}E.addClass("expression",["expression:expression",{name:"format",serializationProperty:"locFormat"},{name:"displayStyle",default:"none",choices:["none","decimal","currency","percent","date"]},{name:"currency",choices:()=>sr(),default:"USD",visibleIf:e=>"currency"===e.displayStyle},{name:"maximumFractionDigits:number",default:-1},{name:"minimumFractionDigits:number",default:-1},{name:"useGrouping:boolean",default:!0},{name:"precision:number",default:-1,category:"data"},{name:"enableIf",visible:!1,isSerializable:!1},{name:"isRequired",visible:!1,isSerializable:!1},{name:"readOnly",visible:!1,isSerializable:!1},{name:"requiredErrorText",visible:!1,isSerializable:!1},{name:"resetValueIf",visible:!1,isSerializable:!1},{name:"setValueIf",visible:!1,isSerializable:!1},{name:"setValueExpression",visible:!1,isSerializable:!1},{name:"defaultValueExpression",visible:!1,isSerializable:!1},{name:"defaultValue",visible:!1,isSerializable:!1},{name:"correctAnswer",visible:!1,isSerializable:!1},{name:"requiredIf",visible:!1,isSerializable:!1}],function(){return new si("")},"question"),st.Instance.registerQuestion("expression",e=>new si(e));var sa={dropdown:{onCellQuestionUpdate:(e,t,s,i)=>{!function(e,t,s,i){sn(e,t,s,i),e.locPlaceholder&&e.locPlaceholder.isEmpty&&!s.locPlaceholder.isEmpty&&(e.optionsCaption=s.optionsCaption)}(e,t,s,i)}},checkbox:{onCellQuestionUpdate:(e,t,s,i)=>{sn(e,t,s,i),e.colCount=t.colCount>-1?t.colCount:s.columnColCount}},radiogroup:{onCellQuestionUpdate:(e,t,s,i)=>{sn(e,t,s,i),e.colCount=t.colCount>-1?t.colCount:s.columnColCount}},tagbox:{onCellQuestionUpdate:(e,t,s,i)=>{sn(e,t,s,i)}},text:{},comment:{},boolean:{onCellQuestionUpdate:(e,t,s,i)=>{e.renderAs=t.renderAs}},expression:{},rating:{}};class so extends eg{static getColumnTypes(){var e=[];for(var t in sa)e.push(t);return e}constructor(e,t,s){super(),this.indexValue=-1,this._hasVisibleCell=!0,this.isColumnsVisibleIf=!0,this.previousChoicesId=void 0,this.colOwnerValue=s,this.createLocalizableString("totalFormat",this),this.createLocalizableString("cellHint",this),this.registerPropertyChangedHandlers(["showInMultipleColumns"],()=>{this.doShowInMultipleColumnsChanged()}),this.registerPropertyChangedHandlers(["visible"],()=>{this.doColumnVisibilityChanged()}),this.updateTemplateQuestion(void 0,e,t)}getOriginalObj(){return this.templateQuestion}getClassNameProperty(){return"cellType"}getSurvey(e=!1){return this.colOwner?this.colOwner.survey:null}endLoadingFromJson(){super.endLoadingFromJson(),this.templateQuestion.autoOtherMode=this.isShowInMultipleColumns,this.templateQuestion.endLoadingFromJson(),this.templateQuestion.onGetSurvey=()=>this.getSurvey()}getDynamicPropertyName(){return"cellType"}getDynamicType(){return"default"===this.cellType?"question":this.calcCellQuestionType(null)}get colOwner(){return this.colOwnerValue}set colOwner(e){this.colOwnerValue=e,e&&(this.updateTemplateQuestion(),this.setParentQuestionToTemplate(this.templateQuestion))}locStrsChanged(){super.locStrsChanged(),this.locTitle.strChanged()}addUsedLocales(e){super.addUsedLocales(e),this.templateQuestion.addUsedLocales(e)}get index(){return this.indexValue}setIndex(e){this.indexValue=e}getType(){return"matrixdropdowncolumn"}get cellType(){return this.getPropertyValue("cellType")}set cellType(e){e=e.toLocaleLowerCase(),this.updateTemplateQuestion(e),this.setPropertyValue("cellType",e),this.colOwner&&this.colOwner.onColumnCellTypeChanged(this)}get templateQuestion(){return this.templateQuestionValue}get value(){return this.templateQuestion.name}get isVisible(){return!0}get isColumnVisible(){return!!this.isDesignMode||this.visible&&this.hasVisibleCell}get visible(){return this.templateQuestion.visible}set visible(e){this.templateQuestion.visible=e}get hasVisibleCell(){return this._hasVisibleCell}set hasVisibleCell(e){this._hasVisibleCell=e}getVisibleMultipleChoices(){let e=this.templateQuestion.visibleChoices;if(!Array.isArray(e))return[];if(!Array.isArray(this._visiblechoices))return e;let t=[];for(let s=0;s<e.length;s++){let i=e[s];this._visiblechoices.indexOf(i.value)>-1&&t.push(i)}return t}get getVisibleChoicesInCell(){if(Array.isArray(this._visiblechoices))return this._visiblechoices;let e=this.templateQuestion.visibleChoices;return Array.isArray(e)?e:[]}setVisibleChoicesInCell(e){this._visiblechoices=e}get isFilteredMultipleColumns(){if(!this.showInMultipleColumns)return!1;let e=this.templateQuestion.choices;if(!Array.isArray(e))return!1;for(let t=0;t<e.length;t++)if(e[t].visibleIf)return!0;return!1}get name(){return this.templateQuestion.name}set name(e){this.templateQuestion.name=e}get title(){return this.templateQuestion.title}set title(e){this.templateQuestion.title=e}get locTitle(){return this.templateQuestion.locTitle}get fullTitle(){return this.locTitle.textOrHtml}get defaultDisplayValue(){return this.templateQuestion.defaultDisplayValue}set defaultDisplayValue(e){this.templateQuestion.defaultDisplayValue=e}get locDefaultDisplayValue(){return this.templateQuestion.locDefaultDisplayValue}get isRequired(){return this.templateQuestion.isRequired}set isRequired(e){this.templateQuestion.isRequired=e}get isRenderedRequired(){return this.getPropertyValue("isRenderedRequired",this.isRequired)}set isRenderedRequired(e){this.setPropertyValue("isRenderedRequired",e)}updateIsRenderedRequired(e){this.isRenderedRequired=e||this.isRequired}get requiredMark(){return this.isRenderedRequired&&this.getSurvey()?this.getSurvey().requiredMark:this.templateQuestion.requiredMark}get requiredErrorText(){return this.templateQuestion.requiredErrorText}set requiredErrorText(e){this.templateQuestion.requiredErrorText=e}get locRequiredErrorText(){return this.templateQuestion.locRequiredErrorText}get readOnly(){return this.templateQuestion.readOnly}set readOnly(e){this.templateQuestion.readOnly=e}get hasOther(){return this.templateQuestion.hasOther}set hasOther(e){this.templateQuestion.hasOther=e}get visibleIf(){return this.templateQuestion.visibleIf}set visibleIf(e){this.templateQuestion.visibleIf=e}get enableIf(){return this.templateQuestion.enableIf}set enableIf(e){this.templateQuestion.enableIf=e}get requiredIf(){return this.templateQuestion.requiredIf}set requiredIf(e){this.templateQuestion.requiredIf=e}get resetValueIf(){return this.templateQuestion.resetValueIf}set resetValueIf(e){this.templateQuestion.resetValueIf=e}get defaultValueExpression(){return this.templateQuestion.defaultValueExpression}set defaultValueExpression(e){this.templateQuestion.defaultValueExpression=e}get setValueIf(){return this.templateQuestion.setValueIf}set setValueIf(e){this.templateQuestion.setValueIf=e}get setValueExpression(){return this.templateQuestion.setValueExpression}set setValueExpression(e){this.templateQuestion.setValueExpression=e}get isUnique(){return this.getPropertyValue("isUnique")}set isUnique(e){this.setPropertyValue("isUnique",e)}get showInMultipleColumns(){return this.getPropertyValue("showInMultipleColumns")}set showInMultipleColumns(e){this.setPropertyValue("showInMultipleColumns",e)}get isSupportMultipleColumns(){return["checkbox","radiogroup"].indexOf(this.cellType)>-1}get isShowInMultipleColumns(){return this.showInMultipleColumns&&this.isSupportMultipleColumns}get validators(){return this.templateQuestion.validators}set validators(e){this.templateQuestion.validators=e}get totalType(){return this.getPropertyValue("totalType")}set totalType(e){this.setPropertyValue("totalType",e)}get totalExpression(){return this.getPropertyValue("totalExpression")}set totalExpression(e){this.setPropertyValue("totalExpression",e)}get hasTotal(){return"none"!=this.totalType||!!this.totalExpression}get totalFormat(){return this.getLocalizableStringText("totalFormat","")}set totalFormat(e){this.setLocalizableStringText("totalFormat",e)}get locTotalFormat(){return this.getLocalizableString("totalFormat")}get cellHint(){return this.getLocalizableStringText("cellHint","")}set cellHint(e){this.setLocalizableStringText("cellHint",e)}get locCellHint(){return this.getLocalizableString("cellHint")}get renderAs(){return this.getPropertyValue("renderAs")}set renderAs(e){this.setPropertyValue("renderAs",e),this.templateQuestion&&(this.templateQuestion.renderAs=e)}get totalMaximumFractionDigits(){return this.getPropertyValue("totalMaximumFractionDigits")}set totalMaximumFractionDigits(e){e<-1||e>20||this.setPropertyValue("totalMaximumFractionDigits",e)}get totalMinimumFractionDigits(){return this.getPropertyValue("totalMinimumFractionDigits")}set totalMinimumFractionDigits(e){e<-1||e>20||this.setPropertyValue("totalMinimumFractionDigits",e)}get totalDisplayStyle(){return this.getPropertyValue("totalDisplayStyle")}set totalDisplayStyle(e){this.setPropertyValue("totalDisplayStyle",e)}get totalAlignment(){return this.getPropertyValue("totalAlignment")}set totalAlignment(e){this.setPropertyValue("totalAlignment",e)}get totalCurrency(){return this.getPropertyValue("totalCurrency")}set totalCurrency(e){0>sr().indexOf(e)||this.setPropertyValue("totalCurrency",e)}get minWidth(){return this.getPropertyValue("minWidth","")}set minWidth(e){this.setPropertyValue("minWidth",e)}get width(){return this.templateQuestion.width}set width(e){this.templateQuestion.width=e}get colCount(){return this.getPropertyValue("colCount")}set colCount(e){e<-1||e>4||this.setPropertyValue("colCount",e)}getLocale(){return this.colOwner?this.colOwner.getLocale():""}getMarkdownHtml(e,t){return this.colOwner?this.colOwner.getMarkdownHtml(e,t):void 0}getRenderer(e){return this.colOwner?this.colOwner.getRenderer(e):null}getRendererContext(e){return this.colOwner?this.colOwner.getRendererContext(e):e}getProcessedText(e){return this.colOwner?this.colOwner.getProcessedText(e):e}createCellQuestion(e){var t=this.calcCellQuestionType(e),s=this.createNewQuestion(t);return this.callOnCellQuestionUpdate(s,e),s}startLoadingFromJson(e){super.startLoadingFromJson(e),e&&!e.cellType&&e.choices&&(e.cellType=this.colOwner.getCellType())}updateCellQuestion(e,t,s=null){this.setQuestionProperties(e,s)}callOnCellQuestionUpdate(e,t){var s=sa[e.getType()];s&&s.onCellQuestionUpdate&&s.onCellQuestionUpdate(e,this,this.colOwner,t)}defaultCellTypeChanged(){this.updateTemplateQuestion()}calcCellQuestionType(e){let t=this.getDefaultCellQuestionType();return e&&this.colOwner&&(t=this.colOwner.getCustomCellType(this,e,t)),t}getDefaultCellQuestionType(e){return(e||(e=this.cellType),"default"!==e)?e:this.colOwner?this.colOwner.getCellType():tp.matrix.defaultCellType}updateTemplateQuestion(e,t,s){let i=this.getDefaultCellQuestionType(e),r=this.templateQuestion?this.templateQuestion.getType():"";i!==r&&(this.templateQuestion&&this.removeProperties(r),this.templateQuestionValue=this.createNewQuestion(i),this.templateQuestion.locOwner=this,this.addProperties(i),t&&(this.name=t),s?this.title=s:this.templateQuestion.locTitle.strChanged(),tp.serialization.matrixDropdownColumnSerializeTitle&&(this.templateQuestion.locTitle.serializeCallBackText=!0),this.templateQuestion.onPropertyChanged.add((e,t)=>{this.propertyValueChanged(t.name,t.oldValue,t.newValue,t.arrayChanges,t.target)}),this.templateQuestion.onItemValuePropertyChanged.add((e,t)=>{this.doItemValuePropertyChanged(t.propertyName,t.obj,t.name,t.newValue,t.oldValue)}),this.templateQuestion.isContentElement=!0,this.isLoadingFromJson||(this.templateQuestion.onGetSurvey=()=>this.getSurvey()),this.templateQuestion.locTitle.strChanged())}createNewQuestion(e){var t=E.createClass(e);return t||(t=E.createClass("text")),t.loadingOwner=this,t.isEditableTemplateElement=!0,t.autoOtherMode=this.isShowInMultipleColumns,this.setQuestionProperties(t),this.setParentQuestionToTemplate(t),t}setParentQuestionToTemplate(e){this.colOwner&&this.colOwner.isQuestion&&e.setParentQuestion(this.colOwner)}setQuestionProperties(e,t=null){if(this.templateQuestion){var s=new I().toJsonObject(this.templateQuestion,!0);if(t&&t(s),s.type=e.getType(),"default"===this.cellType&&this.colOwner&&this.colOwner.hasChoices()&&delete s.choices,delete s.itemComponent,this.jsonObj&&"rating"===s.type&&Object.keys(this.jsonObj).forEach(e=>{s[e]=this.jsonObj[e]}),"random"===s.choicesOrder){s.choicesOrder="none";let e=this.templateQuestion.visibleChoices;Array.isArray(e)&&(s.choices=e)}new I().toObject(s,e),e.isContentElement=this.templateQuestion.isContentElement,this.previousChoicesId=void 0,e.loadedChoicesFromServerCallback=()=>{if(!this.isShowInMultipleColumns||this.previousChoicesId&&this.previousChoicesId!==e.id)return;this.previousChoicesId=e.id;let t=e.visibleChoices;this.templateQuestion.choices=t,this.propertyValueChanged("choices",t,t)}}}propertyValueChanged(e,t,s,i,r){if(super.propertyValueChanged(e,t,s,i,r),"isRequired"===e&&this.updateIsRenderedRequired(s),this.colOwner&&!this.isLoadingFromJson){if(this.isShowInMultipleColumns){if("choicesOrder"===e)return;["visibleChoices","choices"].indexOf(e)>-1&&this.colOwner.onShowInMultipleColumnsChanged(this)}E.hasOriginalProperty(this,e)&&this.colOwner.onColumnPropertyChanged(this,e,s)}}doItemValuePropertyChanged(e,t,s,i,r){E.hasOriginalProperty(t,s)&&null!=this.colOwner&&!this.isLoadingFromJson&&this.colOwner.onColumnItemValuePropertyChanged(this,e,t,s,i,r)}doShowInMultipleColumnsChanged(){null!=this.colOwner&&this.colOwner.onShowInMultipleColumnsChanged(this),this.templateQuestion&&(this.templateQuestion.autoOtherMode=this.isShowInMultipleColumns)}doColumnVisibilityChanged(){null==this.colOwner||this.isDesignMode||this.colOwner.onColumnVisibilityChanged(this)}getProperties(e){return E.getDynamicPropertiesByObj(this,e)}removeProperties(e){for(var t=this.getProperties(e),s=0;s<t.length;s++){var i=t[s];delete this[i.name],i.serializationProperty&&delete this[i.serializationProperty]}}addProperties(e){let t=this.getProperties(e);E.addDynamicPropertiesIntoObj(this,this.templateQuestion,t)}}function sl(e,t,s){return e+(t?"-error":"")+(s?"-detail":"")}E.addClass("matrixdropdowncolumn",[{name:"!name",isUnique:!0},{name:"title",serializationProperty:"locTitle",dependsOn:"name",onPropertyEditorUpdate:function(e,t){e&&t&&(t.placeholder=e.name)}},{name:"cellHint",serializationProperty:"locCellHint",visible:!1},{name:"cellType",default:"default",choices:()=>{var e=so.getColumnTypes();return e.splice(0,0,"default"),e}},{name:"colCount",default:-1,choices:[-1,0,1,2,3,4]},"isRequired:boolean","isUnique:boolean",{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},"readOnly:boolean",{name:"minWidth",onPropertyEditorUpdate:function(e,t){e&&t&&(t.value=e.minWidth)}},"width",{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},"visibleIf:condition","enableIf:condition","requiredIf:condition","resetValueIf:condition","setValueIf:condition","setValueExpression:expression",{name:"showInMultipleColumns:boolean",dependsOn:"cellType",visibleIf:e=>e.isSupportMultipleColumns},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"},{name:"totalType",visibleIf:e=>!e.isShowInMultipleColumns,default:"none",choices:["none","sum","count","min","max","avg"]},{name:"totalExpression:expression",visibleIf:e=>!e.isShowInMultipleColumns},{name:"totalFormat",serializationProperty:"locTotalFormat",visibleIf:e=>e.hasTotal},{name:"totalDisplayStyle",visibleIf:e=>e.hasTotal,default:"none",choices:["none","decimal","currency","percent"]},{name:"totalAlignment",visibleIf:e=>e.hasTotal,default:"auto",choices:["auto","left","center","right"]},{name:"totalCurrency",visibleIf:e=>e.hasTotal,choices:()=>sr(),default:"USD"},{name:"totalMaximumFractionDigits:number",default:-1,visibleIf:e=>e.hasTotal},{name:"totalMinimumFractionDigits:number",default:-1,visibleIf:e=>e.hasTotal},{name:"renderAs",default:"default",visible:!1},{name:"defaultDisplayValue",serializationProperty:"locDefaultDisplayValue"}],function(){return new so("")});class sh{constructor(){this.minWidth="",this.width="",this.colSpans=1,this.isActionsCell=!1,this.isErrorsCell=!1,this.isDragHandlerCell=!1,this.isDetailRowCell=!1,this.classNameValue="",this.idValue=sh.counter++}get requiredMark(){return this.column&&this.column.isRenderedRequired?this.column.requiredMark:void 0}get hasQuestion(){return!!this.question&&!this.isErrorsCell}get hasTitle(){return!!this.locTitle}get hasPanel(){return!!this.panel}get id(){let e=this.question?this.question.id:this.idValue.toString();return this.isChoice&&(e+="-"+(Number.isInteger(this.choiceIndex)?"index"+this.choiceIndex.toString():this.item.id)),sl(e,this.isErrorsCell,this.isDetailRowCell)}get item(){return this.itemValue}set item(e){this.itemValue=e,e&&(e.hideCaption=!0)}get isChoice(){return!!this.item}get isItemChoice(){return this.isChoice&&!this.isOtherChoice}get choiceValue(){return this.isChoice?this.item.value:null}get isCheckbox(){return this.isItemChoice&&this.question.isDescendantOf("checkbox")}get isRadio(){return this.isItemChoice&&this.question.isDescendantOf("radiogroup")}get isFirstChoice(){return 0===this.choiceIndex}set className(e){this.classNameValue=e}get className(){let e=new eV().append(this.classNameValue);return this.hasQuestion&&e.append(this.question.cssClasses.hasError,this.question.errors.length>0).append(this.question.cssClasses.answered,this.question.isAnswered),e.toString()}get cellQuestionWrapperClassName(){return this.cell.getQuestionWrapperClassName(this.matrix.cssClasses.cellQuestionWrapper)}get isVisible(){var e;return!this.hasQuestion&&!this.isErrorsCell||!(null===(e=this.matrix)||void 0===e?void 0:e.isMobile)||this.question.isVisible}get showResponsiveTitle(){var e;return this.hasQuestion&&(null===(e=this.matrix)||void 0===e?void 0:e.isMobile)}get responsiveTitleCss(){return new eV().append(this.matrix.cssClasses.cellResponsiveTitle).toString()}get responsiveLocTitle(){return this.cell.column.locTitle}get headers(){if(this.cell&&this.cell.column){if(this.matrix.IsMultiplyColumn(this.cell.column))return this.item?this.item.locText.renderedHtml:"";let e=this.cell.column.cellHint;return e?""===e.trim()?"":this.cell.column.locCellHint.renderedHtml:this.hasQuestion&&this.question.isVisible&&this.question.title?this.question.title:this.cell.column.title}return this.hasQuestion&&this.question.isVisible?this.question.locTitle.renderedHtml:this.hasTitle&&this.locTitle.renderedHtml||""}getTitle(){return this.matrix&&this.matrix.showHeader?this.headers:""}calculateFinalClassName(e){let t=this.cell.question.cssClasses,s=new eV().append(t.itemValue,!!t).append(t.asCell,!!t);return s.append(e.cell,s.isEmpty()&&!!e).append(e.choiceCell,this.isChoice).toString()}focusIn(){this.question&&this.question.focusIn()}}sh.counter=1;class su extends eg{constructor(e,t=!1){super(),this.cssClasses=e,this.isDetailRow=t,this.hasEndActions=!1,this.isErrorsRow=!1,this.cells=[],this.idValue=su.counter++}get id(){var e;return sl((null===(e=this.row)||void 0===e?void 0:e.id)||this.idValue.toString(),this.isErrorsRow,this.isDetailRow)}get attributes(){return this.row?{"data-sv-drop-target-matrix-row":this.row.id}:{}}get className(){var e,t;return new eV().append(this.cssClasses.row).append(this.cssClasses.detailRow,this.isDetailRow).append(this.cssClasses.rowHasPanel,null===(e=this.row)||void 0===e?void 0:e.hasPanel).append(this.cssClasses.expandedRow,(null===(t=this.row)||void 0===t?void 0:t.isDetailPanelShowing)&&!this.isDetailRow).append(this.cssClasses.rowHasEndActions,this.hasEndActions).append(this.cssClasses.ghostRow,this.isGhostRow).append(this.cssClasses.rowAdditional,this.isAdditionalClasses).toString()}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}focusCell(e){if(this.rootElement){let t=`:scope td:nth-of-type(${e+1}) input, :scope td:nth-of-type(${e+1}) button`,s=this.rootElement.querySelectorAll(t)[0];s&&s.focus()}}}su.counter=1,ey([c({defaultValue:!1})],su.prototype,"isGhostRow",void 0),ey([c({defaultValue:!1})],su.prototype,"isAdditionalClasses",void 0),ey([c({defaultValue:!0})],su.prototype,"visible",void 0);class sd extends su{constructor(e){super(e),this.isErrorsRow=!0}get attributes(){return{}}get className(){return new eV().append(this.cssClasses.row).append(this.cssClasses.errorRow).toString()}onAfterCreated(){let e=()=>{this.visible=this.cells.some(e=>e.question&&e.question.hasVisibleErrors)};this.cells.forEach(t=>{t.question&&t.question.registerFunctionOnPropertyValueChanged("hasVisibleErrors",e)}),e()}}class sc extends eg{getIsAnimationAllowed(){return super.getIsAnimationAllowed()&&this.matrix.animationAllowed}getRenderedRowsAnimationOptions(){let e=e=>{e.querySelectorAll(":scope > td > *").forEach(e=>{td(e)})},t=e=>{e.querySelectorAll(":scope > td > *").forEach(e=>{tc(e)})};return{isAnimationEnabled:()=>this.animationAllowed,getRerenderEvent:()=>this.onElementRerendered,getAnimatedElement:e=>e.getRootElement(),getLeaveOptions:()=>({cssClass:this.cssClasses.rowLeave,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getEnterOptions:(s,i)=>({cssClass:this.cssClasses.rowEnter,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getKey:e=>e.id}}updateRenderedRows(){this.renderedRows=this.rows}get renderedRows(){return this._renderedRows}set renderedRows(e){this.renderedRowsAnimation.sync(e)}constructor(e){super(),this.matrix=e,this._renderedRows=[],this.renderedRowsAnimation=new eQ(this.getRenderedRowsAnimationOptions(),e=>{this._renderedRows=e},()=>this._renderedRows),this.hasActionCellInRowsValues={},this.build()}get showTable(){return this.getPropertyValue("showTable",!0)}get showHeader(){return this.getPropertyValue("showHeader")}get showAddRow(){return this.getPropertyValue("showAddRow",!1)}get showAddRowOnTop(){return this.getPropertyValue("showAddRowOnTop",!1)}get showAddRowOnBottom(){return this.getPropertyValue("showAddRowOnBottom",!1)}get showFooter(){return this.matrix.hasFooter&&this.matrix.isColumnLayoutHorizontal}get hasFooter(){return!!this.footerRow}get hasRemoveRows(){return this.hasRemoveRowsValue}isRequireReset(){return this.hasRemoveRows!=this.matrix.canRemoveRows||!this.matrix.isColumnLayoutHorizontal}get headerRow(){return this.headerRowValue}get footerRow(){return this.footerRowValue}get isRowsDragAndDrop(){return this.matrix.isRowsDragAndDrop&&this.matrix.isColumnLayoutHorizontal}get showCellErrorsTop(){return"top"===this.matrix.getErrorLocation()}get showCellErrorsBottom(){return"bottom"===this.matrix.getErrorLocation()}build(){this.hasRemoveRowsValue=this.matrix.canRemoveRows,this.matrix.visibleRows,this.cssClasses=this.matrix.cssClasses,this.buildRowsActions(),this.buildHeader(),this.buildRows(),this.buildFooter(),this.updateShowTableAndAddRow()}updateShowTableAndAddRow(){var e=this.rows.length>0||this.matrix.isDesignMode||!this.matrix.getShowColumnsIfEmpty();this.setPropertyValue("showTable",e);var t=this.matrix.canAddRow&&e,s=t,i=t;s&&(s="default"===this.matrix.getAddRowLocation()?!this.matrix.isColumnLayoutHorizontal:"bottom"!==this.matrix.getAddRowLocation()),i&&"topBottom"!==this.matrix.getAddRowLocation()&&(i=!s),this.setPropertyValue("showAddRow",this.matrix.canAddRow),this.setPropertyValue("showAddRowOnTop",s),this.setPropertyValue("showAddRowOnBottom",i)}onAddedRow(e,t){if(this.getRenderedDataRowCount()>=this.matrix.visibleRows.length)return;let s=this.getRenderedRowIndexByIndex(t);this.rowsActions.splice(t,0,this.buildRowActions(e)),this.addHorizontalRow(this.rows,e,s),this.updateShowTableAndAddRow()}getRenderedRowIndexByIndex(e){let t=0,s=0;for(var i=0;i<this.rows.length;i++){if(s===e){(this.rows[i].isErrorsRow||this.rows[i].isDetailRow)&&(t++,i+1<this.rows.length&&this.rows[i+1].isDetailRow&&t++);break}t++,!this.rows[i].isErrorsRow&&!this.rows[i].isDetailRow&&s++}return s<e?this.rows.length:t}getRenderedDataRowCount(){for(var e=0,t=0;t<this.rows.length;t++)!this.rows[t].isErrorsRow&&!this.rows[t].isDetailRow&&e++;return e}onRemovedRow(e){var t=this.getRenderedRowIndex(e);if(!(t<0)){this.rowsActions.splice(t,1);var s=1;t<this.rows.length-1&&this.showCellErrorsBottom&&this.rows[t+1].isErrorsRow&&s++,t<this.rows.length-1&&(this.rows[t+1].isDetailRow||this.showCellErrorsBottom&&t+1<this.rows.length-1&&this.rows[t+2].isDetailRow)&&s++,t>0&&this.showCellErrorsTop&&this.rows[t-1].isErrorsRow&&(t--,s++),this.rows.splice(t,s),this.updateShowTableAndAddRow()}}onDetailPanelChangeVisibility(e,t){let s=this.getRenderedRowIndex(e);if(s<0)return;let i=s;this.showCellErrorsBottom&&i++;var r=i<this.rows.length-1&&this.rows[i+1].isDetailRow?i+1:-1;if((!t||!(r>-1))&&(t||!(r<0))){if(t){var n=this.createDetailPanelRow(e,this.rows[s]);this.rows.splice(i+1,0,n)}else this.rows.splice(r,1)}}focusActionCell(e,t){let s=this.rows[this.rows.length-1];if(this.matrix.isColumnLayoutHorizontal){let t=this.getRenderedRowIndex(e);s=this.rows[t]}null==s||s.focusCell(t)}getRenderedRowIndex(e){for(var t=0;t<this.rows.length;t++)if(this.rows[t].row==e)return t;return -1}buildRowsActions(){this.rowsActions=[];for(var e=this.matrix.visibleRows,t=0;t<e.length;t++)this.rowsActions.push(this.buildRowActions(e[t]))}createRenderedRow(e,t=!1){return new su(e,t)}createErrorRenderedRow(e){return new sd(e)}buildHeader(){var e=this.matrix.isColumnLayoutHorizontal&&this.matrix.showHeader||this.matrix.hasRowText&&!this.matrix.isColumnLayoutHorizontal;if(this.setPropertyValue("showHeader",e),e){if(this.headerRowValue=this.createRenderedRow(this.cssClasses),this.isRowsDragAndDrop&&this.headerRow.cells.push(this.createHeaderCell(null,"action",this.cssClasses.actionsCellDrag)),this.hasActionCellInRows("start")&&this.headerRow.cells.push(this.createHeaderCell(null,"action")),this.matrix.hasRowText&&this.matrix.showHeader&&this.headerRow.cells.push(this.createHeaderCell(null)),this.matrix.isColumnLayoutHorizontal)for(var t=0;t<this.matrix.columns.length;t++){var s=this.matrix.columns[t];s.isColumnVisible&&(this.matrix.IsMultiplyColumn(s)?this.createMutlipleColumnsHeader(s):this.headerRow.cells.push(this.createHeaderCell(s)))}else{for(var i=this.matrix.visibleRows,t=0;t<i.length;t++){let e=this.createTextCell(i[t].locText);this.setHeaderCellCssClasses(e),e.row=i[t],this.headerRow.cells.push(e)}if(this.matrix.hasFooter){let e=this.createTextCell(this.matrix.getFooterText());this.setHeaderCellCssClasses(e),this.headerRow.cells.push(e)}}this.hasActionCellInRows("end")&&this.headerRow.cells.push(this.createHeaderCell(null,"action"))}}buildFooter(){if(this.showFooter){if(this.footerRowValue=this.createRenderedRow(this.cssClasses),this.isRowsDragAndDrop&&this.footerRow.cells.push(this.createHeaderCell(null)),this.hasActionCellInRows("start")&&this.footerRow.cells.push(this.createHeaderCell(null,"action")),this.matrix.hasRowText){let e=this.createTextCell(this.matrix.getFooterText());e.className=new eV().append(e.className).append(this.cssClasses.footerTotalCell).toString(),this.footerRow.cells.push(e)}for(var e=this.matrix.visibleTotalRow.cells,t=0;t<e.length;t++){var s=e[t];if(s.column.isColumnVisible){if(this.matrix.IsMultiplyColumn(s.column))this.createMutlipleColumnsFooter(this.footerRow,s);else{var i=this.createEditCell(s);s.column&&this.setCellWidth(s.column,i),i.className=new eV().append(i.className).append(this.cssClasses.footerCell).toString(),this.footerRow.cells.push(i)}}}this.hasActionCellInRows("end")&&this.footerRow.cells.push(this.createHeaderCell(null,"action"))}}buildRows(){this.blockAnimations();var e=this.matrix.isColumnLayoutHorizontal?this.buildHorizontalRows():this.buildVerticalRows();this.rows=e,this.releaseAnimations()}hasActionCellInRows(e){return void 0===this.hasActionCellInRowsValues[e]&&(this.hasActionCellInRowsValues[e]=this.hasActionsCellInLocaltion(e)),this.hasActionCellInRowsValues[e]}hasActionsCellInLocaltion(e){return"end"==e&&!!this.hasRemoveRows||this.matrix.visibleRows.some((t,s)=>!this.isValueEmpty(this.getRowActions(s,e)))}canRemoveRow(e){return this.matrix.canRemoveRow(e)}buildHorizontalRows(){for(var e=this.matrix.visibleRows,t=[],s=0;s<e.length;s++)this.addHorizontalRow(t,e[s]);return t}addHorizontalRow(e,t,s=-1){let i=this.createHorizontalRow(t),r=this.createErrorRow(i);if(i.row=t,s<0&&(s=e.length),this.matrix.isMobile){let t=[];for(let e=0;e<i.cells.length;e++)this.showCellErrorsTop&&!r.cells[e].isEmpty&&t.push(r.cells[e]),t.push(i.cells[e]),this.showCellErrorsBottom&&!r.cells[e].isEmpty&&t.push(r.cells[e]);i.cells=t,e.splice(s,0,i)}else e.splice(s,0,...this.showCellErrorsTop?[r,i]:[i,r]),s++;t.isDetailPanelShowing&&e.splice(s+1,0,this.createDetailPanelRow(t,i))}getRowDragCell(e){let t=new sh,s=this.matrix.lockedRowCount;return t.isDragHandlerCell=s<1||e>=s,t.isEmpty=!t.isDragHandlerCell,t.className=this.getActionsCellClassName(t),t.row=this.matrix.visibleRows[e],t}getActionsCellClassName(e=null){let t=new eV().append(this.cssClasses.actionsCell).append(this.cssClasses.actionsCellDrag,null==e?void 0:e.isDragHandlerCell).append(this.cssClasses.detailRowCell,null==e?void 0:e.isDetailRowCell).append(this.cssClasses.verticalCell,!this.matrix.isColumnLayoutHorizontal);if(e.isActionsCell){let s=e.item.value.actions;this.cssClasses.actionsCellPrefix&&s.forEach(e=>{t.append(this.cssClasses.actionsCellPrefix+"--"+e.id)})}return t.toString()}getRowActionsCell(e,t,s=!1){let i=this.getRowActions(e,t);if(!this.isValueEmpty(i)){let t=new sh,r=this.matrix.allowAdaptiveActions?new ek:new ex;return this.matrix.survey&&this.matrix.survey.getCss().actionBar&&(r.cssClasses=this.matrix.survey.getCss().actionBar),r.setItems(i),t.item=new tJ(r),t.isActionsCell=!0,t.isDragHandlerCell=!1,t.isDetailRowCell=s,t.className=this.getActionsCellClassName(t),t.row=this.matrix.visibleRows[e],t}return null}getRowActions(e,t){var s=this.rowsActions[e];return Array.isArray(s)?s.filter(e=>(e.location||(e.location="start"),e.location===t)):[]}buildRowActions(e){var t=[];return this.setDefaultRowActions(e,t),this.matrix.survey&&(t=this.matrix.survey.getUpdatedMatrixRowActions(this.matrix,e,t)),t}get showRemoveButtonAsIcon(){return tp.matrix.renderRemoveAsIcon&&this.matrix.survey&&"sd-root-modern"===this.matrix.survey.css.root}setDefaultRowActions(e,t){let s=this.matrix;this.hasRemoveRows&&this.canRemoveRow(e)&&(this.showRemoveButtonAsIcon?t.push(new eL({id:"remove-row",iconName:"icon-delete-24x24",iconSize:"auto",component:"sv-action-bar-item",innerCss:new eV().append(this.matrix.cssClasses.button).append(this.matrix.cssClasses.buttonRemove).toString(),location:"end",showTitle:!1,title:s.removeRowText,enabled:!s.isInputReadOnly,data:{row:e,question:s},action:()=>{s.removeRowUI(e)}})):t.push(new eL({id:"remove-row",location:"end",enabled:!this.matrix.isInputReadOnly,component:"sv-matrix-remove-button",data:{row:e,question:this.matrix}}))),e.hasPanel&&(this.matrix.isMobile?t.unshift(new eL({id:"show-detail-mobile",title:new ec(()=>e.isDetailPanelShowing?this.matrix.getLocalizationString("hideDetails"):this.matrix.getLocalizationString("showDetails")),showTitle:!0,location:"end",action:t=>{e.showHideDetailPanelClick()}})):t.push(new eL({id:"show-detail",title:this.matrix.getLocalizationString("editText"),showTitle:!1,location:"start",component:"sv-matrix-detail-button",data:{row:e,question:this.matrix}})))}createErrorRow(e){let t=this.createErrorRenderedRow(this.cssClasses);for(let s=0;s<e.cells.length;s++){let i=e.cells[s];i.hasQuestion?this.matrix.IsMultiplyColumn(i.cell.column)?i.isFirstChoice?t.cells.push(this.createErrorCell(i.cell)):t.cells.push(this.createEmptyCell(!0)):t.cells.push(this.createErrorCell(i.cell)):t.cells.push(this.createEmptyCell(!0))}return t.onAfterCreated(),t}createHorizontalRow(e){var t=this.createRenderedRow(this.cssClasses);if(this.isRowsDragAndDrop){var s=this.matrix.visibleRows.indexOf(e);t.cells.push(this.getRowDragCell(s))}if(this.addRowActionsCell(e,t,"start"),this.matrix.hasRowText){var i=this.createTextCell(e.locText);i.row=e,t.cells.push(i),this.setCellWidth(null,i),i.className=new eV().append(i.className).append(this.cssClasses.rowTextCell).append(this.cssClasses.columnTitleCell,!this.matrix.isColumnLayoutHorizontal).append(this.cssClasses.detailRowText,e.hasPanel).toString()}for(var r=0;r<e.cells.length;r++){let s=e.cells[r];if(s.column.isColumnVisible){if(this.matrix.IsMultiplyColumn(s.column))this.createMutlipleEditCells(t,s);else{s.column.isShowInMultipleColumns&&s.question.visibleChoices.map(e=>e.hideCaption=!1);var i=this.createEditCell(s);t.cells.push(i),this.setCellWidth(s.column,i)}}}return this.addRowActionsCell(e,t,"end"),t}addRowActionsCell(e,t,s){var i=this.matrix.visibleRows.indexOf(e);if(this.hasActionCellInRows(s)){let e=this.getRowActionsCell(i,s,t.isDetailRow);if(e)t.cells.push(e),t.hasEndActions=!0;else{var r=new sh;r.isEmpty=!0,r.isDetailRowCell=t.isDetailRow,t.cells.push(r)}}}createDetailPanelRow(e,t){let s=this.matrix.isDesignMode;var i=this.createRenderedRow(this.cssClasses,!0);i.row=e;var r=new sh;this.matrix.hasRowText&&(r.colSpans=2),r.isEmpty=!0,s||i.cells.push(r);var n=null;this.hasActionCellInRows("end")&&((n=new sh).isEmpty=!0);var a=new sh;return a.panel=e.detailPanel,a.colSpans=t.cells.length-(s?0:r.colSpans)-(n?n.colSpans:0),a.className=this.cssClasses.detailPanelCell,i.cells.push(a),n&&(this.matrix.isMobile?this.addRowActionsCell(e,i,"end"):i.cells.push(n)),"function"==typeof this.matrix.onCreateDetailPanelRenderedRowCallback&&this.matrix.onCreateDetailPanelRenderedRowCallback(i),i}buildVerticalRows(){for(var e=this.matrix.columns,t=[],s=0;s<e.length;s++){var i=e[s];if(i.isColumnVisible){if(this.matrix.IsMultiplyColumn(i))this.createMutlipleVerticalRows(t,i,s);else{let e=this.createVerticalRow(i,s),r=this.createErrorRow(e);this.showCellErrorsTop?(t.push(r),t.push(e)):(t.push(e),t.push(r))}}}return this.hasActionCellInRows("end")&&t.push(this.createEndVerticalActionRow()),t}createMutlipleVerticalRows(e,t,s){var i=this.getMultipleColumnChoices(t);if(i)for(var r=0;r<i.length;r++){let n=this.createVerticalRow(t,s,i[r],r),a=this.createErrorRow(n);this.showCellErrorsTop?(e.push(a),e.push(n)):(e.push(n),e.push(a))}}createVerticalRow(e,t,s=null,i=-1){var r=this.createRenderedRow(this.cssClasses);if(this.matrix.showHeader){var n=s?s.locText:e.locTitle,a=this.createTextCell(n);a.column=e,a.className=new eV().append(a.className).append(this.cssClasses.rowTextCell).append(this.cssClasses.columnTitleCell).toString(),r.cells.push(a)}for(var o=this.matrix.visibleRows,l=0;l<o.length;l++){var h=s,u=i>=0?i:l,d=o[l].cells[t],c=s?d.question.visibleChoices:void 0;c&&u<c.length&&(h=c[u]);var g=this.createEditCell(d,h);g.item=h,g.choiceIndex=u,r.cells.push(g)}return this.matrix.hasTotal&&r.cells.push(this.createEditCell(this.matrix.visibleTotalRow.cells[t])),r}createEndVerticalActionRow(){var e=this.createRenderedRow(this.cssClasses);this.matrix.showHeader&&e.cells.push(this.createEmptyCell());for(var t=this.matrix.visibleRows,s=0;s<t.length;s++)e.cells.push(this.getRowActionsCell(s,"end"));return this.matrix.hasTotal&&e.cells.push(this.createEmptyCell()),e}createMutlipleEditCells(e,t,s=!1){var i=s?this.getMultipleColumnChoices(t.column):t.question.visibleChoices;if(i)for(var r=0;r<i.length;r++){var n=this.createEditCell(t,s?void 0:i[r]);s||(this.setItemCellCssClasses(n),n.choiceIndex=r),e.cells.push(n)}}setItemCellCssClasses(e){e.className=new eV().append(this.cssClasses.cell).append(this.cssClasses.itemCell).append(this.cssClasses.radioCell,e.isRadio).append(this.cssClasses.checkboxCell,e.isCheckbox).toString()}createEditCell(e,t){var s=new sh;return s.cell=e,s.row=e.row,s.column=e.column,s.question=e.question,s.matrix=this.matrix,s.item=t,s.isOtherChoice=!!t&&!!e.question&&e.question.otherItem===t,s.className=s.calculateFinalClassName(this.cssClasses),s}createErrorCell(e,t){var s=new sh;return s.question=e.question,s.row=e.row,s.matrix=this.matrix,s.isErrorsCell=!0,s.className=new eV().append(this.cssClasses.cell).append(this.cssClasses.errorsCell).append(this.cssClasses.errorsCellTop,this.showCellErrorsTop).append(this.cssClasses.errorsCellBottom,this.showCellErrorsBottom).toString(),s}createMutlipleColumnsFooter(e,t){this.createMutlipleEditCells(e,t,!0)}createMutlipleColumnsHeader(e){var t=this.getMultipleColumnChoices(e);if(t)for(var s=0;s<t.length;s++){var i=this.createTextCell(t[s].locText);this.setHeaderCell(e,i),this.setHeaderCellCssClasses(i),this.headerRow.cells.push(i)}}getMultipleColumnChoices(e){var t=e.templateQuestion.choices;return t&&Array.isArray(t)&&0==t.length?[].concat(this.matrix.choices,e.getVisibleMultipleChoices()):(t=e.getVisibleMultipleChoices())&&Array.isArray(t)?t:null}setHeaderCellCssClasses(e,t,s){e.className=new eV().append(this.cssClasses.headerCell).append(this.cssClasses.columnTitleCell,this.matrix.isColumnLayoutHorizontal).append(this.cssClasses.emptyCell,!!e.isEmpty).append(this.cssClasses.cell+"--"+t,!!t).append(s,!!s).toString()}createHeaderCell(e,t=null,s){let i=e?this.createTextCell(e.locTitle):this.createEmptyCell();return i.column=e,this.setHeaderCell(e,i),t||(t=e&&"default"!==e.cellType?e.cellType:this.matrix.cellType),this.setHeaderCellCssClasses(i,t,s),i}setHeaderCell(e,t){this.setCellWidth(e,t)}setCellWidth(e,t){t.minWidth=null!=e?this.matrix.getColumnWidth(e):this.matrix.getRowTitleWidth(),t.width=null!=e?e.width:this.matrix.getRowTitleWidth()}createTextCell(e){var t=new sh;return t.locTitle=e,this.cssClasses.cell&&(t.className=this.cssClasses.cell),t}createEmptyCell(e=!1){let t=this.createTextCell(null);return t.isEmpty=!0,t.className=new eV().append(this.cssClasses.cell).append(this.cssClasses.emptyCell).append(this.cssClasses.errorsCell,e).toString(),t}}ey([p({onPush:(e,t,s)=>{s.updateRenderedRows()},onRemove:(e,t,s)=>{s.updateRenderedRows()}})],sc.prototype,"rows",void 0),ey([p()],sc.prototype,"_renderedRows",void 0);class sg{constructor(e,t,s){this.column=e,this.row=t,this.data=s,this.questionValue=this.createQuestion(e,t,s),this.questionValue.updateCustomWidget(),this.updateCellQuestionTitleDueToAccessebility(t)}updateCellQuestionTitleDueToAccessebility(e){this.questionValue.locTitle.onGetTextCallback=t=>{if(!e||!e.getSurvey())return this.questionValue.title;let s=e.getAccessbilityText();return s?this.column.colOwner.getCellAriaLabel(s,this.questionValue.title):this.questionValue.title}}locStrsChanged(){this.question.locStrsChanged()}createQuestion(e,t,s){let i=s.createQuestion(this.row,this.column);return i.readOnlyCallback=()=>!this.row.isRowEnabled(),i.validateValueCallback=function(){return s.validateCell(t,e.name,t.value)},v.getProperties(e.getType()).forEach(t=>{let s=t.name;void 0!==e[s]&&(i[s]=e[s])}),i}get question(){return this.questionValue}get value(){return this.question.value}set value(e){this.question.value=e}getQuestionWrapperClassName(e){return e}runCondition(e,t){this.question.runCondition(e,t)}}class sp extends sg{constructor(e,t,s){super(e,t,s),this.column=e,this.row=t,this.data=s,this.updateCellQuestion()}createQuestion(e,t,s){var i=E.createClass("expression");return i.setSurveyImpl(t),i}locStrsChanged(){this.updateCellQuestion(),super.locStrsChanged()}updateCellQuestion(){this.question.locCalculation(),this.column.updateCellQuestion(this.question,null,function(e){delete e.defaultValue}),this.question.expression=this.getTotalExpression(),this.question.format=this.column.totalFormat,this.question.currency=this.column.totalCurrency,this.question.displayStyle=this.column.totalDisplayStyle,this.question.maximumFractionDigits=this.column.totalMaximumFractionDigits,this.question.minimumFractionDigits=this.column.totalMinimumFractionDigits,this.question.unlocCalculation(),this.question.runIfReadOnly=!0}getQuestionWrapperClassName(e){let t=super.getQuestionWrapperClassName(e);if(!t)return t;this.question.expression&&"''"!=this.question.expression&&(t+=" "+e+"--expression");let s=this.column.totalAlignment;return"auto"===s&&"dropdown"===this.column.cellType&&(s="left"),t+" "+e+"--"+s}getTotalExpression(){if(this.column.totalExpression)return this.column.totalExpression;if("none"==this.column.totalType)return"''";var e=this.column.totalType+"InArray";return O.Instance.hasFunction(e)?e+"({self}, '"+this.column.name+"')":""}}class sm extends t3{constructor(e,t,s){super(t),this.row=e,this.variableName=t,this.parentTextProcessor=s}getParentTextProcessor(){return this.parentTextProcessor}get survey(){return this.row.getSurvey()}getValues(){return this.row.value}getQuestionByName(e){return this.row.getQuestionByName(e)}onCustomProcessText(e){return e.name==sv.IndexVariableName?(e.isExists=!0,e.value=this.row.rowIndex,!0):[sv.RowValueVariableName,sv.RowNameVariableName].indexOf(e.name)>-1&&(e.isExists=!0,e.value=this.row.rowName,!0)}}class sv{static getId(){return"srow_"+sv.idCounter++}constructor(e,t){this.isSettingValue=!1,this.detailPanelValue=null,this.visibleValue=!0,this.cells=[],this.isCreatingDetailPanel=!1,this.data=e,this.subscribeToChanges(t),this.textPreProcessor=new sm(this,sv.RowVariableName,e?e.getParentTextProcessor():null),this.showHideDetailPanelClick=()=>{if(this.getSurvey().isDesignMode)return!0;this.showHideDetailPanel()},this.idValue=sv.getId()}get id(){return this.idValue}get rowName(){return null}get dataName(){return this.rowName}get text(){return this.rowName}isRowEnabled(){return!0}isRowHasEnabledCondition(){return!1}get isVisible(){return this.visible&&this.isItemVisible()}get visible(){return this.visibleValue}set visible(e){var t;this.visible!==e&&(this.visibleValue=e,null===(t=this.data)||void 0===t||t.onRowVisibilityChanged(this))}isItemVisible(){return!0}get value(){for(var e={},t=this.questions,s=0;s<t.length;s++){var i=t[s];i.isEmpty()||(e[i.getValueName()]=i.value),i.comment&&this.getSurvey()&&this.getSurvey().storeOthersAsComment&&(e[i.getValueName()+eg.commentSuffix]=i.comment)}return e}set value(e){this.isSettingValue=!0,this.subscribeToChanges(e);for(var t=this.questions,s=0;s<t.length;s++){var i=t[s],r=this.getCellValue(e,i.getValueName()),n=i.comment,a=e?e[i.getValueName()+eg.commentSuffix]:"";void 0==a&&(a=""),i.updateValueFromSurvey(r),(a||this.isTwoValueEquals(n,i.comment))&&i.updateCommentFromSurvey(a),i.onSurveyValueChanged(r)}this.isSettingValue=!1}get locText(){return null}getAccessbilityText(){return this.locText&&this.locText.renderedHtml}get hasPanel(){return!!this.data&&this.data.hasDetailPanel(this)}get detailPanel(){return this.detailPanelValue}get detailPanelId(){return this.detailPanel?this.detailPanel.id:""}get isDetailPanelShowing(){return!!this.data&&this.data.getIsDetailPanelShowing(this)}setIsDetailPanelShowing(e){!e&&this.detailPanel&&this.detailPanel.onHidingContent(),this.data&&this.data.setIsDetailPanelShowing(this,e),this.onDetailPanelShowingChanged&&this.onDetailPanelShowingChanged()}showHideDetailPanel(){this.isDetailPanelShowing?this.hideDetailPanel():this.showDetailPanel()}showDetailPanel(){this.ensureDetailPanel(),this.detailPanelValue&&this.setIsDetailPanelShowing(!0)}hideDetailPanel(e=!1){this.setIsDetailPanelShowing(!1),e&&(this.detailPanelValue=null)}ensureDetailPanel(){if(!this.isCreatingDetailPanel&&!this.detailPanelValue&&this.hasPanel&&this.data){this.isCreatingDetailPanel=!0,this.detailPanelValue=this.data.createRowDetailPanel(this);var e=this.detailPanelValue.questions,t=this.data.getRowValue(this.data.getRowIndex(this));if(!a.isValueEmpty(t))for(var s=0;s<e.length;s++){let i=e[s].getValueName(),r=this.editingObj?E.getObjPropertyValue(this.editingObj,i):t[i];a.isValueEmpty(r)||(e[s].value=r)}this.detailPanelValue.setSurveyImpl(this),this.isCreatingDetailPanel=!1}}getAllValues(){return this.value}getFilteredValues(){let e=this.data?this.data.getDataFilteredValues():{};var t=this.validationValues;if(t)for(var s in t)e[s]=t[s];return e.row=this.getAllValues(),this.applyRowVariablesToValues(e,this.rowIndex),e}getFilteredProperties(){return{survey:this.getSurvey(),row:this}}applyRowVariablesToValues(e,t){e[sv.IndexVariableName]=t,e[sv.RowValueVariableName]=this.rowName,e[sv.RowNameVariableName]=this.rowName}runCondition(e,t,s){if(!this.data)return;e[sv.OwnerVariableName]=this.data.getFilteredData();let i=this.rowIndex;this.applyRowVariablesToValues(e,i);let r=a.createCopy(t);r[sv.RowVariableName]=this;let n=i>0?this.data.getRowValue(this.rowIndex-1):this.value;s?(e[sv.RowVariableName]=n,this.setRowsVisibleIfValues(e),this.visible=new el(s).run(e,t)):this.visible=!0;for(var o=0;o<this.cells.length;o++)o>0&&to(this.value,n),e[sv.RowVariableName]=n,this.cells[o].runCondition(e,r);this.detailPanel&&this.detailPanel.runCondition(e,r),this.isRowHasEnabledCondition()&&this.onQuestionReadOnlyChanged()}updateElementVisibility(){this.cells.forEach(e=>e.question.updateElementVisibility()),this.detailPanel&&this.detailPanel.updateElementVisibility()}setRowsVisibleIfValues(e){}getNamesWithDefaultValues(){let e=[];return this.questions.forEach(t=>{t.isValueDefault&&e.push(t.getValueName())}),e}clearValue(e){for(var t=this.questions,s=0;s<t.length;s++)t[s].clearValue(e)}onAnyValueChanged(e,t){for(var s=this.questions,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}getDataValueCore(e,t){var s=this.getSurvey();return s?s.getDataValueCore(e,t):e[t]}getValue(e){var t=this.getQuestionByName(e);return t?t.value:null}setValue(e,t){this.setValueCore(e,t,!1)}getVariable(e){}setVariable(e,t){}getComment(e){var t=this.getQuestionByName(e);return t?t.comment:""}setComment(e,t,s){this.setValueCore(e,t,!0)}findQuestionByName(e){if(!e)return;let t=sv.RowVariableName+".";if(0===e.indexOf(t))return this.getQuestionByName(e.substring(t.length));let s=this.getSurvey();return s?s.getQuestionByName(e):null}getEditingSurveyElement(){}setValueCore(e,t,s){if(this.isSettingValue)return;this.updateQuestionsValue(e,t,s),s||this.updateSharedQuestionsValue(e,t);var i=this.value,r=s?e+eg.commentSuffix:e,n=this.getQuestionByName(e),a=this.data.onRowChanging(this,r,i);if(n&&!this.isTwoValueEquals(a,t)&&(this.isSettingValue=!0,s?n.comment=a:n.value=a,this.isSettingValue=!1,i=this.value),this.data.isValidateOnValueChanging&&this.hasQuestonError(n))return;let o=null==t&&!n||s&&!t&&!!n;this.data.onRowChanged(this,r,i,o),r&&this.runTriggers(sy.RowVariableName+"."+r,i),this.onAnyValueChanged(sv.RowVariableName,"")}updateQuestionsValue(e,t,s){if(this.detailPanel){var i=this.getQuestionByColumnName(e),r=this.detailPanel.getQuestionByName(e);if(i&&r){var n=this.isTwoValueEquals(t,s?i.comment:i.value)?r:i;this.isSettingValue=!0,s?n.comment=t:n.value=t,this.isSettingValue=!1}}}updateSharedQuestionsValue(e,t){let s=this.getQuestionsByValueName(e);if(s.length>1)for(let e=0;e<s.length;e++)a.isTwoValueEquals(s[e].value,t)||(this.isSettingValue=!0,s[e].updateValueFromSurvey(t),this.isSettingValue=!1)}runTriggers(e,t){e&&this.questions.forEach(s=>s.runTriggers(e,t))}hasQuestonError(e){if(!e)return!1;if(e.hasErrors(!0,{isOnValueChanged:!this.data.isValidateOnValueChanging}))return!0;if(e.isEmpty())return!1;var t=this.getCellByColumnName(e.name);return!!t&&!!t.column&&!!t.column.isUnique&&this.data.checkIfValueInRowDuplicated(this,e)}get isEmpty(){var e=this.value;if(a.isValueEmpty(e))return!0;for(var t in e)if(void 0!==e[t]&&null!==e[t])return!1;return!0}getQuestionByColumn(e){var t=this.getCellByColumn(e);return t?t.question:null}getCellByColumn(e){for(var t=0;t<this.cells.length;t++)if(this.cells[t].column==e)return this.cells[t];return null}getCellByColumnName(e){for(var t=0;t<this.cells.length;t++)if(this.cells[t].column.name==e)return this.cells[t];return null}getQuestionByColumnName(e){var t=this.getCellByColumnName(e);return t?t.question:null}get questions(){for(var e=[],t=0;t<this.cells.length;t++)e.push(this.cells[t].question);for(var s=this.detailPanel?this.detailPanel.questions:[],t=0;t<s.length;t++)e.push(s[t]);return e}getQuestionByName(e){var t=this.getQuestionByColumnName(e);return t||(this.detailPanel?this.detailPanel.getQuestionByName(e):null)}getQuestionsByName(e){let t=[],s=this.getQuestionByColumnName(e);return s&&t.push(s),this.detailPanel&&(s=this.detailPanel.getQuestionByName(e))&&t.push(s),t}getQuestionsByValueName(e){let t=[];for(var s=0;s<this.cells.length;s++){let i=this.cells[s];i.question&&i.question.getValueName()===e&&t.push(i.question)}return this.detailPanel&&(t=t.concat(this.detailPanel.getQuestionsByValueName(e))),t}getSharedQuestionByName(e){return this.data?this.data.getSharedQuestionByName(e,this):null}clearIncorrectValues(e){for(var t in e){var s=this.getQuestionByName(t);if(s){var i=s.value;s.clearIncorrectValues(),this.isTwoValueEquals(i,s.value)||this.setValue(t,s.value)}else!this.getSharedQuestionByName(t)&&0>t.indexOf(tp.matrix.totalsSuffix)&&this.setValue(t,null)}}getLocale(){return this.data?this.data.getLocale():""}getMarkdownHtml(e,t){return this.data?this.data.getMarkdownHtml(e,t):void 0}getRenderer(e){return this.data?this.data.getRenderer(e):null}getRendererContext(e){return this.data?this.data.getRendererContext(e):e}getProcessedText(e){return this.data?this.data.getProcessedText(e):e}locStrsChanged(){for(var e=0;e<this.cells.length;e++)this.cells[e].locStrsChanged();this.detailPanel&&this.detailPanel.locStrsChanged()}updateCellQuestionOnColumnChanged(e,t,s){var i=this.getCellByColumn(e);i&&this.updateCellOnColumnChanged(i,t,s)}updateCellQuestionOnColumnItemValueChanged(e,t,s,i,r,n){var a=this.getCellByColumn(e);a&&this.updateCellOnColumnItemValueChanged(a,t,s,i,r,n)}onQuestionReadOnlyChanged(){let e=this.questions;for(var t=0;t<e.length;t++){let s=e[t];s.setPropertyValue("isReadOnly",s.isReadOnly)}if(this.detailPanel){let e=!!this.data&&this.data.isMatrixReadOnly();this.detailPanel.readOnly=e||!this.isRowEnabled()}}hasErrors(e,t,s){var i=!1,r=this.cells;if(!r)return i;this.validationValues=t.validationValues;for(var n=0;n<r.length;n++){if(r[n]){var a=r[n].question;a&&a.visible&&(a.onCompletedAsyncValidators=e=>{s()},t&&!0===t.isOnValueChanged&&a.isEmpty()||(i=a.hasErrors(e,t)||i))}}if(this.hasPanel){this.ensureDetailPanel();var o=this.detailPanel.hasErrors(e,!1,t);!t.hideErroredPanel&&o&&e&&(t.isSingleDetailPanel&&(t.hideErroredPanel=!0),this.showDetailPanel()),i=o||i}return this.validationValues=void 0,i}updateCellOnColumnChanged(e,t,s){"choices"===t&&Array.isArray(s)&&0===s.length&&this.data&&(s=this.data.choices),e.question[t]=s}updateCellOnColumnItemValueChanged(e,t,s,i,r,n){var a=e.question[t];if(Array.isArray(a)){var o="value"===i?n:s.value,l=tJ.getItemByValue(a,o);l&&(l[i]=r)}}buildCells(e){this.isSettingValue=!0;for(var t=this.data.columns,s=0;s<t.length;s++){var i=t[s],r=this.createCell(i);this.cells.push(r);var n=this.getCellValue(e,i.name);if(!a.isValueEmpty(n)){r.question.value=n;var o=i.name+eg.commentSuffix;e&&!a.isValueEmpty(e[o])&&(r.question.comment=e[o])}}this.isSettingValue=!1}isTwoValueEquals(e,t){return a.isTwoValueEquals(e,t,!1,!0,!1)}getCellValue(e,t){return this.editingObj?E.getObjPropertyValue(this.editingObj,t):e?e[t]:void 0}createCell(e){return new sg(e,this,this.data)}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.textPreProcessor}get rowIndex(){return this.getRowIndex()}getRowIndex(){return this.data?this.data.getRowIndex(this)+1:-1}get editingObj(){return this.editingObjValue}dispose(){this.editingObj&&(this.editingObj.onPropertyChanged.remove(this.onEditingObjPropertyChanged),this.editingObjValue=null)}subscribeToChanges(e){e&&e.getType&&e.onPropertyChanged&&e!==this.editingObj&&(this.editingObjValue=e,this.onEditingObjPropertyChanged=(e,t)=>{this.updateOnSetValue(t.name,t.newValue)},this.editingObj.onPropertyChanged.add(this.onEditingObjPropertyChanged))}updateOnSetValue(e,t){this.isSettingValue=!0;let s=this.getQuestionsByName(e);for(let e=0;e<s.length;e++)s[e].value=t;this.isSettingValue=!1}}sv.RowVariableName="row",sv.OwnerVariableName="self",sv.IndexVariableName="rowIndex",sv.RowValueVariableName="rowValue",sv.RowNameVariableName="rowName",sv.idCounter=1;class sy extends sv{constructor(e){super(e,null),this.buildCells(null)}createCell(e){return new sp(e,this,this.data)}setValue(e,t){this.data&&!this.isSettingValue&&this.data.onTotalValueChanged()}runCondition(e,t,s){var i,r=0;do i=a.getUnbindValue(this.value),super.runCondition(e,t,""),r++;while(!a.isTwoValueEquals(i,this.value)&&r<3)}updateCellOnColumnChanged(e,t,s){e.updateCellQuestion()}}class sC extends t0{static get defaultCellType(){return tp.matrix.defaultCellType}static set defaultCellType(e){tp.matrix.defaultCellType=e}static addDefaultColumns(e){for(var t=st.DefaultColums,s=0;s<t.length;s++)e.addColumn(t[s])}createColumnValues(){return this.createNewArray("columns",e=>{e.colOwner=this,this.onAddColumn&&this.onAddColumn(e),this.survey&&this.survey.matrixColumnAdded(this,e)},e=>{e.colOwner=null,this.onRemoveColumn&&this.onRemoveColumn(e)})}constructor(e){super(e),this.isRowChanging=!1,this.lockResetRenderedTable=!1,this.isDoingonAnyValueChanged=!1,this.createItemValues("choices"),this.createLocalizableString("placeholder",this,!1,!0),this.createLocalizableString("keyDuplicationError",this,!1,!0),this.detailPanelValue=this.createNewDetailPanel(),this.detailPanel.selectedElementInDesign=this,this.detailPanel.renderWidth="100%",this.detailPanel.isInteractiveDesignElement=!1,this.detailPanel.showTitle=!1,this.registerPropertyChangedHandlers(["columns","cellType"],()=>{this.updateColumnsAndRows()}),this.registerPropertyChangedHandlers(["placeholder","columnColCount","rowTitleWidth","choices"],()=>{this.clearRowsAndResetRenderedTable()}),this.registerPropertyChangedHandlers(["transposeData","addRowButtonLocation","hideColumnsIfEmpty","showHeader","minRowCount","isReadOnly","rowCount","hasFooter","detailPanelMode","displayMode"],()=>{this.resetRenderedTable()})}getType(){return"matrixdropdownbase"}dispose(){super.dispose(),this.clearGeneratedRows()}get hasSingleInput(){return!1}get isContainer(){return!0}get isRowsDynamic(){return!1}get isUpdateLocked(){return this.isLoadingFromJson||this.isUpdating}beginUpdate(){this.isUpdating=!0}endUpdate(){this.isUpdating=!1,this.updateColumnsAndRows()}updateColumnsAndRows(){this.updateColumnsIndexes(this.columns),this.updateColumnsCellType(),this.generatedTotalRow=null,this.clearRowsAndResetRenderedTable()}itemValuePropertyChanged(e,t,s,i){super.itemValuePropertyChanged(e,t,s,i),"choices"===e.ownerPropertyName&&this.clearRowsAndResetRenderedTable()}get transposeData(){return this.getPropertyValue("transposeData")}set transposeData(e){this.setPropertyValue("transposeData",e)}get columnLayout(){return this.transposeData?"vertical":"horizontal"}set columnLayout(e){this.transposeData="vertical"===e}get columnsLocation(){return this.columnLayout}set columnsLocation(e){this.columnLayout=e}get detailErrorLocation(){return this.getPropertyValue("detailErrorLocation")}set detailErrorLocation(e){this.setPropertyValue("detailErrorLocation",e.toLowerCase())}get cellErrorLocation(){return this.getPropertyValue("cellErrorLocation")}set cellErrorLocation(e){this.setPropertyValue("cellErrorLocation",e.toLowerCase())}getChildErrorLocation(e){let t=e.parent?this.detailErrorLocation:this.cellErrorLocation;return"default"!==t?t:super.getChildErrorLocation(e)}get isColumnLayoutHorizontal(){return!!this.isMobile||!this.transposeData}get useCaseSensitiveComparison(){return void 0!==this.useCaseSensitiveComparisonValue?this.useCaseSensitiveComparisonValue:tp.comparator.caseSensitive}set useCaseSensitiveComparison(e){this.useCaseSensitiveComparisonValue=e}get isUniqueCaseSensitive(){return this.useCaseSensitiveComparison}set isUniqueCaseSensitive(e){this.useCaseSensitiveComparison=e}get detailPanelMode(){return this.getPropertyValue("detailPanelMode")}set detailPanelMode(e){this.setPropertyValue("detailPanelMode",e)}get detailPanel(){return this.detailPanelValue}getPanel(){return this.detailPanel}get detailElements(){return this.detailPanel.elements}createNewDetailPanel(){return E.createClass("panel")}get hasRowText(){return!0}getFooterText(){return null}get canAddRow(){return!1}get canRemoveRows(){return!1}canRemoveRow(e){return!0}onPointerDown(e,t){}onRowsChanged(){this.clearVisibleRows(),this.resetRenderedTable(),super.onRowsChanged()}onStartRowAddingRemoving(){this.lockResetRenderedTable=!0,this.setValueChangedDirectly(!0)}onEndRowAdding(){if(this.lockResetRenderedTable=!1,this.renderedTable){if(this.renderedTable.isRequireReset())this.resetRenderedTable();else{let e=this.visibleRows.length-1;this.renderedTable.onAddedRow(this.visibleRows[e],e)}}}onEndRowRemoving(e){this.lockResetRenderedTable=!1,this.renderedTable.isRequireReset()?this.resetRenderedTable():e&&this.renderedTable.onRemovedRow(e)}get renderedTableValue(){return this.getPropertyValue("renderedTable",null)}set renderedTableValue(e){this.setPropertyValue("renderedTable",e)}clearRowsAndResetRenderedTable(){this.clearGeneratedRows(),this.resetRenderedTable(),this.fireCallback(this.columnsChangedCallback)}resetRenderedTable(){this.lockResetRenderedTable||this.isUpdateLocked||(this.renderedTableValue=null,this.fireCallback(this.onRenderedTableResetCallback))}clearGeneratedRows(){if(this.clearVisibleRows(),this.generatedVisibleRows){for(var e=0;e<this.generatedVisibleRows.length;e++)this.generatedVisibleRows[e].dispose();super.clearGeneratedRows()}}get isRendredTableCreated(){return!!this.renderedTableValue}get renderedTable(){return!this.renderedTableValue&&(this.renderedTableValue=this.createRenderedTable(),this.onRenderedTableCreatedCallback&&this.onRenderedTableCreatedCallback(this.renderedTableValue)),this.renderedTableValue}createRenderedTable(){return new sc(this)}onMatrixRowCreated(e){if(this.survey)for(var t={rowValue:e.value,row:e,column:null,columnName:null,cell:null,cellQuestion:null,value:null},s=0;s<this.columns.length;s++){t.column=this.columns[s],t.columnName=t.column.name;var i=e.cells[s];t.cell=i,t.cellQuestion=i.question,t.value=i.value,this.onCellCreatedCallback&&this.onCellCreatedCallback(t),this.survey.matrixCellCreated(this,t)}}get cellType(){return this.getPropertyValue("cellType",tp.matrix.defaultCellType)}set cellType(e){e=e.toLowerCase(),this.setPropertyValue("cellType",e)}isSelectCellType(){return E.isDescendantOf(this.cellType,"selectbase")}updateColumnsCellType(){for(var e=0;e<this.columns.length;e++)this.columns[e].defaultCellTypeChanged()}updateColumnsIndexes(e){for(var t=0;t<e.length;t++)e[t].setIndex(t)}get columnColCount(){return this.getPropertyValue("columnColCount")}set columnColCount(e){e<0||e>4||this.setPropertyValue("columnColCount",e)}get horizontalScroll(){return this.getPropertyValue("horizontalScroll")}set horizontalScroll(e){this.setPropertyValue("horizontalScroll",e)}get allowAdaptiveActions(){return this.getPropertyValue("allowAdaptiveActions")}set allowAdaptiveActions(e){this.setPropertyValue("allowAdaptiveActions",e),this.detailPanel&&(this.detailPanel.allowAdaptiveActions=e)}hasChoices(){return this.choices.length>0}onColumnPropertyChanged(e,t,s){if(this.updateHasFooter(),this.generatedVisibleRows){for(var i=0;i<this.generatedVisibleRows.length;i++)this.generatedVisibleRows[i].updateCellQuestionOnColumnChanged(e,t,s);this.generatedTotalRow&&this.generatedTotalRow.updateCellQuestionOnColumnChanged(e,t,s),this.onColumnsChanged(),"isRequired"==t&&this.resetRenderedTable()}}onColumnItemValuePropertyChanged(e,t,s,i,r,n){if(this.generatedVisibleRows)for(var a=0;a<this.generatedVisibleRows.length;a++)this.generatedVisibleRows[a].updateCellQuestionOnColumnItemValueChanged(e,t,s,i,r,n)}onShowInMultipleColumnsChanged(e){this.resetTableAndRows()}onColumnVisibilityChanged(e){this.resetTableAndRows()}onColumnCellTypeChanged(e){this.resetTableAndRows()}resetTableAndRows(){this.clearGeneratedRows(),this.resetRenderedTable()}getRowTitleWidth(){return""}get hasFooter(){return this.getPropertyValue("hasFooter",!1)}getAddRowLocation(){return"default"}getShowColumnsIfEmpty(){return!1}updateShowTableAndAddRow(){this.renderedTable&&this.renderedTable.updateShowTableAndAddRow()}updateHasFooter(){this.setPropertyValue("hasFooter",this.hasTotal)}get hasTotal(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].hasTotal)return!0;return!1}getCellType(){return this.cellType}getCustomCellType(e,t,s){if(!this.survey)return s;var i={rowValue:t.value,row:t,column:e,columnName:e.name,cellType:s};return this.survey.matrixCellCreating(this,i),i.cellType}getConditionJson(e=null,t=null){let s;if(!t)return super.getConditionJson(e);let i="";for(let e=t.length-1;e>=0&&"."!=t[e];e--)i=t[e]+i;let r=this.getColumnByName(i);return r?s=r.createCellQuestion(null):"none"!==this.detailPanelMode&&(s=this.detailPanel.getQuestionByName(i)),s?s.getConditionJson(e):null}clearIncorrectValues(){if(!Array.isArray(this.visibleRows))return;let e=this.generatedVisibleRows;for(let t=0;t<e.length;t++)e[t].clearIncorrectValues(this.getRowValue(t))}clearErrors(){super.clearErrors(),this.runFuncForCellQuestions(e=>{e.clearErrors()})}localeChanged(){super.localeChanged(),this.runFuncForCellQuestions(e=>{e.localeChanged()})}runFuncForCellQuestions(e){let t=this.generatedVisibleRows;if(t)for(let s=0;s<t.length;s++){let i=t[s];if(i.isVisible)for(let t=0;t<i.cells.length;t++)e(i.cells[t].question)}}runConditionCore(e,t){let s=e[sv.RowVariableName];super.runConditionCore(e,t);var i,r=0;do i=a.getUnbindValue(this.totalValue),this.runCellsCondition(e,t),this.runTotalsCondition(e,t),r++;while(!a.isTwoValueEquals(i,this.totalValue)&&r<3);this.updateVisibilityBasedOnRows(),e[sv.RowVariableName]=s}runTriggers(e,t,s){super.runTriggers(e,t,s),this.runFuncForCellQuestions(i=>{i.runTriggers(e,t,s)})}updateElementVisibility(){super.updateElementVisibility();let e=this.generatedVisibleRows;e&&e.forEach(e=>e.updateElementVisibility())}shouldRunColumnExpression(){return!1}runCellsCondition(e,t){if(this.isDesignMode)return;let s=this.generatedVisibleRows;if(s){let r=this.getRowConditionValues(e);for(var i=0;i<s.length;i++)s[i].runCondition(r,t,this.rowsVisibleIf)}this.checkColumnsVisibility(),this.checkColumnsRenderedRequired()}runConditionsForColumns(e,t){return this.columns.forEach(s=>{if(this.columnsVisibleIf){let i=new el(this.columnsVisibleIf);e.item=s.name,s.isColumnsVisibleIf=!0===i.run(e,t)}else s.isColumnsVisibleIf=!0}),!1}checkColumnsVisibility(){if(!this.isDesignMode){for(var e=!1,t=0;t<this.columns.length;t++){let s=this.columns[t],i=!!s.visibleIf||s.isFilteredMultipleColumns;(i||this.columnsVisibleIf||!s.isColumnVisible)&&(e=this.isColumnVisibilityChanged(s,i)||e)}e&&this.resetRenderedTable()}}checkColumnsRenderedRequired(){let e=this.generatedVisibleRows;if(e)for(var t=0;t<this.columns.length;t++){let i=this.columns[t];if(!i.requiredIf||!i.isColumnVisible)continue;let r=e.length>0;for(var s=0;s<e.length;s++)if(!e[s].cells[t].question.isRequired){r=!1;break}i.updateIsRenderedRequired(r)}}isColumnVisibilityChanged(e,t){let s=e.isColumnVisible,i=!t,r=this.generatedVisibleRows,n=t&&r,o=n&&e.isFilteredMultipleColumns,l=o?e.getVisibleChoicesInCell:[],h=[];if(n)for(let t=0;t<r.length;t++){let s=r[t].cells[e.index],n=null==s?void 0:s.question;if(n&&n.isVisible){if(i=!0,o)this.updateNewVisibleChoices(n,h);else break}}return e.hasVisibleCell=i&&e.isColumnsVisibleIf,!!o&&(e.setVisibleChoicesInCell(h),!a.isArraysEqual(l,h,!0,!1,!1))||s!==e.isColumnVisible}updateNewVisibleChoices(e,t){let s=e.visibleChoices;if(Array.isArray(s))for(let e=0;e<s.length;e++){let i=s[e];0>t.indexOf(i.value)&&t.push(i.value)}}runTotalsCondition(e,t){this.generatedTotalRow&&this.generatedTotalRow.runCondition(this.getRowConditionValues(e),t)}getRowConditionValues(e){var t=e;t||(t={});var s={};return this.isValueEmpty(this.totalValue)||(s=JSON.parse(JSON.stringify(this.totalValue))),t.row={},t.totalRow=s,t}IsMultiplyColumn(e){return e.isShowInMultipleColumns&&!this.isMobile}locStrsChanged(){super.locStrsChanged();for(var e=this.columns,t=0;t<e.length;t++)e[t].locStrsChanged();var s=this.generatedVisibleRows;if(s){for(var t=0;t<s.length;t++)s[t].locStrsChanged();this.generatedTotalRow&&this.generatedTotalRow.locStrsChanged()}}getColumnByName(e){for(var t=0;t<this.columns.length;t++)if(this.columns[t].name==e)return this.columns[t];return null}getColumnName(e){return this.getColumnByName(e)}getColumnWidth(e){var t;return e.minWidth?e.minWidth:this.columnMinWidth?this.columnMinWidth:(null===(t=tp.matrix.columnWidthsByType[e.cellType])||void 0===t?void 0:t.minWidth)||""}get choices(){return this.getPropertyValue("choices")}set choices(e){this.setPropertyValue("choices",e)}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}get optionsCaption(){return this.placeholder}set optionsCaption(e){this.placeholder=e}get keyDuplicationError(){return this.getLocalizableStringText("keyDuplicationError")}set keyDuplicationError(e){this.setLocalizableStringText("keyDuplicationError",e)}get locKeyDuplicationError(){return this.getLocalizableString("keyDuplicationError")}get storeOthersAsComment(){return!!this.survey&&this.survey.storeOthersAsComment}addColumn(e,t){var s=new so(e,t,this);return this.columns.push(s),s}clearVisibleRows(){this.visibleRowsArray=null}isColumnVisible(e){return e.isColumnVisible}getVisibleRows(){return this.isUpdateLocked?null:this.isGenereatingRows?[]:(this.visibleRowsArray||(this.generateVisibleRowsIfNeeded(),this.visibleRowsArray=this.getVisibleFromGenerated(this.generatedVisibleRows)),this.visibleRowsArray)}generateVisibleRowsIfNeeded(){this.isUpdateLocked||this.generatedVisibleRows||this.generatedVisibleRows||(this.isGenereatingRows=!0,this.generatedVisibleRows=this.generateRows(),this.isGenereatingRows=!1,this.generatedVisibleRows.forEach(e=>this.onMatrixRowCreated(e)),this.data&&this.runCellsCondition(this.data.getFilteredValues(),this.data.getFilteredProperties()),this.generatedVisibleRows&&(this.updateValueOnRowsGeneration(this.generatedVisibleRows),this.updateIsAnswered()))}getVisibleFromGenerated(e){let t=[];return e?(e.forEach(e=>{e.isVisible&&t.push(e)}),t.length===e.length?e:t):t}updateValueOnRowsGeneration(e){for(var t=this.createNewValue(!0),s=this.createNewValue(),i=0;i<e.length;i++){var r=e[i];if(!r.editingObj){var n=this.getRowValue(i),a=r.value;this.isTwoValueEquals(n,a)||(s=this.getNewValueOnRowChanged(r,"",a,!1,s).value)}}this.isTwoValueEquals(t,s)||(this.isRowChanging=!0,this.setNewValue(s),this.isRowChanging=!1)}get totalValue(){return this.hasTotal&&this.visibleTotalRow?this.visibleTotalRow.value:{}}getVisibleTotalRow(){if(this.isUpdateLocked)return null;if(this.hasTotal){if(!this.generatedTotalRow&&(this.generatedTotalRow=this.generateTotalRow(),this.data)){var e={survey:this.survey};this.runTotalsCondition(this.data.getAllValues(),e)}}else this.generatedTotalRow=null;return this.generatedTotalRow}get visibleTotalRow(){return this.getVisibleTotalRow()}onSurveyLoad(){super.onSurveyLoad(),this.updateColumnsIndexes(this.columns),this.clearGeneratedRows(),this.generatedTotalRow=null,this.updateHasFooter()}getRowValue(e){if(e<0||!Array.isArray(this.visibleRows))return null;var t=this.generatedVisibleRows;if(e>=t.length)return null;let s=this.value,i=this.getRowValueCore(t[e],s);return this.isValueSurveyElement(s)?i:a.getUnbindValue(i)}checkIfValueInRowDuplicated(e,t){return!!this.generatedVisibleRows&&this.isValueInColumnDuplicated(t.name,!0,e)}setRowValue(e,t){if(e<0)return null;var s=this.visibleRows;if(e>=s.length)return null;s[e].value=t,this.onRowChanged(s[e],"",t,!1)}generateRows(){return null}generateTotalRow(){return new sy(this)}createNewValue(e=!1){var t=this.value?this.createValueCopy():{};return e&&this.isMatrixValueEmpty(t)?null:t}getRowValueCore(e,t,s=!1){var i=t&&t[e.rowName]?t[e.rowName]:null;return!i&&s&&(i={},t&&(t[e.rowName]=i)),i}getRowObj(e){var t=this.getRowValueCore(e,this.value);return t&&t.getType?t:null}getRowDisplayValue(e,t,s){if(!s||t.editingObj)return s;for(var i=Object.keys(s),r=0;r<i.length;r++){var n=i[r],a=t.getQuestionByName(n);if(a||(a=this.getSharedQuestionByName(n,t)),a){var o=a.getDisplayValue(e,s[n]);e&&a.title&&a.title!==n?(s[a.title]=o,delete s[n]):s[n]=o}}return s}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){t.isNode=!0;let s=Array.isArray(t.data)?[].concat(t.data):[];t.data=this.visibleRows.map(t=>{var s={name:t.dataName,title:t.text,value:t.value,displayValue:this.getRowDisplayValue(!1,t,t.value),getString:e=>"object"==typeof e?JSON.stringify(e):e,isNode:!0,data:t.cells.map(t=>t.question.getPlainData(e)).filter(e=>!!e)};return(e.calculations||[]).forEach(e=>{s[e.propertyName]=t[e.propertyName]}),s}),t.data=t.data.concat(s)}return t}addConditionObjectsByContext(e,t){let s=[].concat(this.columns);"none"!==this.detailPanelMode&&(s=s.concat(this.detailPanel.questions));let i=!!t&&s.indexOf(t)>-1,r=!0===t||i,n=this.getConditionObjectsRowIndeces();r&&n.push(-1);for(var a=0;a<n.length;a++){let r=n[a],l=r>-1?this.getConditionObjectRowName(r):"row";if(!l)continue;let h=r>-1?this.getConditionObjectRowText(r):"row",u=r>-1||!0===t,d=u&&-1===r?".":"",c=(u?this.getValueName():"")+d+l+".",g=(u?this.processedTitle:"")+d+h+".";for(var o=0;o<s.length;o++){let n=s[o];if(-1===r&&t===n)continue;let a={name:c+n.name,text:g+n.fullTitle,question:this};-1===r&&!0===t?a.context=this:i&&c.startsWith("row.")&&(a.context=t),e.push(a)}}}onHidingContent(){if(super.onHidingContent(),!this.generatedVisibleRows)return;let e=[];this.collectNestedQuestions(e,!0),e.forEach(e=>e.onHidingContent())}getIsReadyNestedQuestions(){if(!this.generatedVisibleRows)return[];let e=[];return this.collectNestedQuestonsInRows(this.generatedVisibleRows,e,!1),this.generatedTotalRow&&this.collectNestedQuestonsInRows([this.generatedTotalRow],e,!1),e}collectNestedQuestionsCore(e,t){this.collectNestedQuestonsInRows(this.visibleRows,e,t)}collectNestedQuestonsInRows(e,t,s){Array.isArray(e)&&e.forEach(e=>{e.questions.forEach(e=>e.collectNestedQuestions(t,s))})}getConditionObjectRowName(e){return""}getConditionObjectRowText(e){return this.getConditionObjectRowName(e)}getConditionObjectsRowIndeces(){return[]}getProgressInfo(){if(this.getIsRequireToGenerateRows()&&this.generateVisibleRowsIfNeeded(),this.generatedVisibleRows)return eW.getProgressInfoByElements(this.getCellQuestions(),this.isRequired);let e=eg.createProgressInfo();return this.updateProgressInfoByValues(e),0===e.requiredQuestionCount&&this.isRequired&&(e.requiredQuestionCount=1,e.requiredAnsweredQuestionCount=+!this.isEmpty()),e}getIsRequireToGenerateRows(){return!!this.rowsVisibleIf}updateProgressInfoByValues(e){}updateProgressInfoByRow(e,t){for(var s=0;s<this.columns.length;s++){let i=this.columns[s];if(!i.templateQuestion.hasInput)continue;let r=!a.isValueEmpty(t[i.name]);(r||!i.templateQuestion.visibleIf)&&(e.questionCount+=1,e.requiredQuestionCount+=i.isRequired,e.answeredQuestionCount+=+!!r,e.requiredAnsweredQuestionCount+=r&&i.isRequired?1:0)}}getCellQuestions(){let e=[];return this.runFuncForCellQuestions(t=>{e.push(t)}),e}onBeforeValueChanged(e){}onSetQuestionValue(){if(!this.isRowChanging&&(this.onBeforeValueChanged(this.value),this.generatedVisibleRows&&0!=this.generatedVisibleRows.length)){this.isRowChanging=!0;for(var e=this.createNewValue(),t=0;t<this.generatedVisibleRows.length;t++){var s=this.generatedVisibleRows[t];this.generatedVisibleRows[t].value=this.getRowValueCore(s,e)}this.isRowChanging=!1}}setQuestionValue(e){super.setQuestionValue(e,!1),this.onSetQuestionValue(),this.updateIsAnswered()}supportAutoAdvance(){var e=this.generatedVisibleRows;if(e||(e=this.visibleRows),!e)return!0;for(var t=0;t<e.length;t++){var s=this.generatedVisibleRows[t].cells;if(s)for(var i=0;i<s.length;i++){var r=s[i].question;if(r&&(!r.supportAutoAdvance()||!r.value))return!1}}return!0}getContainsErrors(){return super.getContainsErrors()||this.checkForAnswersOrErrors(e=>e.containsErrors,!1)}getIsAnswered(){return super.getIsAnswered()&&this.checkForAnswersOrErrors(e=>e.isAnswered,!0)}checkForAnswersOrErrors(e,t=!1){var s=this.generatedVisibleRows;if(!s)return!1;for(var i=0;i<s.length;i++){var r=s[i].cells;if(r){for(var n=0;n<r.length;n++)if(r[n]){var a=r[n].question;if(a&&a.isVisible){if(e(a)){if(!t)return!0}else if(t)return!1}}}}return!!t}hasErrors(e=!0,t=null){var s=this.hasErrorInRows(e,t),i=this.isValueDuplicated();return super.hasErrors(e,t)||s||i}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;if(!this.generatedVisibleRows)return!1;for(var e=0;e<this.generatedVisibleRows.length;e++){var t=this.generatedVisibleRows[e].cells;if(t){for(var s=0;s<t.length;s++)if(t[s]){var i=t[s].question;if(i&&i.isRunningValidators)return!0}}}return!1}getAllErrors(){var e=super.getAllErrors(),t=this.generatedVisibleRows;if(null===t)return e;for(var s=0;s<t.length;s++)for(var i=t[s],r=0;r<i.cells.length;r++){var n=i.cells[r].question.getAllErrors();n&&n.length>0&&(e=e.concat(n))}return e}hasErrorInRows(e,t){let s=this.generatedVisibleRows;this.generatedVisibleRows||(s=this.visibleRows);var i=!1;if(t||(t={}),!s)return t;t.validationValues=this.getDataFilteredValues(),t.isSingleDetailPanel="underRowSingle"===this.detailPanelMode;for(var r=0;r<s.length;r++)s[r].isVisible&&(i=s[r].hasErrors(e,t,()=>{this.raiseOnCompletedAsyncValidators()})||i);return i}isValueDuplicated(){if(!this.generatedVisibleRows)return!1;for(var e=this.getUniqueColumnsNames(),t=!1,s=0;s<e.length;s++)t=this.isValueInColumnDuplicated(e[s],!0)||t;return t}getUniqueColumnsNames(){for(var e=[],t=0;t<this.columns.length;t++)this.columns[t].isUnique&&e.push(this.columns[t].name);return e}isValueInColumnDuplicated(e,t,s){let i=this.getDuplicatedRows(e);return t&&this.showDuplicatedErrorsInRows(i,e),this.removeDuplicatedErrorsInRows(i,e),s?i.indexOf(s)>-1:i.length>0}getDuplicatedRows(e){let t={},s=[],i=this.generatedVisibleRows;for(var r=0;r<i.length;r++){let s;let n=i[r].getQuestionByName(e);if(n)s=n.value;else{let t=this.getRowValue(r);s=t?t[e]:void 0}this.isValueEmpty(s)||(this.useCaseSensitiveComparison||"string"!=typeof s||(s=s.toLocaleLowerCase()),t[s]||(t[s]=[]),t[s].push(i[r]))}for(let e in t)t[e].length>1&&t[e].forEach(e=>s.push(e));return s}showDuplicatedErrorsInRows(e,t){e.forEach(e=>{let s=e.getQuestionByName(t),i=this.detailPanel.getQuestionByName(t);!s&&i&&(e.showDetailPanel(),e.detailPanel&&(s=e.detailPanel.getQuestionByName(t))),s&&(i&&e.showDetailPanel(),this.addDuplicationError(s))})}removeDuplicatedErrorsInRows(e,t){this.generatedVisibleRows.forEach(s=>{if(0>e.indexOf(s)){let e=s.getQuestionByName(t);e&&this.removeDuplicationError(s,e)}})}getDuplicationError(e){let t=e.errors;for(let e=0;e<t.length;e++)if("keyduplicationerror"===t[e].getErrorType())return t[e];return null}addDuplicationError(e){this.getDuplicationError(e)||e.addError(new tR(this.keyDuplicationError,this))}removeDuplicationError(e,t){t.removeError(this.getDuplicationError(t))&&0===t.errors.length&&e.editingObj&&(e.editingObj[t.getValueName()]=t.value)}getFirstQuestionToFocus(e){return this.getFirstCellQuestion(e)}getFirstInputElementId(){var e=this.getFirstCellQuestion(!1);return e?e.inputId:super.getFirstInputElementId()}getFirstErrorInputElementId(){var e=this.getFirstCellQuestion(!0);return e?e.inputId:super.getFirstErrorInputElementId()}getFirstCellQuestion(e){if(!this.generatedVisibleRows)return null;for(var t=0;t<this.generatedVisibleRows.length;t++)for(var s=this.generatedVisibleRows[t].cells,i=0;i<s.length;i++)if(!e||s[i].question.currentErrorCount>0)return s[i].question;return null}onReadOnlyChanged(){if(super.onReadOnlyChanged(),this.generateRows)for(var e=0;e<this.visibleRows.length;e++)this.visibleRows[e].onQuestionReadOnlyChanged()}createQuestion(e,t){return this.createQuestionCore(e,t)}createQuestionCore(e,t){var s=t.createCellQuestion(e);return s.setSurveyImpl(e),s.setParentQuestion(this),s.inMatrixMode=!0,s}deleteRowValue(e,t){return e?(delete e[t.rowName],this.isObject(e)&&0==Object.keys(e).length?null:e):e}onAnyValueChanged(e,t){if(!this.isUpdateLocked&&!this.isDoingonAnyValueChanged&&this.generatedVisibleRows){this.isDoingonAnyValueChanged=!0;for(var s=this.generatedVisibleRows,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t);var r=this.visibleTotalRow;r&&r.onAnyValueChanged(e,t),this.isDoingonAnyValueChanged=!1}}isObject(e){return null!==e&&"object"==typeof e}getOnCellValueChangedOptions(e,t,s){return{row:e,columnName:t,rowValue:s,value:s?s[t]:null,getCellQuestion:t=>e.getQuestionByName(t),cellQuestion:e.getQuestionByName(t),column:this.getColumnByName(t)}}onCellValueChanged(e,t,s){if(this.survey){var i=this.getOnCellValueChangedOptions(e,t,s);this.onCellValueChangedCallback&&this.onCellValueChangedCallback(i),this.survey.matrixCellValueChanged(this,i)}}validateCell(e,t,s){if(this.survey){var i=this.getOnCellValueChangedOptions(e,t,s);return this.survey.matrixCellValidate(this,i)}}get isValidateOnValueChanging(){return!!this.survey&&this.survey.isValidateOnValueChanging}get hasInvisibleRows(){let e=this.generatedVisibleRows;if(!Array.isArray(e))return!1;for(let t=0;t<e.length;t++)if(!e[t].isVisible)return!0;return!1}getFilteredData(){return!this.isEmpty()&&this.generatedVisibleRows&&this.hasInvisibleRows?this.getFilteredDataCore():this.value}getFilteredDataCore(){return this.value}onRowChanging(e,t,s){if(!this.survey&&!this.cellValueChangingCallback)return s?s[t]:null;var i=this.getOnCellValueChangedOptions(e,t,s),r=this.getRowValueCore(e,this.createNewValue(),!0);return i.oldValue=r?r[t]:null,this.cellValueChangingCallback&&(i.value=this.cellValueChangingCallback(e,t,i.value,i.oldValue)),this.survey&&this.survey.matrixCellValueChanging(this,i),i.value}onRowChanged(e,t,s,i){var r=t?this.getRowObj(e):null;if(r){var n=null;s&&!i&&(n=s[t]),this.isRowChanging=!0,E.setObjPropertyValue(r,t,n),this.isRowChanging=!1,this.onCellValueChanged(e,t,r)}else{var a=this.createNewValue(!0),o=this.getNewValueOnRowChanged(e,t,s,i,this.createNewValue());if(this.isTwoValueEquals(a,o.value))return;this.isRowChanging=!0,this.setNewValue(o.value),this.isRowChanging=!1,t&&this.onCellValueChanged(e,t,o.rowValue)}this.getUniqueColumnsNames().indexOf(t)>-1&&this.isValueInColumnDuplicated(t,!!r)}getNewValueOnRowChanged(e,t,s,i,r){let n=this.getRowValueCore(e,r,!0);if(i&&delete n[t],e.questions.forEach(e=>{delete n[e.getValueName()]}),s)for(var a in s=JSON.parse(JSON.stringify(s)))this.isValueEmpty(s[a])||(n[a]=s[a]);return this.isObject(n)&&0===Object.keys(n).length&&(r=this.deleteRowValue(r,e)),{value:r,rowValue:n}}getRowIndex(e){return Array.isArray(this.generatedVisibleRows)?this.generatedVisibleRows.indexOf(e):-1}getElementsInDesign(e=!1){let t;return t="none"==this.detailPanelMode?super.getElementsInDesign(e):e?[this.detailPanel]:this.detailElements,this.columns.concat(t)}hasDetailPanel(e){return"none"!=this.detailPanelMode&&(!!this.isDesignMode||(this.onHasDetailPanelCallback?this.onHasDetailPanelCallback(e):this.detailElements.length>0))}getIsDetailPanelShowing(e){if("none"==this.detailPanelMode)return!1;if(this.isDesignMode){var t=0==this.visibleRows.indexOf(e);return t&&!e.detailPanel&&e.showDetailPanel(),t}return this.getPropertyValue("isRowShowing"+e.id,!1)}setIsDetailPanelShowing(e,t){if(t!=this.getIsDetailPanelShowing(e)&&(this.setPropertyValue("isRowShowing"+e.id,t),this.updateDetailPanelButtonCss(e),this.renderedTable&&this.renderedTable.onDetailPanelChangeVisibility(e,t),this.survey&&this.survey.matrixDetailPanelVisibleChanged(this,e.rowIndex-1,e,t),t&&"underRowSingle"===this.detailPanelMode))for(var s=this.visibleRows,i=0;i<s.length;i++)s[i].id!==e.id&&s[i].isDetailPanelShowing&&s[i].hideDetailPanel()}getDetailPanelButtonCss(e){let t=new eV().append(this.getPropertyValue("detailButtonCss"+e.id));return t.append(this.cssClasses.detailButton,""===t.toString()).toString()}getDetailPanelIconCss(e){let t=new eV().append(this.getPropertyValue("detailIconCss"+e.id));return t.append(this.cssClasses.detailIcon,""===t.toString()).toString()}getDetailPanelIconId(e){return this.getIsDetailPanelShowing(e)?this.cssClasses.detailIconExpandedId:this.cssClasses.detailIconId}updateDetailPanelButtonCss(e){let t=this.cssClasses,s=this.getIsDetailPanelShowing(e),i=new eV().append(t.detailIcon).append(t.detailIconExpanded,s);this.setPropertyValue("detailIconCss"+e.id,i.toString());let r=new eV().append(t.detailButton).append(t.detailButtonExpanded,s);this.setPropertyValue("detailButtonCss"+e.id,r.toString())}createRowDetailPanel(e){if(this.isDesignMode)return this.detailPanel;var t=this.createNewDetailPanel();t.readOnly=this.isReadOnly||!e.isRowEnabled(),t.setSurveyImpl(e);var s=this.detailPanel.toJSON();return new I().toObject(s,t),t.renderWidth="100%",t.updateCustomWidgets(),this.onCreateDetailPanelCallback&&this.onCreateDetailPanelCallback(e,t),t.questions.forEach(e=>e.setParentQuestion(this)),t.onSurveyLoad(),t}getSharedQuestionByName(e,t){if(!this.survey||!this.valueName)return null;var s=this.getRowIndex(t);return s<0?null:this.survey.getQuestionByValueNameFromArray(this.valueName,e,s)}onTotalValueChanged(){this.data&&this.visibleTotalRow&&!this.isUpdateLocked&&!this.isSett&&this.data.setValue(this.getValueName()+tp.matrix.totalsSuffix,this.totalValue,!1)}getDataFilteredValues(){return this.data?this.data.getFilteredValues():{}}getParentTextProcessor(){if(!this.parentQuestion||!this.parent)return null;let e=this.parent.data;return e&&e.getTextProcessor?e.getTextProcessor():null}isMatrixReadOnly(){return this.isReadOnly}onRowVisibilityChanged(e){this.clearVisibleRows(),this.resetRenderedTable()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearInvisibleValuesInRows()}clearInvisibleValuesInRows(){var e;!this.isEmpty()&&this.isRowsFiltered()&&((null===(e=this.survey)||void 0===e?void 0:e.questionsByValueName(this.getValueName()))||[]).length<2&&(this.value=this.getFilteredData())}isRowsFiltered(){return super.isRowsFiltered()||this.visibleRows!==this.generatedVisibleRows}getQuestionFromArray(e,t){return t>=this.visibleRows.length?null:this.visibleRows[t].getQuestionByName(e)}isMatrixValueEmpty(e){if(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if(this.isObject(e[t])&&Object.keys(e[t]).length>0)return!1;return!0}return 0==Object.keys(e).length}}get SurveyModel(){return this.survey}getCellTemplateData(e){return this.SurveyModel.getMatrixCellTemplateData(e)}getCellWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,e.row instanceof sy?"row-footer":"cell")}getCellWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,e.row instanceof sy?"row-footer":"cell")}getColumnHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,"column-header")}getColumnHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,"column-header")}getRowHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,"row-header")}getRowHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,"row-header")}get showHorizontalScroll(){return!this.isDefaultV2Theme&&this.horizontalScroll}onMobileChanged(){super.onMobileChanged(),this.resetRenderedTable()}getRootCss(){return new eV().append(super.getRootCss()).append(this.cssClasses.rootScroll,this.horizontalScroll).toString()}afterRenderQuestionElement(e){super.afterRenderQuestionElement(e),this.setRootElement(null==e?void 0:e.parentElement)}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.setRootElement(void 0)}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}}E.addClass("matrixdropdownbase",[{name:"columns:matrixdropdowncolumns",className:"matrixdropdowncolumn",isArray:!0},{name:"columnLayout",alternativeName:"columnsLocation",choices:["horizontal","vertical"],visible:!1,isSerializable:!1},{name:"transposeData:boolean",version:"1.9.130",oldName:"columnLayout"},{name:"detailElements",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"detailPanelMode",choices:["none","underRow","underRowSingle"],default:"none"},{name:"cellErrorLocation",default:"default",choices:["default","top","bottom"]},{name:"detailErrorLocation",default:"default",choices:["default","top","bottom"],visibleIf:e=>!!e&&"none"!=e.detailPanelMode},{name:"horizontalScroll:boolean",visible:!1},{name:"choices:itemvalue[]",uniqueProperty:"value",visibleIf:e=>e.isSelectCellType()},{name:"placeholder",alternativeName:"optionsCaption",serializationProperty:"locPlaceholder"},{name:"keyDuplicationError",serializationProperty:"locKeyDuplicationError"},{name:"cellType",default:"dropdown",choices:()=>so.getColumnTypes()},{name:"columnColCount",default:0,choices:[0,1,2,3,4]},"columnMinWidth",{name:"allowAdaptiveActions:boolean",default:!1,visible:!1}],function(){return new sC("")},"matrixbase");class sf extends sv{constructor(e,t,s,i){super(s,i),this.name=e,this.item=t,this.buildCells(i)}get rowName(){return this.name}get text(){return this.item.text}get locText(){return this.item.locText}isItemVisible(){return this.item.isVisible}isRowEnabled(){return this.item.isEnabled}isRowHasEnabledCondition(){return!!this.item.enableIf}setRowsVisibleIfValues(e){e.item=this.item.value,e.choice=this.item.value}}class sb extends sC{constructor(e){super(e),this.defaultValuesInRows={},this.createLocalizableString("totalText",this,!0),this.registerPropertyChangedHandlers(["rows"],()=>{this.generatedVisibleRows&&(this.clearGeneratedRows(),this.resetRenderedTable(),this.getVisibleRows(),this.clearIncorrectValues())}),this.registerPropertyChangedHandlers(["hideIfRowsEmpty"],()=>{this.updateVisibilityBasedOnRows()})}getType(){return"matrixdropdown"}get totalText(){return this.getLocalizableStringText("totalText","")}set totalText(e){this.setLocalizableStringText("totalText",e)}get locTotalText(){return this.getLocalizableString("totalText")}getFooterText(){return this.locTotalText}getRowTitleWidth(){return this.rowTitleWidth}get hideIfRowsEmpty(){return this.getPropertyValue("hideIfRowsEmpty")}set hideIfRowsEmpty(e){this.setPropertyValue("hideIfRowsEmpty",e)}getDisplayValueCore(e,t){if(!t)return t;var s=this.visibleRows,i={};if(!s)return i;for(var r=0;r<s.length;r++){var n=s[r].rowName,a=t[n];if(a){if(e){var o=tJ.getTextOrHtmlByValue(this.rows,n);o&&(n=o)}i[n]=this.getRowDisplayValue(e,s[r],a)}}return i}getConditionObjectRowName(e){return"."+this.rows[e].value}getConditionObjectRowText(e){return"."+this.rows[e].calculatedText}getConditionObjectsRowIndeces(){let e=[];for(var t=0;t<this.rows.length;t++)e.push(t);return e}isNewValueCorrect(e){return a.isValueObject(e,!0)}clearIncorrectValues(){if(!this.isEmpty()){this.getVisibleRows();let e={},t=this.value;for(let s in t){let i=this.getRowByKey(s);i&&i.isVisible&&(e[s]=t[s])}this.value=e}super.clearIncorrectValues()}getRowByKey(e){let t=this.generatedVisibleRows;if(!t)return null;for(let s=0;s<t.length;s++)if(t[s].rowName===e)return t[s];return null}clearGeneratedRows(){this.generatedVisibleRows&&(this.isDisposed||this.generatedVisibleRows.forEach(e=>{this.defaultValuesInRows[e.rowName]=e.getNamesWithDefaultValues()}),super.clearGeneratedRows())}getRowValueForCreation(e,t){let s=e[t];if(!s)return s;let i=this.defaultValuesInRows[t];return Array.isArray(i)&&0!==i.length&&i.forEach(e=>{delete s[e]}),s}generateRows(){var e=[],t=this.rows;if(!t||0===t.length)return e;var s=this.value;s||(s={});for(var i=0;i<t.length;i++){let r=t[i];this.isValueEmpty(r.value)||e.push(this.createMatrixRow(r,this.getRowValueForCreation(s,r.value)))}return e}createMatrixRow(e,t){return new sf(e.value,e,this,t)}getFilteredDataCore(){let e={},t=this.createValueCopy();return this.generatedVisibleRows.forEach(s=>{let i=t[s.rowName];s.isVisible&&!a.isValueEmpty(i)&&(e[s.rowName]=i)}),e}getSearchableItemValueKeys(e){e.push("rows")}getIsRequireToGenerateRows(){if(super.getIsRequireToGenerateRows())return!0;for(let e=0;e<this.rows.length;e++)if(this.rows[e].visibleIf)return!0;return!1}updateProgressInfoByValues(e){let t=this.value;t||(t={});for(var s=0;s<this.rows.length;s++){let i=t[this.rows[s].value];this.updateProgressInfoByRow(e,i||{})}}}E.addClass("matrixdropdown",[{name:"rows:itemvalue[]",uniqueProperty:"value"},"rowsVisibleIf:condition","rowTitleWidth",{name:"totalText",serializationProperty:"locTotalText"},"hideIfRowsEmpty:boolean"],function(){return new sb("")},"matrixdropdownbase"),st.Instance.registerQuestion("matrixdropdown",e=>{var t=new sb(e);return t.choices=[1,2,3,4,5],t.rows=st.DefaultRows,sC.addDefaultColumns(t),t});let sV=!1,sw=null;"undefined"!=typeof navigator&&navigator&&i.isAvailable()&&(sw=navigator.userAgent||navigator.vendor||i.hasOwn("opera")),function(e){e&&("MacIntel"===navigator.platform&&navigator.maxTouchPoints>0||"iPad"===navigator.platform?sV=!0:(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substring(0,4)))&&(sV=!0))}(sw);let sx=sV||!1;var sP={get isTouch(){return!this.hasMouse&&this.hasTouchEvent},get hasTouchEvent(){return i.isAvailable()&&(i.hasOwn("ontouchstart")||navigator.maxTouchPoints>0)},hasMouse:!0};sP.hasMouse=function(e){if(!e||sx)return!1;let t=e("(pointer:fine)"),s=e("(any-hover:hover)");return!!t&&t.matches||!!s&&s.matches}(i.matchMedia);let sT=sP.isTouch;"undefined"!=typeof window&&window.addEventListener("touchmove",e=>{sS.PreventScrolling&&e.preventDefault()},{passive:!1});class sS{constructor(e,t=!0,s=!1){this.dd=e,this.longTap=t,this.fitToContainer=s,this.scrollIntervalId=null,this.stopLongTapIfMoveEnough=e=>{e.preventDefault(),this.currentX=e.pageX,this.currentY=e.pageY,this.isMicroMovement||(this.returnUserSelectBack(),this.stopLongTap())},this.stopLongTap=e=>{clearTimeout(this.timeoutID),this.timeoutID=null,document.removeEventListener("pointerup",this.stopLongTap),document.removeEventListener("pointermove",this.stopLongTapIfMoveEnough)},this.handlePointerCancel=e=>{this.clear()},this.handleEscapeButton=e=>{27==e.keyCode&&this.clear()},this.onContextMenu=e=>{e.preventDefault(),e.stopPropagation()},this.dragOver=e=>{this.moveShortcutElement(e),this.draggedElementShortcut.style.cursor="grabbing",this.dd.dragOver(e)},this.clear=()=>{cancelAnimationFrame(this.scrollIntervalId),document.removeEventListener("pointermove",this.dragOver),document.removeEventListener("pointercancel",this.handlePointerCancel),document.removeEventListener("keydown",this.handleEscapeButton),document.removeEventListener("pointerup",this.drop),this.draggedElementShortcut.removeEventListener("pointerup",this.drop),sT&&this.draggedElementShortcut.removeEventListener("contextmenu",this.onContextMenu),this.draggedElementShortcut.parentElement.removeChild(this.draggedElementShortcut),this.dd.clear(),this.draggedElementShortcut=null,this.scrollIntervalId=null,sT&&(this.savedTargetNode.style.cssText=null,this.savedTargetNode&&this.savedTargetNode.parentElement.removeChild(this.savedTargetNode),this.insertNodeToParentAtIndex(this.savedTargetNodeParent,this.savedTargetNode,this.savedTargetNodeIndex),sS.PreventScrolling=!1),this.savedTargetNode=null,this.savedTargetNodeParent=null,this.savedTargetNodeIndex=null,this.returnUserSelectBack()},this.drop=()=>{this.dd.drop(),this.clear()},this.draggedElementShortcut=null}get documentOrShadowRoot(){return tp.environment.root}get rootElement(){return eY(tp.environment.root)?this.rootContainer||tp.environment.root.host:this.rootContainer||tp.environment.root.documentElement||document.body}get isMicroMovement(){let e=Math.abs(this.currentX-this.startX),t=Math.abs(this.currentY-this.startY);return e<5&&t<5}startLongTapProcessing(e,t,s,i,r=!1){this.startX=e.pageX,this.startY=e.pageY,document.body.style.setProperty("touch-action","none","important"),this.timeoutID=setTimeout(()=>{this.doStartDrag(e,t,s,i),r||(this.savedTargetNode=e.target,this.savedTargetNode.style.cssText=`
          position: absolute;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden;
          clip: rect(1px 1px 1px 1px);
          clip: rect(1px, 1px, 1px, 1px);
        `,this.savedTargetNodeParent=this.savedTargetNode.parentElement,this.savedTargetNodeIndex=this.getNodeIndexInParent(this.savedTargetNode),this.rootElement.appendChild(this.savedTargetNode)),this.stopLongTap()},500*!!this.longTap),document.addEventListener("pointerup",this.stopLongTap),document.addEventListener("pointermove",this.stopLongTapIfMoveEnough)}moveShortcutElement(e){let t=this.rootElement.getBoundingClientRect().x,s=this.rootElement.getBoundingClientRect().y,i=this.rootElement.scrollLeft,r=this.rootElement.scrollTop;this.doScroll(e.clientY,e.clientX);let n=this.draggedElementShortcut.offsetHeight,a=this.draggedElementShortcut.offsetWidth,o=this.draggedElementShortcut.shortcutXOffset||a/2,l=this.draggedElementShortcut.shortcutYOffset||n/2;0!==document.querySelectorAll("[dir='rtl']").length&&(o=a/2,l=n/2);let h=document.documentElement.clientHeight,u=document.documentElement.clientWidth,d=e.pageX,c=e.pageY,g=e.clientX,p=e.clientY;t-=i,s-=r;let m=this.getShortcutBottomCoordinate(p,n,l);if(this.getShortcutRightCoordinate(g,a,o)>=u){this.draggedElementShortcut.style.left=u-a-t+"px",this.draggedElementShortcut.style.top=p-l-s+"px";return}if(g-o<=0){this.draggedElementShortcut.style.left=d-g-t+"px",this.draggedElementShortcut.style.top=p-s-l+"px";return}if(m>=h){this.draggedElementShortcut.style.left=g-o-t+"px",this.draggedElementShortcut.style.top=h-n-s+"px";return}if(p-l<=0){this.draggedElementShortcut.style.left=g-o-t+"px",this.draggedElementShortcut.style.top=c-p-s+"px";return}this.draggedElementShortcut.style.left=g-t-o+"px",this.draggedElementShortcut.style.top=p-s-l+"px"}getShortcutBottomCoordinate(e,t,s){return e+t-s}getShortcutRightCoordinate(e,t,s){return e+t-s}requestAnimationFrame(e){return requestAnimationFrame(e)}scrollByDrag(e,t,s){let i,r,n,a;"HTML"===e.tagName?(i=0,r=document.documentElement.clientHeight,n=0,a=document.documentElement.clientWidth):(i=e.getBoundingClientRect().top,r=e.getBoundingClientRect().bottom,n=e.getBoundingClientRect().left,a=e.getBoundingClientRect().right);let o=()=>{let l=t-i<=100,h=r-t<=100,u=s-n<=100,d=a-s<=100;!l||u||d?!h||u||d?!d||l||h?!u||l||h||(e.scrollLeft-=15):e.scrollLeft+=15:e.scrollTop+=15:e.scrollTop-=15,this.scrollIntervalId=this.requestAnimationFrame(o)};this.scrollIntervalId=this.requestAnimationFrame(o)}doScroll(e,t){cancelAnimationFrame(this.scrollIntervalId);let s=this.draggedElementShortcut.style.display;this.draggedElementShortcut.style.display="none";let i=this.documentOrShadowRoot.elementFromPoint(t,e);this.draggedElementShortcut.style.display=s||"block";let r=e$(i);this.scrollByDrag(r,e,t)}doStartDrag(e,t,s,i){sT&&(sS.PreventScrolling=!0),3!==e.which&&(this.dd.dragInit(e,t,s,i),this.rootElement.append(this.draggedElementShortcut),this.moveShortcutElement(e),document.addEventListener("pointermove",this.dragOver),document.addEventListener("pointercancel",this.handlePointerCancel),document.addEventListener("keydown",this.handleEscapeButton),document.addEventListener("pointerup",this.drop),sT?this.draggedElementShortcut.addEventListener("contextmenu",this.onContextMenu):this.draggedElementShortcut.addEventListener("pointerup",this.drop))}returnUserSelectBack(){document.body.style.setProperty("touch-action","auto"),document.body.style.setProperty("user-select","auto"),document.body.style.setProperty("-webkit-user-select","auto")}startDrag(e,t,s,i,r=!1){if(document.body.style.setProperty("user-select","none","important"),document.body.style.setProperty("-webkit-user-select","none","important"),sT){this.startLongTapProcessing(e,t,s,i,r);return}this.doStartDrag(e,t,s,i)}getNodeIndexInParent(e){return[...e.parentElement.childNodes].indexOf(e)}insertNodeToParentAtIndex(e,t,s){e.insertBefore(t,e.childNodes[s])}}sS.PreventScrolling=!1;class sI{get isBottom(){return!!this._isBottom}set isBottom(e){this._isBottom=e,this.ghostPositionChanged()}ghostPositionChanged(){this.onGhostPositionChanged.fire({},{})}get dropTargetDataAttributeName(){return`[data-sv-drop-target-${this.draggedElementType}]`}get survey(){var e;return this.surveyValue||(null===(e=this.creator)||void 0===e?void 0:e.survey)}constructor(e,t,s,i){var r;this.surveyValue=e,this.creator=t,this._isBottom=null,this.onGhostPositionChanged=new ev,this.onDragStart=new ev,this.onDragEnd=new ev,this.onDragClear=new ev,this.onBeforeDrop=this.onDragStart,this.onAfterDrop=this.onDragEnd,this.draggedElement=null,this.dropTarget=null,this.prevDropTarget=null,this.allowDropHere=!1,this.banDropHere=()=>{this.allowDropHere=!1,this.doBanDropHere(),this.dropTarget=null,this.domAdapter.draggedElementShortcut.style.cursor="not-allowed",this.isBottom=null},this.doBanDropHere=()=>{},this.domAdapter=i||new sS(this,s,null===(r=this.survey)||void 0===r?void 0:r.fitToContainer)}startDrag(e,t,s,i,r=!1){this.domAdapter.rootContainer=this.getRootElement(this.survey,this.creator),this.domAdapter.startDrag(e,t,s,i,r)}getRootElement(e,t){return t?t.rootElement:e.rootElement}dragInit(e,t,s,i){this.draggedElement=t,this.parentElement=s;let r=this.getShortcutText(this.draggedElement);this.domAdapter.draggedElementShortcut=this.createDraggedElementShortcut(r,i,e),this.onStartDrag(e);let n=this.draggedElement&&this.draggedElement.parent;this.onDragStart.fire(this,{fromElement:n,draggedElement:this.draggedElement})}onStartDrag(e){}isDropTargetDoesntChanged(e){return this.dropTarget===this.prevDropTarget&&e===this.isBottom}getShortcutText(e){return null==e?void 0:e.shortcutText}createDraggedElementShortcut(e,t,s){let i=r.createElement("div");return i&&(i.innerText=e,i.className=this.getDraggedElementClass()),i}getDraggedElementClass(){return"sv-dragged-element-shortcut"}doDragOver(){}afterDragOver(e){}findDropTargetNodeFromPoint(e,t){let s=this.domAdapter.draggedElementShortcut.style.display;if(this.domAdapter.draggedElementShortcut.style.display="none",!r.isAvailable())return null;let i=this.domAdapter.documentOrShadowRoot.elementsFromPoint(e,t);this.domAdapter.draggedElementShortcut.style.display=s||"block";let n=0,a=i[0];for(;a&&a.className&&"function"==typeof a.className.indexOf&&-1!=a.className.indexOf("sv-drag-target-skipped");)a=i[++n];return a?this.findDropTargetNodeByDragOverNode(a):null}getDataAttributeValueByNode(e){let t="svDropTarget";return this.draggedElementType.split("-").forEach(e=>{t+=this.capitalizeFirstLetter(e)}),e.dataset[t]}getDropTargetByNode(e,t){let s=this.getDataAttributeValueByNode(e);return this.getDropTargetByDataAttributeValue(s,e,t)}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}calculateVerticalMiddleOfHTMLElement(e){let t=e.getBoundingClientRect();return t.y+t.height/2}calculateHorizontalMiddleOfHTMLElement(e){let t=e.getBoundingClientRect();return t.x+t.width/2}calculateIsBottom(e,t){return!1}findDropTargetNodeByDragOverNode(e){return e.closest(this.dropTargetDataAttributeName)}dragOver(e){let t=this.findDropTargetNodeFromPoint(e.clientX,e.clientY);if(!t){this.banDropHere();return}this.dropTarget=this.getDropTargetByNode(t,e);let s=this.isDropTargetValid(this.dropTarget,t);if(this.doDragOver(),!s){this.banDropHere();return}let i=this.calculateIsBottom(e.clientY,t);this.allowDropHere=!0,this.isDropTargetDoesntChanged(i)||(this.isBottom=null,this.isBottom=i,this.draggedElement!=this.dropTarget&&this.afterDragOver(t),this.prevDropTarget=this.dropTarget)}drop(){if(this.allowDropHere){let e=this.draggedElement.parent,t=this.doDrop();this.onDragEnd.fire(this,{fromElement:e,draggedElement:t,toElement:this.dropTarget})}}clear(){let e={draggedElement:this.draggedElement};this.dropTarget=null,this.prevDropTarget=null,this.draggedElement=null,this.isBottom=null,this.parentElement=null,this.onDragClear.fire(this,e)}}class sE extends sI{constructor(){super(...arguments),this.fromIndex=null,this.toIndex=null,this.doDrop=()=>(this.parentElement.moveRowByIndex(this.fromIndex,this.toIndex),this.parentElement)}get draggedElementType(){return"matrix-row"}onStartDrag(){let e=r.getBody();e&&(this.restoreUserSelectValue=e.style.userSelect,e.style.userSelect="none")}get shortcutClass(){return new eV().append(this.parentElement.cssClasses.draggedRow).toString()}createDraggedElementShortcut(e,t,s){let i=r.createElement("div");if(i){if(i.className=this.shortcutClass,t){let e=t.closest("[data-sv-drop-target-matrix-row]"),r=e.cloneNode(!0);r.style.cssText=`
        width: ${e.offsetWidth}px;
      `,r.classList.remove("sv-matrix__drag-drop--moveup"),r.classList.remove("sv-matrix__drag-drop--movedown"),this.draggedElement.isDragDropMoveDown=!1,this.draggedElement.isDragDropMoveUp=!1,i.appendChild(r);let n=t.getBoundingClientRect();i.shortcutXOffset=s.clientX-n.x,i.shortcutYOffset=s.clientY-n.y}return this.parentElement.renderedTable.rows.forEach((e,t)=>{e.row===this.draggedElement&&(e.isGhostRow=!0)}),this.fromIndex=this.parentElement.visibleRows.indexOf(this.draggedElement),i}}getDropTargetByDataAttributeValue(e){return this.parentElement.renderedTable.rows.filter(t=>t.row&&t.row.id===e)[0].row}canInsertIntoThisRow(e){let t=this.parentElement.lockedRowCount;return t<=0||e.rowIndex>t}isDropTargetValid(e,t){return this.canInsertIntoThisRow(e)}calculateIsBottom(e){let t=this.parentElement.renderedTable.rows.map(e=>e.row);return t.indexOf(this.dropTarget)-t.indexOf(this.draggedElement)>0}afterDragOver(e){let t,s,i;if(this.isDropTargetDoesntChanged(this.isBottom))return;let r=this.parentElement.renderedTable.rows;r.forEach((e,r)=>{e.row===this.dropTarget&&(t=r),e.row===this.draggedElement&&(i=e,s=r,i.isGhostRow=!0)}),r.splice(s,1),r.splice(t,0,i),this.toIndex=this.parentElement.visibleRows.indexOf(this.dropTarget),super.ghostPositionChanged()}clear(){this.parentElement.renderedTable.rows.forEach(e=>{e.isGhostRow=!1}),this.parentElement.clearOnDrop(),this.fromIndex=null,this.toIndex=null;let e=r.getBody();e&&(e.style.userSelect=this.restoreUserSelectValue||"initial"),super.clear()}}class sR{constructor(e){this.dragHandler=e,this.onPointerUp=e=>{this.clearListeners()},this.tryToStartDrag=e=>{if(this.currentX=e.pageX,this.currentY=e.pageY,!this.isMicroMovement)return this.clearListeners(),this.dragHandler(this.pointerDownEvent,this.currentTarget,this.itemModel),!0}}onPointerDown(e,t){if(sT){this.dragHandler(e,e.currentTarget,t);return}this.pointerDownEvent=e,this.currentTarget=e.currentTarget,this.startX=e.pageX,this.startY=e.pageY,r.addEventListener("pointermove",this.tryToStartDrag),this.currentTarget.addEventListener("pointerup",this.onPointerUp),this.itemModel=t}get isMicroMovement(){let e=Math.abs(this.currentX-this.startX),t=Math.abs(this.currentY-this.startY);return e<10&&t<10}clearListeners(){this.pointerDownEvent&&(r.removeEventListener("pointermove",this.tryToStartDrag),this.currentTarget.removeEventListener("pointerup",this.onPointerUp))}}class sA extends sv{constructor(e,t,s){super(t,s),this.index=e,this.buildCells(s)}getRowIndex(){let e=super.getRowIndex();return e>0?e:this.index+1}get rowName(){return this.id}get dataName(){return"row"+(this.index+1)}get text(){return"row "+(this.index+1)}getAccessbilityText(){return(this.index+1).toString()}get shortcutText(){let e=this.data.visibleRows.indexOf(this)+1,t=this.cells.length>1?this.cells[1].questionValue:void 0,s=this.cells.length>0?this.cells[0].questionValue:void 0;return t&&t.value||s&&s.value||""+e}}class sD extends sC{constructor(e){super(e),this.rowCounter=0,this.setRowCountValueFromData=!1,this.startDragMatrixRow=(e,t)=>{this.dragDropMatrixRows.startDrag(e,this.draggedRow,this,e.target)},this.initialRowCount=this.getDefaultPropertyValue("rowCount"),this.createLocalizableString("confirmDeleteText",this,!1,"confirmDelete"),this.createLocalizableString("addRowText",this).onGetTextCallback=e=>e||this.defaultAddRowText,this.createLocalizableString("removeRowText",this,!1,"removeRow"),this.createLocalizableString("noRowsText",this,!1,!0),this.registerPropertyChangedHandlers(["hideColumnsIfEmpty","allowAddRows"],()=>{this.updateShowTableAndAddRow()}),this.registerPropertyChangedHandlers(["allowRowReorder","isReadOnly","lockedRowCount"],()=>{this.resetRenderedTable()}),this.registerPropertyChangedHandlers(["minRowCount"],()=>{this.onMinRowCountChanged()}),this.registerPropertyChangedHandlers(["maxRowCount"],()=>{this.onMaxRowCountChanged()}),this.dragOrClickHelper=new sR(this.startDragMatrixRow)}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.dragDropMatrixRows=new sE(this.survey,null,!0)}isBanStartDrag(e){let t=e.target;return"true"===t.getAttribute("contenteditable")||"INPUT"===t.nodeName||!this.isDragHandleAreaValid(t)}isDragHandleAreaValid(e){return"icon"!==this.survey.matrixDragHandleArea||e.classList.contains(this.cssClasses.dragElementDecorator)}onPointerDown(e,t){!(!t||!this.isRowsDragAndDrop||this.isDesignMode||this.isBanStartDrag(e))&&(t.isDetailPanelShowing||(this.draggedRow=t,this.dragOrClickHelper.onPointerDown(e)))}getType(){return"matrixdynamic"}get isRowsDynamic(){return!0}get confirmDelete(){return this.getPropertyValue("confirmDelete")}set confirmDelete(e){this.setPropertyValue("confirmDelete",e)}get isValueArray(){return!0}get keyName(){return this.getPropertyValue("keyName","")}set keyName(e){this.setPropertyValue("keyName",e)}get defaultRowValue(){return this.getPropertyValue("defaultRowValue")}set defaultRowValue(e){this.setPropertyValue("defaultRowValue",e)}get copyDefaultValueFromLastEntry(){return this.getPropertyValue("copyDefaultValueFromLastEntry")}set copyDefaultValueFromLastEntry(e){this.setPropertyValue("copyDefaultValueFromLastEntry",e)}get defaultValueFromLastRow(){return this.copyDefaultValueFromLastEntry}set defaultValueFromLastRow(e){this.copyDefaultValueFromLastEntry=e}isDefaultValueEmpty(){return super.isDefaultValueEmpty()&&this.isValueEmpty(this.defaultRowValue)}valueFromData(e){if(this.minRowCount<1||this.isEmpty())return super.valueFromData(e);Array.isArray(e)||(e=[]);for(var t=e.length;t<this.minRowCount;t++)e.push({});return e}isNewValueCorrect(e){return Array.isArray(e)}setDefaultValue(){if(this.isValueEmpty(this.defaultRowValue)||!this.isValueEmpty(this.defaultValue)){super.setDefaultValue();return}if(this.isEmpty()&&0!=this.rowCount){for(var e=[],t=0;t<this.rowCount;t++)e.push(this.defaultRowValue);this.value=e}}moveRowByIndex(e,t){let s=this.createNewValue();if(!Array.isArray(s)&&Math.max(e,t)>=s.length)return;let i=s[e];s.splice(e,1),s.splice(t,0,i),this.value=s}clearOnDrop(){this.isEditingSurveyElement||this.resetRenderedTable()}initDataUI(){this.generatedVisibleRows||this.getVisibleRows()}get rowCount(){return this.rowCountValue}set rowCount(e){if(!((e=a.getNumber(e))<0)&&!(e>tp.matrix.maxRowCount)){this.setRowCountValueFromData=!1;var t=this.rowCountValue;if(this.rowCountValue=e,this.value&&this.value.length>e){var s=this.value;s.splice(e),this.value=s}if(this.isUpdateLocked){this.initialRowCount=e;return}if(this.generatedVisibleRows||0==t){this.generatedVisibleRows||(this.clearGeneratedRows(),this.generatedVisibleRows=[]),this.generatedVisibleRows.splice(e);for(var i=t;i<e;i++){var r=this.createMatrixRow(this.getValueForNewRow());this.generatedVisibleRows.push(r),this.onMatrixRowCreated(r)}this.runCondition(this.getDataFilteredValues(),this.getDataFilteredProperties())}this.onRowsChanged()}}updateBindingProp(e,t){super.updateBindingProp(e,t);let s=this.generatedVisibleRows;if("rowCount"!==e||!Array.isArray(s))return;let i=this.getUnbindValue(this.value)||[];if(i.length<s.length){let e=!1;for(let t=i.length;t<s.length;t++)e||(e=!s[t].isEmpty),i.push(s[t].value||{});e&&(this.value=i)}}updateProgressInfoByValues(e){let t=this.value;Array.isArray(t)||(t=[]);for(var s=0;s<this.rowCount;s++){let i=s<t.length?t[s]:{};this.updateProgressInfoByRow(e,i)}}getValueForNewRow(){var e=null;return this.onGetValueForNewRowCallBack&&(e=this.onGetValueForNewRowCallBack(this)),e}get allowRowReorder(){return this.getPropertyValue("allowRowReorder")}set allowRowReorder(e){this.setPropertyValue("allowRowReorder",e)}get allowRowsDragAndDrop(){return this.allowRowReorder}set allowRowsDragAndDrop(e){this.allowRowReorder=e}get isRowsDragAndDrop(){return this.allowRowReorder&&!this.isReadOnly}get lockedRowCount(){return this.getPropertyValue("lockedRowCount",0)}set lockedRowCount(e){this.setPropertyValue("lockedRowCount",e)}get iconDragElement(){return this.cssClasses.iconDragElement}createRenderedTable(){return new sO(this)}get rowCountValue(){return this.getPropertyValue("rowCount")}set rowCountValue(e){this.setPropertyValue("rowCount",e)}get minRowCount(){return this.getPropertyValue("minRowCount")}set minRowCount(e){e<0&&(e=0),this.setPropertyValue("minRowCount",e)}onMinRowCountChanged(){let e=this.minRowCount;e>this.maxRowCount&&(this.maxRowCount=e),this.initialRowCount<e&&(this.initialRowCount=e),this.rowCount<e&&(this.rowCount=e)}get maxRowCount(){return this.getPropertyValue("maxRowCount")}set maxRowCount(e){!(e<=0)&&(e>tp.matrix.maxRowCount&&(e=tp.matrix.maxRowCount),e!=this.maxRowCount&&this.setPropertyValue("maxRowCount",e))}onMaxRowCountChanged(){let e=this.maxRowCount;e<this.minRowCount&&(this.minRowCount=e),this.rowCount>e&&(this.rowCount=e)}get allowAddRows(){return this.getPropertyValue("allowAddRows")}set allowAddRows(e){this.setPropertyValue("allowAddRows",e)}get allowRemoveRows(){return this.getPropertyValue("allowRemoveRows")}set allowRemoveRows(e){this.setPropertyValue("allowRemoveRows",e),this.isUpdateLocked||this.resetRenderedTable()}get canAddRow(){return this.allowAddRows&&!this.isReadOnly&&this.rowCount<this.maxRowCount}get canRemoveRows(){var e=this.allowRemoveRows&&!this.isReadOnly&&this.rowCount>this.minRowCount;return this.canRemoveRowsCallback?this.canRemoveRowsCallback(e):e}canRemoveRow(e){if(!this.survey)return!0;let t=e.rowIndex-1;return(!(this.lockedRowCount>0)||!(t<this.lockedRowCount))&&this.survey.matrixAllowRemoveRow(this,t,e)}addRowUI(){this.addRow(!0)}getQuestionToFocusOnAddingRow(){if(0===this.visibleRows.length)return null;for(var e=this.visibleRows[this.visibleRows.length-1],t=0;t<e.cells.length;t++){var s=e.cells[t].question;if(s&&s.isVisible&&!s.isReadOnly)return s}return null}addRow(e){let t=this.rowCount,s=this.canAddRow;var i={question:this,canAddRow:s,allow:s};if(this.survey&&this.survey.matrixBeforeRowAdded(i),(s!==i.allow?i.allow:s!==i.canAddRow?i.canAddRow:s)&&(this.onStartRowAddingRemoving(),this.addRowCore(),this.onEndRowAdding(),this.detailPanelShowOnAdding&&this.visibleRows.length>0&&this.visibleRows[this.visibleRows.length-1].showDetailPanel(),e&&t!==this.rowCount)){let e=this.getQuestionToFocusOnAddingRow();e&&e.focus()}}get detailPanelShowOnAdding(){return this.getPropertyValue("detailPanelShowOnAdding")}set detailPanelShowOnAdding(e){this.setPropertyValue("detailPanelShowOnAdding",e)}hasRowsAsItems(){return!1}unbindValue(){this.clearGeneratedRows(),this.clearPropertyValue("value"),this.rowCountValue=0,super.unbindValue()}isValueSurveyElement(e){return this.isEditingSurveyElement||super.isValueSurveyElement(e)}addRowCore(){var e=this.rowCount;this.rowCount=this.rowCount+1;var t=this.getDefaultRowValue(!0),s=null;if(this.isValueEmpty(t)||(s=this.createNewValue()).length!=this.rowCount||(s[s.length-1]=t,this.value=s),this.data){this.runCellsCondition(this.getDataFilteredValues(),this.getDataFilteredProperties());let e=this.visibleRows;if(this.isValueEmpty(t)&&e.length>0){let t=e[e.length-1];this.isValueEmpty(t.value)||(s||(s=this.createNewValue()),this.isValueSurveyElement(s)||this.isTwoValueEquals(s[s.length-1],t.value)||(s[s.length-1]=t.value,this.value=s))}}if(this.survey){let t=this.visibleRows;if(e+1==this.rowCount&&t.length>0){let e=t[t.length-1];this.survey.matrixRowAdded(this,e),this.onRowsChanged()}}}getDefaultRowValue(e){for(var t=null,s=0;s<this.columns.length;s++){var i=this.columns[s].templateQuestion;i&&!this.isValueEmpty(i.getDefaultValue())&&((t=t||{})[this.columns[s].name]=i.getDefaultValue())}if(!this.isValueEmpty(this.defaultRowValue))for(var r in this.defaultRowValue)(t=t||{})[r]=this.defaultRowValue[r];if(e&&this.copyDefaultValueFromLastEntry){var n=this.value;if(n&&Array.isArray(n)&&n.length>=this.rowCount-1){var a=n[this.rowCount-2];for(var r in a)(t=t||{})[r]=a[r]}}return t}focusAddBUtton(){let e=this.getRootElement();if(e&&this.cssClasses.buttonAdd){let t=e.querySelectorAll("."+this.cssClasses.buttonAdd)[0];t&&t.focus()}}getActionCellIndex(e){let t=+!!this.showHeader;return this.isColumnLayoutHorizontal?e.cells.length-1+t:this.visibleRows.indexOf(e)+t}removeRowUI(e){if(e&&e.rowName){var t=this.visibleRows.indexOf(e);if(t<0)return;e=t}this.removeRow(e,void 0,()=>{let e=this.visibleRows.length,s=t>=e?e-1:t,i=s>-1?this.visibleRows[s]:void 0;setTimeout(()=>{i?this.renderedTable.focusActionCell(i,this.getActionCellIndex(i)):this.focusAddBUtton()},10)})}isRequireConfirmOnRowDelete(e){if(!this.confirmDelete||e<0||e>=this.rowCount)return!1;var t=this.createNewValue();return!this.isValueEmpty(t)&&!!Array.isArray(t)&&!(e>=t.length)&&!this.isValueEmpty(t[e])}removeRow(e,t,s){if(this.canRemoveRows&&!(e<0)&&!(e>=this.rowCount)){var i=this.visibleRows&&e<this.visibleRows.length?this.visibleRows[e]:null;if(void 0===t&&(t=this.isRequireConfirmOnRowDelete(e)),t){eG({message:this.confirmDeleteText,funcOnYes:()=>{this.removeRowAsync(e,i),s&&s()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.removeRowAsync(e,i),s&&s()}}removeRowAsync(e,t){(!t||!this.survey||this.survey.matrixRowRemoving(this,e,t))&&(this.onStartRowAddingRemoving(),this.removeRowCore(e),this.onEndRowRemoving(t))}removeRowCore(e){var t=this.generatedVisibleRows?this.generatedVisibleRows[e]:null;if(this.generatedVisibleRows&&e<this.generatedVisibleRows.length&&this.generatedVisibleRows.splice(e,1),this.rowCountValue--,this.value){var s=[];(s=Array.isArray(this.value)&&e<this.value.length?this.createValueCopy():this.createNewValue()).splice(e,1),s=this.deleteRowValue(s,null),this.isRowChanging=!0,this.value=s,this.isRowChanging=!1}this.onRowsChanged(),this.survey&&this.survey.matrixRowRemoved(this,e,t)}get confirmDeleteText(){return this.getLocalizableStringText("confirmDeleteText")}set confirmDeleteText(e){this.setLocalizableStringText("confirmDeleteText",e)}get locConfirmDeleteText(){return this.getLocalizableString("confirmDeleteText")}get addRowText(){return this.getLocalizableStringText("addRowText",this.defaultAddRowText)}set addRowText(e){this.setLocalizableStringText("addRowText",e)}get locAddRowText(){return this.getLocalizableString("addRowText")}get defaultAddRowText(){return this.getLocalizationString(this.isColumnLayoutHorizontal?"addRow":"addColumn")}get addRowButtonLocation(){return this.getPropertyValue("addRowButtonLocation")}set addRowButtonLocation(e){this.setPropertyValue("addRowButtonLocation",e)}get addRowLocation(){return this.addRowButtonLocation}set addRowLocation(e){this.addRowButtonLocation=e}getAddRowLocation(){return this.addRowButtonLocation}get hideColumnsIfEmpty(){return this.getPropertyValue("hideColumnsIfEmpty")}set hideColumnsIfEmpty(e){this.setPropertyValue("hideColumnsIfEmpty",e)}getShowColumnsIfEmpty(){return this.hideColumnsIfEmpty}get removeRowText(){return this.getLocalizableStringText("removeRowText")}set removeRowText(e){this.setLocalizableStringText("removeRowText",e)}get locRemoveRowText(){return this.getLocalizableString("removeRowText")}get noRowsText(){return this.getLocalizableStringText("noRowsText")}set noRowsText(e){this.setLocalizableStringText("noRowsText",e)}get locNoRowsText(){return this.getLocalizableString("noRowsText")}get emptyRowsText(){return this.noRowsText}set emptyRowsText(e){this.noRowsText=e}get locEmptyRowsText(){return this.locNoRowsText}getDisplayValueCore(e,t){if(!t||!Array.isArray(t))return t;for(var s=this.getUnbindValue(t),i=this.visibleRows,r=0;r<i.length&&r<s.length;r++){var n=s[r];n&&(s[r]=this.getRowDisplayValue(e,i[r],n))}return s}getConditionObjectRowName(e){return"["+e.toString()+"]"}getConditionObjectsRowIndeces(){let e=[],t=Math.max(this.rowCount,1);for(var s=0;s<Math.min(tp.matrix.maxRowCountInCondition,t);s++)e.push(s);return e}supportAutoAdvance(){return!1}get hasRowText(){return!1}onCheckForErrors(e,t,s){super.onCheckForErrors(e,t,s),!t&&this.hasErrorInMinRows()&&e.push(new tE(this.minRowCount,this))}hasErrorInMinRows(){if(this.minRowCount<=0||!this.isRequired||!this.generatedVisibleRows)return!1;for(var e=0,t=0;t<this.generatedVisibleRows.length;t++)!this.generatedVisibleRows[t].isEmpty&&e++;return e<this.minRowCount}getUniqueColumnsNames(){var e=super.getUniqueColumnsNames();let t=this.keyName;return t&&0>e.indexOf(t)&&e.push(t),e}generateRows(){var e=[];if(0===this.rowCount)return e;for(var t=this.createNewValue(),s=0;s<this.rowCount;s++)e.push(this.createMatrixRow(this.getRowValueByIndex(t,s)));return this.isValueEmpty(this.getDefaultRowValue(!1))||(this.value=t),e}createMatrixRow(e){return new sA(this.rowCounter++,this,e)}getInsertedDeletedIndex(e,t){let s=Math.min(e.length,t.length);for(let i=0;i<s;i++)if(t[i]!==e[i].editingObj)return i;return s}isEditingObjectValueChanged(){let e=this.value;if(!this.generatedVisibleRows||!this.isValueSurveyElement(e))return!1;let t=this.lastDeletedRow;this.lastDeletedRow=void 0;let s=this.generatedVisibleRows;if(!Array.isArray(e)||Math.abs(s.length-e.length)>1||s.length===e.length)return!1;let i=this.getInsertedDeletedIndex(s,e);if(s.length>e.length){this.lastDeletedRow=s[i];let e=s[i];s.splice(i,1),this.isRendredTableCreated&&this.renderedTable.onRemovedRow(e)}else{let r;t&&t.editingObj===e[i]?r=t:(t=void 0,r=this.createMatrixRow(e[i])),s.splice(i,0,r),t||this.onMatrixRowCreated(r),this.isRendredTableCreated&&this.renderedTable.onAddedRow(r,i)}return this.setPropertyValueDirectly("rowCount",e.length),!0}updateValueFromSurvey(e,t=!1){if(this.setRowCountValueFromData=!0,this.minRowCount>0&&a.isValueEmpty(e)&&!a.isValueEmpty(this.defaultRowValue)){e=[];for(let t=0;t<this.minRowCount;t++)e.push(a.createCopy(this.defaultRowValue))}super.updateValueFromSurvey(e,t),this.setRowCountValueFromData=!1}getFilteredDataCore(){let e=[],t=this.createValueCopy();if(!Array.isArray(t))return e;let s=this.generatedVisibleRows;for(let i=0;i<s.length&&i<t.length;i++){let r=t[i];s[i].isVisible&&!a.isValueEmpty(r)&&e.push(r)}return e}onBeforeValueChanged(e){if(e&&Array.isArray(e)){var t=e.length;if(!(t==this.rowCount||!this.setRowCountValueFromData&&t<this.initialRowCount||this.isEditingObjectValueChanged())&&(this.setRowCountValueFromData=!0,this.rowCountValue=t,this.generatedVisibleRows)){if(t==this.generatedVisibleRows.length+1){this.onStartRowAddingRemoving();let s=this.getRowValueByIndex(e,t-1),i=this.createMatrixRow(s);this.generatedVisibleRows.push(i),this.onMatrixRowCreated(i),this.onEndRowAdding()}else this.clearGeneratedRows(),this.getVisibleRows(),this.onRowsChanged();this.setRowCountValueFromData=!1}}}createNewValue(){var e=this.createValueCopy();e&&Array.isArray(e)||(e=[]),e.length>this.rowCount&&e.splice(this.rowCount);var t=this.getDefaultRowValue(!1);t=t||{};for(var s=e.length;s<this.rowCount;s++)e.push(this.getUnbindValue(t));return e}deleteRowValue(e,t){if(!Array.isArray(e))return e;for(var s=!0,i=0;i<e.length;i++)if(this.isObject(e[i])&&Object.keys(e[i]).length>0){s=!1;break}return s?null:e}getRowValueByIndex(e,t){return Array.isArray(e)&&t>=0&&t<e.length?e[t]:null}getRowValueCore(e,t,s=!1){if(!this.generatedVisibleRows)return{};var i=this.getRowValueByIndex(t,this.generatedVisibleRows.indexOf(e));return!i&&s&&(i={}),i}getAddRowButtonCss(e=!1){return new eV().append(this.cssClasses.button).append(this.cssClasses.buttonAdd).append(this.cssClasses.emptyRowsButton,e).toString()}getRemoveRowButtonCss(){return new eV().append(this.cssClasses.button).append(this.cssClasses.buttonRemove).toString()}getRootCss(){var e;return new eV().append(super.getRootCss()).append(this.cssClasses.empty,!(null===(e=this.renderedTable)||void 0===e?void 0:e.showTable)).toString()}}class sO extends sc{setDefaultRowActions(e,t){super.setDefaultRowActions(e,t)}}E.addClass("matrixdynamic",[{name:"allowAddRows:boolean",default:!0},{name:"allowRemoveRows:boolean",default:!0},{name:"rowCount:number",default:2,minValue:0,isBindable:!0},{name:"minRowCount:number",default:0,minValue:0},{name:"maxRowCount:number",default:tp.matrix.maxRowCount},{name:"keyName"},"defaultRowValue:rowvalue",{name:"copyDefaultValueFromLastEntry:boolean",alternativeName:"defaultValueFromLastRow"},{name:"confirmDelete:boolean"},{name:"confirmDeleteText",dependsOn:"confirmDelete",visibleIf:function(e){return!e||e.confirmDelete},serializationProperty:"locConfirmDeleteText"},{name:"addRowButtonLocation",alternativeName:"addRowLocation",default:"default",choices:["default","top","bottom","topBottom"]},{name:"addRowText",serializationProperty:"locAddRowText"},{name:"removeRowText",serializationProperty:"locRemoveRowText"},"hideColumnsIfEmpty:boolean",{name:"noRowsText:text",alternativeName:"emptyRowsText",serializationProperty:"locNoRowsText",dependsOn:"hideColumnsIfEmpty",visibleIf:function(e){return!e||e.hideColumnsIfEmpty}},{name:"detailPanelShowOnAdding:boolean",dependsOn:"detailPanelMode",visibleIf:function(e){return"none"!==e.detailPanelMode}},{name:"allowRowReorder:switch",alternativeName:"allowRowsDragAndDrop"}],function(){return new sD("")},"matrixdropdownbase"),st.Instance.registerQuestion("matrixdynamic",e=>{var t=new sD(e);return t.choices=[1,2,3,4,5],sC.addDefaultColumns(t),t});var sL={currentType:"default",getCss:function(){var e=this.currentType?this[this.currentType]:sN;return e||(e=sN),e},getAvailableThemes:function(){return Object.keys(this).filter(e=>-1===["currentType","getCss","getAvailableThemes"].indexOf(e))}},sN={root:"sd-root-modern",rootProgress:"sd-progress",rootMobile:"sd-root-modern--mobile",rootAnimationDisabled:"sd-root-modern--animation-disabled",rootReadOnly:"sd-root--readonly",rootCompact:"sd-root--compact",rootFitToContainer:"sd-root-modern--full-container",rootWrapper:"sd-root-modern__wrapper",rootWrapperFixed:"sd-root-modern__wrapper--fixed",rootWrapperHasImage:"sd-root-modern__wrapper--has-image",rootBackgroundImage:"sd-root_background-image",container:"sd-container-modern",header:"sd-title sd-container-modern__title",bodyContainer:"sv-components-row",body:"sd-body",bodyWithTimer:"sd-body--with-timer",clockTimerRoot:"sd-timer",clockTimerRootTop:"sd-timer--top",clockTimerRootBottom:"sd-timer--bottom",clockTimerProgress:"sd-timer__progress",clockTimerProgressAnimation:"sd-timer__progress--animation",clockTimerTextContainer:"sd-timer__text-container",clockTimerMinorText:"sd-timer__text--minor",clockTimerMajorText:"sd-timer__text--major",bodyEmpty:"sd-body sd-body--empty",bodyLoading:"sd-body--loading",footer:"sd-footer sd-body__navigation sd-clearfix",title:"sd-title",description:"sd-description",logo:"sd-logo",logoImage:"sd-logo__image",headerText:"sd-header__text",headerClose:"sd-hidden",navigationButton:"",bodyNavigationButton:"sd-btn",completedPage:"sd-completedpage",completedBeforePage:"sd-completed-before-page",timerRoot:"sd-body__timer",navigation:{complete:"sd-btn--action sd-navigation__complete-btn",prev:"sd-navigation__prev-btn",next:"sd-navigation__next-btn",start:"sd-navigation__start-btn",preview:"sd-navigation__preview-btn",edit:"sd-btn sd-btn--small"},panel:{contentEnter:"sd-element__content--enter",contentLeave:"sd-element__content--leave",enter:"sd-element-wrapper--enter",leave:"sd-element-wrapper--leave",asPage:"sd-panel--as-page",number:"sd-element__num",title:"sd-title sd-element__title sd-panel__title",titleExpandable:"sd-element__title--expandable",titleExpandableSvg:"sd-element__title-expandable-svg",titleNumInline:"sd-element__title--num-inline",titleExpanded:"sd-element__title--expanded",titleCollapsed:"sd-element__title--collapsed",titleDisabled:"sd-element__title--disabled",titleOnExpand:"sd-panel__title--expanded",titleOnError:"sd-panel__title--error",titleBar:"sd-action-title-bar",description:"sd-description sd-panel__description",container:"sd-element sd-element--complex sd-panel sd-row__panel",withFrame:"sd-element--with-frame",content:"sd-element__content sd-panel__content",icon:"sd-panel__icon",iconExpanded:"sd-panel__icon--expanded",footer:"sd-panel__footer",requiredMark:"sd-panel__required-text",header:"sd-panel__header sd-element__header sd-element__header--location-top",collapsed:"sd-element--collapsed",expanded:"sd-element--expanded",expandable:"sd-element--expandable",expandableAnimating:"sd-elemenet--expandable--animating",nested:"sd-element--nested sd-element--nested-with-borders",invisible:"sd-element--invisible",navigationButton:"",compact:"sd-element--with-frame sd-element--compact",errorsContainer:"sd-panel__errbox sd-element__erbox sd-element__erbox--above-element"},paneldynamic:{mainRoot:"sd-element  sd-question sd-question--paneldynamic sd-element--complex sd-question--complex sd-row__question",empty:"sd-question--empty",root:"sd-paneldynamic",iconRemove:"sd-hidden",navigation:"sd-paneldynamic__navigation",title:"sd-title sd-element__title sd-question__title",header:"sd-paneldynamic__header sd-element__header",headerTab:"sd-paneldynamic__header-tab",button:"sd-action sd-paneldynamic__btn",buttonRemove:"sd-action--negative sd-paneldynamic__remove-btn",buttonAdd:"sd-paneldynamic__add-btn",buttonPrev:"sd-paneldynamic__prev-btn sd-action--icon sd-action",buttonPrevDisabled:"sd-action--disabled",buttonNextDisabled:"sd-action--disabled",buttonNext:"sd-paneldynamic__next-btn sd-action--icon sd-action",progressContainer:"sd-paneldynamic__progress-container",progress:"sd-progress",progressBar:"sd-progress__bar",nested:"sd-element--nested sd-element--nested-with-borders",progressText:"sd-paneldynamic__progress-text",separator:"sd-paneldynamic__separator",panelWrapper:"sd-paneldynamic__panel-wrapper",footer:"sd-paneldynamic__footer",panelFooter:"sd-paneldynamic__panel-footer",footerButtonsContainer:"sd-paneldynamic__buttons-container",panelsContainer:"sd-paneldynamic__panels-container",panelWrapperInRow:"sd-paneldynamic__panel-wrapper--in-row",panelWrapperEnter:"sd-paneldynamic__panel-wrapper--enter",panelWrapperLeave:"sd-paneldynamic__panel-wrapper--leave",panelWrapperList:"sd-paneldynamic__panel-wrapper--list",progressBtnIcon:"icon-progressbuttonv2",noEntriesPlaceholder:"sd-paneldynamic__placeholder sd-question__placeholder",compact:"sd-element--with-frame sd-element--compact",tabsContainer:"sd-paneldynamic__tabs-container",tabsContainerWithHeader:"sd-paneldynamic__tabs-container--with-header",tabsRoot:"sd-tabs-toolbar",tabsLeft:"sd-tabs-toolbar--left",tabsRight:"sd-tabs-toolbar--right",tabsCenter:"sd-tabs-toolbar--center",tabs:{item:"sd-tab-item",itemPressed:"sd-tab-item--pressed",itemAsIcon:"sd-tab-item--icon",itemIcon:"sd-tab-item__icon",itemTitle:"sd-tab-item__title"}},progress:"sd-progress sd-body__progress",progressTop:"sd-body__progress--top",progressBottom:"sd-body__progress--bottom",progressBar:"sd-progress__bar",progressText:"sd-progress__text",progressButtonsRoot:"sd-progress-buttons",progressButtonsNumbered:"sd-progress-buttons--numbered",progressButtonsFitSurveyWidth:"sd-progress-buttons--fit-survey-width",progressButtonsContainerCenter:"sd-progress-buttons__container-center",progressButtonsContainer:"sd-progress-buttons__container",progressButtonsConnector:"sd-progress-buttons__connector",progressButtonsButton:"sd-progress-buttons__button",progressButtonsButtonBackground:"sd-progress-buttons__button-background",progressButtonsButtonContent:"sd-progress-buttons__button-content",progressButtonsHeader:"sd-progress-buttons__header",progressButtonsFooter:"sd-progress-buttons__footer",progressButtonsImageButtonLeft:"sd-progress-buttons__image-button-left",progressButtonsImageButtonRight:"sd-progress-buttons__image-button-right",progressButtonsImageButtonHidden:"sd-progress-buttons__image-button--hidden",progressButtonsListContainer:"sd-progress-buttons__list-container",progressButtonsList:"sd-progress-buttons__list",progressButtonsListElementPassed:"sd-progress-buttons__list-element--passed",progressButtonsListElementCurrent:"sd-progress-buttons__list-element--current",progressButtonsListElementNonClickable:"sd-progress-buttons__list-element--nonclickable",progressButtonsPageTitle:"sd-progress-buttons__page-title",progressButtonsPageDescription:"sd-progress-buttons__page-description",progressTextInBar:"sd-hidden",page:{root:"sd-page sd-body__page",emptyHeaderRoot:"sd-page__empty-header",title:"sd-title sd-page__title",description:"sd-description sd-page__description",number:"sd-page__num",errorsContainer:"sd-page__errbox"},pageTitle:"sd-title sd-page__title",pageDescription:"sd-description sd-page__description",row:"sd-row sd-clearfix",rowMultiple:"sd-row--multiple",rowCompact:"sd-row--compact",rowEnter:"sd-row--enter",rowDelayedEnter:"sd-row--delayed-enter",rowLeave:"sd-row--leave",rowReplace:"sd-row--replace",pageRow:"sd-page__row",question:{contentEnter:"sd-element__content--enter",contentLeave:"sd-element__content--leave",enter:"sd-element-wrapper--enter",leave:"sd-element-wrapper--leave",mobile:"sd-question--mobile",mainRoot:"sd-element sd-question sd-row__question",flowRoot:"sd-element sd-question sd-row__question sd-row__question--flow",withFrame:"sd-element--with-frame",asCell:"sd-table__cell",answered:"sd-question--answered",header:"sd-question__header sd-element__header",headerLeft:"sd-question__header--location--left",headerTop:"sd-question__header--location-top sd-element__header--location-top",headerBottom:"sd-question__header--location--bottom",content:"sd-element__content sd-question__content",contentSupportContainerQueries:"sd-question__content--support-container-queries",contentLeft:"sd-question__content--left",titleNumInline:"sd-element__title--num-inline",titleLeftRoot:"sd-question--left",titleTopRoot:"sd-question--title-top",descriptionUnderInputRoot:"sd-question--description-under-input",titleBottomRoot:"sd-question--title-bottom",titleOnAnswer:"sd-question__title--answer",titleEmpty:"sd-question__title--empty",titleOnError:"sd-question__title--error",title:"sd-title sd-element__title sd-question__title",titleExpandable:"sd-element__title--expandable",titleExpandableSvg:"sd-element__title-expandable-svg",titleExpanded:"sd-element__title--expanded",titleCollapsed:"sd-element__title--collapsed",titleDisabled:"sd-element__title--disabled",titleReadOnly:"sd-element__title--readonly",titleBar:"sd-action-title-bar",requiredMark:"sd-question__required-text",number:"sd-element__num",description:"sd-description sd-question__description",descriptionUnderInput:"sd-question__description--under-input",comment:"sd-input sd-comment",other:"sd-input sd-comment",required:"sd-question--required",titleRequired:"sd-question__title--required",indent:20,footer:"sd-question__footer",commentArea:"sd-question__comment-area",formGroup:"sd-question__form-group",hasError:"sd-question--error",hasErrorTop:"sd-question--error-top",hasErrorBottom:"sd-question--error-bottom",collapsed:"sd-element--collapsed",expandable:"sd-element--expandable",expandableAnimating:"sd-elemenet--expandable--animating",expanded:"sd-element--expanded",nested:"sd-element--nested",invisible:"sd-element--invisible",composite:"sd-element--complex sd-composite",disabled:"sd-question--disabled",readOnly:"sd-question--readonly",preview:"sd-question--preview",noPointerEventsMode:"sd-question--no-pointer-events",errorsContainer:"sd-element__erbox sd-question__erbox",errorsContainerTop:"sd-element__erbox--above-element sd-question__erbox--above-question",errorsContainerBottom:"sd-question__erbox--below-question",confirmDialog:"sd-popup--confirm sv-popup--confirm"},image:{mainRoot:"sd-element sd-question sd-question--image",root:"sd-image",image:"sd-image__image",adaptive:"sd-image__image--adaptive",noImage:"sd-image__no-image",noImageSvgIconId:"icon-no-image",withFrame:""},html:{mainRoot:"sd-element sd-question sd-row__question sd-question--html",root:"sd-html",withFrame:"",nested:"sd-element--nested sd-html--nested"},error:{root:"sd-error",icon:"",item:"",locationTop:"",locationBottom:""},checkbox:{root:"sd-selectbase",rootMobile:"sd-selectbase--mobile",rootRow:"sd-selectbase--row",rootMultiColumn:"sd-selectbase--multi-column",item:"sd-item sd-checkbox sd-selectbase__item",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",itemOnError:"sd-item--error",itemSelectAll:"sd-checkbox--selectall",itemNone:"sd-checkbox--none",itemDisabled:"sd-item--disabled sd-checkbox--disabled",itemReadOnly:"sd-item--readonly sd-checkbox--readonly",itemPreview:"sd-item--preview sd-checkbox--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemChecked:"sd-item--checked sd-checkbox--checked",itemHover:"sd-item--allowhover sd-checkbox--allowhover",itemInline:"sd-selectbase__item--inline",label:"sd-selectbase__label",labelChecked:"",itemControl:"sd-visuallyhidden sd-item__control sd-checkbox__control",itemDecorator:"sd-item__svg sd-checkbox__svg",itemSvgIconId:"#icon-check-16x16",controlLabel:"sd-item__control-label",materialDecorator:"sd-item__decorator sd-checkbox__decorator",other:"sd-input sd-comment sd-selectbase__other",column:"sd-selectbase__column"},radiogroup:{root:"sd-selectbase",rootMobile:"sd-selectbase--mobile",rootRow:"sd-selectbase--row",rootMultiColumn:"sd-selectbase--multi-column",item:"sd-item sd-radio sd-selectbase__item",itemOnError:"sd-item--error",itemInline:"sd-selectbase__item--inline",label:"sd-selectbase__label",labelChecked:"",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",itemDisabled:"sd-item--disabled sd-radio--disabled",itemReadOnly:"sd-item--readonly sd-radio--readonly",itemPreview:"sd-item--preview sd-radio--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemChecked:"sd-item--checked sd-radio--checked",itemHover:"sd-item--allowhover sd-radio--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-radio__control",itemDecorator:"sd-item__svg sd-radio__svg",controlLabel:"sd-item__control-label",materialDecorator:"sd-item__decorator sd-radio__decorator",other:"sd-input sd-comment sd-selectbase__other",clearButton:"",column:"sd-selectbase__column"},boolean:{mainRoot:"sd-element sd-question sd-row__question sd-question--boolean",root:"sv_qcbc sv_qbln sd-scrollable-container sd-boolean-root",rootRadio:"sv_qcbc sv_qbln sd-scrollable-container sd-scrollable-container--compact",item:"sd-boolean",itemOnError:"sd-boolean--error",control:"sd-boolean__control sd-visuallyhidden",itemChecked:"sd-boolean--checked",itemExchanged:"sd-boolean--exchanged",itemIndeterminate:"sd-boolean--indeterminate",itemDisabled:"sd-boolean--disabled",itemReadOnly:"sd-boolean--readonly",itemPreview:"sd-boolean--preview",itemHover:"sd-boolean--allowhover",label:"sd-boolean__label",labelTrue:"sd-boolean__label--true",labelFalse:"sd-boolean__label--false",switch:"sd-boolean__switch",disabledLabel:"sd-checkbox__label--disabled",labelReadOnly:"sd-checkbox__label--readonly",labelPreview:"sd-checkbox__label--preview",sliderText:"sd-boolean__thumb-text",slider:"sd-boolean__thumb",sliderGhost:"sd-boolean__thumb-ghost",radioItem:"sd-item",radioItemChecked:"sd-item--checked sd-radio--checked",radioItemDisabled:"sd-item--disabled sd-radio--disabled",radioItemReadOnly:"sd-item--readonly sd-radio--readonly",radioItemPreview:"sd-item--preview sd-radio--preview",itemPreviewSvgIconId:"#icon-check-16x16",radioLabel:"sd-selectbase__label",radioControlLabel:"sd-item__control-label",radioFieldset:"sd-selectbase",itemRadioDecorator:"sd-item__svg sd-radio__svg",materialRadioDecorator:"sd-item__decorator sd-radio__decorator",itemRadioControl:"sd-visuallyhidden sd-item__control sd-radio__control",rootCheckbox:"sd-selectbase",checkboxItem:"sd-item sd-selectbase__item sd-checkbox",checkboxLabel:"sd-selectbase__label",checkboxItemOnError:"sd-item--error",checkboxItemIndeterminate:"sd-checkbox--intermediate",checkboxItemChecked:"sd-item--checked sd-checkbox--checked",checkboxItemDecorator:"sd-item__svg sd-checkbox__svg",checkboxItemDisabled:"sd-item--disabled sd-checkbox--disabled",checkboxItemReadOnly:"sd-item--readonly sd-checkbox--readonly",checkboxItemPreview:"sd-item--preview sd-checkbox--preview",controlCheckbox:"sd-visuallyhidden sd-item__control sd-checkbox__control",checkboxMaterialDecorator:"sd-item__decorator sd-checkbox__decorator",checkboxControlLabel:"sd-item__control-label",svgIconCheckedId:"#icon-check-16x16"},text:{root:"sd-input sd-text",small:"sd-row__question--small",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",constrolWithCharacterCounter:"sd-text__character-counter",characterCounterBig:"sd-text__character-counter--big",content:"sd-text__content sd-question__content",remainingCharacterCounter:"sd-remaining-character-counter",onError:"sd-input--error"},multipletext:{root:"sd-multipletext",rootMobile:"sd-multipletext--mobile",itemLabel:"sd-multipletext__item-container sd-input",itemLabelReadOnly:"sd-input--readonly",itemLabelDisabled:"sd-input--disabled",itemLabelPreview:"sd-input--preview",itemLabelOnError:"sd-multipletext__item-container--error",itemLabelAllowFocus:"sd-multipletext__item-container--allow-focus",itemLabelAnswered:"sd-multipletext__item-container--answered",itemWithCharacterCounter:"sd-multipletext-item__character-counter",item:"sd-multipletext__item",itemTitle:"sd-multipletext__item-title",content:"sd-multipletext__content sd-question__content",row:"sd-multipletext__row",cell:"sd-multipletext__cell",cellError:"sd-multipletext__cell--error",cellErrorTop:"sd-multipletext__cell--error-top",cellErrorBottom:"sd-multipletext__cell--error-bottom"},dropdown:{root:"sd-selectbase",popup:"sv-dropdown-popup",small:"sd-row__question--small",selectWrapper:"sv-dropdown_select-wrapper",other:"sd-input sd-comment sd-selectbase__other",onError:"sd-input--error",label:"sd-selectbase__label",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",item:"sd-item sd-radio sd-selectbase__item",itemDisabled:"sd-item--disabled sd-radio--disabled",itemChecked:"sd-item--checked sd-radio--checked",itemHover:"sd-item--allowhover sd-radio--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-radio__control",itemDecorator:"sd-item__svg sd-radio__svg",cleanButton:"sd-dropdown_clean-button",cleanButtonSvg:"sd-dropdown_clean-button-svg",cleanButtonIconId:"icon-cancel",chevronButton:"sd-dropdown_chevron-button",chevronButtonSvg:"sd-dropdown_chevron-button-svg",chevronButtonIconId:"icon-chevron",control:"sd-input sd-dropdown",controlInputFieldComponent:"sd-dropdown__input-field-component",controlValue:"sd-dropdown__value",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty",controlLabel:"sd-item__control-label",filterStringInput:"sd-dropdown__filter-string-input",materialDecorator:"sd-item__decorator sd-radio__decorator",hintPrefix:"sd-dropdown__hint-prefix",hintSuffix:"sd-dropdown__hint-suffix"},imagepicker:{mainRoot:"sd-element sd-question sd-row__question",root:"sd-selectbase sd-imagepicker",rootResponsive:"sd-imagepicker--responsive",rootStatic:"sd-imagepicker--static",rootColumn:"sd-imagepicker--column",item:"sd-imagepicker__item",itemOnError:"sd-imagepicker__item--error",itemInline:"sd-imagepicker__item--inline",itemChecked:"sd-imagepicker__item--checked",itemDisabled:"sd-imagepicker__item--disabled",itemReadOnly:"sd-imagepicker__item--readonly",itemPreview:"sd-imagepicker__item--preview",itemHover:"sd-imagepicker__item--allowhover",label:"sd-imagepicker__label",itemDecorator:"sd-imagepicker__item-decorator",imageContainer:"sd-imagepicker__image-container",itemControl:"sd-imagepicker__control sd-visuallyhidden",image:"sd-imagepicker__image",itemText:"sd-imagepicker__text",other:"sd-input sd-comment",itemNoImage:"sd-imagepicker__no-image",itemNoImageSvgIcon:"sd-imagepicker__no-image-svg",itemNoImageSvgIconId:"icon-no-image",column:"sd-selectbase__column sd-imagepicker__column",checkedItemDecorator:"sd-imagepicker__check-decorator",checkedItemSvgIcon:"sd-imagepicker__check-icon",checkedItemSvgIconId:"icon-check-24x24"},matrix:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",tableWrapper:"sd-matrix sd-table-wrapper",root:"sd-table sd-matrix__table",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",rootVerticalAlignTop:"sd-table--align-top",rootVerticalAlignMiddle:"sd-table--align-middle",rootAlternateRows:"sd-table--alternate-rows",rowError:"sd-matrix__row--error",cell:"sd-table__cell sd-matrix__cell",row:"sd-table__row",rowDisabled:"sd-table__row-disabled",rowReadOnly:"sd-table__row-readonly",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-matrix__cell sd-table__cell--row-text",label:"sd-item sd-radio sd-matrix__label",itemOnError:"sd-item--error",itemValue:"sd-visuallyhidden sd-item__control sd-radio__control",itemChecked:"sd-item--checked sd-radio--checked",itemDisabled:"sd-item--disabled sd-radio--disabled",itemReadOnly:"sd-item--readonly sd-radio--readonly",itemPreview:"sd-item--preview sd-radio--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemHover:"sd-radio--allowhover",materialDecorator:"sd-item__decorator sd-radio__decorator",itemDecorator:"sd-item__svg sd-radio__svg",cellText:"sd-matrix__text",cellTextSelected:"sd-matrix__text--checked",cellTextDisabled:"sd-matrix__text--disabled",cellResponsiveTitle:"sd-matrix__responsive-title",compact:"sd-element--with-frame sd-element--compact"},matrixdropdown:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",rootScroll:"sd-question--scroll",root:"sd-table sd-matrixdropdown",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",hasFooter:"sd-table--has-footer",rootVerticalAlignTop:"sd-table--align-top",rootVerticalAlignMiddle:"sd-table--align-middle",tableWrapper:"sd-table-wrapper",rootAlternateRows:"sd-table--alternate-rows",cell:"sd-table__cell",cellResponsiveTitle:"sd-table__responsive-title",errorsCell:"sd-table__cell--error",errorsCellTop:"sd-table__cell--error-top",errorsCellBottom:"sd-table__cell--error-bottom",itemCell:"sd-table__cell--item",row:"sd-table__row",rowDelayedEnter:"sd-table__row--delayed-enter",rowEnter:"sd-table__row--enter",rowLeave:"sd-table__row--leave",expandedRow:"sd-table__row--expanded",rowHasPanel:"sd-table__row--has-panel",rowHasEndActions:"sd-table__row--has-end-actions",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-table__cell--row-text",footerCell:"sd-table__cell sd-table__cell--footer",footerTotalCell:"sd-table__cell sd-table__cell--footer-total",columnTitleCell:"sd-table__cell--column-title",cellRequiredMark:"sd-question__required-text",detailButton:"sd-table__cell--detail-button",detailButtonExpanded:"sd-table__cell--detail-button--expanded",detailIcon:"sd-detail-panel__icon",detailIconExpanded:"sd-detail-panel__icon--expanded",detailIconId:"icon-expanddetail",detailIconExpandedId:"icon-collapsedetail",detailPanelCell:"sd-table__cell--detail-panel",detailRowCell:"sd-table__cell--detail",actionsCellPrefix:"sd-table__cell-action",actionsCell:"sd-table__cell sd-table__cell--actions",actionsCellDrag:"sd-table__cell--drag",emptyCell:"sd-table__cell--empty",verticalCell:"sd-table__cell--vertical",cellQuestionWrapper:"sd-matrix__question-wrapper sd-table__question-wrapper",compact:"sd-element--with-frame sd-element--compact"},matrixdynamic:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",rootScroll:"sd-question--scroll",empty:"sd-question--empty",root:"sd-table sd-matrixdynamic",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",hasFooter:"sd-table--has-footer",tableWrapper:"sd-table-wrapper",rootAlternateRows:"sd-table--alternate-rows",content:"sd-matrixdynamic__content sd-question__content",cell:"sd-table__cell",cellResponsiveTitle:"sd-table__responsive-title",row:"sd-table__row",rowDelayedEnter:"sd-table__row--delayed-enter",rowEnter:"sd-table__row--enter",rowLeave:"sd-table__row--leave",rowHasPanel:"sd-table__row--has-panel",rowHasEndActions:"sd-table__row--has-end-actions",expandedRow:"sd-table__row--expanded",itemCell:"sd-table__cell--item",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-table__cell--row-text",footerCell:"sd-table__cell sd-table__cell--footer",columnTitleCell:"sd-table__cell--column-title",cellRequiredMark:"sd-question__required-text",button:"sd-action sd-matrixdynamic__btn",detailRow:"sd-table__row sd-table__row--detail",detailButton:"sd-table__cell--detail-button",detailButtonExpanded:"sd-table__cell--detail-button--expanded",detailIcon:"sd-detail-panel__icon",detailIconExpanded:"sd-detail-panel__icon--expanded",detailIconId:"icon-expanddetail",detailIconExpandedId:"icon-collapsedetail",detailPanelCell:"sd-table__cell--detail-panel",detailRowCell:"sd-table__cell--detail",actionsCellPrefix:"sd-table__cell-action",actionsCell:"sd-table__cell sd-table__cell--actions",actionsCellDrag:"sd-table__cell--drag",buttonAdd:"sd-matrixdynamic__add-btn",buttonRemove:"sd-action--negative sd-matrixdynamic__remove-btn",iconAdd:"sd-hidden",iconRemove:"",dragElementDecorator:"sd-drag-element__svg",iconDragElement:"#icon-drag-24x24",footer:"sd-matrixdynamic__footer",footerTotalCell:"sd-table__cell sd-table__cell--footer-total",noRowsSection:"sd-matrixdynamic__placeholder sd-question__placeholder",iconDrag:"sv-matrixdynamic__drag-icon",ghostRow:"sv-matrix-row--drag-drop-ghost-mod",draggedRow:"sv-matrixdynamic-dragged-row",emptyCell:"sd-table__cell--empty",verticalCell:"sd-table__cell--vertical",cellQuestionWrapper:"sd-matrix__question-wrapper sd-table__question-wrapper",errorsCell:"sd-table__cell--error",errorsCellTop:"sd-table__cell--error-top",errorsCellBottom:"sd-table__cell--error-bottom",compact:"sd-element--with-frame sd-element--compact"},rating:{rootDropdown:"sd-scrollable-container sd-scrollable-container--compact sd-selectbase",root:"sd-scrollable-container sd-rating",rootWrappable:"sd-rating--wrappable",rootLabelsTop:"sd-rating--labels-top",rootLabelsBottom:"sd-rating--labels-bottom",rootLabelsDiagonal:"sd-rating--labels-diagonal",item:"sd-rating__item",itemOnError:"sd-rating__item--error",itemHover:"sd-rating__item--allowhover",selected:"sd-rating__item--selected",itemStar:"sd-rating__item-star",itemStarOnError:"sd-rating__item-star--error",itemStarHover:"sd-rating__item-star--allowhover",itemStarSelected:"sd-rating__item-star--selected",itemStarDisabled:"sd-rating__item-star--disabled",itemStarReadOnly:"sd-rating__item-star--readonly",itemStarPreview:"sd-rating__item-star--preview",itemStarHighlighted:"sd-rating__item-star--highlighted",itemStarUnhighlighted:"sd-rating__item-star--unhighlighted",itemStarSmall:"sd-rating__item-star--small",itemSmiley:"sd-rating__item-smiley",itemSmileyOnError:"sd-rating__item-smiley--error",itemSmileyHover:"sd-rating__item-smiley--allowhover",itemSmileySelected:"sd-rating__item-smiley--selected",itemSmileyDisabled:"sd-rating__item-smiley--disabled",itemSmileyReadOnly:"sd-rating__item-smiley--readonly",itemSmileyPreview:"sd-rating__item-smiley--preview",itemSmileyHighlighted:"sd-rating__item-star--highlighted",itemSmileyScaleColored:"sd-rating__item-smiley--scale-colored",itemSmileyRateColored:"sd-rating__item-smiley--rate-colored",itemSmileySmall:"sd-rating__item-smiley--small",minText:"sd-rating__item-text sd-rating__min-text",itemText:"sd-rating__item-text",maxText:"sd-rating__item-text sd-rating__max-text",itemDisabled:"sd-rating__item--disabled",itemReadOnly:"sd-rating__item--readonly",itemPreview:"sd-rating__item--preview",itemFixedSize:"sd-rating__item--fixed-size",control:"sd-input sd-dropdown",itemSmall:"sd-rating--small",selectWrapper:"sv-dropdown_select-wrapper",controlValue:"sd-dropdown__value",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty",filterStringInput:"sd-dropdown__filter-string-input",chevronButton:"sd-dropdown_chevron-button",chevronButtonSvg:"sd-dropdown_chevron-button-svg",chevronButtonIconId:"icon-chevron",popup:"sv-dropdown-popup",onError:"sd-input--error"},comment:{root:"sd-input sd-comment",small:"sd-row__question--small",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",content:"sd-comment__content sd-question__content",remainingCharacterCounter:"sd-remaining-character-counter",onError:"sd-input--error"},expression:"sd-expression",file:{root:"sd-file",rootDragging:"sd-file--dragging",rootAnswered:"sd-file--answered",rootDisabled:"sd-file--disabled",rootReadOnly:"sd-file--readonly",rootPreview:"sd-file--preview",other:"sd-input sd-comment",placeholderInput:"sd-visuallyhidden",previewItem:"sd-file__preview-item",fileSign:"",fileList:"sd-file__list",fileSignBottom:"sd-file__sign",dragArea:"sd-file__drag-area",dragAreaActive:"sd-file__drag-area--active",fileDecorator:"sd-file__decorator",onError:"sd-file__decorator--error",fileDecoratorDrag:"sd-file__decorator--drag",fileInput:"sd-visuallyhidden",noFileChosen:"sd-description sd-file__no-file-chosen",chooseFile:"sd-file__choose-btn",chooseFileAsText:"sd-action sd-file__choose-btn--text",chooseFileAsTextDisabled:"sd-action--disabled",chooseFileAsIcon:"sd-file__choose-btn--icon",chooseFileIconId:"icon-choosefile",disabled:"sd-file__choose-btn--disabled",controlDisabled:"sd-file__choose-file-btn--disabled",removeButton:"sd-context-btn--negative",removeButtonBottom:"",removeButtonIconId:"icon-clear",removeFile:"sd-hidden",removeFileSvg:"",removeFileSvgIconId:"icon-close_16x16",wrapper:"sd-file__wrapper",defaultImage:"sd-file__default-image",defaultImageIconId:"icon-defaultfile",leftIconId:"icon-arrowleft",rightIconId:"icon-arrowright",removeFileButton:"sd-context-btn--small sd-context-btn--with-border sd-context-btn--colorful sd-context-btn--negative sd-file__remove-file-button",dragAreaPlaceholder:"sd-file__drag-area-placeholder",imageWrapper:"sd-file__image-wrapper",imageWrapperDefaultImage:"sd-file__image-wrapper--default-image",single:"sd-file--single",singleImage:"sd-file--single-image",mobile:"sd-file--mobile",videoContainer:"sd-file__video-container",contextButton:"sd-context-btn",video:"sd-file__video",actionsContainer:"sd-file__actions-container",closeCameraButton:"sd-file__close-camera-button",changeCameraButton:"sd-file__change-camera-button",takePictureButton:"sd-file__take-picture-button",loadingIndicator:"sd-file__loading-indicator",page:"sd-file__page"},signaturepad:{mainRoot:"sd-element sd-question sd-question--signature sd-row__question",root:"sd-signaturepad sjs_sp_container",small:"sd-row__question--small",controls:"sjs_sp_controls sd-signaturepad__controls",placeholder:"sjs_sp_placeholder",canvas:"sjs_sp_canvas sd-signaturepad__canvas",backgroundImage:"sjs_sp__background-image sd-signaturepad__background-image",clearButton:"sjs_sp_clear sd-context-btn sd-context-btn--negative sd-signaturepad__clear",clearButtonIconId:"icon-clear",loadingIndicator:"sd-signaturepad__loading-indicator"},saveData:{root:"sv-save-data_root",rootWithButtons:"sv-save-data_root--with-buttons",info:"sv-save-data_info",error:"sv-save-data_error",success:"sv-save-data_success",button:"sv-save-data_button",shown:"sv-save-data_root--shown"},window:{root:"sv_window",rootCollapsedMod:"sv_window--collapsed",rootFullScreenMode:"sv_window--full-screen",rootContent:"sv_window_root-content",body:"sv_window_content",header:{root:"sv_window_header",titleCollapsed:"sv_window_header_title_collapsed",buttonsContainer:"sv_window_buttons_container",button:"sv_window_button",buttonExpanded:"",buttonCollapsed:"",collapseButton:"sv_window_button sv_window_button_collapse",closeButton:"sv_window_button sv_window_button_close",fullScreenButton:"sv_window_button sv_window_button_full_screen"}},ranking:{root:"sv-ranking",rootMobileMod:"sv-ranking--mobile",rootDragMod:"sv-ranking--drag",rootDisabled:"sd-ranking--disabled",rootReadOnly:"sd-ranking--readonly",rootPreview:"sd-ranking--preview",rootDesignMode:"sv-ranking--design-mode",rootDragHandleAreaIcon:"sv-ranking--drag-handle-area-icon",rootSelectToRankMod:"sv-ranking--select-to-rank",rootSelectToRankEmptyValueMod:"sv-ranking--select-to-rank-empty-value",rootSelectToRankAlignVertical:"sv-ranking--select-to-rank-vertical",rootSelectToRankAlignHorizontal:"sv-ranking--select-to-rank-horizontal",rootSelectToRankSwapAreas:"sv-ranking--select-to-rank-swap-areas",item:"sv-ranking-item",itemContent:"sv-ranking-item__content sd-ranking-item__content",itemIndex:"sv-ranking-item__index sd-ranking-item__index",itemIndexEmptyMode:"sv-ranking-item__index--empty sd-ranking-item__index--empty",itemDisabled:"sv-ranking-item--disabled",itemReadOnly:"sv-ranking-item--readonly",itemPreview:"sv-ranking-item--preview",controlLabel:"sv-ranking-item__text",itemGhostNode:"sv-ranking-item__ghost",itemIconContainer:"sv-ranking-item__icon-container",itemIcon:"sv-ranking-item__icon",itemIconHoverMod:"sv-ranking-item__icon--hover",itemIconFocusMod:"sv-ranking-item__icon--focus",itemGhostMod:"sv-ranking-item--ghost",itemDragMod:"sv-ranking--drag",itemOnError:"sv-ranking-item--error",container:"sv-ranking__container",containerEmptyMode:"sv-ranking__container--empty",containerFromMode:"sv-ranking__container--from",containerToMode:"sv-ranking__container--to",containerPlaceholder:"sv-ranking__container-placeholder",containersDivider:"sv-ranking__containers-divider"},buttongroup:{root:"sv-button-group",item:"sv-button-group__item",itemIcon:"sv-button-group__item-icon",itemDecorator:"sv-button-group__item-decorator",itemCaption:"sv-button-group__item-caption",itemHover:"sv-button-group__item--hover",itemSelected:"sv-button-group__item--selected",itemDisabled:"sv-button-group__item--disabled",itemControl:"sv-visuallyhidden"},list:{root:"sv-list__container sd-list",item:"sv-list__item sd-list__item",itemBody:"sv-list__item-body sd-list__item-body",itemSelected:"sv-list__item--selected sd-list__item--selected",itemFocused:"sv-list__item--focused sd-list__item--focused",itemHovered:"sv-list__item--hovered sd-list__item--hovered"},actionBar:{root:"sd-action-bar",item:"sd-action",defaultSizeMode:"",smallSizeMode:"",itemPressed:"sd-action--pressed",itemAsIcon:"sd-action--icon",itemIcon:"sd-action__icon",itemTitle:"sd-action__title"},variables:{mobileWidth:"--sd-mobile-width",themeMark:"--sv-defaultV2-mark"},tagbox:{root:"sd-selectbase",popup:"sv-dropdown-popup",small:"sd-row__question--small",selectWrapper:"sv-dropdown_select-wrapper",other:"sd-input sd-comment sd-selectbase__other",onError:"sd-input--error",label:"sd-selectbase__label",itemSvgIconId:"#icon-check-16x16",item:"sd-item sd-checkbox sd-selectbase__item",itemDisabled:"sd-item--disabled sd-checkbox--disabled",itemChecked:"sd-item--checked sd-checkbox--checked",itemHover:"sd-item--allowhover sd-checkbox--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-checkbox__control",itemDecorator:"sd-item__svg sd-checkbox__svg",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",cleanButton:"sd-tagbox_clean-button sd-dropdown_clean-button",cleanButtonSvg:"sd-tagbox_clean-button-svg sd-dropdown_clean-button-svg",cleanButtonIconId:"icon-cancel-24x24",cleanItemButton:"sd-tagbox-item_clean-button",cleanItemButtonSvg:"sd-tagbox-item_clean-button-svg",cleanItemButtonIconId:"icon-clear_16x16",chevronButton:"sd-dropdown_chevron-button",chevronButtonSvg:"sd-dropdown_chevron-button-svg",chevronButtonIconId:"icon-chevron",control:"sd-input sd-tagbox sd-dropdown",controlValue:"sd-tagbox__value sd-dropdown__value",controlValueItems:"sd-tagbox__value-items",placeholderInput:"sd-tagbox__placeholder",controlEditable:"sd-input--editable",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty sd-tagbox--empty",controlLabel:"sd-item__control-label",filterStringInput:"sd-tagbox__filter-string-input sd-dropdown__filter-string-input",materialDecorator:"sd-item__decorator sd-checkbox__decorator",hint:"sd-tagbox__hint",hintPrefix:"sd-dropdown__hint-prefix sd-tagbox__hint-prefix",hintSuffix:"sd-dropdown__hint-suffix sd-tagbox__hint-suffix",hintSuffixWrapper:"sd-tagbox__hint-suffix-wrapper"}};let sk="default";sL[sk]=sN;var sF={setTimeout:e=>sF.safeTimeOut(e,1e3),clearTimeout:e=>{clearTimeout(e)},safeTimeOut:(e,t)=>t<=0?(e(),0):setTimeout(e,t),now:()=>Date.now()};class sM{constructor(){this.listenerCounter=0,this.timerId=-1,this.onTimerTick=new ev,this.onTimer=this.onTimerTick}static get instance(){return sM.instanceValue||(sM.instanceValue=new sM),sM.instanceValue}start(e=null){e&&this.onTimerTick.add(e),this.prevTimeInMs=sF.now(),this.timerId<0&&(this.timerId=sF.setTimeout(()=>{this.doTimer()})),this.listenerCounter++}stop(e=null){e&&this.onTimerTick.remove(e),this.listenerCounter--,0==this.listenerCounter&&this.timerId>-1&&(sF.clearTimeout(this.timerId),this.timerId=-1)}doTimer(){if((this.onTimerTick.isEmpty||0==this.listenerCounter)&&(this.timerId=-1),this.timerId<0)return;let e=sF.now(),t=Math.floor((e-this.prevTimeInMs)/1e3);this.prevTimeInMs=e,t<0&&(t=1);let s=this.timerId;this.onTimerTick.fire(this,{seconds:t}),s===this.timerId&&(this.timerId=sF.setTimeout(()=>{this.doTimer()}))}}sM.instanceValue=null;class s_ extends eg{constructor(e){super(),this.timerFunc=null,this.surveyValue=e,this.onCreating()}get survey(){return this.surveyValue}onCreating(){}start(){this.survey&&(this.isRunning||this.isDesignMode||(this.survey.onCurrentPageChanged.add(()=>{this.update()}),this.timerFunc=(e,t)=>{this.doTimer(t.seconds)},this.setIsRunning(!0),this.update(),sM.instance.start(this.timerFunc)))}stop(){this.isRunning&&(this.setIsRunning(!1),sM.instance.stop(this.timerFunc))}get isRunning(){return this.getPropertyValue("isRunning",!1)}setIsRunning(e){this.setPropertyValue("isRunning",e)}update(){this.updateText(),this.updateProgress()}doTimer(e){var t=this.survey.currentPage;if(t){let s=t.getMaxTimeToFinish();s>0&&s<t.timeSpent+e&&(e=s-t.timeSpent),t.timeSpent=t.timeSpent+e}this.spent=this.spent+e,this.update(),this.onTimerTick&&this.onTimerTick(t)}updateProgress(){let{spent:e,limit:t}=this.survey.timerInfo;t?(0==e?(this.progress=0,setTimeout(()=>{this.progress=Math.floor((e+1)/t*100)/100},0)):e<=t&&(this.progress=Math.floor((e+1)/t*100)/100),this.progress>1&&(this.progress=void 0)):this.progress=void 0}updateText(){let e=this.survey.timerClock;this.clockMajorText=e.majorText,this.clockMinorText=e.minorText,this.text=this.survey.timerInfoText}get showProgress(){return void 0!==this.progress}get showTimerAsClock(){return!!this.survey.getCss().clockTimerRoot}get rootCss(){return new eV().append(this.survey.getCss().clockTimerRoot).append(this.survey.getCss().clockTimerRootTop,this.survey.isTimerPanelShowingOnTop).append(this.survey.getCss().clockTimerRootBottom,this.survey.isTimerPanelShowingOnBottom).toString()}getProgressCss(){return new eV().append(this.survey.getCss().clockTimerProgress).append(this.survey.getCss().clockTimerProgressAnimation,this.progress>0).toString()}get textContainerCss(){return this.survey.getCss().clockTimerTextContainer}get minorTextCss(){return this.survey.getCss().clockTimerMinorText}get majorTextCss(){return this.survey.getCss().clockTimerMajorText}}ey([c()],s_.prototype,"text",void 0),ey([c()],s_.prototype,"progress",void 0),ey([c()],s_.prototype,"clockMajorText",void 0),ey([c()],s_.prototype,"clockMinorText",void 0),ey([c({defaultValue:0})],s_.prototype,"spent",void 0);class sq extends eg{constructor(e){super(),this.cssClasses=e,this.timeout=tp.notifications.lifetime,this.timer=void 0,this.actionsVisibility={},this.showActions=!0,this.actionBar=new ex,this.actionBar.updateCallback=e=>{this.actionBar.actions.forEach(e=>e.cssClasses={})},this.css=this.cssClasses.root}getCssClass(e){return new eV().append(this.cssClasses.root).append(this.cssClasses.rootWithButtons,this.actionBar.visibleActions.length>0).append(this.cssClasses.info,"error"!==e&&"success"!==e).append(this.cssClasses.error,"error"===e).append(this.cssClasses.success,"success"===e).append(this.cssClasses.shown,this.active).toString()}updateActionsVisibility(e){this.actionBar.actions.forEach(t=>t.visible=this.showActions&&this.actionsVisibility[t.id]===e)}notify(e,t="info",s=!1){this.isDisplayed=!0,setTimeout(()=>{this.updateActionsVisibility(t),this.message=e,this.active=!0,this.css=this.getCssClass(t),this.timer&&(clearTimeout(this.timer),this.timer=void 0),s||(this.timer=setTimeout(()=>{this.timer=void 0,this.active=!1,this.css=this.getCssClass(t)},this.timeout))},1)}addAction(e,t){e.visible=!1,e.innerCss=this.cssClasses.button;let s=this.actionBar.addAction(e);this.actionsVisibility[s.id]=t}}ey([c({defaultValue:!1})],sq.prototype,"active",void 0),ey([c({defaultValue:!1})],sq.prototype,"isDisplayed",void 0),ey([c()],sq.prototype,"message",void 0),ey([c()],sq.prototype,"css",void 0);class sB{calcRow(e){return"top"===e?1:"middle"===e?2:3}calcColumn(e){return"left"===e?1:"center"===e?2:3}calcAlignItems(e){return"left"===e?"flex-start":"center"===e?"center":"flex-end"}calcAlignText(e){return"left"===e?"start":"center"===e?"center":"end"}calcJustifyContent(e){return"top"===e?"flex-start":"middle"===e?"center":"flex-end"}constructor(e,t,s){this.cover=e,this.positionX=t,this.positionY=s}get survey(){return this.cover.survey}get css(){return new eV().append(sB.CLASSNAME).append(`${sB.CLASSNAME}--${this.positionX}`).append(`${sB.CLASSNAME}--${this.positionY}`).append(sB.CLASSNAME+"--empty",this.isEmpty).toString()}get style(){let e={};return e.gridColumn=this.calcColumn(this.positionX),e.gridRow=this.calcRow(this.positionY),e.width=this.width?this.width+"px":void 0,e}get contentStyle(){let e={};return e.textAlign=this.calcAlignText(this.positionX),e.alignItems=this.calcAlignItems(this.positionX),e.justifyContent=this.calcJustifyContent(this.positionY),e.maxWidth=this.contentMaxWidth,e}get showLogo(){return this.survey.hasLogo&&this.positionX===this.cover.logoPositionX&&this.positionY===this.cover.logoPositionY}get showTitle(){return this.survey.hasTitle&&this.positionX===this.cover.titlePositionX&&this.positionY===this.cover.titlePositionY}get showDescription(){return this.survey.renderedHasDescription&&this.positionX===this.cover.descriptionPositionX&&this.positionY===this.cover.descriptionPositionY}get isEmpty(){return!this.showLogo&&!this.showTitle&&!this.showDescription}get textAreaWidth(){return this.cover.renderedTextAreaWidth}get width(){if(this.cover.width)return Math.ceil(this.cover.width/3)}get contentMaxWidth(){return this.cover.getContentMaxWidth(this)}}sB.CLASSNAME="sv-header__cell";class sQ extends eg{calcBackgroundSize(e){return"fill"===e?"100% 100%":"tile"===e?"auto":e}updateHeaderClasses(){let e=!this.backgroundColor||"transparent"===this.backgroundColor,t="var(--sjs-primary-backcolor)"===this.backgroundColor,s=!e&&!t;this.headerClasses=new eV().append("sv-header").append("sv-header--height-auto",!this.renderedHeight).append("sv-header__without-background",e&&!this.backgroundImage).append("sv-header__background-color--none",e&&!this.titleColor&&!this.descriptionColor).append("sv-header__background-color--accent",t&&!this.titleColor&&!this.descriptionColor).append("sv-header__background-color--custom",s&&!this.titleColor&&!this.descriptionColor).append("sv-header__overlap",this.overlapEnabled).toString()}updateContentClasses(){let e=!!this.survey&&this.survey.calculateWidthMode();this.maxWidth="survey"===this.inheritWidthFrom&&!!e&&"static"===e&&this.survey.renderedWidth,this.contentClasses=new eV().append("sv-header__content").append("sv-header__content--static","survey"===this.inheritWidthFrom&&!!e&&"static"===e).append("sv-header__content--responsive","container"===this.inheritWidthFrom||!!e&&"responsive"===e).toString()}updateBackgroundImageClasses(){this.backgroundImageClasses=new eV().append("sv-header__background-image").append("sv-header__background-image--contain","contain"===this.backgroundImageFit).append("sv-header__background-image--tile","tile"===this.backgroundImageFit).toString()}fromTheme(e){super.fromJSON(e.header||{}),e.cssVariables&&(this.backgroundColor=e.cssVariables["--sjs-header-backcolor"],this.titleColor=e.cssVariables["--sjs-font-headertitle-color"],this.descriptionColor=e.cssVariables["--sjs-font-headerdescription-color"]),this.init()}init(){this.renderBackgroundImage=e0(this.backgroundImage),this.updateHeaderClasses(),this.updateContentClasses(),this.updateBackgroundImageClasses()}constructor(){super(),this.cells=[],["top","middle","bottom"].forEach(e=>["left","center","right"].forEach(t=>this.cells.push(new sB(this,t,e)))),this.init()}getType(){return"cover"}get renderedHeight(){return(!this.survey||this.survey.isMobile)&&this.survey?this.survey&&this.survey.isMobile&&this.mobileHeight?this.mobileHeight+"px":void 0:this.height?this.height+"px":void 0}get renderedTextAreaWidth(){return this.textAreaWidth?this.textAreaWidth+"px":void 0}get isEmpty(){return!this.survey.hasLogo&&!this.survey.hasTitle&&!this.survey.renderedHasDescription}get survey(){return this._survey}set survey(e){this._survey!==e&&(this._survey=e,e&&(this.updateContentClasses(),this._survey.onPropertyChanged.add((e,t)=>{("widthMode"==t.name||"width"==t.name)&&this.updateContentClasses()})))}get backgroundImageStyle(){return this.backgroundImage?{opacity:this.backgroundImageOpacity,backgroundImage:this.renderBackgroundImage,backgroundSize:this.calcBackgroundSize(this.backgroundImageFit)}:null}propertyValueChanged(e,t,s,i,r){super.propertyValueChanged(e,t,s),("height"===e||"backgroundColor"===e||"backgroundImage"===e||"overlapEnabled"===e)&&this.updateHeaderClasses(),"inheritWidthFrom"===e&&this.updateContentClasses(),"backgroundImageFit"===e&&this.updateBackgroundImageClasses()}getContentMaxWidth(e){if(e.isEmpty||e.showLogo)return;let t=this.cells.indexOf(e),s=Math.floor(t/3),i=t%3;if(1==i){if(!this.cells[3*s].isEmpty||!this.cells[3*s+2].isEmpty)return"100%"}else if(0==i){let e=0,t=i+1;for(;t<3&&this.cells[3*s+t].isEmpty;)this.cells[3*s+t].isEmpty&&e++,t++;return 100*(e+1)+"%"}else if(2==i){let e=0,t=i-1;for(;t>0&&this.cells[3*s+t].isEmpty;)this.cells[3*s+t].isEmpty&&e++,t--;return 100*(e+1)+"%"}}processResponsiveness(){if(this.survey&&this.survey.rootElement&&!this.survey.isMobile){let e=this.survey.rootElement.querySelectorAll(".sv-header__content")[0];if(!e)return;let t=e.getBoundingClientRect().width,s=r.getComputedStyle(e),i=parseFloat(s.paddingLeft)||0,n=parseFloat(s.paddingRight)||0,a=parseFloat(s.columnGap)||0;this.width=t-i-n-2*a}}get hasBackground(){return!!this.backgroundImage||"transparent"!==this.backgroundColor}}ey([c()],sQ.prototype,"height",void 0),ey([c()],sQ.prototype,"mobileHeight",void 0),ey([c()],sQ.prototype,"inheritWidthFrom",void 0),ey([c()],sQ.prototype,"textAreaWidth",void 0),ey([c()],sQ.prototype,"textGlowEnabled",void 0),ey([c()],sQ.prototype,"overlapEnabled",void 0),ey([c({defaultValue:"transparent"})],sQ.prototype,"backgroundColor",void 0),ey([c()],sQ.prototype,"titleColor",void 0),ey([c()],sQ.prototype,"descriptionColor",void 0),ey([c({onSet:(e,t)=>{t.renderBackgroundImage=e0(e)}})],sQ.prototype,"backgroundImage",void 0),ey([c()],sQ.prototype,"renderBackgroundImage",void 0),ey([c()],sQ.prototype,"backgroundImageFit",void 0),ey([c()],sQ.prototype,"backgroundImageOpacity",void 0),ey([c()],sQ.prototype,"logoPositionX",void 0),ey([c()],sQ.prototype,"logoPositionY",void 0),ey([c()],sQ.prototype,"titlePositionX",void 0),ey([c()],sQ.prototype,"titlePositionY",void 0),ey([c()],sQ.prototype,"descriptionPositionX",void 0),ey([c()],sQ.prototype,"descriptionPositionY",void 0),ey([c()],sQ.prototype,"logoStyle",void 0),ey([c()],sQ.prototype,"titleStyle",void 0),ey([c()],sQ.prototype,"descriptionStyle",void 0),ey([c()],sQ.prototype,"headerClasses",void 0),ey([c()],sQ.prototype,"contentClasses",void 0),ey([c()],sQ.prototype,"width",void 0),ey([c()],sQ.prototype,"maxWidth",void 0),ey([c()],sQ.prototype,"backgroundImageClasses",void 0),E.addClass("cover",[{name:"height:number",minValue:0,default:0},{name:"mobileHeight:number",minValue:0,default:0},{name:"inheritWidthFrom",default:"survey"},{name:"textAreaWidth:number",minValue:0,default:0},{name:"textGlowEnabled:boolean"},{name:"overlapEnabled:boolean"},{name:"backgroundImage:file"},{name:"backgroundImageOpacity:number",minValue:0,maxValue:1,default:1},{name:"backgroundImageFit",default:"cover",choices:["cover","fill","contain"]},{name:"logoPositionX",default:"left"},{name:"logoPositionY",default:"top"},{name:"titlePositionX",default:"left"},{name:"titlePositionY",default:"bottom"},{name:"descriptionPositionX",default:"left"},{name:"descriptionPositionY",default:"bottom"}],function(){return new sQ});class sz{constructor(e){this.type=e,this.timestamp=new Date}}class sH extends eg{constructor(){super(),this.taskList=[],this.onAllTasksCompleted=this.addEvent()}runTask(e,t){let s=new sz(e);return this.taskList.push(s),this.hasActiveTasks=!0,t(()=>this.taskFinished(s)),s}waitAndExecute(e){if(!this.hasActiveTasks){e();return}this.onAllTasksCompleted.add(()=>{e()})}taskFinished(e){let t=this.taskList.indexOf(e);t>-1&&this.taskList.splice(t,1),this.hasActiveTasks&&0==this.taskList.length&&(this.hasActiveTasks=!1,this.onAllTasksCompleted.fire(this,{}))}}ey([c({defaultValue:!1})],sH.prototype,"hasActiveTasks",void 0);class sW extends eg{constructor(e,t){super(),this.effectiveWidth=e,this.questionTitleWidth=t}getType(){return"panellayoutcolumn"}isEmpty(){return!this.width&&!this.questionTitleWidth}}ey([c()],sW.prototype,"width",void 0),ey([c({onSet:(e,t,s)=>{e!==s&&(t.width=e)}})],sW.prototype,"effectiveWidth",void 0),ey([c()],sW.prototype,"questionTitleWidth",void 0),E.addClass("panellayoutcolumn",[{name:"effectiveWidth:number",isSerializable:!1,minValue:0},{name:"width:number",visible:!1},"questionTitleWidth"],e=>new sW);class sU extends eg{static getRowId(){return"pr_"+sU.rowCounter++}get allowRendering(){return!this.panel||!this.panel.survey||!this.panel.survey.isLazyRenderingSuspended}startLazyRendering(e,t=e$){if(!r.isAvailable())return;this._scrollableParent=t(e),this._scrollableParent===r.getDocumentElement()&&(this._scrollableParent=i.getWindow());let s=this._scrollableParent.scrollHeight>this._scrollableParent.clientHeight;this.isNeedRender=!s,s&&(this._updateVisibility=()=>{if(this.allowRendering){var t=function(e,t=0){if(void 0===tp.environment)return!1;let{root:s}=tp.environment,r=eY(s)?s.host.clientHeight:s.documentElement.clientHeight,n=e.getBoundingClientRect(),a=Math.max(r,i.getInnerHeight()),o=n.top;return Math.max(-t,o)<=Math.min(a+t,n.bottom)}(e,50);!this.isNeedRender&&t&&(this.isNeedRender=!0,this.stopLazyRendering())}},setTimeout(()=>{this._scrollableParent&&this._scrollableParent.addEventListener&&this._scrollableParent.addEventListener("scroll",this._updateVisibility),this.ensureVisibility()},10))}ensureVisibility(){this._updateVisibility&&this._updateVisibility()}stopLazyRendering(){this._scrollableParent&&this._updateVisibility&&this._scrollableParent.removeEventListener&&this._scrollableParent.removeEventListener("scroll",this._updateVisibility),this._scrollableParent=void 0,this._updateVisibility=void 0}constructor(e){super(),this.panel=e,this._scrollableParent=void 0,this._updateVisibility=void 0,this.visibleElementsAnimation=new eQ(this.getVisibleElementsAnimationOptions(),e=>{this.setWidth(e),this.setPropertyValue("visibleElements",e)},()=>this.visibleElements),this.idValue=sU.getRowId(),this.visible=e.areInvisibleElementsShowing,this.createNewArray("elements"),this.createNewArray("visibleElements")}setIsLazyRendering(e){this.isLazyRenderingValue=e,this.isNeedRender=!e}isLazyRendering(){return!0===this.isLazyRenderingValue}get id(){return this.idValue}equalsCore(e){return this==e}get elements(){return this.getPropertyValue("elements")}getIsAnimationAllowed(){var e;return super.getIsAnimationAllowed()&&this.visible&&(null===(e=this.panel)||void 0===e?void 0:e.animationAllowed)}getVisibleElementsAnimationOptions(){let e=e=>{td(e),tu(e,{width:tn(e)+"px"})};return{getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed,allowSyncRemovalAddition:!1,getAnimatedElement:e=>e.getWrapperElement(),getLeaveOptions:t=>({cssClass:(t.isPanel?t.cssClasses.panel:t.cssClasses).leave,onBeforeRunAnimation:e,onAfterRunAnimation:tc}),getEnterOptions:t=>({cssClass:(t.isPanel?t.cssClasses.panel:t.cssClasses).enter,onBeforeRunAnimation:e,onAfterRunAnimation:tc})}}set visibleElements(e){if(e.length)this.visible=!0;else{this.visible=!1,this.visibleElementsAnimation.cancel();return}this.visibleElementsAnimation.sync(e)}get visibleElements(){return this.getPropertyValue("visibleElements")}get visible(){return this.getPropertyValue("visible",!0)}set visible(e){this.setPropertyValue("visible",e),this.onVisibleChangedCallback&&this.onVisibleChangedCallback()}get isNeedRender(){return this.getPropertyValue("isneedrender",!0)}set isNeedRender(e){this.setPropertyValue("isneedrender",e)}updateVisible(){for(var e=[],t=0;t<this.elements.length;t++)this.elements[t].isVisible&&e.push(this.elements[t]),(this.elements[t].isPanel||"paneldynamic"===this.elements[t].getType())&&(this.setIsLazyRendering(!1),this.stopLazyRendering());this.visibleElements=e}addElement(e){this.elements.push(e),this.updateVisible()}get index(){return this.panel.rows.indexOf(this)}setWidth(e){var t,s=e.length;if(0==s)return;let i=1===e.length;for(var r=0,n=[],a=0;a<this.elements.length;a++){var o=this.elements[a];if(o.isVisible){o.isSingleInRow=i;var l=this.getElementWidth(o);l&&(o.renderWidth=this.getRenderedWidthFromWidth(l),n.push(o)),r<s-1&&!(this.panel.isDefaultV2Theme||(null===(t=this.panel.parentQuestion)||void 0===t?void 0:t.isDefaultV2Theme))?o.rightIndent=1:o.rightIndent=0,r++}else o.renderWidth=""}for(var a=0;a<this.elements.length;a++){var o=this.elements[a];!o.isVisible||n.indexOf(o)>-1||(0==n.length?o.renderWidth=`${Number.parseFloat((100/s).toFixed(6))}%`:o.renderWidth=this.getRenderedCalcWidth(o,n,s))}}getRenderedCalcWidth(e,t,s){for(var i="100%",r=0;r<t.length;r++)i+=" - "+t[r].renderWidth;var n=s-t.length;return n>1&&(i="("+i+")/"+n.toString()),"calc("+i+")"}getElementWidth(e){var t=e.width;return t&&"string"==typeof t?t.trim():""}getRenderedWidthFromWidth(e){return a.isNumber(e)?e+"px":e}dispose(){super.dispose(),this.stopLazyRendering()}getRowCss(){return new eV().append(this.panel.cssClasses.row).append(this.panel.cssClasses.rowCompact,this.panel.isCompact).append(this.panel.cssClasses.pageRow,this.panel.isPage||this.panel.showPanelAsPage).append(this.panel.cssClasses.rowMultiple,this.visibleElements.length>1).toString()}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}}sU.rowCounter=100,ey([c({defaultValue:null})],sU.prototype,"dragTypeOverMe",void 0);class sj extends eW{static getPanelId(){return"sp_"+sj.panelCounter++}get gridLayoutColumns(){let e=this.getPropertyValue("gridLayoutColumns");return this._columns||(this.generateColumns([].concat(e)),e=this._columns,this.gridLayoutColumns=e),e}set gridLayoutColumns(e){this.setPropertyValue("gridLayoutColumns",e)}onAddRow(e){this.onRowVisibleChanged(),e.onVisibleChangedCallback=()=>this.onRowVisibleChanged()}getRowsAnimationOptions(){return{getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed,getAnimatedElement:e=>e.getRootElement(),getLeaveOptions:(e,t)=>({cssClass:this.cssClasses.rowLeave,onBeforeRunAnimation:td,onAfterRunAnimation:tc}),getEnterOptions:(e,t)=>{let s=this.cssClasses;return{cssClass:new eV().append(s.rowEnter).append(s.rowDelayedEnter,t.isDeletingRunning).toString(),onBeforeRunAnimation:td,onAfterRunAnimation:tc}}}}get visibleRows(){return this.getPropertyValue("visibleRows")}set visibleRows(e){this.rowsAnimation.sync(e)}onRemoveRow(e){e.visibleElementsAnimation.cancel(),this.visibleRows=this.rows.filter(e=>e.visible),e.onVisibleChangedCallback=void 0}onRowVisibleChanged(){this.visibleRows=this.rows.filter(e=>e.visible)}constructor(e=""){super(e),this.isQuestionsReady=!1,this.questionsValue=[],this._columns=void 0,this._columnsReady=!1,this.rowsAnimation=new eQ(this.getRowsAnimationOptions(),e=>{this.setPropertyValue("visibleRows",e)},()=>this.visibleRows),this.isRandomizing=!1,this.onColumnPropertyValueChangedCallback=(e,t,s,i,r)=>{this._columnsReady&&(this.updateColumnWidth(this.gridLayoutColumns),this.updateRootStyle())},this.locCountRowUpdates=0,this.createNewArray("rows",(e,t)=>{this.onAddRow(e)},e=>{this.onRemoveRow(e)}),this.createNewArray("visibleRows"),this.createNewArray("gridLayoutColumns",e=>{e.onPropertyValueChangedCallback=this.onColumnPropertyValueChangedCallback}),this.elementsValue=this.createNewArray("elements",this.onAddElement.bind(this),this.onRemoveElement.bind(this)),this.setPropertyValueDirectly("id",sj.getPanelId()),this.addExpressionProperty("visibleIf",(e,t)=>{this.visible=!0===t},e=>!this.areInvisibleElementsShowing),this.addExpressionProperty("enableIf",(e,t)=>{this.readOnly=!1===t}),this.addExpressionProperty("requiredIf",(e,t)=>{this.isRequired=!0===t}),this.createLocalizableString("requiredErrorText",this),this.createLocalizableString("navigationTitle",this,!0).onGetTextCallback=e=>e||this.title||this.name,this.registerPropertyChangedHandlers(["questionTitleLocation"],()=>{this.onVisibleChanged.bind(this),this.updateElementCss(!0)}),this.registerPropertyChangedHandlers(["questionStartIndex","showQuestionNumbers"],()=>{this.updateVisibleIndexes()}),this.registerPropertyChangedHandlers(["title"],()=>{this.resetHasTextInTitle()})}getType(){return"panelbase"}setSurveyImpl(e,t){this.blockAnimations(),super.setSurveyImpl(e,t),this.isDesignMode&&this.onVisibleChanged();for(var s=0;s<this.elements.length;s++)this.elements[s].setSurveyImpl(e,t);this.releaseAnimations()}endLoadingFromJson(){super.endLoadingFromJson(),this.markQuestionListDirty(),this.onRowsChanged()}get hasTextInTitle(){return this.getPropertyValue("hasTextInTitle",void 0,()=>!!this.title)}resetHasTextInTitle(){this.resetPropertyValue("hasTextInTitle")}get hasTitle(){return this.canShowTitle(this.survey)&&(this.hasTextInTitle||this.locTitle.textOrHtml.length>0)||this.isDesignMode&&!this.isPanel&&this.showTitle&&tp.designMode.showEmptyTitles}delete(e=!0){this.deletePanel(),this.removeFromParent(),e&&this.dispose()}deletePanel(){let e=this.elements;for(let t=0;t<e.length;t++){let s=e[t];s.isPanel&&s.deletePanel(),this.onRemoveElementNotifySurvey(s)}}removeFromParent(){}canShowTitle(e){return!0}get _showDescription(){return(!!this.hasTitle||!this.isDesignMode)&&(this.survey&&this.survey.showPageTitles&&this.hasDescription||this.showDescription&&this.isDesignMode&&tp.designMode.showEmptyDescriptions)}localeChanged(){super.localeChanged();for(var e=0;e<this.elements.length;e++)this.elements[e].localeChanged()}locStrsChanged(){super.locStrsChanged();for(var e=0;e<this.elements.length;e++)this.elements[e].locStrsChanged()}getMarkdownHtml(e,t){return"navigationTitle"===t&&this.locNavigationTitle.isEmpty?this.locTitle.renderedHtml||this.name:super.getMarkdownHtml(e,t)}get locNavigationTitle(){return this.getLocalizableString("navigationTitle")}get renderedNavigationTitle(){return this.locNavigationTitle.renderedHtml}get requiredMark(){return this.survey&&this.isRequired?this.survey.requiredMark:""}get requiredText(){return this.requiredMark}get titlePattern(){return this.survey?this.survey.questionTitlePattern:"numTitleRequire"}get isRequireTextOnStart(){return this.isRequired&&"requireNumTitle"==this.titlePattern}get isRequireTextBeforeTitle(){return this.isRequired&&"numRequireTitle"==this.titlePattern}get isRequireTextAfterTitle(){return this.isRequired&&"numTitleRequire"==this.titlePattern}get requiredErrorText(){return this.getLocalizableStringText("requiredErrorText")}set requiredErrorText(e){this.setLocalizableStringText("requiredErrorText",e)}get locRequiredErrorText(){return this.getLocalizableString("requiredErrorText")}get questionOrder(){return this.getPropertyValue("questionOrder")}set questionOrder(e){this.setPropertyValue("questionOrder",e)}get questionsOrder(){return this.questionOrder}set questionsOrder(e){this.questionOrder=e}canRandomize(e){return e&&"initial"!==this.questionOrder||"random"===this.questionOrder}randomizeElements(e){if(!this.canRandomize(e)||this.isRandomizing)return!1;this.isRandomizing=!0;for(var t=[],s=this.elements,i=0;i<s.length;i++)t.push(s[i]);let r=a.randomizeArray(t);return this.setArrayPropertyDirectly("elements",r,!1),this.updateRows(),this.updateVisibleIndexes(),this.isRandomizing=!1,!0}get areQuestionsRandomized(){return"random"==("default"==this.questionOrder&&this.survey?this.survey.questionOrder:this.questionOrder)}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.setPropertyValue("parent",e)}get depth(){return null==this.parent?0:this.parent.depth+1}get visibleIf(){return this.getPropertyValue("visibleIf","")}set visibleIf(e){this.setPropertyValue("visibleIf",e)}calcCssClasses(e){var t={panel:{},error:{},row:"",rowEnter:"",rowLeave:"",rowDelayedEnter:"",rowMultiple:"",pageRow:"",rowCompact:""};return this.copyCssClasses(t.panel,e.panel),this.copyCssClasses(t.error,e.error),e.pageRow&&(t.pageRow=e.pageRow),e.rowCompact&&(t.rowCompact=e.rowCompact),e.row&&(t.row=e.row),e.rowEnter&&(t.rowEnter=e.rowEnter),e.rowLeave&&(t.rowLeave=e.rowLeave),e.rowDelayedEnter&&(t.rowDelayedEnter=e.rowDelayedEnter),e.rowMultiple&&(t.rowMultiple=e.rowMultiple),this.survey&&this.survey.updatePanelCssClasses(this,t),t}get id(){return this.getPropertyValue("id")}set id(e){this.setPropertyValue("id",e)}get isPanel(){return!1}getPanel(){return this}getLayoutType(){return"row"}isLayoutTypeSupported(e){return"flow"!==e}get questions(){if(!this.isQuestionsReady){this.questionsValue=[];for(var e=0;e<this.elements.length;e++){var t=this.elements[e];if(t.isPanel)for(var s=t.questions,i=0;i<s.length;i++)this.questionsValue.push(s[i]);else this.questionsValue.push(t)}this.isQuestionsReady=!0}return this.questionsValue}getQuestions(e){let t=this.questions;if(!e)return t;let s=[];return t.forEach(e=>{s.push(e),e.getNestedQuestions().forEach(e=>s.push(e))}),s}getValidName(e){return e?e.trim():e}getQuestionByName(e){for(var t=this.questions,s=0;s<t.length;s++)if(t[s].name==e)return t[s];return null}getElementByName(e){for(var t=this.elements,s=0;s<t.length;s++){var i=t[s];if(i.name==e)return i;var r=i.getPanel();if(r){var n=r.getElementByName(e);if(n)return n}}return null}getQuestionByValueName(e){let t=this.getQuestionsByValueName(e);return t.length>0?t[0]:null}getQuestionsByValueName(e){let t=[];for(var s=this.questions,i=0;i<s.length;i++)s[i].getValueName()==e&&t.push(s[i]);return t}getValue(){var e={};return this.collectValues(e,0),a.getUnbindValue(e)}collectValues(e,t){let s=this.elements;0===t&&(s=this.questions);for(var i=0;i<s.length;i++){let a=s[i];if(a.isPanel||a.isPage){let s={};a.collectValues(s,t-1)&&(e[a.name]=s)}else if(!a.isEmpty()){var r=a.getValueName();if(e[r]=a.value,this.data){var n=this.data.getComment(r);n&&(e[r+eg.commentSuffix]=n)}}}return!0}getDisplayValue(e){for(var t={},s=this.questions,i=0;i<s.length;i++){var r=s[i];r.isEmpty()||(t[e?r.title:r.getValueName()]=r.getDisplayValue(e))}return t}getComments(){var e={};if(!this.data)return e;for(var t=this.questions,s=0;s<t.length;s++){var i=t[s],r=this.data.getComment(i.getValueName());r&&(e[i.getValueName()]=r)}return e}clearIncorrectValues(){for(var e=0;e<this.elements.length;e++)this.elements[e].clearIncorrectValues()}clearErrors(){for(var e=0;e<this.elements.length;e++)this.elements[e].clearErrors();this.errors=[]}markQuestionListDirty(){this.isQuestionsReady=!1,this.parent&&this.parent.markQuestionListDirty()}get elements(){return eg.collectDependency(this,"elements"),this.elementsValue}getElementsInDesign(e=!1){return this.elements}containsElement(e){for(var t=0;t<this.elements.length;t++){var s=this.elements[t];if(s==e)return!0;var i=s.getPanel();if(i&&i.containsElement(e))return!0}return!1}get isRequired(){return this.getPropertyValue("isRequired")}set isRequired(e){this.setPropertyValue("isRequired",e)}get requiredIf(){return this.getPropertyValue("requiredIf","")}set requiredIf(e){this.setPropertyValue("requiredIf",e)}searchText(e,t){super.searchText(e,t);for(var s=0;s<this.elements.length;s++)this.elements[s].searchText(e,t)}hasErrors(e=!0,t=!1,s=null){return!this.validate(e,t,s)}validate(e=!0,t=!1,s=null){return!0!==(s=s||{fireCallback:e,focusOnFirstError:t,firstErrorQuestion:null,result:!1}).result&&(s.result=!1),this.hasErrorsCore(s),!s.result}validateContainerOnly(){this.hasErrorsInPanels({fireCallback:!0}),this.parent&&this.parent.validateContainerOnly()}onQuestionValueChanged(e){let t=this.questions.indexOf(e);if(t<0)return;let s=this.questions.length-1,i=t-5>0?t-5:0,r=t+5<s?t+5:s;for(let e=i;e<=r;e++){if(e===t)continue;let s=this.questions[e];s.errors.length>0&&s.validate(!1)&&s.validate(!0)}}hasErrorsInPanels(e){var t=[];this.hasRequiredError(e,t),this.survey&&(this.survey.validatePanel(this,t,e.fireCallback),t.length>0&&(e.result=!0)),e.fireCallback&&(this.errors=t)}getErrorCustomText(e,t){return this.survey?this.survey.getSurveyErrorCustomText(this,e,t):e}hasRequiredError(e,t){if(this.isRequired){var s=[];if(this.addQuestionsToList(s,!0),0!=s.length){for(var i=0;i<s.length;i++)if(!s[i].isEmpty())return;e.result=!0,t.push(new tf(this.requiredErrorText,this)),e.focusOnFirstError&&!e.firstErrorQuestion&&(e.firstErrorQuestion=s[0])}}}hasErrorsCore(e){let t=this.elements,s=null,i=null;for(var r=0;r<t.length;r++)if((s=t[r]).isVisible){if(s.isPanel)s.hasErrorsCore(e);else{var n=s;n.validate(e.fireCallback,e)||(i||(i=n),e.firstErrorQuestion||(e.firstErrorQuestion=n),e.result=!0)}}this.hasErrorsInPanels(e),this.updateContainsErrors(),i||!(this.errors.length>0)||(i=this.getFirstQuestionToFocus(!1,!0),e.firstErrorQuestion||(e.firstErrorQuestion=i)),e.fireCallback&&i&&(i===e.firstErrorQuestion&&e.focusOnFirstError?i.focus(!0):i.expandAllParents())}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.elements,s=0;s<t.length;s++)if(t[s].containsErrors)return!0;return!1}updateElementVisibility(){for(let e=0;e<this.elements.length;e++)this.elements[e].updateElementVisibility();super.updateElementVisibility()}getFirstQuestionToFocus(e=!1,t=!1){if(!e&&!t&&this.isCollapsed)return null;for(var s=this.elements,i=0;i<s.length;i++){var r=s[i];if(r.isVisible&&(t||!r.isCollapsed)){if(r.isPanel){var n=r.getFirstQuestionToFocus(e,t);if(n)return n}else{let t=r.getFirstQuestionToFocus(e);if(t)return t}}}return null}getFirstVisibleQuestion(){let e=this.questions;for(let t=0;t<e.length;t++)if(e[t].isVisible)return e[t];return null}focusFirstQuestion(){let e=this.getFirstQuestionToFocus();e&&e.focus()}focusFirstErrorQuestion(){var e=this.getFirstQuestionToFocus(!0);e&&e.focus()}addQuestionsToList(e,t=!1,s=!1){this.addElementsToList(e,t,s,!1)}addPanelsIntoList(e,t=!1,s=!1){this.addElementsToList(e,t,s,!0)}addElementsToList(e,t,s,i){(!t||this.visible)&&this.addElementsToListCore(e,this.elements,t,s,i)}addElementsToListCore(e,t,s,i,r){for(var n=0;n<t.length;n++){var a=t[n];(!s||a.visible)&&((r&&a.isPanel||!r&&!a.isPanel)&&e.push(a),a.isPanel?a.addElementsToListCore(e,a.elements,s,i,r):i&&this.addElementsToListCore(e,a.getElementsInDesign(!1),s,i,r))}}calcMaxRowColSpan(){let e=0;return this.rows.forEach(t=>{let s=0,i=!1;t.elements.forEach(e=>{e.width&&(i=!0),s+=e.colSpan||1}),!i&&s>e&&(e=s)}),e}updateColumnWidth(e){let t=0,s=0;if(e.forEach(e=>{e.width?(t+=e.width,e.setPropertyValue("effectiveWidth",e.width)):s++}),s){let i=Math.floor((100-t)/s*100)/100;for(let t=0;t<e.length;t++)e[t].width||e[t].setPropertyValue("effectiveWidth",i)}}updateColumns(){this._columns=void 0,this.updateRootStyle()}updateRootStyle(){var e;super.updateRootStyle(),null===(e=this.elements)||void 0===e||e.forEach(e=>e.updateRootStyle())}updateCustomWidgets(){for(var e=0;e<this.elements.length;e++)this.elements[e].updateCustomWidgets()}get questionTitleLocation(){return this.getPropertyValue("questionTitleLocation")}set questionTitleLocation(e){this.setPropertyValue("questionTitleLocation",e.toLowerCase())}getQuestionTitleLocation(){return this.onGetQuestionTitleLocation?this.onGetQuestionTitleLocation():"default"!=this.questionTitleLocation?this.questionTitleLocation:this.parent?this.parent.getQuestionTitleLocation():this.survey?this.survey.questionTitleLocation:"top"}availableQuestionTitleWidth(){return"left"===this.getQuestionTitleLocation()||this.hasElementWithTitleLocationLeft()}hasElementWithTitleLocationLeft(){return this.elements.some(e=>e instanceof sj?e.hasElementWithTitleLocationLeft():e instanceof tU?"left"===e.getTitleLocation():void 0)}getQuestionTitleWidth(){return this.questionTitleWidth||this.parent&&this.parent.getQuestionTitleWidth()}get columns(){return this._columns||(this.generateColumns(this.gridLayoutColumns),this.gridLayoutColumns=this._columns),this._columns||[]}generateColumns(e){var t;let s=null===(t=this.survey)||void 0===t?void 0:t.gridLayoutEnabled,i=[].concat(e);if(s){let t=this.calcMaxRowColSpan();if(t<=e.length)i=e.slice(0,t);else for(let s=e.length;s<t;s++){let e=new sW;i.push(e)}}this._columns=i;try{this._columnsReady=!1,this.updateColumnWidth(i)}finally{this._columnsReady=!0}}createGridLayoutColumns(){return this.generateColumns([]),this._columns}updateGridColumns(){this.updateColumns(),this.elements.forEach(e=>{e.isPanel&&e.updateGridColumns()})}getColumsForElement(e){let t=this.findRowByElement(e);if(!t||!this.survey||!this.survey.gridLayoutEnabled)return[];let s=t.elements.length-1;for(;s>=0&&t.elements[s].getPropertyValueWithoutDefault("colSpan");)s--;let i=t.elements.indexOf(e),r=0;for(let e=0;e<i;e++)r+=t.elements[e].colSpan;let n=e.getPropertyValueWithoutDefault("colSpan");if(!n&&i===s){let e=0;for(let i=0;i<t.elements.length;i++)i!==s&&(e+=t.elements[i].colSpan);n=this.columns.length-e}let a=this.columns.slice(r,r+(n||1));return e.setPropertyValueDirectly("effectiveColSpan",a.length),a}getStartIndex(){return this.parent?this.parent.getQuestionStartIndex():this.survey?this.survey.questionStartIndex:""}getQuestionStartIndex(){return this.getStartIndex()}getChildrenLayoutType(){return"row"}getProgressInfo(){return eW.getProgressInfoByElements(this.elements,this.isRequired)}get root(){for(var e=this;e.parent;)e=e.parent;return e}childVisibilityChanged(){this.getIsPageVisible(null)!==this.getPropertyValue("isVisible",!0)&&this.onVisibleChanged()}canRenderFirstRows(){return this.isPage}isLazyRenderInRow(e){return!!this.survey&&!!this.survey.isLazyRendering&&(e>=this.survey.lazyRenderFirstBatchSize||!this.canRenderFirstRows())}createRowAndSetLazy(e){let t=this.createRow();return t.setIsLazyRendering(this.isLazyRenderInRow(e)),t}createRow(){return new sU(this)}onSurveyLoad(){this.blockAnimations(),super.onSurveyLoad();for(var e=0;e<this.elements.length;e++)this.elements[e].onSurveyLoad();this.onElementVisibilityChanged(this),this.releaseAnimations()}onFirstRenderingCore(){super.onFirstRenderingCore(),this.onRowsChanged(),this.elements.forEach(e=>e.onFirstRendering())}updateRows(){this.isLoadingFromJson||(this.getElementsForRows().forEach(e=>{e.isPanel&&e.updateRows()}),this.onRowsChanged())}get rows(){return this.getPropertyValue("rows")}ensureRowsVisibility(){this.rows.forEach(e=>{e.ensureVisibility()})}onRowsChanged(){this.isLoadingFromJson||(this.blockAnimations(),this.setArrayPropertyDirectly("rows",this.buildRows()),this.updateColumns(),this.releaseAnimations())}blockRowsUpdates(){this.locCountRowUpdates++}releaseRowsUpdates(){this.locCountRowUpdates--}updateRowsBeforeElementRemoved(e){let t=this.findRowByElement(e),s=this.rows.indexOf(t),i=t.elements.indexOf(e);t.elements.splice(i,1),0==t.elements.length?this.rows.splice(s,1):!t.elements[0].startWithNewLine&&this.rows[s-1]?(t.elements.forEach(e=>this.rows[s-1].addElement(e)),this.rows.splice(s,1)):t.updateVisible()}updateRowsOnElementAdded(e){let t=this.elements.indexOf(e),s=this.elements[t+1],i=e=>{let t=this.createRowAndSetLazy(e);return this.isDesignMode&&t.setIsLazyRendering(!1),this.rows.splice(e,0,t),t},r=(e,t,s,...i)=>{let r=e.elements.splice(t,s,...i);return e.updateVisible(),r};if(!s){0==t||e.startWithNewLine?r(i(this.rows.length),0,0,e):this.rows[this.rows.length-1].addElement(e);return}let n=this.findRowByElement(s);if(!n)return;let a=this.rows.indexOf(n),o=n.elements.indexOf(s);0==o?s.startWithNewLine?e.startWithNewLine||a<1?i(a).addElement(e):this.rows[a-1].addElement(e):r(n,0,0,e):e.startWithNewLine?r(i(a+1),0,0,...[e].concat(r(n,o,n.elements.length))):r(n,o,0,e)}canFireAddRemoveNotifications(e){return!!this.survey&&e.prevSurvey!==this.survey}onAddElement(e,t){let s=this.survey,i=this.canFireAddRemoveNotifications(e);this.surveyImpl&&e.setSurveyImpl(this.surveyImpl),e.parent=this,this.markQuestionListDirty(),this.canBuildRows()&&this.updateRowsOnElementAdded(e),i&&(e.isPanel?s.panelAdded(e,t,this,this.root):s.questionAdded(e,t,this,this.root)),this.addElementCallback&&this.addElementCallback(e),e.registerPropertyChangedHandlers(["visible","isVisible"],()=>{this.onElementVisibilityChanged(e)},this.id),e.registerPropertyChangedHandlers(["startWithNewLine"],()=>{this.onElementStartWithNewLineChanged(e)},this.id),this.onElementVisibilityChanged(this)}onRemoveElement(e){e.parent=null,this.unregisterElementPropertiesChanged(e),this.markQuestionListDirty(),this.updateRowsOnElementRemoved(e),this.isRandomizing||(this.onRemoveElementNotifySurvey(e),this.removeElementCallback&&this.removeElementCallback(e),this.onElementVisibilityChanged(this))}unregisterElementPropertiesChanged(e){e.unregisterPropertyChangedHandlers(["visible","isVisible","startWithNewLine"],this.id)}onRemoveElementNotifySurvey(e){this.canFireAddRemoveNotifications(e)&&(e.isPanel?this.survey.panelRemoved(e):this.survey.questionRemoved(e))}onElementVisibilityChanged(e){this.isLoadingFromJson||this.isRandomizing||(this.updateRowsVisibility(e),this.childVisibilityChanged(),this.parent&&this.parent.onElementVisibilityChanged(this))}onElementStartWithNewLineChanged(e){this.locCountRowUpdates>0||(this.blockAnimations(),this.updateRowsBeforeElementRemoved(e),this.updateRowsOnElementAdded(e),this.releaseAnimations())}updateRowsVisibility(e){for(var t=this.rows,s=0;s<t.length;s++){var i=t[s];if(i.elements.indexOf(e)>-1){i.updateVisible(),i.visible&&!i.isNeedRender&&(i.isNeedRender=!0);break}}}canBuildRows(){return!this.isLoadingFromJson&&"row"==this.getChildrenLayoutType()}buildRows(){if(!this.canBuildRows())return[];let e=[],t=this.getElementsForRows();for(let s=0;s<t.length;s++){let i=t[s],r=0==s||i.startWithNewLine,n=r?this.createRowAndSetLazy(e.length):e[e.length-1];r&&e.push(n),n.addElement(i)}return e.forEach(e=>e.updateVisible()),e}getElementsForRows(){return this.elements}getDragDropInfo(){let e=this.getPage(this.parent);return e?e.getDragDropInfo():void 0}updateRowsOnElementRemoved(e){this.canBuildRows()&&(this.updateRowsRemoveElementFromRow(e,this.findRowByElement(e)),this.updateColumns())}updateRowsRemoveElementFromRow(e,t){if(t&&t.panel){var s=t.elements.indexOf(e);!(s<0)&&(t.elements.splice(s,1),t.elements.length>0?(this.blockRowsUpdates(),t.elements[0].startWithNewLine=!0,this.releaseRowsUpdates(),t.updateVisible()):t.index>=0&&t.panel.rows.splice(t.index,1))}}getAllRows(){let e=[];return this.rows.forEach(t=>{let s=[];t.elements.forEach(e=>{e.isPanel?s.push(...e.getAllRows()):"paneldynamic"==e.getType()&&(this.isDesignMode?s.push(...e.template.getAllRows()):e.panels.forEach(e=>s.push(...e.getAllRows())))}),e.push(t),e.push(...s)}),e}findRowAndIndexByElement(e,t){if(!e)return{row:void 0,index:this.rows.length-1};t=t||this.rows;for(var s=0;s<t.length;s++)if(t[s].elements.indexOf(e)>-1)return{row:t[s],index:s};return{row:null,index:-1}}forceRenderRow(e){e&&!e.isNeedRender&&(e.isNeedRender=!0,e.stopLazyRendering())}forceRenderElement(e,t=()=>{},s=0){let i=this.getAllRows(),{row:r,index:n}=this.findRowAndIndexByElement(e,i);if(n>=0&&n<i.length){let e=[];e.push(r);for(let t=n-1;t>=n-s&&t>=0;t--)e.push(i[t]);this.forceRenderRows(e,t)}}forceRenderRows(e,t=()=>{}){let s;let i=(s=e.length,()=>{--s<=0&&t()});e.forEach(e=>new eU(e.visibleElements,i)),e.forEach(e=>this.forceRenderRow(e))}findRowByElement(e){return this.findRowAndIndexByElement(e).row}elementWidthChanged(e){if(!this.isLoadingFromJson){var t=this.findRowByElement(e);t&&t.updateVisible()}}get processedTitle(){return this.getRenderedTitle(this.locTitle.textOrHtml)}getRenderedTitle(e){return null!=this.textProcessor?this.textProcessor.processText(e,!0):e}get visible(){return this.getPropertyValue("visible",!0)}set visible(e){e===this.visible||(this.setPropertyValue("visible",e),this.setPropertyValue("isVisible",this.isVisible),this.isLoadingFromJson||this.onVisibleChanged())}onHidingContent(){this.questions.forEach(e=>e.onHidingContent())}onVisibleChanged(){if(!this.isRandomizing&&(this.setPropertyValue("isVisible",this.isVisible),this.survey&&"none"!==this.survey.getQuestionClearIfInvisible("default")&&!this.isLoadingFromJson)){let t=this.questions,s=this.isVisible;for(var e=0;e<t.length;e++){let i=t[e];s?i.updateValueWithDefaults():(i.clearValueIfInvisible("onHiddenContainer"),i.onHidingContent())}}}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed&&this.questions.forEach(e=>e.onHidingContent())}get isVisible(){return this.areInvisibleElementsShowing||this.getIsPageVisible(null)}getIsContentVisible(e){if(this.areInvisibleElementsShowing)return!0;for(var t=0;t<this.elements.length;t++)if(this.elements[t]!=e&&this.elements[t].isVisible)return!0;return!1}getIsPageVisible(e){let t=this.getIsContentVisible(e);return this.visible&&t}setVisibleIndex(e){if(!this.isVisible||e<0)return this.resetVisibleIndexes(),0;this.lastVisibleIndex=e;var t=e;e+=this.beforeSetVisibleIndex(e);var s=this.getPanelStartIndex(e),i=s;let r=this.elements;for(var n=0;n<r.length;n++)i+=r[n].setVisibleIndex(i);return this.isContinueNumbering()&&(e+=i-s),e-t}updateVisibleIndexes(){void 0!==this.lastVisibleIndex&&(this.resetVisibleIndexes(),this.setVisibleIndex(this.lastVisibleIndex))}resetVisibleIndexes(){let e=this.elements;for(var t=0;t<e.length;t++)e[t].setVisibleIndex(-1)}beforeSetVisibleIndex(e){return 0}getPanelStartIndex(e){return e}isContinueNumbering(){return!0}get isReadOnly(){var e=!!this.parent&&this.parent.isReadOnly,t=!!this.survey&&this.survey.isDisplayMode;return this.readOnly||e||t}onReadOnlyChanged(){for(var e=0;e<this.elements.length;e++){var t=this.elements[e];t.setPropertyValue("isReadOnly",t.isReadOnly)}super.onReadOnlyChanged()}updateElementCss(e){super.updateElementCss(e);for(let t=0;t<this.elements.length;t++)this.elements[t].updateElementCss(e)}get enableIf(){return this.getPropertyValue("enableIf","")}set enableIf(e){this.setPropertyValue("enableIf",e)}addElement(e,t=-1){return!!this.canAddElement(e)&&(t<0||t>=this.elements.length?this.elements.push(e):this.elements.splice(t,0,e),this.wasRendered&&e.onFirstRendering(),this.updateColumns(),!0)}insertElement(e,t,s="bottom"){if(!t){this.addElement(e);return}this.blockRowsUpdates();let i=this.elements.indexOf(t),r=this.findRowByElement(t);"left"==s||"right"==s?"right"==s?(e.startWithNewLine=!1,i++):0==r.elements.indexOf(t)?(t.startWithNewLine=!1,e.startWithNewLine=!0):e.startWithNewLine=!1:(e.startWithNewLine=!0,i="top"==s?this.elements.indexOf(r.elements[0]):this.elements.indexOf(r.elements[r.elements.length-1])+1),this.releaseRowsUpdates(),this.addElement(e,i)}insertElementAfter(e,t){let s=this.elements.indexOf(t);s>=0&&this.addElement(e,s+1)}insertElementBefore(e,t){let s=this.elements.indexOf(t);s>=0&&this.addElement(e,s)}canAddElement(e){return!!e&&e.isLayoutTypeSupported(this.getChildrenLayoutType())}addQuestion(e,t=-1){return this.addElement(e,t)}addPanel(e,t=-1){return this.addElement(e,t)}addNewQuestion(e,t=null,s=-1){var i=st.Instance.createQuestion(e,t);return this.addQuestion(i,s)?i:null}addNewPanel(e=null){var t=this.createNewPanel(e);return this.addPanel(t)?t:null}indexOf(e){return this.elements.indexOf(e)}createNewPanel(e){var t=E.createClass("panel");return t.name=e,t}removeElement(e){var t=this.elements.indexOf(e);if(t<0){for(var s=0;s<this.elements.length;s++)if(this.elements[s].removeElement(e))return!0;return!1}return this.elements.splice(t,1),this.updateColumns(),!0}removeQuestion(e){this.removeElement(e)}runCondition(e,t){if(!this.isDesignMode&&!this.isLoadingFromJson){for(var s=this.elements.slice(),i=0;i<s.length;i++)s[i].runCondition(e,t);this.runConditionCore(e,t)}}onAnyValueChanged(e,t){for(var s=this.elements,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}checkBindings(e,t){for(var s=this.elements,i=0;i<s.length;i++)s[i].checkBindings(e,t)}dragDropFindRow(e){if(!e||e.isPage)return null;for(var t=this.rows,s=0;s<t.length;s++)if(t[s].elements.indexOf(e)>-1)return t[s];for(var s=0;s<this.elements.length;s++){var i=this.elements[s].getPanel();if(i){var r=i.dragDropFindRow(e);if(r)return r}}return null}needResponsiveWidth(){let e=!1;return this.elements.forEach(t=>{t.needResponsiveWidth()&&(e=!0)}),this.rows.forEach(t=>{t.elements.length>1&&(e=!0)}),e}get hasDescriptionUnderTitle(){return this.hasDescription}get cssHeader(){return this.cssClasses.panel.header}get cssDescription(){return this.cssClasses.panel.description}get questionErrorLocation(){return this.getPropertyValue("questionErrorLocation")}set questionErrorLocation(e){this.setPropertyValue("questionErrorLocation",e)}getQuestionErrorLocation(){return"default"!==this.questionErrorLocation?this.questionErrorLocation:this.parent?this.parent.getQuestionErrorLocation():this.survey?this.survey.questionErrorLocation:"top"}getTitleOwner(){return this}get no(){return""}get cssTitleNumber(){return this.cssClasses.panel.number}get cssRequiredMark(){return this.cssClasses.panel.requiredMark}get cssError(){return this.getCssError(this.cssClasses)}getCssError(e){return new eV().append(e.error.root).toString()}getSerializableColumnsValue(){let e=-1;for(let t=this.gridLayoutColumns.length-1;t>=0;t--)if(!this.gridLayoutColumns[t].isEmpty()){e=t;break}return this.gridLayoutColumns.slice(0,e+1)}afterRender(e){this.afterRenderCore(e)}dispose(){if(super.dispose(),this.rows){for(let e=0;e<this.rows.length;e++)this.rows[e].dispose();this.rows.splice(0,this.rows.length)}this.disposeElements(),this.elements.splice(0,this.elements.length)}disposeElements(){for(let e=0;e<this.elements.length;e++)this.elements[e].dispose()}}sj.panelCounter=100,ey([c({defaultValue:!0})],sj.prototype,"showTitle",void 0),ey([c({defaultValue:!0})],sj.prototype,"showDescription",void 0),ey([c()],sj.prototype,"questionTitleWidth",void 0);class sJ extends sj{constructor(e=""){super(e),this.forcusFirstQuestionOnExpand=!0,this.createNewArray("footerActions"),this.registerPropertyChangedHandlers(["width"],()=>{this.parent&&this.parent.elementWidthChanged(this)}),this.registerPropertyChangedHandlers(["indent","innerIndent","rightIndent"],()=>{this.resetIndents()}),this.registerPropertyChangedHandlers(["colSpan"],()=>{var e;null===(e=this.parent)||void 0===e||e.updateColumns()})}getType(){return"panel"}get contentId(){return this.id+"_content"}getSurvey(e=!1){return e&&this.isPanel?this.parent?this.parent.getSurvey(e):null:super.getSurvey(e)}get isPanel(){return!0}get page(){return this.getPage(this.parent)}set page(e){this.setPage(this.parent,e)}removeFromParent(){this.parent&&this.removeSelfFromList(this.parent.elements)}moveTo(e,t=null){return this.moveToBase(this.parent,e,t)}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}get showNumber(){return this.getPropertyValue("showNumber")}set showNumber(e){this.setPropertyValue("showNumber",e),this.notifySurveyOnVisibilityChanged()}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){this.setPropertyValue("showQuestionNumbers",e),this.notifySurveyOnVisibilityChanged()}get questionStartIndex(){return this.getPropertyValue("questionStartIndex","")}set questionStartIndex(e){this.setPropertyValue("questionStartIndex",e)}getQuestionStartIndex(){return this.questionStartIndex?this.questionStartIndex:super.getQuestionStartIndex()}get no(){return this.getPropertyValue("no",void 0,()=>this.calcNo())}calcNo(){let e=a.getNumberByIndex(this.visibleIndex,this.getStartIndex());return this.survey&&(e=this.survey.getUpdatedPanelNo(this,e)),e||""}notifyStateChanged(e){this.isLoadingFromJson||this.locTitle.strChanged(),super.notifyStateChanged(e)}createLocTitleProperty(){let e=super.createLocTitleProperty();return e.onGetTextCallback=e=>(e||"default"===this.state||(e=this.name),e),e}beforeSetVisibleIndex(e){if(this.isPage)return super.beforeSetVisibleIndex(e);let t=-1;return this.showNumber&&(this.isDesignMode||!this.locTitle.isEmpty||this.hasParentInQuestionIndex())&&(t=e),this.setPropertyValue("visibleIndex",t),this.resetPropertyValue("no"),t<0?0:1}getPanelStartIndex(e){return"off"===this.showQuestionNumbers?-1:"onpanel"===this.showQuestionNumbers?0:e}hasParentInQuestionIndex(){if("onpanel"!==this.showQuestionNumbers)return!1;let e=this.questionStartIndex,t=e.indexOf(".");return t>-1&&t<e.length-1}isContinueNumbering(){return"off"!==this.showQuestionNumbers&&"onpanel"!==this.showQuestionNumbers}notifySurveyOnVisibilityChanged(){null!=this.survey&&!this.isLoadingFromJson&&this.page&&this.survey.panelVisibilityChanged(this,this.isVisible)}getRenderedTitle(e){if(this.isPanel&&!e){if(this.isCollapsed||this.isExpanded)return this.name;if(this.isDesignMode)return"["+this.name+"]"}return super.getRenderedTitle(e)}get innerIndent(){return this.getPropertyValue("innerIndent")}set innerIndent(e){this.setPropertyValue("innerIndent",e)}get startWithNewLine(){return this.getPropertyValue("startWithNewLine")}set startWithNewLine(e){this.setPropertyValue("startWithNewLine",e)}get allowAdaptiveActions(){return this.getPropertyValue("allowAdaptiveActions")}set allowAdaptiveActions(e){this.setPropertyValue("allowAdaptiveActions",e)}get innerPaddingLeft(){return this.getPropertyValue("innerPaddingLeft",void 0,()=>this.getIndentSize(this.innerIndent))}set innerPaddingLeft(e){this.setPropertyValue("innerPaddingLeft",e)}calcPaddingLeft(){return this.getIndentSize(this.indent)}calcPaddingRight(){return this.getIndentSize(this.rightIndent)}resetIndents(){this.resetPropertyValue("innerPaddingLeft"),super.resetIndents()}getIndentSize(e){if(this.survey){if(e<1)return"";var t=this.survey.css;return t&&t.question&&t.question.indent?e*t.question.indent+"px":""}}clearOnDeletingContainer(){this.elements.forEach(e=>{(e instanceof tU||e instanceof sJ)&&e.clearOnDeletingContainer()})}get footerActions(){return this.getPropertyValue("footerActions")}getFooterToolbar(){var e,t;if(!this.footerToolbarValue){var s=this.footerActions;this.hasEditButton&&s.push({id:"cancel-preview",locTitle:this.survey.locEditText,innerCss:this.survey.cssNavigationEdit,component:"sv-nav-btn",action:()=>{this.cancelPreview()}}),s=this.onGetFooterActionsCallback?this.onGetFooterActionsCallback():null===(e=this.survey)||void 0===e?void 0:e.getUpdatedPanelFooterActions(this,s),this.footerToolbarValue=this.createActionContainer(this.allowAdaptiveActions);let i=this.onGetFooterToolbarCssCallback?this.onGetFooterToolbarCssCallback():"";i||(i=null===(t=this.cssClasses.panel)||void 0===t?void 0:t.footer),i&&(this.footerToolbarValue.containerCss=i),this.footerToolbarValue.setItems(s)}return this.footerToolbarValue}get hasEditButton(){return!1}cancelPreview(){this.hasEditButton&&this.survey.cancelPreviewByPage(this)}get cssTitle(){return this.getCssPanelTitle()}getCssPanelTitle(){return this.getCssTitle(this.cssClasses.panel)}getCssTitleExpandableSvg(){return"default"===this.state?null:this.cssClasses.panel.titleExpandableSvg}get showErrorsAbovePanel(){return this.isDefaultV2Theme&&!this.showPanelAsPage}getCssError(e){if(this.isPage)return super.getCssError(e);let t=new eV().append(super.getCssError(e)).append(e.panel.errorsContainer);return t.append("panel-error-root",t.isEmpty()).toString()}onVisibleChanged(){super.onVisibleChanged(),this.notifySurveyOnVisibilityChanged()}needResponsiveWidth(){return!this.startWithNewLine||super.needResponsiveWidth()}focusIn(){this.survey&&this.survey.whenPanelFocusIn(this)}getHasFrameV2(){return super.getHasFrameV2()&&!this.showPanelAsPage}getIsNested(){return super.getIsNested()&&void 0!==this.parent}get showPanelAsPage(){return!1}expand(e=!0){this.forcusFirstQuestionOnExpand=e,super.expand()}onElementExpanded(e){if(this.forcusFirstQuestionOnExpand&&null!=this.survey&&!this.isLoadingFromJson){let t=this.getFirstQuestionToFocus(!1);t&&setTimeout(()=>{!this.isDisposed&&this.survey&&this.survey.scrollElementToTop(t,t,null,t.inputId,!1,{behavior:"smooth"})},15*!e)}}getCssRoot(e){return new eV().append(super.getCssRoot(e)).append(e.container).append(e.asPage,this.showPanelAsPage).append(e.invisible,!this.isDesignMode&&this.areInvisibleElementsShowing&&!this.visible).toString()}getContainerCss(){return this.getCssRoot(this.cssClasses.panel)}afterRenderCore(e){var t;super.afterRenderCore(e),this.isPanel&&(null===(t=this.survey)||void 0===t||t.afterRenderPanel(this,e))}}E.addClass("panelbase",["name",{name:"elements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},{name:"readOnly:boolean",overridingProperty:"enableIf"},"visibleIf:condition","enableIf:condition","requiredIf:condition",{name:"questionTitleWidth",visibleIf:function(e){return!!e&&e.availableQuestionTitleWidth()}},{name:"questionTitleLocation",default:"default",choices:["default","top","bottom","left","hidden"]},{name:"gridLayoutColumns:panellayoutcolumns",className:"panellayoutcolumn",isArray:!0,onSerializeValue:e=>e.getSerializableColumnsValue(),visibleIf:function(e){return!!e&&!!e.survey&&e.survey.gridLayoutEnabled}},{name:"title:text",serializationProperty:"locTitle"},{name:"description:text",serializationProperty:"locDescription"},{name:"questionOrder",alternativeName:"questionsOrder",default:"default",choices:["default","initial","random"]},{name:"questionErrorLocation",default:"default",choices:["default","top","bottom"]}],function(){return new sj}),E.addClass("panel",[{name:"state",default:"default",choices:["default","collapsed","expanded"]},{name:"isRequired:switch",overridingProperty:"requiredIf"},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"startWithNewLine:boolean",default:!0},{name:"width"},{name:"minWidth",defaultFunc:()=>"auto"},{name:"maxWidth",defaultFunc:()=>tp.maxWidth},{name:"colSpan:number",visible:!1,onSerializeValue:e=>e.getPropertyValue("colSpan")},{name:"effectiveColSpan:number",minValue:1,isSerializable:!1,visibleIf:function(e){return!!e.survey&&e.survey.gridLayoutEnabled}},{name:"innerIndent:number",default:0,choices:[0,1,2,3]},{name:"indent:number",default:0,choices:[0,1,2,3],visible:!1},{name:"page",isSerializable:!1,visibleIf:function(e){var t=e?e.survey:null;return!t||!t.pages||t.pages.length>1},choices:function(e){var t=e?e.survey:null;return t?t.pages.map(e=>({value:e.name,text:e.title})):[]}},{name:"showNumber:boolean"},{name:"showQuestionNumbers",default:"default",choices:["default","onpanel","off"]},{name:"questionStartIndex",visibleIf:e=>e.isPanel},{name:"allowAdaptiveActions:boolean",default:!0,visible:!1}],function(){return new sJ},"panelbase"),ss.Instance.registerElement("panel",e=>new sJ(e));class sG extends sJ{constructor(e=""){super(e),this.hasShownValue=!1,this.timeSpent=0,this._isReadyForClean=!0,this.createLocalizableString("navigationDescription",this,!0)}getType(){return"page"}toString(){return this.name}get isPage(){return!this.isPanel}get isPanel(){return!!this.parent}get showPanelAsPage(){return!0}get hasEditButton(){return this.isPanel&&this.survey&&"preview"===this.survey.state&&!!this.parent&&!this.parent.isPanel}getElementsForRows(){var e;if(!this.isStartPage){let t=null===(e=this.survey)||void 0===e?void 0:e.currentSingleQuestion;if(t)return t.page===this?[t]:[]}return super.getElementsForRows()}disposeElements(){this.isPageContainer||super.disposeElements()}onRemoveElement(e){this.isPageContainer?(e.parent=null,this.unregisterElementPropertiesChanged(e)):super.onRemoveElement(e)}getTemplate(){return this.isPanel?"panel":super.getTemplate()}get no(){if(!this.canShowPageNumber()||!this.survey)return"";let e=this.isStartPage?"":this.num+". ";return this.survey.getUpdatedPageNo(this,e)}get cssTitleNumber(){return this.cssClasses.page.number}getCssTitleExpandableSvg(){return null}get cssRequiredMark(){return""}canShowPageNumber(){return this.survey&&this.survey.showPageNumbers}canShowTitle(e){return!e||e.showPageTitles}setTitleValue(e){super.setTitleValue(e),this.navigationLocStrChanged()}get navigationTitle(){return this.getLocalizableStringText("navigationTitle")}set navigationTitle(e){this.setLocalizableStringText("navigationTitle",e)}get navigationDescription(){return this.getLocalizableStringText("navigationDescription")}set navigationDescription(e){this.setLocalizableStringText("navigationDescription",e)}get locNavigationDescription(){return this.getLocalizableString("navigationDescription")}navigationLocStrChanged(){this.locNavigationTitle.isEmpty&&this.locTitle.strChanged(),this.locNavigationTitle.strChanged(),this.locNavigationDescription.strChanged()}getMarkdownHtml(e,t){let s=super.getMarkdownHtml(e,t);return"navigationTitle"===t&&this.canShowPageNumber()&&s?this.num+". "+s:s}get passed(){return this.getPropertyValue("passed",!1)}set passed(e){this.setPropertyValue("passed",e)}removeFromParent(){this.survey&&this.removeSelfFromList(this.survey.pages)}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}set visibleIndex(e){this.setPropertyValue("visibleIndex",e)}canRenderFirstRows(){return!this.isDesignMode||0==this.visibleIndex}get isStartPage(){return this.survey&&this.survey.isPageStarted(this)}get isStarted(){return this.isStartPage}calcCssClasses(e){if(this.isPanel)return super.calcCssClasses(e);let t={page:{},error:{},pageTitle:"",pageDescription:"",row:"",rowMultiple:"",pageRow:"",rowCompact:"",rowEnter:"",rowLeave:"",rowDelayedEnter:"",rowReplace:""};return this.copyCssClasses(t.page,e.page),this.copyCssClasses(t.error,e.error),e.pageTitle&&(t.pageTitle=e.pageTitle),e.pageDescription&&(t.pageDescription=e.pageDescription),e.row&&(t.row=e.row),e.pageRow&&(t.pageRow=e.pageRow),e.rowMultiple&&(t.rowMultiple=e.rowMultiple),e.rowCompact&&(t.rowCompact=e.rowCompact),e.rowEnter&&(t.rowEnter=e.rowEnter),e.rowDelayedEnter&&(t.rowDelayedEnter=e.rowDelayedEnter),e.rowLeave&&(t.rowLeave=e.rowLeave),e.rowReplace&&(t.rowReplace=e.rowReplace),this.survey&&this.survey.updatePageCssClasses(this,t),t}getCssPanelTitle(){return this.isPanel?super.getCssPanelTitle():this.cssClasses.page?new eV().append(this.cssClasses.page.title).toString():""}get cssRoot(){return!this.isPanel&&this.cssClasses.page&&this.survey?new eV().append(this.cssClasses.page.root).append(this.cssClasses.page.emptyHeaderRoot,!this.survey.renderedHasHeader&&!(this.survey.isShowProgressBarOnTop&&!this.survey.isStaring)).toString():""}getCssError(e){return this.isPanel?super.getCssError(e):new eV().append(super.getCssError(e)).append(e.page.errorsContainer).toString()}get navigationButtonsVisibility(){let e=this.showNavigationButtons;return null==e?"inherit":e?"show":"hide"}set navigationButtonsVisibility(e){"string"==typeof e&&(e=e.toLowerCase()),this.showNavigationButtons=e}get showNavigationButtons(){return this.getPropertyValue("showNavigationButtons",void 0)}set showNavigationButtons(e){this.setShowNavigationButtonsProperty(e)}setShowNavigationButtonsProperty(e){!0===e||!1===e?this.setPropertyValue("showNavigationButtons",e):"show"===e?this.setPropertyValue("showNavigationButtons",!0):"hide"===e?this.setPropertyValue("showNavigationButtons",!1):this.setPropertyValue("showNavigationButtons",void 0)}get isActive(){return!!this.survey&&this.survey.currentPage===this}get wasShown(){return this.hasShownValue}get hasShown(){return this.wasShown}setWasShown(e){if(e!=this.hasShownValue&&(this.hasShownValue=e,!this.isDesignMode&&!0===e)){for(var t,s=this.elements,i=0;i<s.length;i++)s[i].isPanel&&s[i].randomizeElements(this.areQuestionsRandomized);if(this.randomizeElements(this.areQuestionsRandomized)){let e=null===(t=this.survey)||void 0===t?void 0:t.currentSingleQuestion;(null==e?void 0:e.page)===this&&(this.survey.currentSingleQuestion=this.getFirstVisibleQuestion())}}}scrollToTop(){this.survey&&this.survey.scrollElementToTop(this,null,this,this.id)}getAllPanels(e=!1,t=!1){var s=[];return this.addPanelsIntoList(s,e,t),s}getPanels(e=!1,t=!1){return this.getAllPanels(e,t)}get timeLimit(){return this.getPropertyValue("timeLimit",0)}set timeLimit(e){this.setPropertyValue("timeLimit",e)}get maxTimeToFinish(){return this.timeLimit}set maxTimeToFinish(e){this.timeLimit=e}getMaxTimeToFinish(){if(0!==this.timeLimit)return this.timeLimit;let e=this.survey?this.survey.timeLimitPerPage:0;return e>0?e:0}onNumChanged(e){}onVisibleChanged(){this.isRandomizing||(super.onVisibleChanged(),null!=this.survey&&this.survey.pageVisibilityChanged(this,this.isVisible))}ensureRowsVisibility(){super.ensureRowsVisibility(),this.getPanels().forEach(e=>e.ensureRowsVisibility())}get isReadyForClean(){return this._isReadyForClean}set isReadyForClean(e){let t=this._isReadyForClean;this._isReadyForClean=e,this._isReadyForClean!==t&&this.isReadyForCleanChangedCallback&&this.isReadyForCleanChangedCallback()}enableOnElementRerenderedEvent(){super.enableOnElementRerenderedEvent(),this.isReadyForClean=!1}disableOnElementRerenderedEvent(){super.disableOnElementRerenderedEvent(),this.isReadyForClean=!0}}ey([c({defaultValue:-1,onSet:(e,t)=>t.onNumChanged(e)})],sG.prototype,"num",void 0),E.addClass("page",[{name:"showNavigationButtons:boolean",defaultFunc:()=>void 0,onSetValue:function(e,t){e&&e.setShowNavigationButtonsProperty(t)},alternativeName:"navigationButtonsVisibility"},{name:"timeLimit:number",alternativeName:"maxTimeToFinish",default:0,minValue:0,visibleIf:e=>!!e.survey&&e.survey.showTimer},{name:"navigationTitle",visibleIf:function(e){return!!e.survey&&("buttons"===e.survey.progressBarType||e.survey.showTOC)},serializationProperty:"locNavigationTitle"},{name:"navigationDescription",visibleIf:function(e){return!!e.survey&&"buttons"===e.survey.progressBarType},serializationProperty:"locNavigationDescription"},{name:"title:text",serializationProperty:"locTitle"},{name:"description:text",serializationProperty:"locDescription"},{name:"state",visible:!1},{name:"isRequired",visible:!1},{name:"startWithNewLine",visible:!1},{name:"width",visible:!1},{name:"minWidth",visible:!1},{name:"maxWidth",visible:!1},{name:"colSpan",visible:!1,isSerializable:!1},{name:"effectiveColSpan:number",visible:!1,isSerializable:!1},{name:"innerIndent",visible:!1},{name:"indent",visible:!1},{name:"page",visible:!1,isSerializable:!1},{name:"showNumber",visible:!1},{name:"showQuestionNumbers",visible:!1},{name:"questionStartIndex",visible:!1},{name:"allowAdaptiveActions",visible:!1},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText",visible:!1}],function(){return new sG},"panel");class sK extends eg{constructor(e){super(),this.survey=e,this.onResize=this.addEvent()}isListElementClickable(e){return!this.survey.onServerValidateQuestions||!!this.survey.onServerValidateQuestions.isEmpty||"onComplete"===this.survey.checkErrorsMode||e<=this.survey.currentPageNo+1}getRootCss(e="center"){let t=this.survey.css.progressButtonsContainerCenter;return this.survey.css.progressButtonsRoot&&(t+=" "+this.survey.css.progressButtonsRoot+" "+this.survey.css.progressButtonsRoot+"--"+(-1!==["footer","contentBottom"].indexOf(e)?"bottom":"top"),t+=" "+this.survey.css.progressButtonsRoot+"--"+(this.showItemTitles?"with-titles":"no-titles")),this.showItemNumbers&&this.survey.css.progressButtonsNumbered&&(t+=" "+this.survey.css.progressButtonsNumbered),this.isFitToSurveyWidth&&(t+=" "+this.survey.css.progressButtonsFitSurveyWidth),t}getListElementCss(e){if(!(e>=this.survey.visiblePages.length))return new eV().append(this.survey.css.progressButtonsListElementPassed,this.survey.visiblePages[e].passed).append(this.survey.css.progressButtonsListElementCurrent,this.survey.currentPageNo===e).append(this.survey.css.progressButtonsListElementNonClickable,!this.isListElementClickable(e)).toString()}getScrollButtonCss(e,t){return new eV().append(this.survey.css.progressButtonsImageButtonLeft,t).append(this.survey.css.progressButtonsImageButtonRight,!t).append(this.survey.css.progressButtonsImageButtonHidden,!e).toString()}clickListElement(e){e instanceof sG||(e=this.survey.visiblePages[e]),this.survey.tryNavigateToPage(e)}isListContainerHasScroller(e){let t=e.querySelector("."+this.survey.css.progressButtonsListContainer);return!!t&&t.scrollWidth>t.offsetWidth}isCanShowItemTitles(e){let t=e.querySelector("ul");if(!t||t.children.length<2)return!0;if(t.clientWidth>t.parentElement.clientWidth)return!1;let s=t.children[0].clientWidth;for(let e=0;e<t.children.length;e++)if(Math.abs(t.children[e].clientWidth-s)>5)return!1;return!0}clearConnectorsWidth(e){let t=e.querySelectorAll(".sd-progress-buttons__connector");for(let e=0;e<t.length;e++)t[e].style.width=""}adjustConnectors(e){let t=e.querySelector("ul");if(!t)return;let s=e.querySelectorAll(".sd-progress-buttons__connector"),i=this.showItemNumbers?36:20,r=(t.clientWidth-i)/(t.children.length-1)-i;for(let e=0;e<s.length;e++)s[e].style.width=r+"px"}get isFitToSurveyWidth(){return"default"===sL.currentType&&"survey"===this.survey.progressBarInheritWidthFrom&&"static"==this.survey.widthMode}get progressWidth(){return this.isFitToSurveyWidth?this.survey.renderedWidth:""}get showItemNumbers(){return"default"===sL.currentType&&this.survey.progressBarShowPageNumbers}get showItemTitles(){return"default"!==sL.currentType||this.survey.progressBarShowPageTitles}getItemNumber(e){let t="";return this.showItemNumbers&&(t+=this.survey.visiblePages.indexOf(e)+1),t}get headerText(){return this.survey.currentPage?this.survey.currentPage.renderedNavigationTitle:""}get footerText(){return this.progressText}get progressText(){return this.getPropertyValue("progressText",void 0,()=>this.survey.getProgressText())}resetProgressText(){this.resetPropertyValue("progressText")}processResponsiveness(e){this.onResize.fire(this,{width:e})}}class sY{constructor(e,t,s){this.model=e,this.element=t,this.viewModel=s,this.criticalProperties=["progressBarType","progressBarShowPageTitles"],this.canShowItemTitles=!0,this.processResponsiveness=(e,t)=>{if(this.viewModel.onUpdateScroller(e.isListContainerHasScroller(this.element)),this.model.clearConnectorsWidth(this.element),!e.showItemTitles){this.model.adjustConnectors(this.element);return}if(e.survey.isMobile){this.prevWidth=t.width,this.canShowItemTitles=!1,this.model.adjustConnectors(this.element),this.viewModel.onResize(this.canShowItemTitles);return}void 0!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{(void 0===this.prevWidth||this.prevWidth<t.width&&!this.canShowItemTitles||this.prevWidth>t.width&&this.canShowItemTitles)&&(this.prevWidth=t.width,this.canShowItemTitles=e.isCanShowItemTitles(this.element),this.viewModel.onResize(this.canShowItemTitles),this.timer=void 0)},10)},this.model.survey.registerFunctionOnPropertiesValueChanged(this.criticalProperties,()=>this.forceUpdate(),"ProgressButtonsResponsivityManager"+this.viewModel.container),this.model.onResize.add(this.processResponsiveness),this.forceUpdate()}forceUpdate(){this.viewModel.onUpdateSettings(),this.processResponsiveness(this.model,{})}dispose(){clearTimeout(this.timer),this.model.onResize.remove(this.processResponsiveness),this.model.survey.unRegisterFunctionOnPropertiesValueChanged(this.criticalProperties,"ProgressButtonsResponsivityManager"+this.viewModel.container),this.element=void 0,this.model=void 0}}function sX(e,t){return(e.pages||[]).map(s=>new eL({id:s.name,locTitle:s.locNavigationTitle,action:()=>{if(r.activeElementBlur(),t&&t(),s.isPage)return e.tryNavigateToPage(s)},visible:new ec(()=>s.isVisible&&!s.isStartPage)}))}class s${constructor(e){this.survey=e,this.icon="icon-navmenu_24x24",this.togglePopup=()=>{this.popupModel.toggleVisibility()},this.listModel=function(e,t){var s=sX(e,t),i=new eS({items:s,searchEnabled:!1,locOwner:e});i.allowSelection=!1;let r=(e,t)=>{i.selectedItem=!!e&&i.actions.filter(t=>t.id===e.name)[0]||t};return r(e.currentPage,s[0]),e.onCurrentPageChanged.add((t,s)=>{r(e.currentPage)}),e.onFocusInQuestion.add((e,t)=>{r(function e(t){if(t.parentQuestion)return e(t.parentQuestion);let s=t.parent;for(;s&&"page"!==s.getType()&&s.parent;)s=s.parent;return s&&"page"===s.getType()?s:null}(t.question))}),e.registerFunctionOnPropertyValueChanged("pages",()=>{i.setItems(sX(e,t))},"toc"),i}(e,()=>{this.popupModel.isVisible=!1}),this.popupModel=new eI("sv-list",{model:this.listModel}),this.popupModel.overlayDisplayMode="plain",this.popupModel.displayMode=new ec(()=>this.isMobile?"overlay":"popup"),s$.StickyPosition&&(e.onAfterRenderSurvey.add((e,t)=>this.initStickyTOCSubscriptions(t.htmlElement)),this.initStickyTOCSubscriptions(e.rootElement))}initStickyTOCSubscriptions(e){s$.StickyPosition&&e&&(e.addEventListener("scroll",t=>{this.updateStickyTOCSize(e)}),this.updateStickyTOCSize(e))}updateStickyTOCSize(e){if(!e)return;let t=e.querySelector("."+s$.RootStyle);if(t&&(t.style.height="",!this.isMobile&&s$.StickyPosition&&e)){let s=e.getBoundingClientRect().height,i="advanced"===this.survey.headerView?".sv-header":".sv_custom_header+div div."+(this.survey.css.title||"sd-title"),r=e.querySelector(i),n=r?r.getBoundingClientRect().height:0,a=e.scrollTop>n?0:n-e.scrollTop;t.style.height=s-a-1+"px"}}get isMobile(){return this.survey.isMobile}get containerCss(){return function(e,t=!1){let s=s$.RootStyle;return t?s+" "+s$.RootStyle+"--mobile":(s+=" "+s$.RootStyle+"--"+(e.tocLocation||"").toLowerCase(),s$.StickyPosition&&(s+=" "+s$.RootStyle+"--sticky"),s)}(this.survey,this.isMobile)}dispose(){this.survey.unRegisterFunctionOnPropertyValueChanged("pages","toc"),this.popupModel.dispose(),this.listModel.dispose()}}s$.RootStyle="sv_progress-toc",s$.StickyPosition=!0;class sZ extends eH{get platformName(){return sZ.platform}get commentSuffix(){return tp.commentSuffix}set commentSuffix(e){tp.commentSuffix=e}get commentPrefix(){return this.commentSuffix}set commentPrefix(e){this.commentSuffix=e}constructor(e=null,t=null){super(),this.valuesHash={},this.variablesHash={},this.onTriggerExecuted=this.addEvent(),this.onCompleting=this.addEvent(),this.onComplete=this.addEvent(),this.onShowingPreview=this.addEvent(),this.onNavigateToUrl=this.addEvent(),this.onStarted=this.addEvent(),this.onPartialSend=this.addEvent(),this.onCurrentPageChanging=this.addEvent(),this.onCurrentPageChanged=this.addEvent(),this.onValueChanging=this.addEvent(),this.onValueChanged=this.addEvent(),this.onVariableChanged=this.addEvent(),this.onQuestionVisibleChanged=this.addEvent(),this.onVisibleChanged=this.onQuestionVisibleChanged,this.onPageVisibleChanged=this.addEvent(),this.onPanelVisibleChanged=this.addEvent(),this.onQuestionCreated=this.addEvent(),this.onQuestionAdded=this.addEvent(),this.onQuestionRemoved=this.addEvent(),this.onPanelAdded=this.addEvent(),this.onPanelRemoved=this.addEvent(),this.onPageAdded=this.addEvent(),this.onValidateQuestion=this.addEvent(),this.onSettingQuestionErrors=this.addEvent(),this.onServerValidateQuestions=this.addEvent(),this.onValidatePanel=this.addEvent(),this.onErrorCustomText=this.addEvent(),this.onValidatePage=this.addEvent(),this.onValidatedErrorsOnCurrentPage=this.onValidatePage,this.onProcessHtml=this.addEvent(),this.onGetQuestionDisplayValue=this.addEvent(),this.onGetQuestionTitle=this.addEvent(),this.onGetTitleTagName=this.addEvent(),this.onGetQuestionNumber=this.addEvent(),this.onGetQuestionNo=this.onGetQuestionNumber,this.onGetPanelNumber=this.addEvent(),this.onGetPageNumber=this.addEvent(),this.onGetProgressText=this.addEvent(),this.onProgressText=this.onGetProgressText,this.onTextMarkdown=this.addEvent(),this.onTextRenderAs=this.addEvent(),this.onSendResult=this.addEvent(),this.onGetResult=this.addEvent(),this.onOpenFileChooser=this.addEvent(),this.onUploadFiles=this.addEvent(),this.onDownloadFile=this.addEvent(),this.onClearFiles=this.addEvent(),this.onChoicesLoaded=this.addEvent(),this.onLoadChoicesFromServer=this.onChoicesLoaded,this.onLoadedSurveyFromService=this.addEvent(),this.onProcessDynamicText=this.addEvent(),this.onProcessTextValue=this.onProcessDynamicText,this.onUpdateQuestionCssClasses=this.addEvent(),this.onUpdatePanelCssClasses=this.addEvent(),this.onUpdatePageCssClasses=this.addEvent(),this.onUpdateChoiceItemCss=this.addEvent(),this.onAfterRenderSurvey=this.addEvent(),this.onAfterRenderHeader=this.addEvent(),this.onAfterRenderPage=this.addEvent(),this.onAfterRenderQuestion=this.addEvent(),this.onAfterRenderQuestionInput=this.addEvent(),this.onAfterRenderPanel=this.addEvent(),this.onFocusInQuestion=this.addEvent(),this.onFocusInPanel=this.addEvent(),this.onShowingChoiceItem=this.addEvent(),this.onChoicesLazyLoad=this.addEvent(),this.onChoicesSearch=this.addEvent(),this.onGetChoiceDisplayValue=this.addEvent(),this.onMatrixRowAdded=this.addEvent(),this.onMatrixRowAdding=this.addEvent(),this.onMatrixBeforeRowAdded=this.onMatrixRowAdding,this.onMatrixRowRemoving=this.addEvent(),this.onMatrixRowRemoved=this.addEvent(),this.onMatrixRenderRemoveButton=this.addEvent(),this.onMatrixAllowRemoveRow=this.onMatrixRenderRemoveButton,this.onMatrixDetailPanelVisibleChanged=this.addEvent(),this.onMatrixCellCreating=this.addEvent(),this.onMatrixCellCreated=this.addEvent(),this.onAfterRenderMatrixCell=this.addEvent(),this.onMatrixAfterCellRender=this.onAfterRenderMatrixCell,this.onMatrixCellValueChanged=this.addEvent(),this.onMatrixCellValueChanging=this.addEvent(),this.onMatrixCellValidate=this.addEvent(),this.onMatrixColumnAdded=this.addEvent(),this.onMultipleTextItemAdded=this.addEvent(),this.onDynamicPanelAdded=this.addEvent(),this.onDynamicPanelRemoved=this.addEvent(),this.onDynamicPanelRemoving=this.addEvent(),this.onTimerTick=this.addEvent(),this.onTimer=this.onTimerTick,this.onTimerPanelInfoText=this.addEvent(),this.onDynamicPanelValueChanged=this.addEvent(),this.onDynamicPanelItemValueChanged=this.onDynamicPanelValueChanged,this.onDynamicPanelValueChanging=this.addEvent(),this.onGetDynamicPanelTabTitle=this.addEvent(),this.onDynamicPanelCurrentIndexChanged=this.addEvent(),this.onCheckAnswerCorrect=this.addEvent(),this.onIsAnswerCorrect=this.onCheckAnswerCorrect,this.onDragDropAllow=this.addEvent(),this.onScrollToTop=this.addEvent(),this.onScrollingElementToTop=this.onScrollToTop,this.onLocaleChangedEvent=this.addEvent(),this.onGetQuestionTitleActions=this.addEvent(),this.onGetPanelTitleActions=this.addEvent(),this.onGetPageTitleActions=this.addEvent(),this.onGetPanelFooterActions=this.addEvent(),this.onGetMatrixRowActions=this.addEvent(),this.onElementContentVisibilityChanged=this.addEvent(),this.onGetExpressionDisplayValue=this.addEvent(),this.onPopupVisibleChanged=this.addEvent(),this.onOpenDropdownMenu=this.addEvent(),this.onElementWrapperComponentName=this.addEvent(),this.onElementWrapperComponentData=this.addEvent(),this.jsonErrors=null,this.cssValue=null,this.showHeaderOnCompletePage="auto",this._isLazyRenderingSuspended=!1,this.hideRequiredErrors=!1,this.cssVariables={},this._isMobile=!1,this._isCompact=!1,this.setValueOnExpressionCounter=0,this._isDesignMode=!1,this.validationAllowSwitchPages=!1,this.validationAllowComplete=!1,this.isNavigationButtonPressed=!1,this.mouseDownPage=null,this.isSmoothScrollEnabled=!1,this.onResize=new ev,this.isCurrentPageRendering=!0,this.isCurrentPageRendered=void 0,this.skeletonHeight=void 0,this.isTriggerIsRunning=!1,this.triggerValues=null,this.triggerKeys=null,this.conditionValues=null,this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter=0,this.conditionUpdateVisibleIndexes=!1,this.conditionNotifyElementsOnAnyValueOrVariableChanged=!1,this.isEndLoadingFromJson=null,this.questionHashes={names:{},namesInsensitive:{},valueNames:{},valueNamesInsensitive:{}},this.setValueFromTriggerCounter=0,this.isMovingPage=!1,this.needRenderIcons=!0,this.skippedPages=[],this.skeletonComponentName="sv-skeleton",this.taskManager=new sH,this.questionErrorComponent="sv-question-error",this.onBeforeRunConstructor();let s=e=>"<h3>"+e+"</h3>";this.createHtmlLocString("completedHtml","completingSurvey",s),this.createHtmlLocString("completedBeforeHtml","completingSurveyBefore",s,"completed-before"),this.createHtmlLocString("loadingHtml","loadingSurvey",s,"loading"),this.createLocalizableString("emptySurveyText",this,!0,"emptySurvey"),this.createLocalizableString("logo",this,!1),this.createLocalizableString("startSurveyText",this,!1,!0),this.createLocalizableString("pagePrevText",this,!1,!0),this.createLocalizableString("pageNextText",this,!1,!0),this.createLocalizableString("completeText",this,!1,!0),this.createLocalizableString("previewText",this,!1,!0),this.createLocalizableString("editText",this,!1,!0),this.createLocalizableString("questionTitleTemplate",this,!0),this.timerModelValue=new s_(this),this.timerModelValue.onTimerTick=e=>{this.doTimer(e)},this.createNewArray("pages",e=>{e.isReadyForCleanChangedCallback&&e.isReadyForCleanChangedCallback(),this.doOnPageAdded(e)},e=>{e.isReadyForClean?this.doOnPageRemoved(e):e.isReadyForCleanChangedCallback=()=>{this.doOnPageRemoved(e),e.isReadyForCleanChangedCallback=void 0}}),this.createNewArray("triggers",e=>{e.setOwner(this)}),this.createNewArray("calculatedValues",e=>{e.setOwner(this)}),this.createNewArray("completedHtmlOnCondition",e=>{e.locOwner=this}),this.createNewArray("navigateToUrlOnCondition",e=>{e.locOwner=this}),this.registerPropertyChangedHandlers(["locale"],()=>{this.onSurveyLocaleChanged()}),this.registerPropertyChangedHandlers(["firstPageIsStartPage"],()=>{this.onFirstPageIsStartedChanged()}),this.registerPropertyChangedHandlers(["readOnly"],()=>{this.onReadOnlyChanged()}),this.registerPropertyChangedHandlers(["progressBarType"],()=>{this.updateProgressText()}),this.registerPropertyChangedHandlers(["questionStartIndex","requiredMark","questionTitlePattern"],()=>{this.resetVisibleIndexes()}),this.registerPropertyChangedHandlers(["isLoading","isCompleted","isCompletedBefore","readOnly","isStartedState","currentPage","isShowingPreview"],()=>{this.updateState()}),this.registerPropertyChangedHandlers(["state","currentPage","showPreviewBeforeComplete"],()=>{this.onStateAndCurrentPageChanged()}),this.registerPropertyChangedHandlers(["logo","logoPosition"],()=>{this.resetHasLogo()}),this.registerPropertyChangedHandlers(["backgroundImage"],()=>{this.resetPropertyValue("renderBackgroundImage")}),this.registerPropertyChangedHandlers(["backgroundImage","backgroundOpacity","backgroundImageFit","fitToContainer","backgroundImageAttachment"],()=>{this.resetPropertyValue("backgroundImageStyle")}),this.registerPropertyChangedHandlers(["showPrevButton","showCompleteButton"],()=>{this.updateButtonsVisibility()}),this.onGetQuestionNumber.onCallbacksChanged=()=>{this.resetVisibleIndexes()},this.onGetPanelNumber.onCallbacksChanged=()=>{this.resetVisibleIndexes()},this.onGetProgressText.onCallbacksChanged=()=>{this.updateProgressText()},this.onTextMarkdown.onCallbacksChanged=()=>{this.locStrsChanged()},this.onProcessHtml.onCallbacksChanged=()=>{this.locStrsChanged()},this.onGetQuestionTitle.onCallbacksChanged=()=>{this.locStrsChanged()},this.onUpdatePageCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onUpdatePanelCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onUpdateQuestionCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onShowingChoiceItem.onCallbacksChanged=()=>{this.rebuildQuestionChoices()},this.locTitle.onStringChanged.add(()=>this.resetPropertyValue("titleIsEmpty")),this.onBeforeCreating(),e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),e&&e.clientId&&(this.clientId=e.clientId),this.fromJSON(e),this.surveyId&&this.loadSurveyFromService(this.surveyId,this.clientId)),this.onCreating(),t&&this.render(t),this.updateCss(),this.setCalculatedWidthModeUpdater(),this.notifier=new sq(this.css.saveData),this.notifier.addAction(this.createTryAgainAction(),"error"),this.onPopupVisibleChanged.add((e,t)=>{t.visible?this.onScrollCallback=()=>{t.popup.hide()}:this.onScrollCallback=void 0}),this.layoutElements.push({id:"timerpanel",template:"survey-timerpanel",component:"sv-timerpanel",data:this.timerModel}),this.layoutElements.push({id:"progress-buttons",component:"sv-progress-buttons",getData:()=>this.progressBar,processResponsiveness:e=>this.progressBar.processResponsiveness&&this.progressBar.processResponsiveness(e)}),this.layoutElements.push({id:"progress-questions",component:"sv-progress-questions",data:this}),this.layoutElements.push({id:"progress-pages",component:"sv-progress-pages",data:this}),this.layoutElements.push({id:"progress-correctquestions",component:"sv-progress-correctquestions",data:this}),this.layoutElements.push({id:"progress-requiredquestions",component:"sv-progress-requiredquestions",data:this}),this.addLayoutElement({id:"toc-navigation",component:"sv-navigation-toc",getData:()=>this.tocModel,processResponsiveness:e=>this.tocModel.updateStickyTOCSize(this.rootElement)}),this.layoutElements.push({id:"buttons-navigation",component:"sv-action-bar",getData:()=>this.navigationBar})}get tocModel(){return this.tocModelValue||(this.tocModelValue=new s$(this)),this.tocModelValue}get sjsVersion(){return this.getPropertyValue("sjsVersion")}set sjsVersion(e){this.setPropertyValue("sjsVersion",e)}processClosedPopup(e,t){throw Error("Method not implemented.")}createTryAgainAction(){return{id:"save-again",title:this.getLocalizationString("saveAgainButton"),action:()=>{this.isCompleted?this.saveDataOnComplete():this.doComplete()}}}createHtmlLocString(e,t,s,i){let r=this.createLocalizableString(e,this,!1,t);r.onGetLocalizationTextCallback=s,i&&(r.onGetTextCallback=e=>this.processHtml(e,i))}getType(){return"survey"}onPropertyValueChanged(e,t,s){"questionsOnPageMode"===e&&this.onQuestionsOnPageModeChanged(t)}get pages(){return this.getPropertyValue("pages")}render(e=null){this.renderCallback&&this.renderCallback()}updateSurvey(e,t){for(var s in e)if("model"!=s&&"children"!=s){if(0==s.indexOf("on")&&this[s]&&this[s].add){let t=e[s],i=function(e,s){t(e,s)};this[s].add(i)}else this[s]=e[s]}e&&e.data&&this.onValueChanged.add((t,s)=>{e.data[s.name]=s.value})}getCss(){return this.css}updateCompletedPageCss(){this.containerCss=this.css.container,this.completedCss=new eV().append(this.css.body).append(this.css.completedPage).toString(),this.completedBeforeCss=new eV().append(this.css.body).append(this.css.completedBeforePage).toString(),this.loadingBodyCss=new eV().append(this.css.body).append(this.css.bodyLoading).toString()}updateCss(){this.rootCss=this.getRootCss(),this.updateNavigationCss(),this.updateCompletedPageCss(),this.updateWrapperFormCss()}get css(){return this.cssValue||(this.cssValue={},this.copyCssClasses(this.cssValue,sL.getCss())),this.cssValue}set css(e){this.setCss(e)}setCss(e,t=!0){t?this.mergeValues(e,this.css):this.cssValue=e,this.updateElementCss(!1)}get cssTitle(){return this.css.title}get cssNavigationComplete(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.complete)}get cssNavigationPreview(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.preview)}get cssNavigationEdit(){return this.getNavigationCss(this.css.navigationButton,this.css.navigation.edit)}get cssNavigationPrev(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.prev)}get cssNavigationStart(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.start)}get cssNavigationNext(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.next)}get cssSurveyNavigationButton(){return new eV().append(this.css.navigationButton).append(this.css.bodyNavigationButton).toString()}get bodyCss(){return new eV().append(this.css.body).append(this.css.bodyWithTimer,this.showTimer&&"running"===this.state).append(this.css.body+"--"+this.calculatedWidthMode).toString()}get bodyContainerCss(){return this.css.bodyContainer}insertAdvancedHeader(e){e.survey=this,this.layoutElements.push({id:"advanced-header",container:"header",component:"sv-header",index:-100,data:e,processResponsiveness:t=>e.processResponsiveness()})}getNavigationCss(e,t){return new eV().append(e).append(t).toString()}get lazyRenderEnabled(){return!0===this.lazyRenderEnabledValue}set lazyRenderEnabled(e){if(this.lazyRenderEnabled===e)return;this.lazyRenderEnabledValue=e;let t=this.currentPage;t&&t.updateRows()}get lazyRendering(){return this.lazyRenderEnabled}set lazyRendering(e){this.lazyRenderEnabled=e}get isLazyRendering(){return this.lazyRenderEnabled||tp.lazyRender.enabled}get lazyRenderFirstBatchSize(){return this.lazyRenderFirstBatchSizeValue||tp.lazyRender.firstBatchSize}set lazyRenderFirstBatchSize(e){this.lazyRenderFirstBatchSizeValue=e}get isLazyRenderingSuspended(){return this._isLazyRenderingSuspended}suspendLazyRendering(){this.isLazyRendering&&(this._isLazyRenderingSuspended=!0)}releaseLazyRendering(){this.isLazyRendering&&(this._isLazyRenderingSuspended=!1)}updateLazyRenderingRowsOnRemovingElements(){if(this.isLazyRendering){var e=this.currentPage;e&&eZ(e.id)}}get triggers(){return this.getPropertyValue("triggers")}set triggers(e){this.setPropertyValue("triggers",e)}get calculatedValues(){return this.getPropertyValue("calculatedValues")}set calculatedValues(e){this.setPropertyValue("calculatedValues",e)}get surveyId(){return this.getPropertyValue("surveyId","")}set surveyId(e){this.setPropertyValue("surveyId",e)}get surveyPostId(){return this.getPropertyValue("surveyPostId","")}set surveyPostId(e){this.setPropertyValue("surveyPostId",e)}get clientId(){return this.getPropertyValue("clientId","")}set clientId(e){this.setPropertyValue("clientId",e)}get cookieName(){return this.getPropertyValue("cookieName","")}set cookieName(e){this.setPropertyValue("cookieName",e)}get partialSendEnabled(){return this.getPropertyValue("partialSendEnabled")}set partialSendEnabled(e){this.setPropertyValue("partialSendEnabled",e)}get sendResultOnPageNext(){return this.partialSendEnabled}set sendResultOnPageNext(e){this.partialSendEnabled=e}get surveyShowDataSaving(){return this.getPropertyValue("surveyShowDataSaving")}set surveyShowDataSaving(e){this.setPropertyValue("surveyShowDataSaving",e)}get autoFocusFirstQuestion(){return this.getPropertyValue("autoFocusFirstQuestion")}set autoFocusFirstQuestion(e){this.setPropertyValue("autoFocusFirstQuestion",e)}get focusFirstQuestionAutomatic(){return this.autoFocusFirstQuestion}set focusFirstQuestionAutomatic(e){this.autoFocusFirstQuestion=e}get autoFocusFirstError(){return this.getPropertyValue("autoFocusFirstError")}set autoFocusFirstError(e){this.setPropertyValue("autoFocusFirstError",e)}get focusOnFirstError(){return this.autoFocusFirstError}set focusOnFirstError(e){this.autoFocusFirstError=e}get showNavigationButtons(){return this.getPropertyValue("showNavigationButtons")}set showNavigationButtons(e){!0===e||!1===e?this.setPropertyValue("showNavigationButtons",e):"none"===e?this.setPropertyValue("showNavigationButtons",!1):["top","bottom","both","topBottom"].indexOf(e)>-1&&(this.setPropertyValue("showNavigationButtons",!0),this.navigationButtonsLocation=e)}get navigationButtonsLocation(){return this.getPropertyValue("navigationButtonsLocation")}set navigationButtonsLocation(e){this.setPropertyValue("navigationButtonsLocation",e)}get showPrevButton(){return this.getPropertyValue("showPrevButton")}set showPrevButton(e){this.setPropertyValue("showPrevButton",e)}get showCompleteButton(){return this.getPropertyValue("showCompleteButton",!0)}set showCompleteButton(e){this.setPropertyValue("showCompleteButton",e)}get showTOC(){return this.getPropertyValue("showTOC")}set showTOC(e){this.setPropertyValue("showTOC",e)}get tocLocation(){return this.getPropertyValue("tocLocation")}set tocLocation(e){this.setPropertyValue("tocLocation",e)}get showTitle(){return this.getPropertyValue("showTitle")}set showTitle(e){this.setPropertyValue("showTitle",e)}get showPageTitles(){return this.getPropertyValue("showPageTitles")}set showPageTitles(e){this.setPropertyValue("showPageTitles",e)}get showCompletePage(){return this.getPropertyValue("showCompletePage")}set showCompletePage(e){this.setPropertyValue("showCompletePage",e)}get showCompletedPage(){return this.showCompletePage}set showCompletedPage(e){this.showCompletePage=e}get navigateToUrl(){return this.getPropertyValue("navigateToUrl")}set navigateToUrl(e){this.setPropertyValue("navigateToUrl",e)}get navigateToUrlOnCondition(){return this.getPropertyValue("navigateToUrlOnCondition")}set navigateToUrlOnCondition(e){this.setPropertyValue("navigateToUrlOnCondition",e)}getNavigateToUrl(){var e=this.getExpressionItemOnRunCondition(this.navigateToUrlOnCondition),t=e?e.url:this.navigateToUrl;return t&&(t=this.processText(t,!1)),t}navigateTo(){var e={url:this.getNavigateToUrl(),allow:!0};this.onNavigateToUrl.fire(this,e),e.url&&e.allow&&function(e){var t;let s=i.getLocation();e&&s&&(s.href=(t=e)&&t.toLocaleLowerCase().indexOf("javascript:")>-1?encodeURIComponent(t):t)}(e.url)}get requiredMark(){return this.getPropertyValue("requiredMark")}set requiredMark(e){this.setPropertyValue("requiredMark",e)}get requiredText(){return this.requiredMark}set requiredText(e){this.requiredMark=e}beforeSettingQuestionErrors(e,t){this.makeRequiredErrorsInvisible(t),this.onSettingQuestionErrors.fire(this,{question:e,errors:t})}makeRequiredErrorsInvisible(e){if(this.hideRequiredErrors)for(var t=0;t<e.length;t++){var s=e[t].getErrorType();("required"==s||"requireoneanswer"==s)&&(e[t].visible=!1)}}get questionStartIndex(){return this.getPropertyValue("questionStartIndex","")}set questionStartIndex(e){this.setPropertyValue("questionStartIndex",e)}get storeOthersAsComment(){return this.getPropertyValue("storeOthersAsComment")}set storeOthersAsComment(e){this.setPropertyValue("storeOthersAsComment",e)}get maxTextLength(){return this.getPropertyValue("maxTextLength")}set maxTextLength(e){this.setPropertyValue("maxTextLength",e)}get maxCommentLength(){return this.getPropertyValue("maxCommentLength")}set maxCommentLength(e){this.setPropertyValue("maxCommentLength",e)}get maxOthersLength(){return this.maxCommentLength}set maxOthersLength(e){this.maxCommentLength=e}get autoAdvanceEnabled(){return this.getPropertyValue("autoAdvanceEnabled")}set autoAdvanceEnabled(e){this.setPropertyValue("autoAdvanceEnabled",e)}get goNextPageAutomatic(){return this.autoAdvanceEnabled}set goNextPageAutomatic(e){this.autoAdvanceEnabled=e}get autoAdvanceAllowComplete(){return this.getPropertyValue("autoAdvanceAllowComplete")}set autoAdvanceAllowComplete(e){this.setPropertyValue("autoAdvanceAllowComplete",e)}get allowCompleteSurveyAutomatic(){return this.autoAdvanceAllowComplete}set allowCompleteSurveyAutomatic(e){this.autoAdvanceAllowComplete=e}get checkErrorsMode(){return this.getPropertyValue("checkErrorsMode")}set checkErrorsMode(e){this.setPropertyValue("checkErrorsMode",e)}get validateVisitedEmptyFields(){return this.getPropertyValue("validateVisitedEmptyFields")}set validateVisitedEmptyFields(e){this.setPropertyValue("validateVisitedEmptyFields",e)}getValidateVisitedEmptyFields(){return this.validateVisitedEmptyFields&&this.isValidateOnValueChange}get autoGrowComment(){return this.getPropertyValue("autoGrowComment")}set autoGrowComment(e){this.setPropertyValue("autoGrowComment",e)}get allowResizeComment(){return this.getPropertyValue("allowResizeComment")}set allowResizeComment(e){this.setPropertyValue("allowResizeComment",e)}get commentAreaRows(){return this.getPropertyValue("commentAreaRows")}set commentAreaRows(e){this.setPropertyValue("commentAreaRows",e)}get textUpdateMode(){return this.getPropertyValue("textUpdateMode")}set textUpdateMode(e){this.setPropertyValue("textUpdateMode",e)}get clearInvisibleValues(){return this.getPropertyValue("clearInvisibleValues")}set clearInvisibleValues(e){!0===e&&(e="onComplete"),!1===e&&(e="none"),this.setPropertyValue("clearInvisibleValues",e)}clearIncorrectValues(e=!1){for(var t=0;t<this.pages.length;t++)this.pages[t].clearIncorrectValues();if(e){var s=this.data,i=!1;for(var r in s)if(!(this.getQuestionByValueName(r)||this.iscorrectValueWithPostPrefix(r,tp.commentSuffix)||this.iscorrectValueWithPostPrefix(r,tp.matrix.totalsSuffix))){var n=this.getCalculatedValueByName(r);n&&n.includeIntoResult||(i=!0,delete s[r])}i&&(this.data=s)}}iscorrectValueWithPostPrefix(e,t){return e.indexOf(t)===e.length-t.length&&!!this.getQuestionByValueName(e.substring(0,e.indexOf(t)))}get keepIncorrectValues(){return this.getPropertyValue("keepIncorrectValues")}set keepIncorrectValues(e){this.setPropertyValue("keepIncorrectValues",e)}get locale(){return this.getPropertyValueWithoutDefault("locale")||h.currentLocale}set locale(e){e!==h.defaultLocale||h.currentLocale||(e=""),this.setPropertyValue("locale",e)}onSurveyLocaleChanged(){this.notifyElementsOnAnyValueOrVariableChanged("locale"),this.localeChanged(),this.onLocaleChangedEvent.fire(this,this.locale)}get localeDir(){return h.localeDirections[this.locale]}getUsedLocales(){var e=[];this.addUsedLocales(e);var t=e.indexOf("default");if(t>-1){var s=h.defaultLocale,i=e.indexOf(s);i>-1&&e.splice(i,1),t=e.indexOf("default"),e[t]=s}return e}localeChanged(){for(var e=0;e<this.pages.length;e++)this.pages[e].localeChanged()}getLocale(){return this.locale}locStrsChanged(){if(!this.isClearingUnsedValues&&(super.locStrsChanged(),this.currentPage)){if(this.isDesignMode)this.pages.forEach(e=>e.locStrsChanged());else{var e=this.activePage;e&&e.locStrsChanged();let s=this.visiblePages;for(var t=0;t<s.length;t++)s[t].navigationLocStrChanged()}this.isStartPageActive||this.updateProgressText(),this.navigationBarValue&&this.navigationBar.locStrsChanged()}}getMarkdownHtml(e,t){return this.getSurveyMarkdownHtml(this,e,t)}getRenderer(e){return this.getRendererForString(this,e)}getRendererContext(e){return this.getRendererContextForString(this,e)}getRendererForString(e,t){let s=this.getBuiltInRendererForString(e,t);s=this.elementWrapperComponentNameCore(s,e,"string",t);let i={element:e,name:t,renderAs:s};return this.onTextRenderAs.fire(this,i),i.renderAs}getRendererContextForString(e,t){return this.elementWrapperDataCore(t,e,"string")}getExpressionDisplayValue(e,t,s){let i={question:e,value:t,displayValue:s};return this.onGetExpressionDisplayValue.fire(this,i),i.displayValue}getBuiltInRendererForString(e,t){if(this.isDesignMode)return ej.editableRenderer}getProcessedText(e){return this.processText(e,!0)}getLocString(e){return this.getLocalizationString(e)}getErrorCustomText(e,t){return this.getSurveyErrorCustomText(this,e,t)}getSurveyErrorCustomText(e,t,s){let i={text:t,name:s.getErrorType(),obj:e,error:s};return this.onErrorCustomText.fire(this,i),i.text}getQuestionDisplayValue(e,t){let s={question:e,displayValue:t};return this.onGetQuestionDisplayValue.fire(this,s),s.displayValue}get emptySurveyText(){return this.getLocalizableStringText("emptySurveyText")}set emptySurveyText(e){this.setLocalizableStringText("emptySurveyText",e)}get logo(){return this.getLocalizableStringText("logo")}set logo(e){this.setLocalizableStringText("logo",e)}get locLogo(){return this.getLocalizableString("logo")}get logoWidth(){return this.getPropertyValue("logoWidth")}set logoWidth(e){this.setPropertyValue("logoWidth",e)}get renderedLogoWidth(){return this.logoWidth?e5(this.logoWidth):void 0}get renderedStyleLogoWidth(){return this.logoWidth?e9(this.logoWidth):void 0}get logoHeight(){return this.getPropertyValue("logoHeight")}set logoHeight(e){this.setPropertyValue("logoHeight",e)}get renderedLogoHeight(){return this.logoHeight?e5(this.logoHeight):void 0}get renderedStyleLogoHeight(){return this.logoHeight?e9(this.logoHeight):void 0}get logoPosition(){return this.getPropertyValue("logoPosition")}set logoPosition(e){this.setPropertyValue("logoPosition",e)}get hasLogo(){return this.getPropertyValue("hasLogo",void 0,()=>!!this.logo&&"none"!==this.logoPosition)}resetHasLogo(){this.resetPropertyValue("hasLogo")}get isLogoBefore(){return!this.isDesignMode&&this.renderedHasLogo&&("left"===this.logoPosition||"top"===this.logoPosition)}get isLogoAfter(){return this.isDesignMode?this.renderedHasLogo:this.renderedHasLogo&&("right"===this.logoPosition||"bottom"===this.logoPosition)}get logoClassNames(){return new eV().append(this.css.logo).append({left:"sv-logo--left",right:"sv-logo--right",top:"sv-logo--top",bottom:"sv-logo--bottom"}[this.logoPosition]).toString()}get titleIsEmpty(){return this.getPropertyValue("titleIsEmpty",void 0,()=>this.locTitle.isEmpty)}get renderedHasTitle(){return this.isDesignMode?this.isPropertyVisible("title"):!this.titleIsEmpty&&this.showTitle}get renderedHasDescription(){return this.isDesignMode?this.isPropertyVisible("description"):!!this.hasDescription}get hasTitle(){return this.renderedHasTitle}get renderedHasLogo(){return this.isDesignMode?this.isPropertyVisible("logo"):this.hasLogo}get renderedHasHeader(){return this.renderedHasTitle||this.renderedHasLogo}get logoFit(){return this.getPropertyValue("logoFit")}set logoFit(e){this.setPropertyValue("logoFit",e)}get themeVariables(){return Object.assign({},this.cssVariables)}setIsMobile(e=!0){this._isMobile!==e&&(this._isMobile=e,this.updateCss(),this.getAllQuestions().forEach(t=>t.setIsMobile(e)))}get isMobile(){return this._isMobile&&!this.isDesignMode}set isCompact(e){e!==this._isCompact&&(this._isCompact=e,this.updateElementCss(),this.triggerResponsiveness(!0))}get isCompact(){return this._isCompact}isLogoImageChoosen(){return this.locLogo.renderedHtml}get titleMaxWidth(){return""}get renderBackgroundImage(){return this.getPropertyValue("renderBackgroundImage",void 0,()=>e0(this.backgroundImage))}get backgroundOpacity(){return this.getPropertyValue("backgroundOpacity")}set backgroundOpacity(e){this.setPropertyValue("backgroundOpacity",e)}get backgroundImageStyle(){return this.getPropertyValue("backgroundImageStyle",void 0,()=>this.calcBackgroundImageStyle())}calcBackgroundImageStyle(){return{opacity:this.backgroundOpacity,backgroundImage:this.renderBackgroundImage,backgroundSize:this.backgroundImageFit,backgroundAttachment:this.fitToContainer?void 0:this.backgroundImageAttachment}}updateWrapperFormCss(){this.wrapperFormCss=new eV().append(this.css.rootWrapper).append(this.css.rootWrapperHasImage,!!this.backgroundImage).append(this.css.rootWrapperFixed,!!this.backgroundImage&&"fixed"===this.backgroundImageAttachment).toString()}get completedHtml(){return this.getLocalizableStringText("completedHtml")}set completedHtml(e){this.setLocalizableStringText("completedHtml",e)}get locCompletedHtml(){return this.getLocalizableString("completedHtml")}get completedHtmlOnCondition(){return this.getPropertyValue("completedHtmlOnCondition")}set completedHtmlOnCondition(e){this.setPropertyValue("completedHtmlOnCondition",e)}runExpression(e,t){let s;if(!e)return null;var i=this.getFilteredValues(),r=this.getFilteredProperties();let n=new eh(e);return n.onRunComplete=e=>{s=e,t&&t(e)},n.run(i,r)||s}get isSettingValueOnExpression(){return this.setValueOnExpressionCounter>0}startSetValueOnExpression(){this.setValueOnExpressionCounter++}finishSetValueOnExpression(){this.setValueOnExpressionCounter--}runCondition(e){if(!e)return!1;var t=this.getFilteredValues(),s=this.getFilteredProperties();return new el(e).run(t,s)}runTriggers(){this.checkTriggers(this.getFilteredValues(),!1)}get renderedCompletedHtml(){var e=this.getExpressionItemOnRunCondition(this.completedHtmlOnCondition);return e?e.html:this.completedHtml}getExpressionItemOnRunCondition(e){if(0==e.length)return null;for(var t=this.getFilteredValues(),s=this.getFilteredProperties(),i=0;i<e.length;i++)if(e[i].runCondition(t,s))return e[i];return null}get completedBeforeHtml(){return this.getLocalizableStringText("completedBeforeHtml")}set completedBeforeHtml(e){this.setLocalizableStringText("completedBeforeHtml",e)}get locCompletedBeforeHtml(){return this.getLocalizableString("completedBeforeHtml")}get loadingHtml(){return this.getLocalizableStringText("loadingHtml")}set loadingHtml(e){this.setLocalizableStringText("loadingHtml",e)}get locLoadingHtml(){return this.getLocalizableString("loadingHtml")}get defaultLoadingHtml(){return"<h3>"+this.getLocalizationString("loadingSurvey")+"</h3>"}get navigationBar(){return this.navigationBarValue||(this.navigationBarValue=this.createNavigationBar(),this.updateNavigationCss()),this.navigationBarValue}addNavigationItem(e){return e.component||(e.component="sv-nav-btn"),e.innerCss||(e.innerCss=this.cssSurveyNavigationButton),this.navigationBar.addAction(e)}get startSurveyText(){return this.getLocalizableStringText("startSurveyText")}set startSurveyText(e){this.setLocalizableStringText("startSurveyText",e)}get locStartSurveyText(){return this.getLocalizableString("startSurveyText")}get pagePrevText(){return this.getLocalizableStringText("pagePrevText")}set pagePrevText(e){this.setLocalizableStringText("pagePrevText",e)}get locPagePrevText(){return this.getLocalizableString("pagePrevText")}get pageNextText(){return this.getLocalizableStringText("pageNextText")}set pageNextText(e){this.setLocalizableStringText("pageNextText",e)}get locPageNextText(){return this.getLocalizableString("pageNextText")}get completeText(){return this.getLocalizableStringText("completeText")}set completeText(e){this.setLocalizableStringText("completeText",e)}get locCompleteText(){return this.getLocalizableString("completeText")}get previewText(){return this.getLocalizableStringText("previewText")}set previewText(e){this.setLocalizableStringText("previewText",e)}get locPreviewText(){return this.getLocalizableString("previewText")}get editText(){return this.getLocalizableStringText("editText")}set editText(e){this.setLocalizableStringText("editText",e)}get locEditText(){return this.getLocalizableString("editText")}getElementTitleTagName(e,t){if(this.onGetTitleTagName.isEmpty)return t;let s={element:e,tagName:t};return this.onGetTitleTagName.fire(this,s),s.tagName}get questionTitlePattern(){return this.getPropertyValue("questionTitlePattern","numTitleRequire")}set questionTitlePattern(e){"numRequireTitle"!==e&&"requireNumTitle"!==e&&"numTitle"!=e&&(e="numTitleRequire"),this.setPropertyValue("questionTitlePattern",e)}getQuestionTitlePatternOptions(){let e=[],t=this.getLocalizationString("questionTitlePatternText"),s=this.questionStartIndex?this.questionStartIndex:"1.";return e.push({value:"numTitleRequire",text:s+" "+t+" "+this.requiredMark}),e.push({value:"numRequireTitle",text:s+" "+this.requiredMark+" "+t}),e.push({value:"numTitle",text:s+" "+t}),e}get questionTitleTemplate(){return this.getLocalizableStringText("questionTitleTemplate")}set questionTitleTemplate(e){this.setLocalizableStringText("questionTitleTemplate",e),this.questionTitlePattern=this.getNewTitlePattern(e),this.questionStartIndex=this.getNewQuestionTitleElement(e,"no",this.questionStartIndex,"1"),this.requiredMark=this.getNewQuestionTitleElement(e,"require",this.requiredMark,"*")}getNewTitlePattern(e){if(e){for(var t=[];e.indexOf("{")>-1;){var s=(e=e.substring(e.indexOf("{")+1)).indexOf("}");if(s<0)break;t.push(e.substring(0,s)),e=e.substring(s+1)}if(t.length>1){if("require"==t[0])return"requireNumTitle";if("require"==t[1]&&3==t.length)return"numRequireTitle";if(0>t.indexOf("require"))return"numTitle"}if(1==t.length&&"title"==t[0])return"numTitle"}return"numTitleRequire"}getNewQuestionTitleElement(e,t,s,i){if(t="{"+t+"}",!e||0>e.indexOf(t))return s;for(var r=e.indexOf(t),n="",a="",o=r-1;o>=0&&"}"!=e[o];o--);for(o<r-1&&(n=e.substring(o+1,r)),r+=t.length,o=r;o<e.length&&"{"!=e[o];o++);for(o>r&&(a=e.substring(r,o)),o=0;o<n.length&&33>n.charCodeAt(o);)o++;for(n=n.substring(o),o=a.length-1;o>=0&&33>a.charCodeAt(o);)o--;return(a=a.substring(0,o+1),n||a)?n+(s||i)+a:s}get locQuestionTitleTemplate(){return this.getLocalizableString("questionTitleTemplate")}getUpdatedQuestionTitle(e,t){if(this.onGetQuestionTitle.isEmpty)return t;let s={question:e,title:t};return this.onGetQuestionTitle.fire(this,s),s.title}getUpdatedQuestionNo(e,t){if(this.onGetQuestionNumber.isEmpty)return t;let s={question:e,number:t,no:t};return this.onGetQuestionNumber.fire(this,s),s.no===t?s.number:s.no}getUpdatedPanelNo(e,t){if(this.onGetPanelNumber.isEmpty)return t;let s={panel:e,number:t};return this.onGetPanelNumber.fire(this,s),s.number}getUpdatedPageNo(e,t){if(this.onGetPageNumber.isEmpty)return t;let s={page:e,number:t};return this.onGetPageNumber.fire(this,s),s.number}get showPageNumbers(){return this.getPropertyValue("showPageNumbers")}set showPageNumbers(e){e!==this.showPageNumbers&&(this.setPropertyValue("showPageNumbers",e),this.updateVisibleIndexes())}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){!0===e&&(e="on"),!1===e&&(e="off"),(e="onpage"===(e=e.toLowerCase())?"onPage":e)!==this.showQuestionNumbers&&(this.setPropertyValue("showQuestionNumbers",e),this.updateVisibleIndexes())}get progressBar(){return this.progressBarValue||(this.progressBarValue=new sK(this)),this.progressBarValue}get showProgressBar(){return this.getPropertyValue("showProgressBar")}set showProgressBar(e){this.setShowProgressBar(e)}setShowProgressBar(e){"off"===e&&(e=!1),!0===e||!1===e?this.setPropertyValue("showProgressBar",e):(this.setPropertyValue("showProgressBar",!0),this.progressBarLocation=e)}get progressBarLocation(){return this.getPropertyValue("progressBarLocation")}set progressBarLocation(e){this.setPropertyValue("progressBarLocation",e.toLowerCase())}get progressBarType(){return this.getPropertyValue("progressBarType")}set progressBarType(e){"correctquestion"===e&&(e="correctQuestion"),"requiredquestion"===e&&(e="requiredQuestion"),this.setPropertyValue("progressBarType",e)}get progressBarComponentName(){let e=this.progressBarType;return!tp.legacyProgressBarView&&"default"===sL.currentType&&s0(e,"pages")&&(e="buttons"),"progress-"+e}get isShowProgressBarOnTop(){return!!this.canShowProgressBar()&&!!this.showProgressBar&&-1!==["auto","aboveheader","belowheader","topbottom","top","both"].indexOf(this.progressBarLocation)}get isShowProgressBarOnBottom(){return!!this.canShowProgressBar()&&!!this.showProgressBar&&("bottom"===this.progressBarLocation||"both"===this.progressBarLocation||"topbottom"===this.progressBarLocation)}getProgressTypeComponent(){return"sv-progress-"+this.progressBarType.toLowerCase()}getProgressCssClasses(e=""){return new eV().append(this.css.progress).append(this.css.progressTop,this.isShowProgressBarOnTop&&(!e||"header"==e)).append(this.css.progressBottom,this.isShowProgressBarOnBottom&&(!e||"footer"==e)).toString()}canShowProgressBar(){return!this.isShowingPreview||!this.showPreviewBeforeComplete||"allQuestions"!=this.previewMode}get processedTitle(){return this.locTitle.renderedHtml}get questionTitleLocation(){return this.getPropertyValue("questionTitleLocation")}set questionTitleLocation(e){this.setPropertyValue("questionTitleLocation",e.toLowerCase()),this.isLoadingFromJson||this.updateElementCss(!0)}updateElementCss(e){this.startPage&&this.startPage.updateElementCss(e);for(var t=this.visiblePages,s=0;s<t.length;s++)t[s].updateElementCss(e);this.updateCss()}get questionErrorLocation(){return this.getPropertyValue("questionErrorLocation")}set questionErrorLocation(e){this.setPropertyValue("questionErrorLocation",e.toLowerCase())}get questionDescriptionLocation(){return this.getPropertyValue("questionDescriptionLocation")}set questionDescriptionLocation(e){this.setPropertyValue("questionDescriptionLocation",e)}get mode(){return this.readOnly?"display":"edit"}set mode(e){(e=e.toLowerCase())!=this.mode&&("edit"==e||"display"==e)&&(this.readOnly="display"==e)}get readOnly(){return this.getPropertyValue("readOnly")}set readOnly(e){this.setPropertyValue("readOnly",e)}onReadOnlyChanged(){for(var e=0;e<this.pages.length;e++){var t=this.pages[e];t.setPropertyValue("isReadOnly",t.isReadOnly)}this.updateButtonsVisibility(),this.updateCss()}get data(){for(var e={},t=this.getValuesKeys(),s=0;s<t.length;s++){var i=t[s],r=this.getDataValueCore(this.valuesHash,i);void 0!==r&&(e[i]=r)}return this.setCalculatedValuesIntoResult(e),e}set data(e){this.valuesHash={},this.setDataCore(e,!e)}mergeData(e){if(!e)return;let t=this.data;this.mergeValues(e,t),this.setDataCore(t)}setDataCore(e,t=!1){if(t&&(this.valuesHash={}),e)for(var s in e){let t="string"==typeof s?s.trim():s;this.setDataValueCore(this.valuesHash,t,e[s])}this.updateAllQuestionsValue(t),this.notifyAllQuestionsOnValueChanged(),this.notifyElementsOnAnyValueOrVariableChanged(""),this.runConditions(),this.updateAllQuestionsValue(t)}get isSurvey(){return!0}getData(e){let t=e||{includePages:!1,includePanels:!1};return t.includePages||t.includePanels?this.getStructuredData(!!t.includePages,t.includePanels?-1:+!!t.includePages):this.data}getStructuredData(e=!0,t=-1){if(0===t)return this.data;let s={};return this.pages.forEach(i=>{if(e){let e={};i.collectValues(e,t-1)&&(s[i.name]=e)}else i.collectValues(s,t)}),s}setStructuredData(e,t=!1){if(!e)return;let s={};for(let t in e)if(this.getQuestionByValueName(t))s[t]=e[t];else{let i=this.getPageByName(t);i||(i=this.getPanelByName(t)),i&&this.collectDataFromPanel(i,s,e[t])}t?this.mergeData(s):this.data=s}collectDataFromPanel(e,t,s){for(let i in s){let r=e.getElementByName(i);r&&(r.isPanel?this.collectDataFromPanel(r,t,s[i]):t[i]=s[i])}}get editingObj(){return this.editingObjValue}set editingObj(e){if(this.editingObj!=e&&(this.unConnectEditingObj(),this.editingObjValue=e,!this.isDisposed)){if(!e)for(var t=this.getAllQuestions(),s=0;s<t.length;s++)t[s].unbindValue();this.editingObj&&(this.setDataCore({}),this.onEditingObjPropertyChanged=(e,t)=>{E.hasOriginalProperty(this.editingObj,t.name)&&("locale"===t.name&&this.setDataCore({}),this.updateOnSetValue(t.name,this.editingObj[t.name],t.oldValue))},this.editingObj.onPropertyChanged.add(this.onEditingObjPropertyChanged))}}unConnectEditingObj(){this.editingObj&&!this.editingObj.isDisposed&&this.editingObj.onPropertyChanged.remove(this.onEditingObjPropertyChanged)}get isEditingSurveyElement(){return!!this.editingObj}setCalculatedValuesIntoResult(e){for(var t=0;t<this.calculatedValues.length;t++){var s=this.calculatedValues[t];s.includeIntoResult&&s.name&&void 0!==this.getVariable(s.name)&&(e[s.name]=this.getVariable(s.name))}}getAllValues(){return this.data}getPlainData(e){e||(e={includeEmpty:!0,includeQuestionTypes:!1,includeValues:!1});let t=[],s=[];if(this.getAllQuestions().forEach(i=>{var r=i.getPlainData(e);r&&(t.push(r),s.push(i.valueName||i.name))}),e.includeValues){let e=this.getValuesKeys();for(var i=0;i<e.length;i++){var r=e[i];if(-1==s.indexOf(r)){var n=this.getDataValueCore(this.valuesHash,r);n&&t.push({name:r,title:r,value:n,displayValue:n,isNode:!1,getString:e=>"object"==typeof e?JSON.stringify(e):e})}}}return t}getFilteredValues(){let e={};for(var t in this.variablesHash)e[t]=this.variablesHash[t];if(this.addCalculatedValuesIntoFilteredValues(e),!this.isDesignMode){let i=this.getValuesKeys();for(var s=0;s<i.length;s++){var t=i[s];e[t]=this.getDataValueCore(this.valuesHash,t)}this.getAllQuestions().forEach(t=>{t.hasFilteredValue&&(e[t.getFilteredName()]=t.getFilteredValue())})}return e}addCalculatedValuesIntoFilteredValues(e){for(var t=this.calculatedValues,s=0;s<t.length;s++)e[t[s].name]=t[s].value}getFilteredProperties(){return{survey:this}}getValuesKeys(){if(!this.editingObj)return Object.keys(this.valuesHash);for(var e=E.getPropertiesByObj(this.editingObj),t=[],s=0;s<e.length;s++)t.push(e[s].name);return t}getDataValueCore(e,t){return this.editingObj?E.getObjPropertyValue(this.editingObj,t):this.getDataFromValueHash(e,t)}setDataValueCore(e,t,s){this.editingObj?E.setObjPropertyValue(this.editingObj,t,s):this.setDataToValueHash(e,t,s)}deleteDataValueCore(e,t){this.editingObj?this.editingObj[t]=null:this.deleteDataFromValueHash(e,t)}getDataFromValueHash(e,t){return this.valueHashGetDataCallback?this.valueHashGetDataCallback(e,t):e[t]}setDataToValueHash(e,t,s){this.valueHashSetDataCallback?this.valueHashSetDataCallback(e,t,s):e[t]=s}deleteDataFromValueHash(e,t){this.valueHashDeleteDataCallback?this.valueHashDeleteDataCallback(e,t):delete e[t]}get comments(){for(var e={},t=this.getValuesKeys(),s=0;s<t.length;s++){var i=t[s];i.indexOf(this.commentSuffix)>0&&(e[i]=this.getDataValueCore(this.valuesHash,i))}return e}get visiblePages(){if(this.isDesignMode)return this.pages;if(this.pageContainerValue&&(this.isShowingPreview||this.isSinglePage))return[this.pageContainerValue];for(var e=[],t=0;t<this.pages.length;t++)this.isPageInVisibleList(this.pages[t])&&e.push(this.pages[t]);return e}isPageInVisibleList(e){return this.isDesignMode||e.isVisible&&!e.isStartPage}get isEmpty(){return 0==this.pages.length}get PageCount(){return this.pageCount}get pageCount(){return this.pages.length}get visiblePageCount(){return this.visiblePages.length}get startPage(){var e=this.firstPageIsStartPage&&this.pages.length>1?this.pages[0]:null;return e&&(e.onFirstRendering(),e.setWasShown(!0)),e}get startedPage(){return this.startPage}get currentPage(){return this.getPropertyValue("currentPage",null)}set currentPage(e){if(!this.isLoadingFromJson){var t=this.getPageByObject(e);if((!e||t)&&(t||!this.isCurrentPageAvailable)){var s=this.visiblePages;if(!(null!=t&&0>s.indexOf(t))&&t!=this.currentPage){var i=this.currentPage;(this.isShowingPreview||this.currentSingleQuestion||this.currentPageChanging(t,i))&&(this.setPropertyValue("currentPage",t),t&&(t.onFirstRendering(),t.updateCustomWidgets(),t.setWasShown(!0)),this.locStrsChanged(),this.isShowingPreview||this.currentPageChanged(t,i))}}}}tryNavigateToPage(e){if(!this.performValidationOnPageChanging(e))return!1;let t=this.visiblePages.indexOf(e)<this.currentPageNo||!this.doServerValidation(!1,!1,e);return t&&(this.currentPage=e),t}performValidationOnPageChanging(e){if(this.isDesignMode)return!1;if(this.canGoTroughValidation())return!0;let t=this.visiblePages.indexOf(e);if(t<0||t>=this.visiblePageCount||t===this.currentPageNo)return!1;if(t<this.currentPageNo||"onComplete"===this.checkErrorsMode||this.validationAllowSwitchPages)return!0;if(!this.validateCurrentPage())return!1;for(let e=this.currentPageNo+1;e<t;e++){let t=this.visiblePages[e];if(!t.validate(!0,!0))return!1;t.passed=!0}return!0}updateCurrentPage(){this.isCurrentPageAvailable||(this.currentPage=this.firstVisiblePage)}get isCurrentPageAvailable(){let e=this.currentPage;return!!e&&this.isPageInVisibleList(e)&&this.isPageExistsInSurvey(e)}isPageExistsInSurvey(e){return this.pages.indexOf(e)>-1||!!this.onContainsPageCallback&&this.onContainsPageCallback(e)}get activePage(){return this.getPropertyValue("activePage")}get isStartPageActive(){return"starting"===this.state}get isShowStartingPage(){return this.isStartPageActive}get matrixDragHandleArea(){return this.getPropertyValue("matrixDragHandleArea","entireItem")}set matrixDragHandleArea(e){this.setPropertyValue("matrixDragHandleArea",e)}get isShowingPage(){return"running"==this.state||"preview"==this.state||this.isStartPageActive}updateActivePage(){let e=this.isStartPageActive?this.startPage:this.currentPage;e!==this.activePage&&this.setPropertyValue("activePage",e)}onStateAndCurrentPageChanged(){this.updateActivePage(),this.updateButtonsVisibility()}getPageByObject(e){if(!e)return null;if(e.getType&&"page"==e.getType())return e;if("string"==typeof e||e instanceof String)return this.getPageByName(String(e));if(!isNaN(e)){var t=Number(e),s=this.visiblePages;return e<0||e>=s.length?null:s[t]}return e}get currentPageNo(){return this.visiblePages.indexOf(this.currentPage)}set currentPageNo(e){var t=this.visiblePages;e<0||e>=t.length||(this.currentPage=t[e])}get questionOrder(){return this.getPropertyValue("questionOrder")}set questionOrder(e){this.setPropertyValue("questionOrder",e)}get questionsOrder(){return this.questionOrder}set questionsOrder(e){this.questionOrder=e}focusFirstQuestion(){if(!this.focusingQuestionInfo){var e=this.activePage;e&&(e.scrollToTop(),e.focusFirstQuestion())}}scrollToTopOnPageChange(e=!0){var t=this.activePage;t&&(e&&t.scrollToTop(),this.isCurrentPageRendering&&this.autoFocusFirstQuestion&&!this.focusingQuestionInfo&&(t.focusFirstQuestion(),this.isCurrentPageRendering=!1))}get state(){return this.getPropertyValue("state","empty")}updateState(){this.setPropertyValue("state",this.calcState())}calcState(){return this.isLoading?"loading":this.isCompleted?"completed":this.isCompletedBefore?"completedbefore":!this.isDesignMode&&this.isEditMode&&this.isStartedState&&this.startPage?"starting":this.isShowingPreview?this.currentPage?"preview":"empty":this.currentPage?"running":"empty"}get isCompleted(){return this.getPropertyValue("isCompleted",!1)}set isCompleted(e){this.setPropertyValue("isCompleted",e)}get isShowingPreview(){return this.getPropertyValue("isShowingPreview",!1)}set isShowingPreview(e){this.isShowingPreview!=e&&(this.setPropertyValue("isShowingPreview",e),this.onShowingPreviewChanged())}get isStartedState(){return this.getPropertyValue("isStartedState",!1)}set isStartedState(e){this.setPropertyValue("isStartedState",e)}get isCompletedBefore(){return this.getPropertyValue("isCompletedBefore",!1)}set isCompletedBefore(e){this.setPropertyValue("isCompletedBefore",e)}get isLoading(){return this.getPropertyValue("isLoading",!1)}set isLoading(e){this.setPropertyValue("isLoading",e)}beginLoading(){this.isLoading=!0}endLoading(){this.isLoading=!1}get completedState(){return this.getPropertyValue("completedState","")}get completedStateText(){return this.getPropertyValue("completedStateText","")}setCompletedState(e,t){this.setPropertyValue("completedState",e),t||("saving"==e&&(t=this.getLocalizationString("savingData")),"error"==e&&(t=this.getLocalizationString("savingDataError")),"success"==e&&(t=this.getLocalizationString("savingDataSuccess"))),this.setPropertyValue("completedStateText",t),"completed"===this.state&&this.showCompletePage&&this.completedState&&this.notify(this.completedStateText,this.completedState,"error"===e)}notify(e,t,s=!1){this.notifier.showActions=s,this.notifier.notify(e,t,s)}clear(e=!0,t=!0){this.isCompleted=!1,this.isCompletedBefore=!1,this.isLoading=!1,this.completedByTriggers=void 0,e&&this.setDataCore(null,!0),this.timerModel.spent=0;for(var s=0;s<this.pages.length;s++)this.pages[s].timeSpent=0,this.pages[s].setWasShown(!1),this.pages[s].passed=!1;if(this.onFirstPageIsStartedChanged(),t&&(this.currentPage=this.firstVisiblePage,this.currentSingleQuestion)){let e=this.getSingleQuestions();this.currentSingleQuestion=e.length>0?e[0]:void 0}e&&this.updateValuesWithDefaults()}mergeValues(e,t){to(e,t)}updateValuesWithDefaults(){if(!this.isDesignMode&&!this.isLoading)for(var e=0;e<this.pages.length;e++)for(var t=this.pages[e].questions,s=0;s<t.length;s++)t[s].updateValueWithDefaults()}updateCustomWidgets(e){e&&e.updateCustomWidgets()}currentPageChanging(e,t,s,i){let r=this.createPageChangeEventOptions(e,t,s,i);return this.currentPageChangingFromOptions(r)}currentPageChangingFromOptions(e){e.allow=!0,e.allowChanging=!0,this.onCurrentPageChanging.fire(this,e);let t=e.allowChanging&&e.allow;return t&&e.newCurrentPage!==e.oldCurrentPage&&(this.isCurrentPageRendering=!0),t}currentPageChanged(e,t){if(this.notifyQuestionsOnHidingContent(t),t&&!t.isDisposed&&!t.passed&&t.validate(!1)&&(t.passed=!0),!0===this.isCurrentPageRendered&&(this.isCurrentPageRendered=!1),!this.currentSingleQuestion){let s=this.createPageChangeEventOptions(e,t);this.onCurrentPageChanged.fire(this,s)}}notifyQuestionsOnHidingContent(e){e&&!e.isDisposed&&e.questions.forEach(e=>e.onHidingContent())}createPageChangeEventOptions(e,t,s,i){let r=e&&t?e.visibleIndex-t.visibleIndex:0,n=r;return 0===n&&i&&s&&(n=e.elements.indexOf(s)-e.elements.indexOf(i)),{oldCurrentQuestion:i,newCurrentQuestion:s,oldCurrentPage:t,newCurrentPage:e,isNextPage:1===r,isPrevPage:-1===r,isGoingForward:n>0,isGoingBackward:n<0,isAfterPreview:!0===this.changeCurrentPageFromPreview}}getProgress(){if(null==this.currentPage)return 0;if("pages"!==this.progressBarType){var e=this.getProgressInfo();return"requiredQuestions"===this.progressBarType?e.requiredQuestionCount>=1?Math.ceil(100*e.requiredAnsweredQuestionCount/e.requiredQuestionCount):100:e.questionCount>=1?Math.ceil(100*e.answeredQuestionCount/e.questionCount):100}let t=this.visiblePages;return Math.ceil(100*t.indexOf(this.currentPage)/t.length)}get isNavigationButtonsShowing(){if(this.isDesignMode)return"none";var e=this.activePage;return e&&"hide"!==e.navigationButtonsVisibility?"show"===e.navigationButtonsVisibility?this.showNavigationButtons?this.navigationButtonsLocation:"bottom":this.showNavigationButtons?this.navigationButtonsLocation:"none":"none"}get isNavigationButtonsShowingOnTop(){return this.getIsNavigationButtonsShowingOn("top")}get isNavigationButtonsShowingOnBottom(){return this.getIsNavigationButtonsShowingOn("bottom")}getIsNavigationButtonsShowingOn(e){var t=this.isNavigationButtonsShowing;return"both"==t||"topBottom"==t||t==e}get isEditMode(){return!this.readOnly}get isDisplayMode(){return this.readOnly&&!this.isDesignMode||"preview"==this.state}get isUpdateValueTextOnTyping(){return"onTyping"==this.textUpdateMode}get isDesignMode(){return this._isDesignMode}setDesignMode(e){!!this._isDesignMode!=!!e&&(this._isDesignMode=!!e,this.onQuestionsOnPageModeChanged("standard"))}get showInvisibleElements(){return this.getPropertyValue("showInvisibleElements",!1)}set showInvisibleElements(e){var t=this.visiblePages;this.setPropertyValue("showInvisibleElements",e),this.isLoadingFromJson||(this.runConditions(),this.updateAllElementsVisibility(t))}updateAllElementsVisibility(e){for(var t=0;t<this.pages.length;t++){var s=this.pages[t];s.updateElementVisibility(),e.indexOf(s)>-1!=s.isVisible&&this.onPageVisibleChanged.fire(this,{page:s,visible:s.isVisible})}}get areInvisibleElementsShowing(){return this.isDesignMode||this.showInvisibleElements}get areEmptyElementsHidden(){return this.isShowingPreview&&this.showPreviewBeforeComplete&&"answeredQuestions"==this.previewMode&&this.isAnyQuestionAnswered}get isAnyQuestionAnswered(){let e=this.getAllQuestions(!0);for(let t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1}get hasCookie(){if(!this.cookieName)return!1;var e=r.getCookie();return e&&e.indexOf(this.cookieName+"=true")>-1}setCookie(){this.cookieName&&r.setCookie(this.cookieName+"=true; expires=Fri, 31 Dec 9999 0:0:0 GMT")}deleteCookie(){this.cookieName&&r.setCookie(this.cookieName+"=;")}get ignoreValidation(){return!this.validationEnabled}set ignoreValidation(e){this.validationEnabled=!e}nextPage(){return this.currentSingleQuestion?this.performNext():!this.isLastPage&&this.doCurrentPageComplete(!1)}performNext(){let e=this.currentSingleQuestion;if(!e)return this.nextPage();if(!e.validate(!0))return!1;let t=this.getSingleQuestions(),s=t.indexOf(e);if(s<0||s===t.length-1)return!1;let i={};return i[e.name]=e.value,this.checkTriggers(i,!1,!1,!0,e.name),this.currentSingleQuestion=t[s+1],!0}performPrevious(){let e=this.currentSingleQuestion;if(!e)return this.prevPage();let t=this.getSingleQuestions(),s=t.indexOf(e);return 0!==s&&(this.currentSingleQuestion=t[s-1],!0)}hasErrorsOnNavigate(e){if(this.canGoTroughValidation())return!1;let t=e&&this.validationAllowComplete||!e&&this.validationAllowSwitchPages,s=s=>{(!s||t)&&this.doCurrentPageCompleteCore(e)};return this.isValidateOnComplete?!!this.isLastPage&&!0!==this.validate(!0,this.autoFocusFirstError,s,!0)&&!t:!0!==this.validateCurrentPage(s)&&!t}canGoTroughValidation(){return!this.isEditMode||!this.validationEnabled}checkForAsyncQuestionValidation(e,t){this.clearAsyncValidationQuesitons();for(var s=0;s<e.length;s++)if(e[s].isRunningValidators){let i=e[s];i.onCompletedAsyncValidators=e=>{this.onCompletedAsyncQuestionValidators(i,t,e)},this.asyncValidationQuesitons.push(e[s])}return this.asyncValidationQuesitons.length>0}clearAsyncValidationQuesitons(){if(this.asyncValidationQuesitons)for(var e=this.asyncValidationQuesitons,t=0;t<e.length;t++)e[t].onCompletedAsyncValidators=null;this.asyncValidationQuesitons=[]}onCompletedAsyncQuestionValidators(e,t,s){if(s){if(this.clearAsyncValidationQuesitons(),t(!0),this.autoFocusFirstError&&e&&e.page&&e.page===this.currentPage){let t=this.currentPage.questions;for(let s=0;s<t.length;s++)if(t[s]!==e&&t[s].errors.length>0)return;e.focus(!0)}return}for(var i=this.asyncValidationQuesitons,r=0;r<i.length;r++)if(i[r].isRunningValidators)return;t(!1)}get isCurrentPageHasErrors(){return this.checkIsCurrentPageHasErrors()}get isCurrentPageValid(){return!this.checkIsCurrentPageHasErrors()}hasCurrentPageErrors(e){return this.hasPageErrors(void 0,e)}validateCurrentPage(e){return this.validatePage(void 0,e)}hasPageErrors(e,t){let s=this.validatePage(e,t);return void 0===s?s:!s}validatePage(e,t){return e||(e=this.activePage),!e||!this.checkIsPageHasErrors(e)&&(!t||!this.checkForAsyncQuestionValidation(e.questions,e=>t(e))||void 0)}hasErrors(e=!0,t=!1,s){let i=this.validate(e,t,s);return void 0===i?i:!i}validate(e=!0,t=!1,s,i){s&&(e=!0);var r=this.visiblePages,n=!0;let a={fireCallback:e,focusOnFirstError:t,firstErrorQuestion:null,result:!1};for(var o=0;o<r.length;o++)r[o].validate(e,t,a)||(n=!1);return(a.firstErrorQuestion&&(t||i)&&(t?a.firstErrorQuestion.focus(!0):this.currentPage=a.firstErrorQuestion.page),n&&s)?!this.checkForAsyncQuestionValidation(this.getAllQuestions(),e=>s(e))||void 0:n}ensureUniqueNames(e=null){if(null==e)for(var t=0;t<this.pages.length;t++)this.ensureUniqueName(this.pages[t]);else this.ensureUniqueName(e)}ensureUniqueName(e){if(e.isPage&&this.ensureUniquePageName(e),e.isPanel&&this.ensureUniquePanelName(e),e.isPage||e.isPanel)for(var t=e.elements,s=0;s<t.length;s++)this.ensureUniqueNames(t[s]);else this.ensureUniqueQuestionName(e)}ensureUniquePageName(e){return this.ensureUniqueElementName(e,e=>this.getPageByName(e))}ensureUniquePanelName(e){return this.ensureUniqueElementName(e,e=>this.getPanelByName(e))}ensureUniqueQuestionName(e){return this.ensureUniqueElementName(e,e=>this.getQuestionByName(e))}ensureUniqueElementName(e,t){var s=t(e.name);if(s&&s!=e){for(var i=this.getNewName(e.name);t(i);)var i=this.getNewName(e.name);e.name=i}}getNewName(e){for(var t=e.length;t>0&&e[t-1]>="0"&&e[t-1]<="9";)t--;var s=e.substring(0,t),i=0;return t<e.length&&(i=parseInt(e.substring(t))),s+ ++i}checkIsCurrentPageHasErrors(e){return this.checkIsPageHasErrors(this.activePage,e)}checkIsPageHasErrors(e,t){if(void 0===t&&(t=this.focusOnFirstError),!e)return!0;let s=!1;return s=this.currentSingleQuestion?!this.currentSingleQuestion.validate(!0):!e.validate(!0,t),this.fireValidatedErrorsOnPage(e),s}fireValidatedErrorsOnPage(e){if(!this.onValidatePage.isEmpty&&e){for(var t=e.questions,s=[],i=[],r=0;r<t.length;r++){var n=t[r];if(n.errors.length>0){s.push(n);for(var a=0;a<n.errors.length;a++)i.push(n.errors[a])}}this.onValidatePage.fire(this,{questions:s,errors:i,page:e})}}prevPage(){if(this.currentSingleQuestion)return this.performPrevious();if(this.isFirstPage||"starting"===this.state)return!1;this.resetNavigationButton();let e=this.skippedPages.find(e=>e.to==this.currentPage);if(e)this.currentPage=e.from,this.skippedPages.splice(this.skippedPages.indexOf(e),1);else{let e=this.visiblePages,t=e.indexOf(this.currentPage);this.currentPage=e[t-1]}return!0}tryComplete(){this.isValidateOnComplete&&this.cancelPreview();let e=this.doCurrentPageComplete(!0);return e&&this.cancelPreview(),e}completeLastPage(){return this.tryComplete()}navigationMouseDown(){return this.isNavigationButtonPressed=!0,!0}resetNavigationButton(){this.isNavigationButtonPressed=!1}nextPageUIClick(){return(!this.mouseDownPage||this.mouseDownPage===this.activePage)&&(this.mouseDownPage=null,this.performNext())}nextPageMouseDown(){return this.mouseDownPage=this.activePage,this.navigationMouseDown()}showPreview(){return this.resetNavigationButton(),!(!this.isValidateOnComplete&&(this.hasErrorsOnNavigate(!0)||this.doServerValidation(!0,!0)))&&(this.showPreviewCore(),this.isShowingPreview)}showPreviewCore(){var e={allowShowPreview:!0,allow:!0};this.onShowingPreview.fire(this,e),this.isShowingPreview=e.allowShowPreview&&e.allow}cancelPreview(e=null){if(!this.isShowingPreview)return;this.gotoPageFromPreview=e,this.isShowingPreview=!1;let t=this.currentSingleQuestion;(null==t?void 0:t.page)&&(t.page.updateRows(),this.currentPage=t.page)}cancelPreviewByPage(e){this.cancelPreview(e)}doCurrentPageComplete(e){return!this.isValidatingOnServer&&(this.resetNavigationButton(),!this.hasErrorsOnNavigate(e)&&this.doCurrentPageCompleteCore(e))}doCurrentPageCompleteCore(e){return!this.doServerValidation(e)&&(e?(this.currentPage.passed=!0,this.doComplete(this.canBeCompletedByTrigger,this.completedTrigger)):(this.doNextPage(),!0))}get isSinglePage(){return"singlePage"==this.questionsOnPageMode}set isSinglePage(e){this.questionsOnPageMode=e?"singlePage":"standard"}get isSingleVisibleQuestion(){return this.isSingleVisibleQuestionVal(this.questionsOnPageMode)}isSingleVisibleQuestionVal(e){return"questionPerPage"===e||"questionOnPage"===e}get questionsOnPageMode(){return this.getPropertyValue("questionsOnPageMode")}set questionsOnPageMode(e){this.setPropertyValue("questionsOnPageMode",e)}get firstPageIsStartPage(){return this.getPropertyValue("firstPageIsStartPage")}set firstPageIsStartPage(e){this.setPropertyValue("firstPageIsStartPage",e)}get firstPageIsStarted(){return this.firstPageIsStartPage}set firstPageIsStarted(e){this.firstPageIsStartPage=e}isPageStarted(e){return this.firstPageIsStartPage&&this.pages.length>1&&this.pages[0]===e}get showPreviewBeforeComplete(){return this.getPropertyValue("showPreviewBeforeComplete")}set showPreviewBeforeComplete(e){this.setShowPreviewBeforeComplete(e)}setShowPreviewBeforeComplete(e){void 0===e||"noPreview"===e||!1===e?this.setPropertyValue("showPreviewBeforeComplete",!1):(this.setPropertyValue("showPreviewBeforeComplete",!0),"showAllQuestions"===e&&(this.previewMode="allQuestions"),"showAnsweredQuestions"===e&&(this.previewMode="answeredQuestions"))}get previewMode(){return this.getPropertyValue("previewMode")}set previewMode(e){this.setPropertyValue("previewMode",e)}onFirstPageIsStartedChanged(){this.isStartedState=this.firstPageIsStartPage&&this.pages.length>1,this.pageVisibilityChanged(this.pages[0],!this.isStartedState)}onShowingPreviewChanged(){this.updatePagesContainer()}createRootPage(e,t){let s=E.createClass("page");return s.name=e,s.isPageContainer=!0,t.forEach(e=>{e.isStartPage||s.addElement(e)}),s}disposeContainerPage(){let e=this.pageContainerValue;[].concat(e.elements).forEach(t=>e.removeElement(t)),e.dispose(),this.pageContainerValue=void 0}updatePagesContainer(){let e;if(this.isDesignMode)return;this.getAllQuestions().forEach(e=>e.updateElementVisibility()),this.setPropertyValue("currentPage",void 0);let t="preview-page";if(this.isSinglePage){let s=this.pageContainerValue;s&&s.name===t?(e=s.elements[0],this.disposeContainerPage()):e=this.createRootPage("single-page",this.pages)}if(this.isShowingPreview&&(e=this.createRootPage(t,e?[e]:this.pages)),e&&(e.setSurveyImpl(this),this.pageContainerValue=e,this.currentPage=e,this.currentSingleQuestionValue&&this.visiblePages.forEach(e=>e.updateRows())),!this.isSinglePage&&!this.isShowingPreview){this.disposeContainerPage();let e=this.gotoPageFromPreview;this.gotoPageFromPreview=null,a.isValueEmpty(e)&&this.visiblePageCount>0&&(e=this.visiblePages[this.visiblePageCount-1]),e&&(this.changeCurrentPageFromPreview=!0,this.currentPage=e,this.changeCurrentPageFromPreview=!1)}!this.currentPage&&this.visiblePageCount>0&&(this.currentPage=this.visiblePages[0]),this.pages.forEach(e=>{e.hasShown&&e.updateElementCss(!0)}),this.updateButtonsVisibility()}getSingleQuestions(){let e=[],t=this.pages;for(var s=0;s<t.length;s++){let i=t[s];!i.isStartPage&&i.isVisible&&i.addQuestionsToList(e,!0)}return e}get currentSingleQuestion(){return this.isShowingPreview?void 0:this.currentSingleQuestionValue}set currentSingleQuestion(e){let t=this.currentSingleQuestion;if(e!==t&&!this.isCompleted){let s=e&&t?this.createPageChangeEventOptions(e.page,t.page,e,t):void 0;if(s&&!this.currentPageChangingFromOptions(s))return;if(this.currentSingleQuestionValue=e,e){let t=e.page;t.updateRows(),t!==this.currentPage?this.currentPage=t:this.autoFocusFirstQuestion&&e.focus(),this.updateButtonsVisibility(),s&&this.onCurrentPageChanged.fire(this,s)}else this.visiblePages.forEach(e=>e.updateRows())}}onQuestionsOnPageModeChanged(e){if(!this.isShowingPreview&&!this.isDesignMode&&(this.currentSingleQuestion=void 0,"singlePage"===e&&this.updatePagesContainer(),this.isSinglePage&&this.updatePagesContainer(),this.isSingleVisibleQuestion)){let e=this.getSingleQuestions();e.length>0&&(this.currentSingleQuestion=e[0])}}getPageStartIndex(){return this.firstPageIsStartPage&&this.pages.length>0?1:0}get isFirstPage(){return this.getPropertyValue("isFirstPage")}get isLastPage(){return this.getPropertyValue("isLastPage")}updateButtonsVisibility(){this.updateIsFirstLastPageState(),this.setPropertyValue("isShowPrevButton",this.calcIsShowPrevButton()),this.setPropertyValue("isShowNextButton",this.calcIsShowNextButton()),this.setPropertyValue("isCompleteButtonVisible",this.calcIsCompleteButtonVisible()),this.setPropertyValue("isPreviewButtonVisible",this.calcIsPreviewButtonVisible()),this.setPropertyValue("isCancelPreviewButtonVisible",this.calcIsCancelPreviewButtonVisible())}get isShowPrevButton(){return this.getPropertyValue("isShowPrevButton")}get isShowNextButton(){return this.getPropertyValue("isShowNextButton")}get isCompleteButtonVisible(){return this.getPropertyValue("isCompleteButtonVisible")}get isPreviewButtonVisible(){return this.getPropertyValue("isPreviewButtonVisible")}get isCancelPreviewButtonVisible(){return this.getPropertyValue("isCancelPreviewButtonVisible")}get isFirstElement(){return this.getPropertyValue("isFirstElement")}get isLastElement(){return this.getPropertyValue("isLastElement")}updateIsFirstLastPageState(){let e,t;let s=this.currentPage;this.setPropertyValue("isFirstPage",!!s&&s===this.firstVisiblePage),this.setPropertyValue("isLastPage",!!s&&s===this.lastVisiblePage);let i=this.currentSingleQuestion;if(i){let s=this.getSingleQuestions(),r=s.indexOf(i);r>=0&&(e=0===r,t=r===s.length-1)}this.setPropertyValue("isFirstElement",e),this.setPropertyValue("isLastElement",t)}get isLastPageOrElement(){return void 0!==this.isLastElement?this.isLastElement:this.isLastPage}get isFirstPageOrElement(){return void 0!==this.isFirstElement?this.isFirstElement:this.isFirstPage}calcIsShowPrevButton(){if(this.isFirstPageOrElement||!this.showPrevButton||"running"!==this.state)return!1;if(void 0!==this.isFirstElement)return!0;let e=this.visiblePages[this.currentPageNo-1];return e&&0>=e.getMaxTimeToFinish()}calcIsShowNextButton(){return"running"===this.state&&!this.isLastPageOrElement&&!this.canBeCompletedByTrigger}calcIsCompleteButtonVisible(){let e=this.state;return this.isEditMode&&("running"===this.state&&(this.isLastPageOrElement&&!this.showPreviewBeforeComplete||this.canBeCompletedByTrigger)||"preview"===e)&&this.showCompleteButton}calcIsPreviewButtonVisible(){return this.isEditMode&&this.showPreviewBeforeComplete&&"running"==this.state&&this.isLastPageOrElement}calcIsCancelPreviewButtonVisible(){return this.isEditMode&&this.showPreviewBeforeComplete&&"preview"==this.state}get firstVisiblePage(){if(1===this.visiblePageCount)return this.visiblePages[0];let e=this.pages;for(let t=0;t<e.length;t++)if(this.isPageInVisibleList(e[t]))return e[t];return null}get lastVisiblePage(){if(1===this.visiblePageCount)return this.visiblePages[0];let e=this.pages;for(let t=e.length-1;t>=0;t--)if(this.isPageInVisibleList(e[t]))return e[t];return null}doComplete(e=!1,t){if(!this.isCompleted)return this.checkOnCompletingEvent(e,t)?(this.checkOnPageTriggers(!0),this.stopTimer(),this.notifyQuestionsOnHidingContent(this.currentPage),this.isCompleted=!0,this.clearUnusedValues(),this.saveDataOnComplete(e,t),this.setCookie(),!0):(this.isCompleted=!1,!1)}saveDataOnComplete(e=!1,t){let s=this.hasCookie,i=e=>{o=!0,this.setCompletedState("saving",e)},r=e=>{this.setCompletedState("error",e)},n=e=>{this.setCompletedState("success",e),this.navigateTo()},a=e=>{this.setCompletedState("","")};var o=!1;this.onComplete.fire(this,{isCompleteOnTrigger:e,completeTrigger:t,showSaveInProgress:i,showSaveError:r,showSaveSuccess:n,clearSaveMessages:a,showDataSaving:i,showDataSavingError:r,showDataSavingSuccess:n,showDataSavingClear:a}),!s&&this.surveyPostId&&this.sendResult(),o||this.navigateTo()}checkOnCompletingEvent(e,t){var s={allowComplete:!0,allow:!0,isCompleteOnTrigger:e,completeTrigger:t};return this.onCompleting.fire(this,s),s.allowComplete&&s.allow}start(){return!!this.firstPageIsStartPage&&(this.isCurrentPageRendering=!0,!this.checkIsPageHasErrors(this.startPage,!0)&&(this.isStartedState=!1,this.notifyQuestionsOnHidingContent(this.pages[0]),this.startTimerFromUI(),this.onStarted.fire(this,{}),this.updateVisibleIndexes(),this.currentPageNo=0,this.currentPage&&this.currentPage.locStrsChanged(),!0))}get isValidatingOnServer(){return this.getPropertyValue("isValidatingOnServer",!1)}setIsValidatingOnServer(e){e!=this.isValidatingOnServer&&(this.setPropertyValue("isValidatingOnServer",e),this.onIsValidatingOnServerChanged())}createServerValidationOptions(e,t,s){var i=this;let r={data:{},errors:{},survey:this,complete:function(){i.completeServerValidation(r,t,s)}};if(e&&this.isValidateOnComplete)r.data=this.data;else for(var n=this.activePage.questions,a=0;a<n.length;a++){var o=n[a];if(o.visible){var l=this.getValue(o.getValueName());this.isValueEmpty(l)||(r.data[o.getValueName()]=l)}}return r}onIsValidatingOnServerChanged(){}doServerValidation(e,t=!1,s){if(!this.onServerValidateQuestions||this.onServerValidateQuestions.isEmpty||!e&&this.isValidateOnComplete)return!1;this.setIsValidatingOnServer(!0);let i="function"==typeof this.onServerValidateQuestions;return this.serverValidationEventCount=i?1:this.onServerValidateQuestions.length,i?this.onServerValidateQuestions(this,this.createServerValidationOptions(e,t,s)):this.onServerValidateQuestions.fireByCreatingOptions(this,()=>this.createServerValidationOptions(e,t,s)),!0}completeServerValidation(e,t,s){if((!(this.serverValidationEventCount>1)||(this.serverValidationEventCount--,!e||!e.errors||0!==Object.keys(e.errors).length))&&(this.serverValidationEventCount=0,this.setIsValidatingOnServer(!1),e||e.survey)){var i=e.survey,r=!1;if(e.errors){var n=this.autoFocusFirstError;for(var a in e.errors){var o=i.getQuestionByName(a);o&&o.errors&&(r=!0,o.addError(new tA(e.errors[a],this)),n&&(n=!1,o.page&&(this.currentPage=o.page),o.focus(!0)))}this.fireValidatedErrorsOnPage(this.currentPage)}r||(t?this.showPreviewCore():s?this.currentPage=s:i.isLastPage?i.doComplete():i.doNextPage())}}doNextPage(){var e=this.currentPage;if(this.checkOnPageTriggers(!1),this.isCompleted)this.doComplete(!0);else if(this.partialSendEnabled&&this.sendResult(this.surveyPostId,this.clientId,!0),e===this.currentPage){var t=this.visiblePages,s=t.indexOf(this.currentPage);this.currentPage=t[s+1]}}setCompleted(e){this.doComplete(!0,e)}canBeCompleted(e,t){var s;if(!tp.triggers.changeNavigationButtonsOnComplete)return;let i=this.canBeCompletedByTrigger;this.completedByTriggers||(this.completedByTriggers={}),t?this.completedByTriggers[e.id]={trigger:e,pageId:null===(s=this.currentPage)||void 0===s?void 0:s.id}:delete this.completedByTriggers[e.id],i!==this.canBeCompletedByTrigger&&this.updateButtonsVisibility()}get canBeCompletedByTrigger(){var e;if(!this.completedByTriggers)return!1;let t=Object.keys(this.completedByTriggers);if(0===t.length)return!1;let s=null===(e=this.currentPage)||void 0===e?void 0:e.id;if(!s)return!0;for(let e=0;e<t.length;e++)if(s===this.completedByTriggers[t[e]].pageId)return!0;return!1}get completedTrigger(){if(!this.canBeCompletedByTrigger)return;let e=Object.keys(this.completedByTriggers)[0];return this.completedByTriggers[e].trigger}get processedCompletedHtml(){var e=this.renderedCompletedHtml;return e?this.processHtml(e,"completed"):""}get processedCompletedBeforeHtml(){return this.locCompletedBeforeHtml.textOrHtml}get processedLoadingHtml(){return this.locLoadingHtml.textOrHtml}getProgressInfo(){var e=this.isDesignMode?this.pages:this.visiblePages;return eW.getProgressInfoByElements(e,!1)}get progressText(){return this.progressBar.progressText}get progressValue(){return this.getPropertyValue("progressValue",void 0,()=>this.getProgress())}updateProgressText(e=!1){!this.isShowingPreview&&(e&&"pages"==this.progressBarType&&this.onGetProgressText.isEmpty||(this.progressBarValue&&this.progressBarValue.resetProgressText(),this.resetPropertyValue("progressValue")))}getProgressText(){if(!this.isDesignMode&&null==this.currentPage)return"";let e={questionCount:0,answeredQuestionCount:0,requiredQuestionCount:0,requiredAnsweredQuestionCount:0,text:""};var t=this.progressBarType.toLowerCase();if("questions"===t||"requiredquestions"===t||"correctquestions"===t||!this.onGetProgressText.isEmpty){var s=this.getProgressInfo();e.questionCount=s.questionCount,e.answeredQuestionCount=s.answeredQuestionCount,e.requiredQuestionCount=s.requiredQuestionCount,e.requiredAnsweredQuestionCount=s.requiredAnsweredQuestionCount}return e.text=this.getProgressTextCore(e),this.onGetProgressText.fire(this,e),e.text}getProgressTextCore(e){var t=this.progressBarType.toLowerCase();if("questions"===t)return this.getLocalizationFormatString("questionsProgressText",e.answeredQuestionCount,e.questionCount);if("requiredquestions"===t)return this.getLocalizationFormatString("questionsProgressText",e.requiredAnsweredQuestionCount,e.requiredQuestionCount);if("correctquestions"===t){var s=this.getCorrectedAnswerCount();return this.getLocalizationFormatString("questionsProgressText",s,e.questionCount)}var i=this.isDesignMode?this.pages:this.visiblePages,r=i.indexOf(this.currentPage)+1;return this.getLocalizationFormatString("progressText",r,i.length)}getRootCss(){return new eV().append(this.css.root).append(this.css.rootProgress+"--"+this.progressBarType).append(this.css.rootMobile,this.isMobile).append(this.css.rootAnimationDisabled,!tp.animationEnabled).append(this.css.rootReadOnly,this.readOnly&&!this.isDesignMode).append(this.css.rootCompact,this.isCompact).append(this.css.rootFitToContainer,this.fitToContainer).toString()}afterRenderSurvey(e){this.destroyResizeObserver(),Array.isArray(e)&&(e=eW.GetFirstNonTextElement(e));let t=e,s=this.css.variables;if(s){let e=Number.parseFloat(r.getComputedStyle(t).getPropertyValue(s.mobileWidth));if(e){let s=!1;this.resizeObserver=new ResizeObserver(r=>{i.requestAnimationFrame(()=>{s=!s&&!!ta(t)&&this.processResponsiveness(t.offsetWidth,e,t.offsetHeight)})}),this.resizeObserver.observe(t)}}this.onAfterRenderSurvey.fire(this,{survey:this,htmlElement:e}),this.rootElement=e,this.addScrollEventListener()}beforeDestroySurveyElement(){this.destroyResizeObserver(),this.removeScrollEventListener(),this.rootElement=void 0}processResponsiveness(e,t,s){let i=e<t,r=this.isMobile!==i;return this.setIsMobile(i),this.layoutElements.forEach(t=>t.processResponsiveness&&t.processResponsiveness(e)),this.onResize.fire(this,{height:s,width:e}),r}triggerResponsiveness(e){this.getAllQuestions().forEach(t=>{t.triggerResponsiveness(e)})}destroyResizeObserver(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0)}updateQuestionCssClasses(e,t){this.onUpdateQuestionCssClasses.fire(this,{question:e,cssClasses:t})}updatePanelCssClasses(e,t){this.onUpdatePanelCssClasses.fire(this,{panel:e,cssClasses:t})}updatePageCssClasses(e,t){this.onUpdatePageCssClasses.fire(this,{page:e,cssClasses:t})}updateChoiceItemCss(e,t){t.question=e,this.onUpdateChoiceItemCss.fire(this,t)}afterRenderPage(e){if(!this.isDesignMode&&!this.focusingQuestionInfo){let e=!1===this.isCurrentPageRendered;setTimeout(()=>this.scrollToTopOnPageChange(e),1)}this.focusQuestionInfo(),this.isCurrentPageRendered=!0,this.onAfterRenderPage.isEmpty||this.onAfterRenderPage.fire(this,{page:this.activePage,htmlElement:e})}afterRenderHeader(e){this.onAfterRenderHeader.isEmpty||this.onAfterRenderHeader.fire(this,{htmlElement:e})}afterRenderQuestion(e,t){this.onAfterRenderQuestion.fire(this,{question:e,htmlElement:t})}afterRenderQuestionInput(e,t){if(this.onAfterRenderQuestionInput.isEmpty)return;let s=e.inputId,{root:i}=tp.environment;if(s&&(!t||t.id!==s)&&void 0!==i){let e=i.getElementById(s);e&&(t=e)}this.onAfterRenderQuestionInput.fire(this,{question:e,htmlElement:t})}afterRenderPanel(e,t){this.onAfterRenderPanel.fire(this,{panel:e,htmlElement:t})}whenQuestionFocusIn(e){this.onFocusInQuestion.fire(this,{question:e})}whenPanelFocusIn(e){this.onFocusInPanel.fire(this,{panel:e})}rebuildQuestionChoices(){this.getAllQuestions().forEach(e=>e.surveyChoiceItemVisibilityChange())}canChangeChoiceItemsVisibility(){return!this.onShowingChoiceItem.isEmpty}getChoiceItemVisibility(e,t,s){let i={question:e,item:t,visible:s};return this.onShowingChoiceItem.fire(this,i),i.visible}loadQuestionChoices(e){this.onChoicesLazyLoad.fire(this,e)}getChoiceDisplayValue(e){this.onGetChoiceDisplayValue.isEmpty?e.setItems(null):this.onGetChoiceDisplayValue.fire(this,e)}matrixBeforeRowAdded(e){this.onMatrixRowAdding.fire(this,e)}matrixRowAdded(e,t){this.onMatrixRowAdded.fire(this,{question:e,row:t})}matrixColumnAdded(e,t){this.onMatrixColumnAdded.fire(this,{question:e,column:t})}multipleTextItemAdded(e,t){this.onMultipleTextItemAdded.fire(this,{question:e,item:t})}getQuestionByValueNameFromArray(e,t,s){var i=this.getQuestionsByValueName(e);if(i){for(var r=0;r<i.length;r++){var n=i[r].getQuestionFromArray(t,s);if(n)return n}return null}}matrixRowRemoved(e,t,s){this.onMatrixRowRemoved.fire(this,{question:e,rowIndex:t,row:s})}matrixRowRemoving(e,t,s){var i={question:e,rowIndex:t,row:s,allow:!0};return this.onMatrixRowRemoving.fire(this,i),i.allow}matrixAllowRemoveRow(e,t,s){let i={question:e,rowIndex:t,row:s,allow:!0};return this.onMatrixRenderRemoveButton.fire(this,i),i.allow}matrixDetailPanelVisibleChanged(e,t,s,i){let r={question:e,rowIndex:t,row:s,visible:i,detailPanel:s.detailPanel};this.onMatrixDetailPanelVisibleChanged.fire(this,r)}matrixCellCreating(e,t){t.question=e,this.onMatrixCellCreating.fire(this,t)}matrixCellCreated(e,t){t.question=e,this.onMatrixCellCreated.fire(this,t)}matrixAfterCellRender(e,t){t.question=e,this.onAfterRenderMatrixCell.fire(this,t)}matrixCellValueChanged(e,t){t.question=e,this.onMatrixCellValueChanged.fire(this,t)}matrixCellValueChanging(e,t){t.question=e,this.onMatrixCellValueChanging.fire(this,t)}get isValidateOnValueChanging(){return"onValueChanging"===this.checkErrorsMode}get isValidateOnValueChanged(){return"onValueChanged"===this.checkErrorsMode}get isValidateOnValueChange(){return this.isValidateOnValueChanged||this.isValidateOnValueChanging}get isValidateOnComplete(){return"onComplete"===this.checkErrorsMode||this.validationAllowSwitchPages&&!this.validationAllowComplete}matrixCellValidate(e,t){return t.question=e,this.onMatrixCellValidate.fire(this,t),t.error?new tA(t.error,this):null}dynamicPanelAdded(e,t,s){if(!this.isLoadingFromJson&&this.hasQuestionVisibleIndeces(e)&&this.updateVisibleIndexes(e.page),!this.onDynamicPanelAdded.isEmpty){var i=e.panels;void 0===t&&(t=i.length-1,s=i[t]),this.onDynamicPanelAdded.fire(this,{question:e,panel:s,panelIndex:t})}}dynamicPanelRemoved(e,t,s){for(var i=s?s.questions:[],r=0;r<i.length;r++)i[r].clearOnDeletingContainer();this.hasQuestionVisibleIndeces(e)&&this.updateVisibleIndexes(e.page),this.onDynamicPanelRemoved.fire(this,{question:e,panelIndex:t,panel:s})}hasQuestionVisibleIndeces(e){let t=e.getNestedQuestions(!0);for(let e=0;e<t.length;e++)if(t[e].visibleIndex>-1)return!0;return!1}dynamicPanelRemoving(e,t,s){let i={question:e,panelIndex:t,panel:s,allow:!0};return this.onDynamicPanelRemoving.fire(this,i),i.allow}dynamicPanelItemValueChanged(e,t){t.question=e,this.onDynamicPanelValueChanged.fire(this,t)}dynamicPanelItemValueChanging(e,t){t.question=e,this.onDynamicPanelValueChanging.fire(this,t)}dynamicPanelGetTabTitle(e,t){t.question=e,this.onGetDynamicPanelTabTitle.fire(this,t)}dynamicPanelCurrentIndexChanged(e,t){t.question=e,this.onDynamicPanelCurrentIndexChanged.fire(this,t)}dragAndDropAllow(e){return this.onDragDropAllow.fire(this,e),e.allow}elementContentVisibilityChanged(e){this.currentPage&&this.currentPage.ensureRowsVisibility(),this.onElementContentVisibilityChanged.fire(this,{element:e})}getUpdatedPanelFooterActions(e,t,s){let i={question:s,panel:e,actions:t};return this.onGetPanelFooterActions.fire(this,i),i.actions}getUpdatedElementTitleActions(e,t){return e.isPage?this.getUpdatedPageTitleActions(e,t):e.isPanel?this.getUpdatedPanelTitleActions(e,t):this.getUpdatedQuestionTitleActions(e,t)}getTitleActionsResult(e,t){return e!=t.actions?t.actions:e!=t.titleActions?t.titleActions:e}getUpdatedQuestionTitleActions(e,t){let s={question:e,actions:t,titleActions:t};return this.onGetQuestionTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedPanelTitleActions(e,t){let s={panel:e,actions:t,titleActions:t};return this.onGetPanelTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedPageTitleActions(e,t){var s={page:e,actions:t,titleActions:t};return this.onGetPageTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedMatrixRowActions(e,t,s){let i={question:e,actions:s,row:t};return this.onGetMatrixRowActions.fire(this,i),i.actions}scrollElementToTop(e,t,s,i,r,n,a,o){let l={element:e,question:t,page:s,elementId:i,cancel:!1,allow:!0};if(this.onScrollToTop.fire(this,l),!l.cancel&&l.allow){let t=this.getPageByElement(e);if(this.isLazyRendering&&t){let s=1,{rootElement:i}=tp.environment,h=this.rootElement||a||i;this.skeletonHeight&&h&&"function"==typeof h.getBoundingClientRect&&(s=h.getBoundingClientRect().height/this.skeletonHeight-1),t.forceRenderElement(e,()=>{this.suspendLazyRendering(),eW.ScrollElementToTop(l.elementId,r,n,()=>{this.releaseLazyRendering(),eZ(t.id),o&&o()})},s)}else if(e.isPage&&!this.isSinglePage&&!this.isDesignMode&&this.rootElement){let e=this.rootElement.querySelector(tr(this.css.rootWrapper));eW.ScrollElementToViewCore(e,!1,r,n,o)}else eW.ScrollElementToTop(l.elementId,r,n,o)}}chooseFiles(e,t,s){this.onOpenFileChooser.isEmpty?th(e,t):this.onOpenFileChooser.fire(this,{input:e,element:s&&s.element||this.survey,elementType:s&&s.elementType,item:s&&s.item,propertyName:s&&s.propertyName,callback:t,context:s})}uploadFiles(e,t,s,i){this.onUploadFiles.isEmpty?i("error",this.getLocString("noUploadFilesHandler")):this.taskManager.runTask("file",r=>{this.onUploadFiles.fire(this,{question:e,name:t,files:s||[],callback:(e,t)=>{i(e,t),r()}})}),this.surveyPostId&&this.uploadFilesCore(t,s,i)}downloadFile(e,t,s,i){this.onDownloadFile.isEmpty&&i&&i("skipped",s.content||s),this.onDownloadFile.fire(this,{question:e,name:t,content:s.content||s,fileValue:s,callback:i})}clearFiles(e,t,s,i,r){this.onClearFiles.isEmpty&&r&&r("success",s),this.onClearFiles.fire(this,{question:e,name:t,value:s,fileName:i,callback:r})}updateChoicesFromServer(e,t,s){var i={question:e,choices:t,serverResult:s};return this.onChoicesLoaded.fire(this,i),i.choices}loadedChoicesFromServer(e){this.locStrsChanged()}uploadFilesCore(e,t,s){this.reportWarningOnUsingService()}getPage(e){return this.pages[e]}addPage(e,t=-1){null!=e&&(t<0||t>=this.pages.length?this.pages.push(e):this.pages.splice(t,0,e))}addNewPage(e=null,t=-1){var s=this.createNewPage(e);return this.addPage(s,t),s}removePage(e){var t=this.pages.indexOf(e);t<0||(this.pages.splice(t,1),this.currentPage!=e||(this.currentPage=this.pages.length>0?this.pages[0]:null))}getQuestionByName(e,t=!1){if(!e)return null;t&&(e=e.toLowerCase());var s=(t?this.questionHashes.namesInsensitive:this.questionHashes.names)[e];return s?s[0]:null}findQuestionByName(e){return this.getQuestionByName(e)}getEditingSurveyElement(){return this.editingObjValue}getQuestionByValueName(e,t=!1){var s=this.getQuestionsByValueName(e,t);return s?s[0]:null}getQuestionsByValueName(e,t=!1){var s=(t?this.questionHashes.valueNamesInsensitive:this.questionHashes.valueNames)[e];return s||null}getCalculatedValueByName(e){for(var t=0;t<this.calculatedValues.length;t++)if(e==this.calculatedValues[t].name)return this.calculatedValues[t];return null}getQuestionsByNames(e,t=!1){var s=[];if(!e)return s;for(var i=0;i<e.length;i++)if(e[i]){var r=this.getQuestionByName(e[i],t);r&&s.push(r)}return s}getPageByElement(e){for(var t=0;t<this.pages.length;t++){var s=this.pages[t];if(s.containsElement(e))return s}return null}getPageByQuestion(e){return this.getPageByElement(e)}getPageByName(e){for(var t=0;t<this.pages.length;t++)if(this.pages[t].name==e)return this.pages[t];return null}getPagesByNames(e){var t=[];if(!e)return t;for(var s=0;s<e.length;s++)if(e[s]){var i=this.getPageByName(e[s]);i&&t.push(i)}return t}getAllQuestions(e=!1,t=!1,s=!1){s&&(t=!1);for(var i=[],r=0;r<this.pages.length;r++)this.pages[r].addQuestionsToList(i,e,t);if(!s)return i;let n=[];return i.forEach(t=>{n.push(t),t.getNestedQuestions(e).forEach(e=>n.push(e))}),n}getQuizQuestions(){for(var e=[],t=this.getPageStartIndex(),s=t;s<this.pages.length;s++)if(this.pages[s].isVisible)for(var i=this.pages[s].questions,r=0;r<i.length;r++){var n=i[r];n.quizQuestionCount>0&&e.push(n)}return e}getPanelByName(e,t=!1){var s=this.getAllPanels();t&&(e=e.toLowerCase());for(var i=0;i<s.length;i++){var r=s[i].name;if(t&&(r=r.toLowerCase()),r==e)return s[i]}return null}getAllPanels(e=!1,t=!1){for(var s=[],i=0;i<this.pages.length;i++)this.pages[i].addPanelsIntoList(s,e,t);return s}createNewPage(e){let t=E.createClass("page");return t.name=e,t}getValueChangeReason(){return this.isSettingValueOnExpression?"expression":this.isSettingValueFromTrigger?"trigger":void 0}questionOnValueChanging(e,t,s){if(this.editingObj){let s=E.findProperty(this.editingObj.getType(),e);s&&(t=s.settingValue(this.editingObj,t))}if(this.onValueChanging.isEmpty)return t;var i={name:e,question:this.getQuestionByValueName(s||e),value:this.getUnbindValue(t),oldValue:this.getValue(e),reason:this.getValueChangeReason()};return this.onValueChanging.fire(this,i),i.value}updateQuestionValue(e,t){if(!this.isLoadingFromJson){var s=this.getQuestionsByValueName(e);if(s)for(var i=0;i<s.length;i++){var r=s[i].value;(r===t&&Array.isArray(r)&&this.editingObj||!this.isTwoValueEquals(r,t))&&s[i].updateValueFromSurvey(t,!1)}}}checkQuestionErrorOnValueChanged(e){!this.isNavigationButtonPressed&&(this.isValidateOnValueChanged||e.getAllErrors().length>0)&&this.checkQuestionErrorOnValueChangedCore(e)}checkQuestionErrorOnValueChangedCore(e){var t=e.getAllErrors().length,s=!e.validate(!0,{isOnValueChanged:!this.isValidateOnValueChanging});return e.page&&this.isValidateOnValueChange&&(t>0||e.getAllErrors().length>0)&&this.fireValidatedErrorsOnPage(e.page),s}checkErrorsOnValueChanging(e,t){if(this.isLoadingFromJson)return!1;var s=this.getQuestionsByValueName(e);if(!s)return!1;for(var i=!1,r=0;r<s.length;r++){var n=s[r];this.isTwoValueEquals(n.valueForSurvey,t)||(n.value=t),this.checkQuestionErrorOnValueChangedCore(n)&&(i=!0),i=i||n.errors.length>0}return i}fireOnValueChanged(e,t,s){this.onValueChanged.fire(this,{name:e,question:s,value:t,reason:this.getValueChangeReason()})}notifyQuestionOnValueChanged(e,t,s){if(!this.isLoadingFromJson){var i=this.getQuestionsByValueName(e);if(i)for(var r=0;r<i.length;r++){var n=i[r];this.checkQuestionErrorOnValueChanged(n),n.onSurveyValueChanged(t)}this.updateProgressText(!0),this.fireOnValueChanged(e,t,s?this.getQuestionByName(s):void 0),this.isDisposed||(this.checkElementsBindings(e,t),this.notifyElementsOnAnyValueOrVariableChanged(e,s))}}checkElementsBindings(e,t){this.isRunningElementsBindings=!0;for(var s=0;s<this.pages.length;s++)this.pages[s].checkBindings(e,t);this.isRunningElementsBindings=!1,this.updateVisibleIndexAfterBindings&&(this.updateVisibleIndexes(),this.updateVisibleIndexAfterBindings=!1)}notifyElementsOnAnyValueOrVariableChanged(e,t){if("processing"!==this.isEndLoadingFromJson){if(this.isRunningConditions){this.conditionNotifyElementsOnAnyValueOrVariableChanged=!0;return}for(var s=0;s<this.pages.length;s++)this.pages[s].onAnyValueChanged(e,t);this.isEndLoadingFromJson||this.locStrsChanged()}}updateAllQuestionsValue(e){for(var t=this.getAllQuestions(),s=0;s<t.length;s++){var i=t[s],r=i.getValueName();i.updateValueFromSurvey(this.getValue(r),e),i.requireUpdateCommentValue&&i.updateCommentFromSurvey(this.getComment(r))}}notifyAllQuestionsOnValueChanged(){for(var e=this.getAllQuestions(),t=0;t<e.length;t++)e[t].onSurveyValueChanged(this.getValue(e[t].getValueName()))}checkOnPageTriggers(e){for(var t=this.getCurrentPageQuestions(!0),s={},i=0;i<t.length;i++){var r=t[i].getValueName();s[r]=this.getValue(r)}this.addCalculatedValuesIntoFilteredValues(s),this.checkTriggers(s,!0,e)}getCurrentPageQuestions(e=!1){var t=[],s=this.currentPage;if(!s)return t;for(var i=0;i<s.questions.length;i++){var r=s.questions[i];(e||r.visible)&&r.name&&t.push(r)}return t}checkTriggers(e,t,s=!1,i=!1,r){if(this.isCompleted||0==this.triggers.length||this.isDisplayMode)return;if(this.isTriggerIsRunning){for(var n in this.triggerValues=this.getFilteredValues(),e)this.triggerKeys[n]=e[n];return}let a=!1;if(!s&&r&&this.hasRequiredValidQuestionTrigger){let e=this.getQuestionByValueName(r);a=e&&!e.validate(!1)}this.isTriggerIsRunning=!0,this.triggerKeys=e,this.triggerValues=this.getFilteredValues();var o=this.getFilteredProperties();let l=this.canBeCompletedByTrigger;for(let e=0;e<this.triggers.length;e++){let r=this.triggers[e];if(a&&r.requireValidQuestion)continue;let n={isOnNextPage:t,isOnComplete:s,isOnNavigation:i,keys:this.triggerKeys,values:this.triggerValues,properties:o};r.checkExpression(n)}l!==this.canBeCompletedByTrigger&&this.updateButtonsVisibility(),this.isTriggerIsRunning=!1}checkTriggersAndRunConditions(e,t,s){var i={};i[e]={newValue:t,oldValue:s},this.runConditionOnValueChanged(e,t),this.checkTriggers(i,!1,!1,!1,e)}get hasRequiredValidQuestionTrigger(){for(let e=0;e<this.triggers.length;e++)if(this.triggers[e].requireValidQuestion)return!0;return!1}doElementsOnLoad(){for(var e=0;e<this.pages.length;e++)this.pages[e].onSurveyLoad()}get isRunningConditions(){return!!this.conditionValues}runExpressions(){this.runConditions()}runConditions(){if(!this.isCompleted&&"processing"!==this.isEndLoadingFromJson&&!this.isRunningConditions){this.conditionValues=this.getFilteredValues();var e=this.getFilteredProperties(),t=this.pages.indexOf(this.currentPage);this.runConditionsCore(e),this.checkIfNewPagesBecomeVisible(t),this.conditionValues=null,this.isValueChangedOnRunningCondition&&this.conditionRunnerCounter<tp.maxConditionRunCountOnValueChanged?(this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter++,this.runConditions()):(this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter=0,this.conditionUpdateVisibleIndexes&&(this.conditionUpdateVisibleIndexes=!1,this.updateVisibleIndexes()),this.conditionNotifyElementsOnAnyValueOrVariableChanged&&(this.conditionNotifyElementsOnAnyValueOrVariableChanged=!1,this.notifyElementsOnAnyValueOrVariableChanged("")))}}runConditionOnValueChanged(e,t){this.isRunningConditions?(this.conditionValues[e]=t,this.questionTriggersKeys&&(this.questionTriggersKeys[e]=t),this.isValueChangedOnRunningCondition=!0):(this.questionTriggersKeys={},this.questionTriggersKeys[e]=t,this.runConditions(),this.runQuestionsTriggers(e,t),this.questionTriggersKeys=void 0)}runConditionsCore(e){for(var t=this.pages,s=0;s<this.calculatedValues.length;s++)this.calculatedValues[s].resetCalculation();for(var s=0;s<this.calculatedValues.length;s++)this.calculatedValues[s].doCalculation(this.calculatedValues,this.conditionValues,e);super.runConditionCore(this.conditionValues,e);for(let s=0;s<t.length;s++)t[s].runCondition(this.conditionValues,e)}runQuestionsTriggers(e,t){!this.isDisplayMode&&!this.isDesignMode&&this.getAllQuestions().forEach(s=>{s.runTriggers(e,t,this.questionTriggersKeys)})}checkIfNewPagesBecomeVisible(e){var t=this.pages.indexOf(this.currentPage);if(!(t<=e+1)){for(var s=e+1;s<t;s++)if(this.pages[s].isVisible){this.currentPage=this.pages[s];break}}}sendResult(e=null,t=null,s=!1){if(this.isEditMode)s&&this.onPartialSend&&this.onPartialSend.fire(this,null),!e&&this.surveyPostId&&(e=this.surveyPostId),e&&(t&&(this.clientId=t),(!s||this.clientId)&&this.reportWarningOnUsingService())}getResult(e,t){this.reportWarningOnUsingService()}loadSurveyFromService(e=null,t=null){e&&(this.surveyId=e),t&&(this.clientId=t),this.reportWarningOnUsingService()}reportWarningOnUsingService(){D.warn("Self-hosted Form Library no longer supports integration with SurveyJS Demo Service. Learn more: https://surveyjs.io/stay-updated/release-notes/v2.0.0#form-library-removes-apis-for-integration-with-surveyjs-demo-service")}loadSurveyFromServiceJson(e){e&&(this.fromJSON(e),this.notifyAllQuestionsOnValueChanged(),this.onLoadSurveyFromService(),this.onLoadedSurveyFromService.fire(this,{}))}onLoadingSurveyFromService(){}onLoadSurveyFromService(){}resetVisibleIndexes(){for(var e=this.getAllQuestions(!0),t=0;t<e.length;t++)e[t].setVisibleIndex(-1);this.updateVisibleIndexes()}updateVisibleIndexes(e){if(!this.isLoadingFromJson&&!this.isEndLoadingFromJson){if(this.isRunningConditions&&this.onQuestionVisibleChanged.isEmpty&&this.onPageVisibleChanged.isEmpty){this.conditionUpdateVisibleIndexes=!0;return}if(this.isRunningElementsBindings){this.updateVisibleIndexAfterBindings=!0;return}this.updatePageVisibleIndexes(),this.updatePageElementsVisibleIndexes(e),this.updateProgressText(!0)}}updatePageElementsVisibleIndexes(e){if("onPage"==this.showQuestionNumbers)for(var t=e?[e]:this.visiblePages,s=0;s<t.length;s++)t[s].setVisibleIndex(0);else{let e=this.getStartVisibleIndex(),t=this.pages;for(let s=0;s<t.length;s++)e+=t[s].setVisibleIndex(e)}}getStartVisibleIndex(){return"on"==this.showQuestionNumbers?0:-1}updatePageVisibleIndexes(){this.updateButtonsVisibility();for(var e=0,t=0;t<this.pages.length;t++){let s=this.pages[t],i=s.isVisible&&(t>0||!s.isStartPage);s.visibleIndex=i?e++:-1,s.num=i?s.visibleIndex+1:-1}}fromJSON(e,t){if(!e)return;this.questionHashesClear(),this.jsonErrors=null,this.sjsVersion=void 0;let s=new I;s.toObject(e,this,t),s.errors.length>0&&(this.jsonErrors=s.errors),this.onStateAndCurrentPageChanged(),this.endLoading(),this.updateState(),this.sjsVersion&&tp.version&&a.compareVerions(this.sjsVersion,tp.version)>0&&D.warn("The version of the survey JSON schema (v"+this.sjsVersion+") is newer than your current Form Library version ("+tp.version+"). Please update the Form Library to make sure that all survey features work as expected.")}startLoadingFromJson(e){super.startLoadingFromJson(e),e&&e.locale&&(this.locale=e.locale)}setJsonObject(e){this.fromJSON(e)}endLoadingFromJson(){this.isEndLoadingFromJson="processing",this.onFirstPageIsStartedChanged(),super.endLoadingFromJson(),this.hasCookie&&(this.isCompletedBefore=!0),this.doElementsOnLoad(),this.onQuestionsOnPageModeChanged("standard"),this.isEndLoadingFromJson="conditions",this.runConditions(),this.notifyElementsOnAnyValueOrVariableChanged(""),this.isEndLoadingFromJson=null,this.updateVisibleIndexes(),this.updateCurrentPage(),this.setCalculatedWidthModeUpdater()}updateNavigationCss(){let e=this.navigationBarValue;e&&(e.cssClasses=this.css.actionBar,e.containerCss=this.css.footer,this.updateNavigationItemCssCallback&&this.updateNavigationItemCssCallback())}createNavigationBar(){let e=new ex;return e.setItems(this.createNavigationActions()),e.locOwner=this,e}createNavigationActions(){let e="sv-nav-btn",t=new eL({id:"sv-nav-start",visible:new ec(()=>this.isStartPageActive),visibleIndex:10,locTitle:this.locStartSurveyText,action:()=>this.start(),component:e}),s=new eL({id:"sv-nav-prev",visible:new ec(()=>this.isShowPrevButton),visibleIndex:20,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locPagePrevText,action:()=>this.performPrevious(),component:e}),i=new eL({id:"sv-nav-next",visible:new ec(()=>this.isShowNextButton),visibleIndex:30,data:{mouseDown:()=>this.nextPageMouseDown()},locTitle:this.locPageNextText,action:()=>this.nextPageUIClick(),component:e}),r=new eL({id:"sv-nav-preview",visible:new ec(()=>this.isPreviewButtonVisible),visibleIndex:40,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locPreviewText,action:()=>this.showPreview(),component:e}),n=new eL({id:"sv-nav-complete",visible:new ec(()=>this.isCompleteButtonVisible),visibleIndex:50,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locCompleteText,action:()=>this.taskManager.waitAndExecute(()=>this.tryComplete()),component:e});return this.updateNavigationItemCssCallback=()=>{t.innerCss=this.cssNavigationStart,s.innerCss=this.cssNavigationPrev,i.innerCss=this.cssNavigationNext,r.innerCss=this.cssNavigationPreview,n.innerCss=this.cssNavigationComplete},[t,s,i,r,n]}onBeforeRunConstructor(){}onBeforeCreating(){}onCreating(){}getProcessedTextValue(e){if(this.getProcessedTextValueCore(e),!this.onProcessDynamicText.isEmpty){var t=this.isValueEmpty(e.value);this.onProcessDynamicText.fire(this,e),e.isExists=e.isExists||t&&!this.isValueEmpty(e.value)}}getBuiltInVariableValue(e){if("pageno"===e){var t=this.currentPage;return null!=t?this.visiblePages.indexOf(t)+1:0}return"pagecount"===e?this.visiblePageCount:"correctedanswers"===e||"correctanswers"===e||"correctedanswercount"===e?this.getCorrectedAnswerCount():"incorrectedanswers"===e||"incorrectanswers"===e||"incorrectedanswercount"===e?this.getInCorrectedAnswerCount():"questioncount"===e?this.getQuizQuestionCount():void 0}getProcessedTextValueCore(e){var t=e.name.toLocaleLowerCase();if(-1!==["no","require","title"].indexOf(t))return;let s=this.getBuiltInVariableValue(t);if(void 0!==s){e.isExists=!0,e.value=s;return}if("locale"===t){e.isExists=!0,e.value=this.locale?this.locale:h.defaultLocale;return}var i=this.getVariable(t);if(void 0!==i){e.isExists=!0,e.value=i;return}var r=this.getFirstName(t);if(r){let s=r.useDisplayValuesInDynamicTexts;e.isExists=!0;let i=r.getValueName().toLowerCase();t=(t=i+t.substring(i.length)).toLocaleLowerCase();var n={};n[i]=e.returnDisplayValue&&s?r.getDisplayValue(!1,void 0):r.value,e.value=new A().getValue(t,n);return}this.getProcessedValuesWithoutQuestion(e)}getProcessedValuesWithoutQuestion(e){var t=this.getValue(e.name);if(void 0!==t){e.isExists=!0,e.value=t;return}let s=new A,i=s.getFirstName(e.name);if(i===e.name)return;let r={},n=this.getValue(i);a.isValueEmpty(n)&&(n=this.getVariable(i)),a.isValueEmpty(n)||(r[i]=n,e.value=s.getValue(e.name,r),e.isExists=s.hasValue(e.name,r))}getFirstName(e){var t;e=e.toLowerCase();do t=this.getQuestionByValueName(e,!0),e=this.reduceFirstName(e);while(!t&&!!e);return t}reduceFirstName(e){var t=e.lastIndexOf("."),s=e.lastIndexOf("[");if(t<0&&s<0)return"";var i=Math.max(t,s);return e.substring(0,i)}clearUnusedValues(){this.isClearingUnsedValues=!0;for(var e=this.getAllQuestions(),t=0;t<e.length;t++)e[t].clearUnusedValues();this.clearInvisibleQuestionValues(),this.isClearingUnsedValues=!1}hasVisibleQuestionByValueName(e){var t=this.getQuestionsByValueName(e);if(!t)return!1;for(var s=0;s<t.length;s++){let e=t[s];if(e.isVisible&&e.isParentVisible&&!e.parentQuestion)return!0}return!1}questionsByValueName(e){return this.getQuestionsByValueName(e)||[]}clearInvisibleQuestionValues(){let e="none"===this.clearInvisibleValues?"none":"onComplete",t=this.getAllQuestions();for(var s=0;s<t.length;s++)t[s].clearValueIfInvisible(e)}getVariable(e){if(!e)return null;e=e.toLowerCase();var t=this.variablesHash[e];return this.isValueEmpty(t)&&(e.indexOf(".")>-1||e.indexOf("[")>-1)&&new A().hasValue(e,this.variablesHash)?new A().getValue(e,this.variablesHash):t}setVariable(e,t){if(!e)return;let s=this.getVariable(e);this.valuesHash&&delete this.valuesHash[e],e=e.toLowerCase(),this.variablesHash[e]=t,this.notifyElementsOnAnyValueOrVariableChanged(e),a.isTwoValueEquals(s,t)||(this.checkTriggersAndRunConditions(e,t,s),this.onVariableChanged.fire(this,{name:e,value:t}))}getVariableNames(){var e=[];for(var t in this.variablesHash)e.push(t);return e}getUnbindValue(e){return this.editingObj?e:a.getUnbindValue(e)}getValue(e){if(!e||0==e.length)return null;var t=this.getDataValueCore(this.valuesHash,e);return this.getUnbindValue(t)}setValue(e,t,s=!1,i=!0,r){var n=t;if(i&&(n=this.questionOnValueChanging(e,t)),!(this.isValidateOnValueChanging&&this.checkErrorsOnValueChanging(e,n))&&!(!this.editingObj&&this.isValueEqual(e,n)&&this.isTwoValueEquals(n,t))){var a=this.getValue(e);this.isValueEmpyOnSetValue(e,n)?this.deleteDataValueCore(this.valuesHash,e):(n=this.getUnbindValue(n),this.setDataValueCore(this.valuesHash,e,n)),this.updateOnSetValue(e,n,a,s,i,r)}}isValueEmpyOnSetValue(e,t){return!!this.isValueEmpty(t,!1)&&(!this.editingObj||null==t||this.editingObj.getDefaultPropertyValue(e)===t)}updateOnSetValue(e,t,s,i=!1,r=!0,n){this.updateQuestionValue(e,t),!0===i||this.isDisposed||this.isRunningElementsBindings||(n=n||e,this.checkTriggersAndRunConditions(e,t,s),r&&this.notifyQuestionOnValueChanged(e,t,n),"text"!==i&&this.tryGoNextPageAutomatic(e))}isValueEqual(e,t){(""===t||void 0===t)&&(t=null);var s=this.getValue(e);return((""===s||void 0===s)&&(s=null),null===t||null===s)?t===s:this.isTwoValueEquals(t,s)}doOnPageAdded(e){e.setSurveyImpl(this),e.name||(e.name=this.generateNewName(this.pages,"page")),this.questionHashesPanelAdded(e),this.updateVisibleIndexes(),!this.runningPages&&(this.isLoadingFromJson||(this.updateProgressText(),this.updateCurrentPage()),this.canFireAddPage()&&this.onPageAdded.fire(this,{page:e}))}canFireAddPage(){return!this.isMovingPage}doOnPageRemoved(e){e.setSurveyImpl(null),this.runningPages||(e===this.currentPage&&this.updateCurrentPage(),this.updateVisibleIndexes(),this.updateProgressText(),this.updateLazyRenderingRowsOnRemovingElements())}generateNewName(e,t){for(var s={},i=0;i<e.length;i++)s[e[i].name]=!0;for(var r=1;s[t+r];)r++;return t+r}tryGoNextPageAutomatic(e){if(this.isEndLoadingFromJson||!this.autoAdvanceEnabled||!this.currentPage)return;let t=this.getQuestionByValueName(e);if(!t||t&&(!t.visible||!t.supportAutoAdvance())||!t.validate(!1)&&!t.supportGoNextPageError())return;if(this.currentSingleQuestion){let e=this.currentSingleQuestion;sF.safeTimeOut(()=>{e===this.currentSingleQuestion&&(this.isLastElement?this.autoAdvanceAllowComplete&&this.tryCompleteOrShowPreview():this.performNext())},tp.autoAdvanceDelay)}var s=this.getCurrentPageQuestions();if(0>s.indexOf(t))return;for(var i=0;i<s.length;i++)if(s[i].hasInput&&s[i].isEmpty())return;if(this.isLastPage&&(!0!==this.autoAdvanceEnabled||!this.autoAdvanceAllowComplete)||this.checkIsCurrentPageHasErrors(!1))return;let r=this.currentPage;sF.safeTimeOut(()=>{r===this.currentPage&&(this.isLastPage?this.tryCompleteOrShowPreview():this.nextPage())},tp.autoAdvanceDelay)}tryCompleteOrShowPreview(){this.showPreviewBeforeComplete?this.showPreview():this.tryComplete()}getComment(e){return this.getValue(e+this.commentSuffix)||""}setComment(e,t,s=!1){if(t||(t=""),this.isTwoValueEquals(t,this.getComment(e)))return;let i=e+this.commentSuffix;t=this.questionOnValueChanging(i,t,e),this.isValueEmpty(t)?this.deleteDataValueCore(this.valuesHash,i):this.setDataValueCore(this.valuesHash,i,t);var r=this.getQuestionsByValueName(e);if(r)for(var n=0;n<r.length;n++)r[n].updateCommentFromSurvey(t),this.checkQuestionErrorOnValueChanged(r[n]);s||this.checkTriggersAndRunConditions(e,this.getValue(e),void 0),"text"!==s&&this.tryGoNextPageAutomatic(e);var a=this.getQuestionByValueName(e);a&&(this.fireOnValueChanged(i,t,a),a.comment=t,a.comment!=t&&(a.comment=t))}clearValue(e){this.setValue(e,null),this.setComment(e,null)}get clearDisabledChoices(){return this.getPropertyValue("clearDisabledChoices",!1)}set clearDisabledChoices(e){this.setPropertyValue("clearDisabledChoices",e)}get clearValueOnDisableItems(){return this.clearDisabledChoices}set clearValueOnDisableItems(e){this.clearDisabledChoices=e}getQuestionClearIfInvisible(e){return this.isShowingPreview||this.runningPages?"none":"default"!==e?e:this.clearInvisibleValues}questionVisibilityChanged(e,t,s){s&&this.updateVisibleIndexes(e.page),this.onQuestionVisibleChanged.fire(this,{question:e,name:e.name,visible:t})}pageVisibilityChanged(e,t){this.isLoadingFromJson||((t&&!this.currentPage||e===this.currentPage)&&this.updateCurrentPage(),this.updateVisibleIndexes(),this.onPageVisibleChanged.fire(this,{page:e,visible:t}))}panelVisibilityChanged(e,t){this.updateVisibleIndexes(e.page),this.onPanelVisibleChanged.fire(this,{panel:e,visible:t})}questionCreated(e){this.onQuestionCreated.fire(this,{question:e})}questionAdded(e,t,s,i){e.name||(e.name=this.generateNewName(this.getAllQuestions(!1,!0),"question")),e.page&&this.questionHashesAdded(e),this.isLoadingFromJson||(this.currentPage||this.updateCurrentPage(),this.updateVisibleIndexes(e.page),this.setCalculatedWidthModeUpdater()),this.canFireAddElement()&&this.onQuestionAdded.fire(this,{question:e,name:e.name,index:t,parent:s,page:i,parentPanel:s,rootPanel:i})}canFireAddElement(){return!this.isMovingQuestion}questionRemoved(e){this.questionHashesRemoved(e,e.name,e.getValueName()),this.updateVisibleIndexes(e.page),this.onQuestionRemoved.fire(this,{question:e,name:e.name}),this.updateLazyRenderingRowsOnRemovingElements()}questionRenamed(e,t,s){this.questionHashesRemoved(e,t,s),this.questionHashesAdded(e)}questionHashesClear(){this.questionHashes.names={},this.questionHashes.namesInsensitive={},this.questionHashes.valueNames={},this.questionHashes.valueNamesInsensitive={}}questionHashesPanelAdded(e){if(!this.isLoadingFromJson)for(var t=e.questions,s=0;s<t.length;s++)this.questionHashesAdded(t[s])}questionHashesAdded(e){this.questionHashAddedCore(this.questionHashes.names,e,e.name),this.questionHashAddedCore(this.questionHashes.namesInsensitive,e,e.name.toLowerCase()),this.questionHashAddedCore(this.questionHashes.valueNames,e,e.getValueName()),this.questionHashAddedCore(this.questionHashes.valueNamesInsensitive,e,e.getValueName().toLowerCase())}questionHashesRemoved(e,t,s){t&&(this.questionHashRemovedCore(this.questionHashes.names,e,t),this.questionHashRemovedCore(this.questionHashes.namesInsensitive,e,t.toLowerCase())),s&&(this.questionHashRemovedCore(this.questionHashes.valueNames,e,s),this.questionHashRemovedCore(this.questionHashes.valueNamesInsensitive,e,s.toLowerCase()))}questionHashAddedCore(e,t,s){var i=e[s];if(i){var i=e[s];0>i.indexOf(t)&&i.push(t)}else e[s]=[t]}questionHashRemovedCore(e,t,s){var i=e[s];if(i){var r=i.indexOf(t);r>-1&&i.splice(r,1),0==i.length&&delete e[s]}}panelAdded(e,t,s,i){e.name||(e.name=this.generateNewName(this.getAllPanels(!1,!0),"panel")),this.questionHashesPanelAdded(e),this.updateVisibleIndexes(e.page),this.canFireAddElement()&&this.onPanelAdded.fire(this,{panel:e,name:e.name,index:t,parent:s,page:i,parentPanel:s,rootPanel:i})}panelRemoved(e){this.updateVisibleIndexes(e.page),this.onPanelRemoved.fire(this,{panel:e,name:e.name}),this.updateLazyRenderingRowsOnRemovingElements()}validateQuestion(e,t,s){if(!this.onValidateQuestion.isEmpty){var i={name:e.name,question:e,value:e.value,errors:t,error:null};this.onValidateQuestion.fire(this,i),i.error&&t.push(new tA(i.error,this))}s&&this.beforeSettingQuestionErrors(e,t)}validatePanel(e,t,s){if(e.isPanel&&!this.onValidatePanel.isEmpty){let s={name:e.name,panel:e,error:null,errors:t};this.onValidatePanel.fire(this,s),s.error&&t.push(new tA(s.error,this))}s&&this.makeRequiredErrorsInvisible(t)}processHtml(e,t){t||(t="");var s={html:e,reason:t};return this.onProcessHtml.fire(this,s),this.processText(s.html,!0)}processText(e,t){return this.processTextEx({text:e,returnDisplayValue:t,doEncoding:!1}).text}processTextEx(e){let t=void 0===e.doEncoding?tp.web.encodeUrlParams:e.doEncoding,s=e.text;(e.runAtDesign||!this.isDesignMode)&&(s=this.textPreProcessor.process(s,!0===e.returnDisplayValue,t,e.replaceUndefinedValues));let i={text:s,hasAllValuesOnLastRun:!0};return i.hasAllValuesOnLastRun=this.textPreProcessor.hasAllValuesOnLastRun,i}get textPreProcessor(){return this.textPreProcessorValue||(this.textPreProcessorValue=new t4,this.textPreProcessorValue.onProcess=e=>{this.getProcessedTextValue(e)}),this.textPreProcessorValue}getSurveyMarkdownHtml(e,t,s){let i={element:e,text:t,name:s,html:null};return this.onTextMarkdown.fire(this,i),i.html}getCorrectedAnswerCount(){return this.getCorrectAnswerCount()}getCorrectAnswerCount(){return this.getCorrectedAnswerCountCore(!0)}getQuizQuestionCount(){for(var e=this.getQuizQuestions(),t=0,s=0;s<e.length;s++)t+=e[s].quizQuestionCount;return t}getInCorrectedAnswerCount(){return this.getIncorrectAnswerCount()}getInCorrectAnswerCount(){return this.getIncorrectAnswerCount()}getIncorrectAnswerCount(){return this.getCorrectedAnswerCountCore(!1)}onCorrectQuestionAnswer(e,t){this.onIsAnswerCorrect.isEmpty||(t.question=e,this.onIsAnswerCorrect.fire(this,t))}getCorrectedAnswerCountCore(e){var t=this.getQuizQuestions(),s=0;for(let i=0;i<t.length;i++){let r=t[i],n=r.correctAnswerCount;e?s+=n:s+=r.quizQuestionCount-n}return s}getCorrectedAnswers(){return this.getCorrectedAnswerCount()}getInCorrectedAnswers(){return this.getInCorrectedAnswerCount()}get showTimerPanel(){return this.showTimer?this.timerLocation:"none"}set showTimerPanel(e){this.showTimer="none"!==e,this.showTimer&&(this.timerLocation=e)}get showTimer(){return this.getPropertyValue("showTimer")}set showTimer(e){this.setPropertyValue("showTimer",e)}get timerLocation(){return this.getPropertyValue("timerLocation")}set timerLocation(e){this.setPropertyValue("timerLocation",e)}get isTimerPanelShowingOnTop(){return this.showTimer&&"top"===this.timerLocation}get isTimerPanelShowingOnBottom(){return this.showTimer&&"bottom"===this.timerLocation}get timerInfoMode(){return this.getTimerInfoVal(this.getPropertyValue("timerInfoMode"))}set timerInfoMode(e){this.setPropertyValue("timerInfoMode",e)}getTimerInfoVal(e){return"all"===e?"combined":e}get showTimerPanelMode(){let e=this.timerInfoMode;return"combined"===e?"all":e}set showTimerPanelMode(e){this.timerInfoMode=this.getTimerInfoVal(e)}updateGridColumns(){this.pages.forEach(e=>e.updateGridColumns())}get widthMode(){return this.getPropertyValue("widthMode")}set widthMode(e){this.setPropertyValue("widthMode",e)}setCalculatedWidthModeUpdater(){this.isLoadingFromJson||(this.calculatedWidthModeUpdater&&this.calculatedWidthModeUpdater.dispose(),this.calculatedWidthModeUpdater=new ec(()=>this.calculateWidthMode()),this.calculatedWidthMode=this.calculatedWidthModeUpdater)}calculateWidthMode(){if("auto"==this.widthMode){let e=!1;return this.pages.forEach(t=>{t.needResponsiveWidth()&&(e=!0)}),e?"responsive":"static"}return this.widthMode}get width(){return this.getPropertyValue("width")}set width(e){this.setPropertyValue("width",e)}get renderedWidth(){let e="static"==this.getPropertyValue("calculatedWidthMode"),t=this.getPropertyValue("width");if(this.isScaled&&this.responsiveStartWidth>1){let s=this.responsiveStartWidth;try{t=t||this.staticStartWidth,s=isNaN(t)?parseFloat(t.toString().replace("px","")):t}catch(e){}return(e?s:this.responsiveStartWidth)*this.widthScale/100+"px"}return t&&!isNaN(t)&&(t+="px"),e&&t||void 0}setStaticStartWidth(e){this.staticStartWidth=e}setResponsiveStartWidth(e){this.responsiveStartWidth=e}get isScaled(){return Math.abs(this.widthScale-100)>.001}get timerInfo(){return this.getTimerInfo()}get timerClock(){let e,t;if(this.currentPage){let{spent:s,limit:i,minorSpent:r,minorLimit:n}=this.getTimerInfo();e=i>0?this.getDisplayClockTime(i-s):this.getDisplayClockTime(s),void 0!==r&&(t=n>0?this.getDisplayClockTime(n-r):this.getDisplayClockTime(r))}return{majorText:e,minorText:t}}get timerInfoText(){let e={text:this.getTimerInfoText()};this.onTimerPanelInfoText.fire(this,e);var t=new ej(this,!0);return t.text=e.text,t.textOrHtml}getTimerInfo(){let e=this.currentPage;if(!e)return{spent:0,limit:0};let t=e.timeSpent,s=this.timeSpent,i=e.getMaxTimeToFinish(),r=this.timeLimit;return"page"==this.timerInfoMode?{spent:t,limit:i}:"survey"==this.timerInfoMode?{spent:s,limit:r}:i>0&&r>0?{spent:t,limit:i,minorSpent:s,minorLimit:r}:i>0?{spent:t,limit:i,minorSpent:s}:r>0?{spent:s,limit:r,minorSpent:t}:{spent:t,minorSpent:s}}getTimerInfoText(){var e=this.currentPage;if(!e)return"";var t=this.getDisplayTime(e.timeSpent),s=this.getDisplayTime(this.timeSpent),i=e.getMaxTimeToFinish(),r=this.getDisplayTime(i),n=this.getDisplayTime(this.timeLimit);return"page"==this.timerInfoMode?this.getTimerInfoPageText(e,t,r):"survey"==this.timerInfoMode?this.getTimerInfoSurveyText(s,n):"combined"==this.timerInfoMode?i<=0&&this.timeLimit<=0?this.getLocalizationFormatString("timerSpentAll",t,s):i>0&&this.timeLimit>0?this.getLocalizationFormatString("timerLimitAll",t,r,s,n):this.getTimerInfoPageText(e,t,r)+" "+this.getTimerInfoSurveyText(s,n):""}getTimerInfoPageText(e,t,s){return e&&e.getMaxTimeToFinish()>0?this.getLocalizationFormatString("timerLimitPage",t,s):this.getLocalizationFormatString("timerSpentPage",t,s)}getTimerInfoSurveyText(e,t){let s=this.timeLimit>0?"timerLimitSurvey":"timerSpentSurvey";return this.getLocalizationFormatString(s,e,t)}getDisplayClockTime(e){e<0&&(e=0);let t=Math.floor(e/60),s=e%60,i=s.toString();return s<10&&(i="0"+i),`${t}:${i}`}getDisplayTime(e){let t=Math.floor(e/60),s=e%60,i="";return(t>0&&(i+=t+" "+this.getLocalizationString("timerMin")),i&&0==s)?i:(i&&(i+=" "),i+s+" "+this.getLocalizationString("timerSec"))}get timerModel(){return this.timerModelValue}startTimer(){this.isEditMode&&this.timerModel.start()}startTimerFromUI(){this.showTimer&&"running"===this.state&&this.startTimer()}stopTimer(){this.timerModel.stop()}get timeSpent(){return this.timerModel.spent}set timeSpent(e){this.timerModel.spent=e}get timeLimit(){return this.getPropertyValue("timeLimit",0)}set timeLimit(e){this.setPropertyValue("timeLimit",e)}get maxTimeToFinish(){return this.timeLimit}set maxTimeToFinish(e){this.timeLimit=e}get timeLimitPerPage(){return this.getPropertyValue("timeLimitPerPage",0)}set timeLimitPerPage(e){this.setPropertyValue("timeLimitPerPage",e)}get maxTimeToFinishPage(){return this.timeLimitPerPage}set maxTimeToFinishPage(e){this.timeLimitPerPage=e}doTimer(e){if(this.onTimerTick.fire(this,{}),this.timeLimit>0&&this.timeLimit<=this.timeSpent&&(this.timeSpent=this.timeLimit,this.tryComplete()),e){var t=e.getMaxTimeToFinish();t>0&&t==e.timeSpent&&(this.isLastPage?this.tryComplete():this.nextPage())}}get inSurvey(){return!0}getSurveyData(){return this}getSurvey(){return this}getTextProcessor(){return this}getObjects(e,t){var s=[];return Array.prototype.push.apply(s,this.getPagesByNames(e)),Array.prototype.push.apply(s,this.getQuestionsByNames(t)),s}setTriggerValue(e,t,s){if(e){if(s)this.setVariable(e,t);else{var i=this.getQuestionByName(e);if(this.startSetValueFromTrigger(),i)i.value=t;else{var r=new A,n=r.getFirstName(e);if(n==e)this.setValue(e,t);else{if(!this.getQuestionByName(n))return;var a=this.getUnbindValue(this.getFilteredValues());r.setValue(a,e,t),this.setValue(n,a[n])}}this.finishSetValueFromTrigger()}}}copyTriggerValue(e,t,s){let i;e&&t&&(i=s?this.processText("{"+t+"}",!0):new A().getValue(t,this.getFilteredValues()),this.setTriggerValue(e,i,!1))}triggerExecuted(e){this.onTriggerExecuted.fire(this,{trigger:e})}get isSettingValueFromTrigger(){return this.setValueFromTriggerCounter>0}startSetValueFromTrigger(){this.setValueFromTriggerCounter++}finishSetValueFromTrigger(){this.setValueFromTriggerCounter--}startMovingQuestion(){this.isMovingQuestion=!0}stopMovingQuestion(){this.isMovingQuestion=!1}get isQuestionDragging(){return this.isMovingQuestion}startMovingPage(){this.isMovingPage=!0}stopMovingPage(){this.isMovingPage=!1}focusQuestion(e){return this.focusQuestionByInstance(this.getQuestionByName(e,!0))}focusQuestionByInstance(e,t=!1){var s;if(!e||!e.isVisible||!e.page||(null===(s=this.focusingQuestionInfo)||void 0===s?void 0:s.question)===e)return!1;this.focusingQuestionInfo={question:e,onError:t},this.skippedPages.push({from:this.currentPage,to:e.page});let i=this.activePage!==e.page&&!e.page.isStartPage;return i&&(this.currentPage=e.page,this.isSingleVisibleQuestion&&!this.isDesignMode&&(this.currentSingleQuestion=e)),i||this.focusQuestionInfo(),!0}focusQuestionInfo(){var e;let t=null===(e=this.focusingQuestionInfo)||void 0===e?void 0:e.question;t&&!t.isDisposed&&t.focus(this.focusingQuestionInfo.onError),this.focusingQuestionInfo=void 0}questionEditFinishCallback(e,t){let s=this.enterKeyAction||tp.enterKeyAction;if("loseFocus"==s&&t.target.blur(),"moveToNextEditor"==s){let s=this.currentPage.questions,i=s.indexOf(e);i>-1&&i<s.length-1?s[i+1].focus():t.target.blur()}}elementWrapperComponentNameCore(e,t,s,i,r){if(this.onElementWrapperComponentName.isEmpty)return e;let n={componentName:e,element:t,wrapperName:s,reason:i,item:r};return this.onElementWrapperComponentName.fire(this,n),n.componentName}elementWrapperDataCore(e,t,s,i,r){if(this.onElementWrapperComponentData.isEmpty)return e;let n={data:e,element:t,wrapperName:s,reason:i,item:r};return this.onElementWrapperComponentData.fire(this,n),n.data}getElementWrapperComponentName(e,t){let s="logo-image"===t?"sv-logo-image":sZ.TemplateRendererComponentName;return this.elementWrapperComponentNameCore(s,e,"component",t)}getQuestionContentWrapperComponentName(e){return this.elementWrapperComponentNameCore(sZ.TemplateRendererComponentName,e,"content-component")}getRowWrapperComponentName(e){return this.elementWrapperComponentNameCore(sZ.TemplateRendererComponentName,e,"row")}getItemValueWrapperComponentName(e,t){return this.elementWrapperComponentNameCore(sZ.TemplateRendererComponentName,t,"itemvalue",void 0,e)}getElementWrapperComponentData(e,t){return this.elementWrapperDataCore(e,e,"component",t)}getRowWrapperComponentData(e){return this.elementWrapperDataCore(e,e,"row")}getItemValueWrapperComponentData(e,t){return this.elementWrapperDataCore(e,t,"itemvalue",void 0,e)}getMatrixCellTemplateData(e){let t=e.question;return this.elementWrapperDataCore(t,t,"cell")}searchText(e){e&&(e=e.toLowerCase());for(var t=[],s=0;s<this.pages.length;s++)this.pages[s].searchText(e,t);return t}getSkeletonComponentName(e){return this.skeletonComponentName}addLayoutElement(e){let t=this.removeLayoutElement(e.id);return this.layoutElements.push(e),t}findLayoutElement(e){return this.layoutElements.filter(t=>t.id===e)[0]}removeLayoutElement(e){let t=this.findLayoutElement(e);if(t){let e=this.layoutElements.indexOf(t);this.layoutElements.splice(e,1)}return t}getContainerContent(e){let t=[];for(let s of this.layoutElements)if("display"!==this.mode&&s0(s.id,"timerpanel"))"header"===e&&this.isTimerPanelShowingOnTop&&!this.isStartPageActive&&t.push(s),"footer"===e&&this.isTimerPanelShowingOnBottom&&!this.isStartPageActive&&t.push(s);else if("running"===this.state&&s0(s.id,this.progressBarComponentName)){if("singlePage"!=this.questionsOnPageMode||"questions"==this.progressBarType){let i=this.findLayoutElement("advanced-header"),r=i&&i.data,n=!r||r.hasBackground;s0(this.progressBarLocation,"aboveHeader")&&(n=!1),s0(this.progressBarLocation,"belowHeader")&&(n=!0),"header"!==e||n||(s.index=-150,this.isShowProgressBarOnTop&&!this.isStartPageActive&&t.push(s)),"center"===e&&n&&(s.index&&delete s.index,this.isShowProgressBarOnTop&&!this.isStartPageActive&&t.push(s)),"footer"===e&&this.isShowProgressBarOnBottom&&!this.isStartPageActive&&t.push(s)}}else s0(s.id,"buttons-navigation")?("contentTop"===e&&-1!==["top","both"].indexOf(this.isNavigationButtonsShowing)&&t.push(s),"contentBottom"===e&&-1!==["bottom","both"].indexOf(this.isNavigationButtonsShowing)&&t.push(s)):"running"===this.state&&s0(s.id,"toc-navigation")&&this.showTOC?("left"===e&&-1!==["left","both"].indexOf(this.tocLocation)&&t.push(s),"right"===e&&-1!==["right","both"].indexOf(this.tocLocation)&&t.push(s)):s0(s.id,"advanced-header")?("running"===this.state||"starting"===this.state||!0===this.showHeaderOnCompletePage&&"completed"===this.state)&&s.container===e&&t.push(s):(Array.isArray(s.container)&&-1!==s.container.indexOf(e)||s.container===e)&&t.push(s);return t.sort((e,t)=>(e.index||0)-(t.index||0)),t.forEach(e=>{e.getData&&(e.data=e.getData())}),t}processPopupVisiblityChanged(e,t,s){this.onPopupVisibleChanged.fire(this,{question:e,popup:t,visible:s})}processOpenDropdownMenu(e,t){let s=Object.assign({question:e},t);this.onOpenDropdownMenu.fire(this,s),t.menuType=s.menuType}getCssTitleExpandableSvg(){return null}applyTheme(e){if(e){if(Object.keys(e).forEach(t=>{"header"!==t&&("isPanelless"===t?this.isCompact=e[t]:this[t]=e[t])}),"header"in e&&!e.headerView&&(this.headerView="advanced"),"basic"!==this.headerView){this.removeLayoutElement("advanced-header");let t=new sQ;t.fromTheme(e),this.insertAdvancedHeader(t)}this.themeChanged(e)}}themeChanged(e){this.getAllQuestions().forEach(t=>t.themeChanged(e))}dispose(){if(this.unConnectEditingObj(),this.removeScrollEventListener(),this.destroyResizeObserver(),this.rootElement=void 0,this.layoutElements){for(var e=0;e<this.layoutElements.length;e++)this.layoutElements[e].data&&this.layoutElements[e].data!==this&&this.layoutElements[e].data.dispose&&this.layoutElements[e].data.dispose();this.layoutElements.splice(0,this.layoutElements.length)}if(super.dispose(),this.editingObj=null,this.pages){this.currentPage=null;for(var e=0;e<this.pages.length;e++)this.pages[e].setSurveyImpl(void 0),this.pages[e].dispose();this.pages.splice(0,this.pages.length),this.disposeCallback&&this.disposeCallback()}}_isElementShouldBeSticky(e){if(!e)return!1;let t=this.rootElement.querySelector(e);return!!t&&this.rootElement.scrollTop>0&&t.getBoundingClientRect().y<=this.rootElement.getBoundingClientRect().y}onScroll(){this.rootElement&&(this._isElementShouldBeSticky(".sv-components-container-center")?this.rootElement.classList&&this.rootElement.classList.add("sv-root--sticky-top"):this.rootElement.classList&&this.rootElement.classList.remove("sv-root--sticky-top")),this.onScrollCallback&&this.onScrollCallback()}addScrollEventListener(){var e;this.scrollHandler=()=>{this.onScroll()},this.rootElement.addEventListener("scroll",this.scrollHandler),this.rootElement.getElementsByTagName("form")[0]&&this.rootElement.getElementsByTagName("form")[0].addEventListener("scroll",this.scrollHandler),this.css.rootWrapper&&(null===(e=this.rootElement.getElementsByClassName(this.css.rootWrapper)[0])||void 0===e||e.addEventListener("scroll",this.scrollHandler))}removeScrollEventListener(){var e;this.rootElement&&this.scrollHandler&&(this.rootElement.removeEventListener("scroll",this.scrollHandler),this.rootElement.getElementsByTagName("form")[0]&&this.rootElement.getElementsByTagName("form")[0].removeEventListener("scroll",this.scrollHandler),this.css.rootWrapper&&(null===(e=this.rootElement.getElementsByClassName(this.css.rootWrapper)[0])||void 0===e||e.removeEventListener("scroll",this.scrollHandler)))}}function s0(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()}sZ.TemplateRendererComponentName="sv-template-renderer",sZ.platform="unknown",ey([c()],sZ.prototype,"completedCss",void 0),ey([c()],sZ.prototype,"completedBeforeCss",void 0),ey([c()],sZ.prototype,"loadingBodyCss",void 0),ey([c()],sZ.prototype,"containerCss",void 0),ey([c({onSet:(e,t)=>{t.updateCss()}})],sZ.prototype,"fitToContainer",void 0),ey([c({onSet:(e,t)=>{if("basic"===e)t.removeLayoutElement("advanced-header");else if(!t.findLayoutElement("advanced-header")){let e=new sQ;t.insertAdvancedHeader(e)}}})],sZ.prototype,"headerView",void 0),ey([c()],sZ.prototype,"showBrandInfo",void 0),ey([c()],sZ.prototype,"enterKeyAction",void 0),ey([c()],sZ.prototype,"lazyRenderFirstBatchSizeValue",void 0),ey([c({defaultValue:{}})],sZ.prototype,"cssVariables",void 0),ey([c()],sZ.prototype,"_isMobile",void 0),ey([c()],sZ.prototype,"_isCompact",void 0),ey([c({onSet:(e,t)=>{t.updateCss()}})],sZ.prototype,"backgroundImage",void 0),ey([c()],sZ.prototype,"backgroundImageFit",void 0),ey([c({onSet:(e,t)=>{t.updateCss()}})],sZ.prototype,"backgroundImageAttachment",void 0),ey([c()],sZ.prototype,"wrapperFormCss",void 0),ey([c({getDefaultValue:e=>"buttons"===e.progressBarType})],sZ.prototype,"progressBarShowPageTitles",void 0),ey([c()],sZ.prototype,"progressBarShowPageNumbers",void 0),ey([c()],sZ.prototype,"progressBarInheritWidthFrom",void 0),ey([c({defaultValue:!0})],sZ.prototype,"validationEnabled",void 0),ey([c()],sZ.prototype,"rootCss",void 0),ey([c({onSet:(e,t)=>{t.updateGridColumns()}})],sZ.prototype,"gridLayoutEnabled",void 0),ey([c()],sZ.prototype,"calculatedWidthMode",void 0),ey([c({defaultValue:100,onSet(e,t,s){t.pages.forEach(e=>e.updateRootStyle())}})],sZ.prototype,"widthScale",void 0),ey([c()],sZ.prototype,"staticStartWidth",void 0),ey([c()],sZ.prototype,"responsiveStartWidth",void 0),ey([p()],sZ.prototype,"layoutElements",void 0),E.addClass("survey",[{name:"locale",choices:()=>h.getLocales(!0),onGetValue:e=>e.locale==h.defaultLocale?null:e.locale},{name:"title",serializationProperty:"locTitle",dependsOn:"locale"},{name:"description:text",serializationProperty:"locDescription",dependsOn:"locale"},{name:"logo:file",serializationProperty:"locLogo"},{name:"logoWidth",default:"auto",minValue:0},{name:"logoHeight",default:"40px",minValue:0},{name:"logoFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"logoPosition",default:"left",choices:["none","left","right","top","bottom"]},{name:"autoFocusFirstQuestion:boolean",alternativeName:"focusFirstQuestionAutomatic"},{name:"autoFocusFirstError:boolean",default:!0,alternativeName:"focusOnFirstError"},{name:"completedHtml:html",serializationProperty:"locCompletedHtml"},{name:"completedBeforeHtml:html",serializationProperty:"locCompletedBeforeHtml"},{name:"completedHtmlOnCondition:htmlconditions",className:"htmlconditionitem",isArray:!0},{name:"loadingHtml:html",serializationProperty:"locLoadingHtml"},{name:"pages:surveypages",className:"page",isArray:!0,onSerializeValue:e=>e.originalPages||e.pages},{name:"elements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1,onGetValue:function(e){return null},onSetValue:function(e,t,s){e.pages.splice(0,e.pages.length);var i=e.addNewPage("");s.toObject({questions:t},i,null==s?void 0:s.options)}},{name:"triggers:triggers",baseClassName:"surveytrigger",classNamePart:"trigger"},{name:"calculatedValues:calculatedvalues",className:"calculatedvalue",isArray:!0},{name:"sjsVersion",visible:!1},{name:"surveyId",visible:!1},{name:"surveyPostId",visible:!1},{name:"surveyShowDataSaving:boolean",visible:!1},"cookieName",{name:"partialSendEnabled:boolean",alternativeName:"sendResultOnPageNext"},{name:"showNavigationButtons:boolean",default:!0},{name:"navigationButtonsLocation",default:"bottom",choices:["top","bottom","topBottom"]},{name:"showPrevButton:boolean",default:!0,visibleIf:e=>"none"!==e.showNavigationButtons},{name:"showTitle:boolean",default:!0},{name:"showPageTitles:boolean",default:!0},{name:"showCompletePage:boolean",default:!0,alternativeName:"showCompletedPage"},"navigateToUrl",{name:"navigateToUrlOnCondition:urlconditions",className:"urlconditionitem",isArray:!0},{name:"questionOrder",alternativeName:"questionsOrder",default:"initial",choices:["initial","random"]},{name:"matrixDragHandleArea",visible:!1,default:"entireItem",choices:["entireItem","icon"]},"showPageNumbers:boolean",{name:"showQuestionNumbers",default:"off",choices:["on","onPage","off"]},{name:"questionTitleLocation",default:"top",choices:["top","bottom","left"]},{name:"questionDescriptionLocation",default:"underTitle",choices:["underInput","underTitle"]},{name:"questionErrorLocation",default:"top",choices:["top","bottom"]},{name:"showProgressBar:boolean",default:!1,onSetValue:(e,t,s)=>{e&&e.setShowProgressBar(t)}},{name:"progressBarLocation",default:"auto",choices:["auto","aboveheader","belowheader","bottom","topbottom"]},{name:"progressBarType",default:"pages",choices:["pages","questions","requiredQuestions","correctQuestions"],visibleIf:e=>e.showProgressBar},{name:"progressBarShowPageTitles:switch",category:"navigation",visibleIf:e=>e.showProgressBar&&"pages"===e.progressBarType},{name:"progressBarShowPageNumbers:switch",default:!1,category:"navigation",visibleIf:e=>e.showProgressBar&&"pages"===e.progressBarType},{name:"progressBarInheritWidthFrom",default:"container",choices:["container","survey"],category:"navigation",visibleIf:e=>e.showProgressBar&&"pages"===e.progressBarType},{name:"showTOC:switch",default:!1},{name:"tocLocation",default:"left",choices:["left","right"],dependsOn:["showTOC"],visibleIf:e=>!!e&&e.showTOC},{name:"readOnly:boolean",default:!1},{name:"mode",default:"edit",choices:["edit","display"],visible:!1},{name:"storeOthersAsComment:boolean",default:!0},{name:"maxTextLength:number",default:0,minValue:0},{name:"maxCommentLength:number",default:0,minValue:0,alternativeName:"maxOthersLength"},{name:"autoAdvanceEnabled:boolean",alternativeName:"goNextPageAutomatic",onSetValue:function(e,t){"autogonext"!==t&&(t=a.isTwoValueEquals(t,!0)),"autogonext"===t&&(t=!0),e.setPropertyValue("autoAdvanceEnabled",t)}},{name:"autoAdvanceAllowComplete:boolean",default:!0,alternativeName:"allowCompleteSurveyAutomatic",visibleIf:e=>!0===e.autoAdvanceEnabled},{name:"clearInvisibleValues",default:"onComplete",choices:["none","onComplete","onHidden","onHiddenContainer"]},{name:"checkErrorsMode",default:"onNextPage",choices:["onNextPage","onValueChanged","onComplete"]},{name:"validateVisitedEmptyFields:boolean",dependsOn:"checkErrorsMode",visibleIf:e=>"onValueChanged"===e.checkErrorsMode},{name:"textUpdateMode",default:"onBlur",choices:["onBlur","onTyping"]},{name:"autoGrowComment:boolean",default:!1},{name:"allowResizeComment:boolean",default:!0},{name:"commentAreaRows:number",minValue:1},{name:"startSurveyText",serializationProperty:"locStartSurveyText",visibleIf:e=>e.firstPageIsStartPage},{name:"pagePrevText",serializationProperty:"locPagePrevText",visibleIf:e=>"none"!==e.showNavigationButtons&&e.showPrevButton},{name:"pageNextText",serializationProperty:"locPageNextText",visibleIf:e=>"none"!==e.showNavigationButtons},{name:"completeText",serializationProperty:"locCompleteText",visibleIf:e=>"none"!==e.showNavigationButtons},{name:"previewText",serializationProperty:"locPreviewText",visibleIf:e=>e.showPreviewBeforeComplete},{name:"editText",serializationProperty:"locEditText",visibleIf:e=>e.showPreviewBeforeComplete},{name:"requiredMark",default:"*",alternativeName:"requiredText"},{name:"questionStartIndex",dependsOn:["showQuestionNumbers"],visibleIf:e=>!e||"off"!==e.showQuestionNumbers},{name:"questionTitlePattern",default:"numTitleRequire",dependsOn:["questionStartIndex","requiredMark"],choices:e=>e?e.getQuestionTitlePatternOptions():[]},{name:"questionTitleTemplate",visible:!1,isSerializable:!1,serializationProperty:"locQuestionTitleTemplate"},{name:"firstPageIsStartPage:boolean",default:!1,alternativeName:"firstPageIsStarted"},{name:"isSinglePage:boolean",default:!1,visible:!1,isSerializable:!1},{name:"questionsOnPageMode",default:"standard",choices:["standard","singlePage","questionPerPage"]},{name:"showPreviewBeforeComplete:boolean",default:!1,onSetValue:(e,t,s)=>{e&&e.setShowPreviewBeforeComplete(t)}},{name:"previewMode",default:"allQuestions",choices:["allQuestions","answeredQuestions"],visibleIf:e=>e.showPreviewBeforeComplete},{name:"showTimer:boolean"},{name:"timeLimit:number",alternativeName:"maxTimeToFinish",default:0,minValue:0,enableIf:e=>e.showTimer},{name:"timeLimitPerPage:number",alternativeName:"maxTimeToFinishPage",default:0,minValue:0,enableIf:e=>e.showTimer},{name:"timerLocation",default:"top",choices:["top","bottom"],enableIf:e=>e.showTimer},{name:"timerInfoMode",alternativeName:"showTimerPanelMode",default:"combined",choices:["page","survey","combined"],enableIf:e=>e.showTimer},{name:"showTimerPanel",visible:!1,isSerializable:!1},{name:"widthMode",default:"auto",choices:["auto","static","responsive"]},{name:"gridLayoutEnabled:boolean",default:!1},{name:"width",visibleIf:e=>"static"===e.widthMode},{name:"fitToContainer:boolean",default:!0,visible:!1},{name:"headerView",default:"basic",choices:["basic","advanced"],visible:!1},{name:"backgroundImage:file",visible:!1},{name:"backgroundImageFit",default:"cover",choices:["auto","contain","cover"],visible:!1},{name:"backgroundImageAttachment",default:"scroll",choices:["scroll","fixed"],visible:!1},{name:"backgroundOpacity:number",minValue:0,maxValue:1,default:1,visible:!1},{name:"showBrandInfo:boolean",default:!1,visible:!1}]);class s1 extends tU{get waitingChoicesByURL(){return!this.isChoicesLoaded&&this.hasChoicesUrl}get selectedItemValues(){return this.getPropertyValue("selectedItemValues")}set selectedItemValues(e){this.setPropertyValue("selectedItemValues",e)}constructor(e){super(e),this.otherItemValue=new tJ("other"),this.isSettingDefaultValue=!1,this.isSettingComment=!1,this.isRunningChoices=!1,this.isFirstLoadChoicesFromUrl=!0,this.isUpdatingChoicesDependedQuestions=!1,this._renderedChoices=[],this.renderedChoicesAnimation=new eQ(this.getRenderedChoicesAnimationOptions(),e=>{this._renderedChoices=e,this.renderedChoicesChangedCallback&&this.renderedChoicesChangedCallback()},()=>this._renderedChoices),this.headItemsCount=0,this.footItemsCount=0,this.prevIsOtherSelected=!1,this.noneItemValue=this.createDefaultItem(tp.noneItemValue,"noneText","noneItemText"),this.refuseItemValue=this.createDefaultItem(tp.refuseItemValue,"refuseText","refuseItemText"),this.dontKnowItemValue=this.createDefaultItem(tp.dontKnowItemValue,"dontKnowText","dontKnowItemText"),this.createItemValues("choices"),this.registerPropertyChangedHandlers(["choices"],()=>{this.filterItems()||this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["choicesFromQuestion","choicesFromQuestionMode","choiceValuesFromQuestion","choiceTextsFromQuestion","showNoneItem","showRefuseItem","showDontKnowItem","isUsingRestful","isMessagePanelVisible"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["hideIfChoicesEmpty"],()=>{this.onVisibleChanged()}),this.registerPropertyChangedHandlers(["selecteditemValues"],e=>{this.onSelectedItemValuesChangedHandler(e)}),this.createNewArray("visibleChoices",()=>this.updateRenderedChoices(),()=>this.updateRenderedChoices()),this.setNewRestfulProperty();var t=this.createLocalizableString("otherText",this.otherItemValue,!0,"otherItemText");this.createLocalizableString("otherErrorText",this,!0,"otherRequiredError"),this.createLocalizableString("otherPlaceholder",this,!1,!0),this.otherItemValue.locOwner=this,this.otherItemValue.setLocText(t),this.choicesByUrl.createItemValue=e=>this.createItemValue(e),this.choicesByUrl.beforeSendRequestCallback=()=>{this.onBeforeSendRequest()},this.choicesByUrl.getResultCallback=e=>{this.onLoadChoicesFromUrl(e)},this.choicesByUrl.updateResultCallback=(e,t)=>this.survey?this.survey.updateChoicesFromServer(this,e,t):e}getType(){return"selectbase"}dispose(){super.dispose();let e=this.getQuestionWithChoices();e&&e.removeDependedQuestion(this)}get otherTextAreaModel(){return this.otherTextAreaModelValue||(this.otherTextAreaModelValue=new tH(this.getOtherTextAreaOptions())),this.otherTextAreaModelValue}getOtherTextAreaOptions(){return{question:this,id:()=>this.otherId,propertyName:"otherValue",className:()=>this.cssClasses.other,placeholder:()=>this.otherPlaceholder,isDisabledAttr:()=>this.isInputReadOnly||!1,rows:()=>this.commentAreaRows,maxLength:()=>this.getOthersMaxLength(),autoGrow:()=>this.survey&&this.survey.autoGrowComment,ariaRequired:()=>this.ariaRequired||this.a11y_input_ariaRequired,ariaLabel:()=>this.ariaLabel||this.a11y_input_ariaLabel,getTextValue:()=>this.otherValue,onTextAreaChange:e=>{this.onOtherValueChange(e)},onTextAreaInput:e=>{this.onOtherValueInput(e)}}}resetDependedQuestion(){this.choicesFromQuestion=""}get otherId(){return this.id+"_other"}getCommentElementsId(){return[this.commentId,this.otherId]}getItemValueType(){return"itemvalue"}createItemValue(e,t){let s=E.createClass(this.getItemValueType(),{value:e});return s.locOwner=this,t&&(s.text=t),s}hasErrors(e=!0,t=null){return t&&!0===t.isOnValueChanged||this.clearIncorrectValues(),super.hasErrors(e,t)}get isUsingCarryForward(){return!!this.carryForwardQuestionType}get carryForwardQuestionType(){return this.getPropertyValue("carryForwardQuestionType")}setCarryForwardQuestionType(e,t){this.setPropertyValue("carryForwardQuestionType",e?"select":t?"array":void 0)}get isUsingRestful(){return this.getPropertyValueWithoutDefault("isUsingRestful")||!1}updateIsUsingRestful(){this.setPropertyValueDirectly("isUsingRestful",this.hasChoicesUrl)}supportGoNextPageError(){return!this.isOtherSelected||!!this.otherValue}isLayoutTypeSupported(e){return!0}localeChanged(){super.localeChanged(),"none"!==this.choicesOrder&&(this.updateVisibleChoices(),this.onVisibleChoicesChanged())}locStrsChanged(){super.locStrsChanged(),this.choicesFromUrl&&(tJ.locStrsChanged(this.choicesFromUrl),tJ.locStrsChanged(this.visibleChoices)),this.isUsingCarryForward&&tJ.locStrsChanged(this.visibleChoices)}updatePrevOtherErrorValue(e){let t=this.otherValue;e!==t&&(this.prevOtherErrorValue=t)}get otherValue(){return this.showCommentArea?this.otherValueCore:this.comment}set otherValue(e){this.updatePrevOtherErrorValue(e),this.showCommentArea?this.setOtherValueInternally(e):this.comment=e}get otherValueCore(){return this.getPropertyValue("otherValue")}set otherValueCore(e){this.setPropertyValue("otherValue",e)}get otherItem(){return this.otherItemValue}get isOtherSelected(){return this.hasOther&&this.getHasOther(this.renderedValue)}get isNoneSelected(){return this.showNoneItem&&this.getIsItemValue(this.renderedValue,this.noneItem)}get showNoneItem(){return this.getPropertyValue("showNoneItem")}set showNoneItem(e){this.setPropertyValue("showNoneItem",e)}get hasNone(){return this.showNoneItem}set hasNone(e){this.showNoneItem=e}get noneItem(){return this.noneItemValue}get noneText(){return this.getLocalizableStringText("noneText")}set noneText(e){this.setLocalizableStringText("noneText",e)}get locNoneText(){return this.getLocalizableString("noneText")}get showRefuseItem(){return this.getPropertyValue("showRefuseItem")}set showRefuseItem(e){this.setPropertyValue("showRefuseItem",e)}get refuseItem(){return this.refuseItemValue}get refuseText(){return this.getLocalizableStringText("refuseText")}set refuseText(e){this.setLocalizableStringText("refuseText",e)}get locRefuseText(){return this.getLocalizableString("refuseText")}get showDontKnowItem(){return this.getPropertyValue("showDontKnowItem")}set showDontKnowItem(e){this.setPropertyValue("showDontKnowItem",e)}get dontKnowItem(){return this.dontKnowItemValue}get dontKnowText(){return this.getLocalizableStringText("dontKnowText")}set dontKnowText(e){this.setLocalizableStringText("dontKnowText",e)}get locDontKnowText(){return this.getLocalizableString("dontKnowText")}createDefaultItem(e,t,s){let i=new tJ(e),r=this.createLocalizableString(t,i,!0,s);return i.locOwner=this,i.setLocText(r),i}get choicesVisibleIf(){return this.getPropertyValue("choicesVisibleIf","")}set choicesVisibleIf(e){this.setPropertyValue("choicesVisibleIf",e),this.filterItems()}get choicesEnableIf(){return this.getPropertyValue("choicesEnableIf","")}set choicesEnableIf(e){this.setPropertyValue("choicesEnableIf",e),this.filterItems()}surveyChoiceItemVisibilityChange(){this.filterItems()}runConditionCore(e,t){super.runConditionCore(e,t),this.runItemsEnableCondition(e,t),this.runItemsCondition(e,t),this.choices.forEach(s=>{s.runConditionCore(e,t)})}isTextValue(){return!0}setDefaultValue(){this.isSettingDefaultValue=!this.isValueEmpty(this.defaultValue)&&this.hasUnknownValue(this.defaultValue),this.prevOtherValue=void 0;let e=this.comment;super.setDefaultValue(),this.isSettingDefaultValue=!1,this.comment&&this.getStoreOthersAsComment()&&e!==this.comment&&(this.setValueCore(this.setOtherValueIntoValue(this.value)),this.setCommentIntoData(this.comment))}getIsMultipleValue(){return!1}convertDefaultValue(e){if(null==e||void 0==e)return e;if(this.getIsMultipleValue()){if(!Array.isArray(e))return[e]}else if(Array.isArray(e)&&e.length>0)return e[0];return e}filterItems(){if(this.isLoadingFromJson||!this.data||this.areInvisibleElementsShowing)return!1;var e=this.getDataFilteredValues(),t=this.getDataFilteredProperties();return this.runItemsEnableCondition(e,t),this.runItemsCondition(e,t)}runItemsCondition(e,t){this.setConditionalChoicesRunner();var s=this.runConditionsForItems(e,t);return this.filteredChoicesValue&&this.filteredChoicesValue.length===this.activeChoices.length&&(this.filteredChoicesValue=void 0),s&&(this.onVisibleChoicesChanged(),this.clearIncorrectValues()),s}runItemsEnableCondition(e,t){this.setConditionalEnableChoicesRunner(),tJ.runEnabledConditionsForItems(this.activeChoices,this.conditionChoicesEnableIfRunner,e,t,(e,t)=>t&&this.onEnableItemCallBack(e))&&this.clearDisabledValues(),this.onAfterRunItemsEnableCondition()}onAfterRunItemsEnableCondition(){}onEnableItemCallBack(e){return!0}onSelectedItemValuesChangedHandler(e){var t;null===(t=this.survey)||void 0===t||t.loadedChoicesFromServer(this)}getItemIfChoicesNotContainThisValue(e,t){return this.waitingChoicesByURL?this.createItemValue(e,t):null}getSingleSelectedItem(){let e=this.selectedItemValues;if(this.isEmpty())return null;let t=tJ.getItemByValue(this.visibleChoices,this.value);return this.onGetSingleSelectedItem(t),t||e&&this.value==e.id||this.updateSelectedItemValues(),t||e||(this.isOtherSelected?this.otherItem:this.getItemIfChoicesNotContainThisValue(this.value))}onGetSingleSelectedItem(e){}getMultipleSelectedItems(){return[]}setConditionalChoicesRunner(){this.choicesVisibleIf?(this.conditionChoicesVisibleIfRunner||(this.conditionChoicesVisibleIfRunner=new el(this.choicesVisibleIf)),this.conditionChoicesVisibleIfRunner.expression=this.choicesVisibleIf):this.conditionChoicesVisibleIfRunner=null}setConditionalEnableChoicesRunner(){this.choicesEnableIf?(this.conditionChoicesEnableIfRunner||(this.conditionChoicesEnableIfRunner=new el(this.choicesEnableIf)),this.conditionChoicesEnableIfRunner.expression=this.choicesEnableIf):this.conditionChoicesEnableIfRunner=null}canSurveyChangeItemVisibility(){return!!this.survey&&this.survey.canChangeChoiceItemsVisibility()}changeItemVisibility(){return this.canSurveyChangeItemVisibility()?(e,t)=>this.survey.getChoiceItemVisibility(this,e,t):null}runConditionsForItems(e,t){this.filteredChoicesValue=[];let s=this.changeItemVisibility();return tJ.runConditionsForItems(this.activeChoices,this.getFilteredChoices(),this.areInvisibleElementsShowing?null:this.conditionChoicesVisibleIfRunner,e,t,!this.survey||!this.survey.areInvisibleElementsShowing,(e,t)=>s?s(e,t):t)}getHasOther(e){return this.getIsItemValue(e,this.otherItem)}getIsItemValue(e,t){return e===t.value}get validatedValue(){return this.rendredValueToDataCore(this.value)}createRestful(){return new tZ}setNewRestfulProperty(){this.setPropertyValue("choicesByUrl",this.createRestful()),this.choicesByUrl.owner=this,this.choicesByUrl.loadingOwner=this}get autoOtherMode(){return this.getPropertyValue("autoOtherMode")}set autoOtherMode(e){this.setPropertyValue("autoOtherMode",e)}getQuestionComment(){return this.showCommentArea?super.getQuestionComment():this.otherValueCore?this.otherValueCore:this.hasComment||this.getStoreOthersAsComment()?super.getQuestionComment():this.otherValueCore}selectOtherValueFromComment(e){e&&(this.prevIsOtherSelected=!0),this.value=e?this.otherItem.value:void 0}setQuestionComment(e){if(this.updatePrevOtherErrorValue(e),this.showCommentArea){super.setQuestionComment(e);return}this.onUpdateCommentOnAutoOtherMode(e),this.getStoreOthersAsComment()?super.setQuestionComment(e):this.setOtherValueInternally(e),this.updateChoicesDependedQuestions()}onUpdateCommentOnAutoOtherMode(e){if(!this.autoOtherMode)return;this.prevOtherValue=void 0;let t=this.isOtherSelected;(!t&&e||t&&!e)&&this.selectOtherValueFromComment(!!e)}setOtherValueInternally(e){this.isSettingComment||e==this.otherValueCore||(this.isSettingComment=!0,this.otherValueCore=e,this.isOtherSelected&&!this.isRenderedValueSetting&&(this.value=this.rendredValueToData(this.renderedValue)),this.isSettingComment=!1)}clearValue(e){super.clearValue(e),this.prevOtherValue=void 0,this.selectedItemValues=void 0}updateCommentFromSurvey(e){super.updateCommentFromSurvey(e),this.prevOtherValue=void 0}get renderedValue(){return this.getPropertyValue("renderedValue",null)}set renderedValue(e){if(!this.isReadOnlyAttr){this.setPropertyValue("renderedValue",e);var e=this.rendredValueToData(e);this.isTwoValueEquals(e,this.value)||(this.value=e)}}setQuestionValue(e,t=!0,s=!0){if(!(this.isLoadingFromJson||this.isTwoValueEquals(this.value,e))&&(super.setQuestionValue(e,t),this.setPropertyValue("renderedValue",this.rendredValueFromData(e)),this.updateChoicesDependedQuestions(),!this.hasComment&&s)){var i=this.isOtherSelected;if(i&&this.prevOtherValue){var r=this.prevOtherValue;this.prevOtherValue=void 0,this.otherValue=r}!i&&this.otherValue&&(this.getStoreOthersAsComment()&&!this.autoOtherMode&&(this.prevOtherValue=this.otherValue),this.makeCommentEmpty=!0,this.otherValueCore="",this.setPropertyValue("comment",""))}}setValueCore(e){super.setValueCore(e),this.makeCommentEmpty&&(this.setCommentIntoData(""),this.makeCommentEmpty=!1)}setNewValue(e){e=this.valueFromData(e),(this.choicesByUrl.isRunning||this.choicesByUrl.isWaitingForParameters)&&this.isValueEmpty(e)||(this.cachedValueForUrlRequests=e),super.setNewValue(e)}valueFromData(e){let t=tJ.getItemByValue(this.activeChoices,e);return t?t.value:super.valueFromData(e)}rendredValueFromData(e){return this.getStoreOthersAsComment()?e:this.renderedValueFromDataCore(e)}rendredValueToData(e){return this.getStoreOthersAsComment()?e:this.rendredValueToDataCore(e)}renderedValueFromDataCore(e){return this.hasUnknownValue(e,!0,!1)?(this.otherValue=e,this.otherItem.value):this.valueFromData(e)}rendredValueToDataCore(e){return e==this.otherItem.value&&this.needConvertRenderedOtherToDataValue()&&(e=this.otherValue),e}needConvertRenderedOtherToDataValue(){let e=this.otherValue;return!!(e&&(e=e.trim()))&&this.hasUnknownValue(e,!0,!1)}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.waitingChoicesByURL&&!this.waitingGetChoiceDisplayValueResponse}updateSelectedItemValues(){if(this.waitingGetChoiceDisplayValueResponse||!this.survey||this.isEmpty())return;let e=this.value,t=Array.isArray(e)?e:[e];t.some(e=>!tJ.getItemByValue(this.choices,e))&&(this.choicesLazyLoadEnabled||this.hasChoicesUrl)&&(this.waitingGetChoiceDisplayValueResponse=!0,this.updateIsReady(),this.survey.getChoiceDisplayValue({question:this,values:t,setItems:(s,...i)=>{if(this.waitingGetChoiceDisplayValueResponse=!1,!s||!s.length){this.updateIsReady();return}let r=s.map((e,s)=>this.createItemValue(t[s],e));this.setCustomValuesIntoItems(r,i),Array.isArray(e)?this.selectedItemValues=r:this.selectedItemValues=r[0],this.updateIsReady()}}))}setCustomValuesIntoItems(e,t){Array.isArray(t)&&0!==t.length&&t.forEach(t=>{let s=t.values,i=t.propertyName;if(Array.isArray(s))for(let t=0;t<e.length&&t<s.length;t++)e[t][i]=s[t]})}hasUnknownValue(e,t=!1,s=!0,i=!1){if(!Array.isArray(e))return this.hasUnknownValueItem(e,t,s,i);for(let r=0;r<e.length;r++)if(this.hasUnknownValueItem(e,t,s,i))return!0;return!1}hasUnknownValueItem(e,t=!1,s=!0,i=!1){if(!i&&this.isValueEmpty(e)||t&&e==this.otherItem.value||this.showNoneItem&&e==this.noneItem.value||this.showRefuseItem&&e==this.refuseItem.value||this.showDontKnowItem&&e==this.dontKnowItem.value)return!1;var r=s?this.getFilteredChoices():this.activeChoices;return null==tJ.getItemByValue(r,e)}isValueDisabled(e){var t=tJ.getItemByValue(this.getFilteredChoices(),e);return!!t&&!t.isEnabled}endLoadingFromJson(){super.endLoadingFromJson(),this.updateVisibleChoices()}get choicesByUrl(){return this.getPropertyValue("choicesByUrl")}set choicesByUrl(e){e&&(this.setNewRestfulProperty(),this.choicesByUrl.fromJSON(e.toJSON()))}get choices(){return this.getPropertyValue("choices")}set choices(e){this.setPropertyValue("choices",e)}get choicesFromQuestion(){return this.getPropertyValue("choicesFromQuestion")}set choicesFromQuestion(e){var t=this.getQuestionWithChoices();this.isLockVisibleChoices=!!t&&t.name===e,t&&t.name!==e&&(t.removeDependedQuestion(this),this.isInDesignMode&&!this.isLoadingFromJson&&e&&this.setPropertyValue("choicesFromQuestion",void 0)),this.setPropertyValue("choicesFromQuestion",e),this.isLockVisibleChoices=!1}get choicesFromQuestionMode(){return this.getPropertyValue("choicesFromQuestionMode")}set choicesFromQuestionMode(e){this.setPropertyValue("choicesFromQuestionMode",e)}get choiceValuesFromQuestion(){return this.getPropertyValue("choiceValuesFromQuestion")}set choiceValuesFromQuestion(e){this.setPropertyValue("choiceValuesFromQuestion",e)}get choiceTextsFromQuestion(){return this.getPropertyValue("choiceTextsFromQuestion")}set choiceTextsFromQuestion(e){this.setPropertyValue("choiceTextsFromQuestion",e)}get hideIfChoicesEmpty(){return this.getPropertyValue("hideIfChoicesEmpty")}set hideIfChoicesEmpty(e){this.setPropertyValue("hideIfChoicesEmpty",e)}get keepIncorrectValues(){return this.getPropertyValue("keepIncorrectValues",!1)}set keepIncorrectValues(e){this.setPropertyValue("keepIncorrectValues",e)}get storeOthersAsComment(){return this.getPropertyValue("storeOthersAsComment")}set storeOthersAsComment(e){this.setPropertyValue("storeOthersAsComment",e)}hasOtherChanged(){this.onVisibleChoicesChanged()}get choicesOrder(){return this.getPropertyValue("choicesOrder")}set choicesOrder(e){(e=e.toLowerCase())!=this.choicesOrder&&(this.setPropertyValue("choicesOrder",e),this.onVisibleChoicesChanged())}get otherText(){return this.getLocalizableStringText("otherText")}set otherText(e){this.setLocalizableStringText("otherText",e),this.onVisibleChoicesChanged()}get locOtherText(){return this.getLocalizableString("otherText")}get separateSpecialChoices(){return this.getPropertyValue("separateSpecialChoices")}set separateSpecialChoices(e){this.setPropertyValue("separateSpecialChoices",e)}get otherPlaceholder(){return this.getLocalizableStringText("otherPlaceholder")}set otherPlaceholder(e){this.setLocalizableStringText("otherPlaceholder",e)}get locOtherPlaceholder(){return this.getLocalizableString("otherPlaceholder")}get otherPlaceHolder(){return this.otherPlaceholder}set otherPlaceHolder(e){this.otherPlaceholder=e}get otherErrorText(){return this.getLocalizableStringText("otherErrorText")}set otherErrorText(e){this.setLocalizableStringText("otherErrorText",e)}get locOtherErrorText(){return this.getLocalizableString("otherErrorText")}get visibleChoices(){return this.getPropertyValue("visibleChoices")}get enabledChoices(){for(var e=[],t=this.visibleChoices,s=0;s<t.length;s++)t[s].isEnabled&&e.push(t[s]);return e}updateVisibleChoices(){if(this.isLoadingFromJson||this.isDisposed)return;var e=[],t=this.calcVisibleChoices();t||(t=[]);for(var s=0;s<t.length;s++)e.push(t[s]);let i=this.visibleChoices;(!this.isTwoValueEquals(i,e)||this.choicesLazyLoadEnabled)&&(this.setArrayPropertyDirectly("visibleChoices",e),this.updateRenderedChoices())}calcVisibleChoices(){if(this.canUseFilteredChoices())return this.getFilteredChoices();var e=this.sortVisibleChoices(this.getFilteredChoices().slice());return this.addToVisibleChoices(e,this.isAddDefaultItems),e}canUseFilteredChoices(){return!this.isAddDefaultItems&&!this.showNoneItem&&!this.showRefuseItem&&!this.showDontKnowItem&&!this.hasOther&&"none"==this.choicesOrder}setCanShowOptionItemCallback(e){this.canShowOptionItemCallback=e,e&&this.onVisibleChoicesChanged()}get newItem(){return this.newItemValue}addToVisibleChoices(e,t){this.headItemsCount=0,this.footItemsCount=0,this.isEmptyActiveChoicesInDesign||this.addNewItemToVisibleChoices(e,t);let s=[];this.addNonChoicesItems(s,t),s.sort((e,t)=>e.index===t.index?0:e.index<t.index?-1:1);for(let t=0;t<s.length;t++){let i=s[t];i.index<0?(e.splice(t,0,i.item),this.headItemsCount++):(e.push(i.item),this.footItemsCount++)}}addNewItemToVisibleChoices(e,t){t&&(this.newItemValue||(this.newItemValue=this.createItemValue("newitem"),this.newItemValue.isGhost=!0,this.newItemValue.registerFunctionOnPropertyValueChanged("isVisible",()=>{this.updateVisibleChoices()})),this.newItemValue.isVisible&&!this.isUsingCarryForward&&this.canShowOptionItem(this.newItemValue,t,!1)&&(this.footItemsCount=1,e.push(this.newItemValue)))}addNonChoicesItems(e,t){this.supportNone()&&this.addNonChoiceItem(e,this.noneItem,t,this.showNoneItem,tp.specialChoicesOrder.noneItem),this.supportRefuse()&&this.addNonChoiceItem(e,this.refuseItem,t,this.showRefuseItem,tp.specialChoicesOrder.refuseItem),this.supportDontKnow()&&this.addNonChoiceItem(e,this.dontKnowItem,t,this.showDontKnowItem,tp.specialChoicesOrder.dontKnowItem),this.supportOther()&&this.addNonChoiceItem(e,this.otherItem,t,this.hasOther,tp.specialChoicesOrder.otherItem)}addNonChoiceItem(e,t,s,i,r){this.canShowOptionItem(t,s,i)&&r.forEach(s=>e.push({index:s,item:t}))}canShowOptionItem(e,t,s){let i=t&&(!this.canShowOptionItemCallback||this.canShowOptionItemCallback(e))||s;return this.canSurveyChangeItemVisibility()?this.changeItemVisibility()(e,i):i}isItemInList(e){return e===this.otherItem?this.hasOther:e===this.noneItem?this.showNoneItem:e===this.refuseItem?this.showRefuseItem:e===this.dontKnowItem?this.showDontKnowItem:e!==this.newItemValue}get isAddDefaultItems(){return tp.showDefaultItemsInCreator&&this.isInDesignMode&&!this.customWidget}getPlainData(e={includeEmpty:!0,includeQuestionTypes:!1}){var t=super.getPlainData(e);if(t){var s=Array.isArray(this.value)?this.value:[this.value];t.isNode=!0,t.data=(t.data||[]).concat(s.map((t,s)=>{var i=tJ.getItemByValue(this.visibleChoices,t),r={name:s,title:this.getLocalizationString("choices_Choice"),value:t,displayValue:this.getChoicesDisplayValue(this.visibleChoices,t),getString:e=>"object"==typeof e?JSON.stringify(e):e,isNode:!1};return i&&(e.calculations||[]).forEach(e=>{r[e.propertyName]=i[e.propertyName]}),this.isOtherSelected&&this.otherItemValue===i&&(r.isOther=!0,r.displayValue=this.otherValue),r}))}return t}getDisplayValueCore(e,t){return this.useDisplayValuesInDynamicTexts?this.getChoicesDisplayValue(this.visibleChoices,t):t}getDisplayValueEmpty(){return tJ.getTextOrHtmlByValue(this.visibleChoices,void 0)}getChoicesDisplayValue(e,t){if(t==this.otherItemValue.value)return this.otherValue?this.otherValue:this.locOtherText.textOrHtml;let s=this.getSingleSelectedItem();if(s&&this.isTwoValueEquals(s.value,t))return s.locText.textOrHtml;var i=tJ.getTextOrHtmlByValue(e,t);return""==i&&t?t:i}getDisplayArrayValue(e,t,s){var i=this.visibleChoices,r=[];let n=[];for(var o=0;o<t.length;o++)n.push(s?s(o):t[o]);if(a.isTwoValueEquals(this.value,n)&&this.getMultipleSelectedItems().forEach((e,t)=>r.push(this.getItemDisplayValue(e,n[t]))),0===r.length)for(var o=0;o<n.length;o++){let e=this.getChoicesDisplayValue(i,n[o]);e&&r.push(e)}return r.join(tp.choicesSeparator)}getItemDisplayValue(e,t){if(e===this.otherItem){if(this.hasOther&&this.showCommentArea&&t)return t;if(this.comment)return this.comment}return e.locText.textOrHtml}getFilteredChoices(){return this.filteredChoicesValue?this.filteredChoicesValue:this.activeChoices}get activeChoices(){let e=this.getCarryForwardQuestion();return"select"===this.carryForwardQuestionType?(e.addDependedQuestion(this),this.getChoicesFromSelectQuestion(e)):"array"===this.carryForwardQuestionType?(e.addDependedQuestion(this),this.getChoicesFromArrayQuestion(e)):this.isEmptyActiveChoicesInDesign?[]:this.choicesFromUrl?this.choicesFromUrl:this.getChoices()}get isMessagePanelVisible(){return this.getPropertyValue("isMessagePanelVisible",!1)}set isMessagePanelVisible(e){this.setPropertyValue("isMessagePanelVisible",e)}get isEmptyActiveChoicesInDesign(){return this.isInDesignMode&&(this.hasChoicesUrl||this.isMessagePanelVisible)}getCarryForwardQuestion(e){let t=this.findCarryForwardQuestion(e),s=this.getQuestionWithChoicesCore(t),i=s?null:this.getQuestionWithArrayValue(t);return this.setCarryForwardQuestionType(!!s,!!i),s||i?t:null}getIsReadyDependsOn(){let e=super.getIsReadyDependsOn();return this.carryForwardQuestion&&e.push(this.carryForwardQuestion),e}getQuestionWithChoices(){return this.getQuestionWithChoicesCore(this.findCarryForwardQuestion())}findCarryForwardQuestion(e){return e||(e=this.data),this.carryForwardQuestion=null,this.choicesFromQuestion&&e&&(this.carryForwardQuestion=e.findQuestionByName(this.choicesFromQuestion)),this.carryForwardQuestion}getQuestionWithChoicesCore(e){return e&&e.visibleChoices&&E.isDescendantOf(e.getType(),"selectbase")&&e!==this?e:null}getQuestionWithArrayValue(e){return e&&e.isValueArray?e:null}getChoicesFromArrayQuestion(e){if(this.isInDesignMode)return[];let t=e.value;if(!Array.isArray(t))return[];let s=[];for(var i=0;i<t.length;i++){let e=t[i];if(!a.isValueObject(e))continue;let r=this.getValueKeyName(e);if(r&&!this.isValueEmpty(e[r])){let t=this.choiceTextsFromQuestion?e[this.choiceTextsFromQuestion]:void 0;s.push(this.createItemValue(e[r],t))}}return s}getValueKeyName(e){if(this.choiceValuesFromQuestion)return this.choiceValuesFromQuestion;let t=Object.keys(e);return t.length>0?t[0]:void 0}getChoicesFromSelectQuestion(e){if(this.isInDesignMode)return[];let t=[];var s="selected"==this.choicesFromQuestionMode||"unselected"!=this.choicesFromQuestionMode&&void 0;let i=e.visibleChoices;for(var r=0;r<i.length;r++)if(!e.isBuiltInChoice(i[r])){if(void 0===s){t.push(this.copyChoiceItem(i[r]));continue}var n=e.isItemSelected(i[r]);(n&&s||!n&&!s)&&t.push(this.copyChoiceItem(i[r]))}return"selected"===this.choicesFromQuestionMode&&!this.showOtherItem&&e.isOtherSelected&&e.comment&&t.push(this.createItemValue(e.otherItem.value,e.comment)),t}copyChoiceItem(e){let t=this.createItemValue(e.value);return t.setData(e),t}get hasActiveChoices(){var e=this.visibleChoices;e&&0!=e.length||(this.onVisibleChoicesChanged(),e=this.visibleChoices);for(var t=0;t<e.length;t++)if(!this.isBuiltInChoice(e[t]))return!0;return!1}isBuiltInChoice(e){return this.isNoneItem(e)||e===this.otherItem||e===this.newItemValue}isNoneItem(e){return this.getNoneItems().indexOf(e)>-1}getNoneItems(){return[this.noneItem,this.refuseItem,this.dontKnowItem]}getChoices(){return this.choices}supportOther(){return this.isSupportProperty("showOtherItem")}supportNone(){return this.isSupportProperty("showNoneItem")}supportRefuse(){return this.isSupportProperty("showRefuseItem")}supportDontKnow(){return this.isSupportProperty("showDontKnowItem")}isSupportProperty(e){return!this.isDesignMode||this.getPropertyByName(e).visible}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),!this.hasOther||!this.isOtherSelected||this.otherValue||t&&!this.prevOtherErrorValue)return;let i=new tP(this.otherErrorText,this);i.onUpdateErrorTextCallback=e=>{e.text=this.otherErrorText},e.push(i)}setSurveyImpl(e,t){this.isRunningChoices=!0,super.setSurveyImpl(e,t),this.isRunningChoices=!1,this.runChoicesByUrl(),this.isAddDefaultItems&&this.updateVisibleChoices()}setSurveyCore(e){super.setSurveyCore(e),e&&this.choicesFromQuestion&&this.onVisibleChoicesChanged()}getStoreOthersAsComment(){return!this.isSettingDefaultValue&&!this.showCommentArea&&(!0===this.storeOthersAsComment||"default"==this.storeOthersAsComment&&(null==this.survey||this.survey.storeOthersAsComment)||this.hasChoicesUrl&&!this.choicesFromUrl)}onSurveyLoad(){this.runChoicesByUrl(),this.onVisibleChoicesChanged(),super.onSurveyLoad()}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t),e!=this.getValueName()&&this.runChoicesByUrl();let s=this.choicesFromQuestion;e&&s&&(e===s||t===s)&&(this.onVisibleChoicesChanged(),this.clearIncorrectValues())}updateValueFromSurvey(e,t){var s="";this.hasOther&&!this.isRunningChoices&&!this.choicesByUrl.isRunning&&this.getStoreOthersAsComment()&&(this.hasUnknownValue(e)&&!this.getHasOther(e)?(s=this.getCommentFromValue(e),e=this.setOtherValueIntoValue(e)):this.data&&(s=this.data.getComment(this.getValueName()))),super.updateValueFromSurvey(e,t),(this.isRunningChoices||this.choicesByUrl.isRunning)&&!this.isEmpty()&&(this.cachedValueForUrlRequests=this.value),s&&this.setNewComment(s)}getCommentFromValue(e){return e}setOtherValueIntoValue(e){return this.otherItem.value}onOtherValueInput(e){this.isInputTextUpdate?e.target&&(this.otherValue=e.target.value):this.updateCommentElements()}onOtherValueChange(e){this.otherValue=e.target.value,this.otherValue!==e.target.value&&(e.target.value=this.otherValue)}runChoicesByUrl(){if(this.updateIsUsingRestful(),this.choicesByUrl&&!this.isLoadingFromJson&&!this.isRunningChoices&&!this.isInDesignMode){var e=this.surveyImpl?this.surveyImpl.getTextProcessor():this.textProcessor;e||(e=this.survey),e&&(this.updateIsReady(),this.isRunningChoices=!0,this.choicesByUrl.run(e),this.isRunningChoices=!1)}}onBeforeSendRequest(){!0!==tp.web.disableQuestionWhileLoadingChoices||this.isReadOnly||(this.enableOnLoadingChoices=!0,this.readOnly=!0)}onLoadChoicesFromUrl(e){this.enableOnLoadingChoices&&(this.readOnly=!1);let t=[];!this.isReadOnly&&this.choicesByUrl&&this.choicesByUrl.error&&t.push(this.choicesByUrl.error);var s=null,i=!0;this.isFirstLoadChoicesFromUrl&&!this.cachedValueForUrlRequests&&this.defaultValue&&(this.cachedValueForUrlRequests=this.defaultValue,i=!1),this.isValueEmpty(this.cachedValueForUrlRequests)&&(this.cachedValueForUrlRequests=this.value);var r=this.createCachedValueForUrlRequests(this.cachedValueForUrlRequests,i);if(e&&(e.length>0||this.choicesByUrl.allowEmptyResponse)&&(s=[],tJ.setData(s,e)),s)for(var n=0;n<s.length;n++)s[n].locOwner=this;this.setChoicesFromUrl(s,t,r)}canAvoidSettChoicesFromUrl(e){return!(this.isFirstLoadChoicesFromUrl||(!e||Array.isArray(e)&&0===e.length)&&!this.isEmpty())&&a.isTwoValueEquals(this.choicesFromUrl,e)}setChoicesFromUrl(e,t,s){if(!this.canAvoidSettChoicesFromUrl(e)){if(this.isFirstLoadChoicesFromUrl=!1,this.choicesFromUrl=e,this.filterItems(),this.onVisibleChoicesChanged(),e){var i=this.updateCachedValueForUrlRequests(s,e);if(i&&!this.isReadOnly){var r=!this.isTwoValueEquals(this.value,i.value);try{this.isValueEmpty(i.value)||(this.allowNotifyValueChanged=!1,this.setQuestionValue(void 0,!0,!1)),this.allowNotifyValueChanged=r,r?this.value=i.value:this.setQuestionValue(i.value)}finally{this.allowNotifyValueChanged=!0}}}this.isReadOnly||e||this.isFirstLoadChoicesFromUrl||(this.value=null),this.errors=t,this.choicesLoaded()}}createCachedValueForUrlRequests(e,t){if(this.isValueEmpty(e))return null;if(Array.isArray(e)){for(var s=[],i=0;i<e.length;i++)s.push(this.createCachedValueForUrlRequests(e[i],!0));return s}var r=!t||!this.hasUnknownValue(e);return{value:e,isExists:r}}updateCachedValueForUrlRequests(e,t){if(this.isValueEmpty(e))return null;if(Array.isArray(e)){for(var s=[],i=0;i<e.length;i++){var r=this.updateCachedValueForUrlRequests(e[i],t);if(r&&!this.isValueEmpty(r.value)){var n=r.value,a=tJ.getItemByValue(t,r.value);a&&(n=a.value),s.push(n)}}return{value:s}}var o=e.isExists&&this.hasUnknownValue(e.value)?null:e.value,a=tJ.getItemByValue(t,o);return a&&(o=a.value),{value:o}}updateChoicesDependedQuestions(){this.isLoadingFromJson||this.isUpdatingChoicesDependedQuestions||!this.allowNotifyValueChanged||this.choicesByUrl.isRunning||(this.isUpdatingChoicesDependedQuestions=!0,this.updateDependedQuestions(),this.isUpdatingChoicesDependedQuestions=!1)}updateDependedQuestion(){this.onVisibleChoicesChanged(),this.clearIncorrectValues()}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.updateChoicesDependedQuestions()}onVisibleChoicesChanged(){this.isLoadingFromJson||this.isLockVisibleChoices||(this.updateVisibleChoices(),this.onVisibleChanged(),this.visibleChoicesChangedCallback&&this.visibleChoicesChangedCallback(),this.updateChoicesDependedQuestions())}isVisibleCore(){let e=super.isVisibleCore();if(!this.hideIfChoicesEmpty||!e)return e;var t=this.isUsingCarryForward?this.visibleChoices:this.getFilteredChoices();return!t||t.length>0}sortVisibleChoices(e){if(this.isInDesignMode)return e;var t=this.choicesOrder.toLowerCase();return"asc"==t?this.sortArray(e,1):"desc"==t?this.sortArray(e,-1):"random"==t?this.randomizeArray(e):e}sortArray(e,t){return e.sort(function(e,s){return a.compareStrings(e.calculatedText,s.calculatedText)*t})}randomizeArray(e){return a.randomizeArray(e)}get hasChoicesUrl(){return this.choicesByUrl&&!!this.choicesByUrl.url}clearIncorrectValues(){this.hasValueToClearIncorrectValues()&&this.canClearIncorrectValues()&&(this.clearIncorrectValuesCallback?this.clearIncorrectValuesCallback():this.clearIncorrectValuesCore())}canClearIncorrectValues(){return(!this.carryForwardQuestion||!!this.carryForwardQuestion.isReady)&&(!this.survey||!(this.survey.questionsByValueName(this.getValueName()).length>1))&&(!this.hasChoicesUrl||!!this.choicesFromUrl&&0!=this.choicesFromUrl.length)}hasValueToClearIncorrectValues(){return(!this.survey||!this.survey.keepIncorrectValues)&&!this.keepIncorrectValues&&!this.isEmpty()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearIncorrectValues()}isItemSelected(e){return e===this.otherItem?this.isOtherSelected:this.isItemSelectedCore(e)}isItemSelectedCore(e){return e.value===this.value}clearDisabledValues(){this.survey&&this.survey.clearDisabledChoices&&this.clearDisabledValuesCore()}clearIncorrectValuesCore(){var e=this.value;this.canClearValueAnUnknown(e)&&this.clearValue(!0)}canClearValueAnUnknown(e){return(!!this.getStoreOthersAsComment()||!this.isOtherSelected)&&this.hasUnknownValue(e,!0,!0,!0)}clearDisabledValuesCore(){this.isValueDisabled(this.value)&&this.clearValue(!0)}clearUnusedValues(){super.clearUnusedValues(),this.isOtherSelected||(this.otherValue=""),this.showCommentArea||this.getStoreOthersAsComment()||this.isOtherSelected||(this.comment="")}getColumnClass(){return new eV().append(this.cssClasses.column).append("sv-q-column-"+this.colCount,this.hasColumns).toString()}getItemIndex(e){return this.visibleChoices.indexOf(e)}getItemClass(e){let t={item:e};var s=this.getItemClassCore(e,t);return t.css=s,this.survey&&this.survey.updateChoiceItemCss(this,t),t.css}getCurrentColCount(){return this.colCount}getItemClassCore(e,t){let s=new eV().append(this.cssClasses.item).append(this.cssClasses.itemInline,!this.hasColumns&&0===this.colCount).append("sv-q-col-"+this.getCurrentColCount(),!this.hasColumns&&0!==this.colCount).append(this.cssClasses.itemOnError,this.hasCssError()),i=this.getIsDisableAndReadOnlyStyles(!e.isEnabled),r=i[0],n=i[1],a=this.isItemSelected(e)||this.isOtherSelected&&this.otherItem.value===e.value,o=!n&&!a&&!(this.survey&&this.survey.isDesignMode),l=e===this.noneItem;return t.isDisabled=n||r,t.isChecked=a,t.isNone=l,s.append(this.cssClasses.itemDisabled,n).append(this.cssClasses.itemReadOnly,r).append(this.cssClasses.itemPreview,this.isPreviewStyle).append(this.cssClasses.itemChecked,a).append(this.cssClasses.itemHover,o).append(this.cssClasses.itemNone,l).toString()}getLabelClass(e){return new eV().append(this.cssClasses.label).append(this.cssClasses.labelChecked,this.isItemSelected(e)).toString()}getControlLabelClass(e){return new eV().append(this.cssClasses.controlLabel).append(this.cssClasses.controlLabelChecked,this.isItemSelected(e)).toString()||void 0}updateRenderedChoices(){this.renderedChoices=this.onGetRenderedChoicesCallback?this.onGetRenderedChoicesCallback(this.visibleChoices):this.visibleChoices}getRenderedChoicesAnimationOptions(){return{isAnimationEnabled:()=>this.animationAllowed,getRerenderEvent:()=>this.onElementRerendered,getKey:e=>e!=this.newItemValue?e.value:this.newItemValue,getLeaveOptions:e=>{let t=this.cssClasses.itemLeave;if(this.hasColumns){let s=this.bodyItems.indexOf(e);-1!==s&&s!==this.bodyItems.length-1&&(t="")}return{cssClass:t,onBeforeRunAnimation:td,onAfterRunAnimation:tc}},getAnimatedElement:e=>e.getRootElement(),getEnterOptions:e=>{let t=this.cssClasses.itemEnter;if(this.hasColumns){let s=this.bodyItems.indexOf(e);-1!==s&&s!==this.bodyItems.length-1&&(t="")}return{cssClass:t,onBeforeRunAnimation:t=>{if(0==this.getCurrentColCount()&&this.bodyItems.indexOf(e)>=0){let e=t.parentElement.firstElementChild.offsetLeft;t.offsetLeft>e&&tu(t,{moveAnimationDuration:"0s",fadeAnimationDelay:"0s"},"--")}td(t)},onAfterRunAnimation:tc}}}}get renderedChoices(){return this._renderedChoices}set renderedChoices(e){this.renderedChoicesAnimation.sync(e)}get headItems(){let e=this.separateSpecialChoices||this.isInDesignMode?this.headItemsCount:0,t=[];for(let s=0;s<e;s++)this.renderedChoices[s]&&t.push(this.renderedChoices[s]);return t}get footItems(){let e=this.separateSpecialChoices||this.isInDesignMode?this.footItemsCount:0,t=[],s=this.renderedChoices;for(let i=0;i<e;i++)this.renderedChoices[s.length-e+i]&&t.push(this.renderedChoices[s.length-e+i]);return t}get dataChoices(){return this.renderedChoices.filter(e=>!this.isBuiltInChoice(e))}get bodyItems(){return this.hasHeadItems||this.hasFootItems?this.dataChoices:this.renderedChoices}get hasHeadItems(){return this.headItems.length>0}get hasFootItems(){return this.footItems.length>0}get itemFlowDirection(){return tp.itemFlowDirection}get columns(){if(!this.hasColumns||0===this.renderedChoices.length)return[];let e=this.getCurrentColCount(),t=this.separateSpecialChoices||this.isInDesignMode?this.dataChoices:this.renderedChoices;return"column"===this.itemFlowDirection?this.getColumnsWithColumnItemFlow(t,e):this.getColumnsWithRowItemFlow(t,e)}getColumnsWithColumnItemFlow(e,t){let s=[],i=Math.floor(e.length/t);e.length%t&&(i+=1);let r=e.length,n=t,a=0;for(let o=0;o<t;o++){let t=[];for(let s=0;s<i;s++){r<=n&&(i=1);let o=e[s+a];o&&(t.push(o),r--)}s.push(t),n--,a+=t.length}return s}getColumnsWithRowItemFlow(e,t){let s=[];for(let i=0;i<t;i++){let r=[];for(let s=i;s<e.length;s+=t)r.push(e[s]);s.push(r)}return s}getItemsColumnKey(e){return(e||[]).map(e=>e.value||"").join("")}get hasColumns(){return!this.isMobile&&this.getCurrentColCount()>1}get rowLayout(){return 0==this.getCurrentColCount()&&!(this.hasFootItems||this.hasHeadItems)}get blockedRow(){return 0==this.getCurrentColCount()&&(this.hasFootItems||this.hasHeadItems)}choicesLoaded(){this.isChoicesLoaded=!0,this.updateIsReady(),this.survey&&this.survey.loadedChoicesFromServer(this),this.loadedChoicesFromServerCallback&&this.loadedChoicesFromServerCallback()}getItemValueWrapperComponentName(e){let t=this.survey;return t?t.getItemValueWrapperComponentName(e,this):sZ.TemplateRendererComponentName}getItemValueWrapperComponentData(e){let t=this.survey;return t?t.getItemValueWrapperComponentData(e,this):e}ariaItemChecked(e){return this.renderedValue===e.value?"true":"false"}isOtherItem(e){return this.hasOther&&e.value==this.otherItem.value}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}getSelectBaseRootCss(){return new eV().append(this.getQuestionRootCss()).append(this.cssClasses.rootRow,this.rowLayout).toString()}allowMobileInDesignMode(){return!0}getAriaItemLabel(e){return e.locText.renderedHtml}getItemId(e){return this.inputId+"_"+this.getItemIndex(e)}get questionName(){return this.name+"_"+this.id}getItemEnabled(e){return!this.isDisabledAttr&&e.isEnabled}focusOtherComment(){var e;eW.FocusElement(this.otherId,!1,null===(e=this.survey)||void 0===e?void 0:e.rootElement)}onValueChanged(){super.onValueChanged(),this.isDesignMode||this.prevIsOtherSelected||!this.isOtherSelected||this.focusOtherComment(),this.prevIsOtherSelected=this.isOtherSelected}getDefaultItemComponent(){return""}get itemComponent(){return this.getPropertyValue("itemComponent",this.getDefaultItemComponent())}set itemComponent(e){this.setPropertyValue("itemComponent",e)}}ey([p()],s1.prototype,"_renderedChoices",void 0);class s2 extends s1{constructor(e){super(e)}get colCount(){return this.getPropertyValue("colCount",this.isFlowLayout?0:void 0)}set colCount(e){e<0||e>5||this.isFlowLayout||(this.setPropertyValue("colCount",e),this.fireCallback(this.colCountChangedCallback))}onParentChanged(){super.onParentChanged(),this.isFlowLayout&&this.setPropertyValue("colCount",null)}onParentQuestionChanged(){this.onVisibleChoicesChanged()}getSearchableItemValueKeys(e){e.push("choices")}}function s4(e,t){var s;if(!e)return!1;if(e.templateQuestion){let t=null===(s=e.colOwner)||void 0===s?void 0:s.data;if(!(e=e.templateQuestion).getCarryForwardQuestion(t))return!1}return e.carryForwardQuestionType===t}E.addClass("selectbase",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},"choicesFromQuestion:question_carryforward",{name:"choices:itemvalue[]",uniqueProperty:"value",baseValue:function(){return u("choices_Item")},dependsOn:"choicesFromQuestion",visibleIf:e=>!e.choicesFromQuestion},{name:"choicesFromQuestionMode",default:"all",choices:["all","selected","unselected"],dependsOn:"choicesFromQuestion",visibleIf:e=>s4(e,"select")},{name:"choiceValuesFromQuestion",dependsOn:"choicesFromQuestion",visibleIf:e=>s4(e,"array")},{name:"choiceTextsFromQuestion",dependsOn:"choicesFromQuestion",visibleIf:e=>s4(e,"array")},{name:"choicesOrder",default:"none",choices:["none","asc","desc","random"],dependsOn:"choicesFromQuestion",visibleIf:e=>!e.choicesFromQuestion},{name:"choicesByUrl:restfull",className:"choicesByUrl",onGetValue:function(e){return e.choicesByUrl.getData()},onSetValue:function(e,t){e.choicesByUrl.setData(t)}},"hideIfChoicesEmpty:boolean","choicesVisibleIf:condition",{name:"choicesEnableIf:condition",dependsOn:"choicesFromQuestion",visibleIf:e=>!e.choicesFromQuestion},{name:"defaultValue:value",visibleIf:e=>!e.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"correctAnswer:value",visibleIf:e=>!e.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"separateSpecialChoices:boolean",visible:!1},{name:"showOtherItem:boolean",alternativeName:"hasOther"},{name:"showNoneItem:boolean",alternativeName:"hasNone"},{name:"showRefuseItem:boolean",visible:!1,version:"1.9.128"},{name:"showDontKnowItem:boolean",visible:!1,version:"1.9.128"},{name:"otherPlaceholder",alternativeName:"otherPlaceHolder",serializationProperty:"locOtherPlaceholder",dependsOn:"showOtherItem",visibleIf:function(e){return e.hasOther}},{name:"noneText",serializationProperty:"locNoneText",dependsOn:"showNoneItem",visibleIf:function(e){return e.showNoneItem}},{name:"refuseText",serializationProperty:"locRefuseText",dependsOn:"showRefuseItem",visibleIf:function(e){return e.showRefuseItem}},{name:"dontKnowText",serializationProperty:"locDontKnowText",dependsOn:"showDontKnowItem",visibleIf:function(e){return e.showDontKnowItem}},{name:"otherText",serializationProperty:"locOtherText",dependsOn:"showOtherItem",visibleIf:function(e){return e.hasOther}},{name:"otherErrorText",serializationProperty:"locOtherErrorText",dependsOn:"showOtherItem",visibleIf:function(e){return e.hasOther}},{name:"storeOthersAsComment",default:"default",choices:["default",!0,!1],visible:!1}],null,"question"),E.addClass("checkboxbase",[{name:"colCount:number",default:1,choices:[0,1,2,3,4,5],layout:"row"}],null,"selectbase");class s3{constructor(e,t,s,i){this.x=e,this.y=t,this.width=s,this.height=i}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}}class s6{static calculatePosition(e,t,s,i,r,n="flex"){let a=e.left,o=e.top;return"flex"===n&&(a="center"==r?(e.left+e.right-s)/2:"left"==r?e.left-s:e.right),o="middle"==i?(e.top+e.bottom-t)/2:"top"==i?e.top-t:e.bottom,"center"!=r&&"middle"!=i&&("top"==i?o+=e.height:o-=e.height),{left:Math.round(a),top:Math.round(o)}}static getCorrectedVerticalDimensions(e,t,s,i,r=!0,n={top:0,bottom:0}){let a;let o=s-s6.bottomIndent;if("top"===i&&(a={height:t,top:e}),e<-n.top)a={height:r?t+e:t,top:-n.top};else if(t+e>s){let s=Math.min(t,o-e);a={height:r?s:t,top:r?e:e-(t-s)}}return a&&(a.height=Math.min(a.height,o),a.top=Math.max(a.top,-n.top)),a}static updateHorizontalDimensions(e,t,s,i,r="flex",n={left:0,right:0}){t+=n.left+n.right;let a,o=e;return"center"===i&&("fixed"===r?(e+t>s&&(a=s-e),o-=n.left):e<0?(o=n.left,a=Math.min(t,s)):t+e>s&&(o=Math.max(o=s-t,n.left),a=Math.min(t,s))),"left"===i&&e<0&&(o=n.left,a=Math.min(t,s)),"right"===i&&t+e>s&&(a=s-e),{width:a-n.left-n.right,left:o}}static updateVerticalPosition(e,t,s,i,r){if("middle"===i)return i;let n=t-(e.top+("center"!==s?e.height:0)),a=t+e.bottom-("center"!==s?e.height:0)-r;return n>0&&a<=0&&"top"==i?i="bottom":a>0&&n<=0&&"bottom"==i?i="top":a>0&&n>0&&(i=n<a?"top":"bottom"),i}static updateHorizontalPosition(e,t,s,i){if("center"===s)return s;let r=t-e.left,n=t+e.right-i;return r>0&&n<=0&&"left"==s?s="right":n>0&&r<=0&&"right"==s?s="left":n>0&&r>0&&(s=r<n?"left":"right"),s}static calculatePopupDirection(e,t){var s;return"center"==t&&"middle"!=e?s=e:"center"!=t&&(s=t),s}static calculatePointerTarget(e,t,s,i,r,n=0,a=0){var o={};return"center"!=r?(o.top=e.top+e.height/2,o.left=e[r]):"middle"!=i&&(o.top=e[i],o.left=e.left+e.width/2),o.left=Math.round(o.left-s),o.top=Math.round(o.top-t),"left"==r&&(o.left-=n+a),"center"===r&&(o.left-=n),o}}s6.bottomIndent=16;let s5='input:not(:disabled):not([readonly]):not([type=hidden]),select:not(:disabled):not([readonly]),textarea:not(:disabled):not([readonly]), button:not(:disabled):not([readonly]), [tabindex]:not([tabindex^="-"])';class s9 extends eg{updateIsVisible(e){this._isVisible=e,this.onVisibilityChanged.fire(this,{isVisible:e})}updateBeforeShowing(){this.model.onShow()}updateAfterHiding(){this.model.onHiding()}getLeaveOptions(){return{cssClass:"sv-popup--leave",onBeforeRunAnimation:e=>{e.setAttribute("inert","")},onAfterRunAnimation:e=>e.removeAttribute("inert")}}getEnterOptions(){return{cssClass:"sv-popup--enter"}}getAnimatedElement(){return this.getAnimationContainer()}isAnimationEnabled(){return"overlay"!==this.model.displayMode&&tp.animationEnabled}getRerenderEvent(){return this.onElementRerendered}getAnimationContainer(){var e;return null===(e=this.container)||void 0===e?void 0:e.querySelector(this.fixedPopupContainer)}get isVisible(){return this._isVisible}set isVisible(e){this.visibilityAnimation.sync(e)}get container(){return this.containerElement||this.createdContainer}getLocale(){return this.locale?this.locale:super.getLocale()}hidePopup(){this.model.isVisible=!1}getStyleClass(){return new eV().append(this.model.cssClass).append(`sv-popup--${this.model.displayMode}`,this.isOverlay)}getShowFooter(){return this.isOverlay}getShowHeader(){return!1}getPopupHeaderTemplate(){}createFooterActionBar(){this.footerToolbarValue=new ex,this.footerToolbar.updateCallback=e=>{this.footerToolbarValue.actions.forEach(e=>e.cssClasses={item:"sv-popup__body-footer-item sv-popup__button sd-btn"})};let e=[{id:"cancel",visibleIndex:10,title:this.cancelButtonText,innerCss:"sv-popup__button--cancel sd-btn",action:()=>{this.cancel()}}];e=this.model.updateFooterActions(e),this.footerToolbarValue.setItems(e)}resetDimensionsAndPositionStyleProperties(){this.top="",this.left="",this.height="",this.width="",this.minWidth=""}onModelChanging(e){}setupModel(e){this.model&&this.model.onVisibilityChanged.remove(this.onModelIsVisibleChangedCallback),this.onModelChanging(e),this._model=e,e.onVisibilityChanged.add(this.onModelIsVisibleChangedCallback),this.onModelIsVisibleChangedCallback()}get model(){return this._model}set model(e){this.setupModel(e)}constructor(e){super(),this.popupSelector=".sv-popup",this.fixedPopupContainer=".sv-popup",this.containerSelector=".sv-popup__container",this.scrollingContentSelector=".sv-popup__scrolling-content",this.visibilityAnimation=new eB(this,e=>{this._isVisible!==e&&(e?(this.updateBeforeShowing(),this.updateIsVisible(e)):(this.updateOnHiding(),this.updateIsVisible(e),this.updateAfterHiding(),this._isPositionSetValue=!1))},()=>this._isVisible),this.onVisibilityChanged=new ev,this.onModelIsVisibleChangedCallback=()=>{this.isVisible=this.model.isVisible},this._isPositionSetValue=!1,this.model=e,this.locale=this.model.locale}get title(){return this.model.title}get contentComponentName(){return this.model.contentComponentName}get contentComponentData(){return this.model.contentComponentData}get isModal(){return this.model.isModal}get isFocusedContent(){return this.model.isFocusedContent}get isFocusedContainer(){return this.model.isFocusedContainer}get showFooter(){return this.getShowFooter()}get showHeader(){return this.getShowHeader()}get popupHeaderTemplate(){return this.getPopupHeaderTemplate()}get isOverlay(){return"overlay"===this.model.displayMode}get styleClass(){return this.getStyleClass().toString()}get cancelButtonText(){return this.getLocalizationString("modalCancelButtonText")}get footerToolbar(){return this.footerToolbarValue||this.createFooterActionBar(),this.footerToolbarValue}onKeyDown(e){"Tab"===e.key||9===e.keyCode?this.trapFocus(e):("Escape"===e.key||27===e.keyCode)&&this.hidePopup()}trapFocus(e){let t=this.container.querySelectorAll(s5),s=t[0],i=t[t.length-1];e.shiftKey?tp.environment.root.activeElement===s&&(i.focus(),e.preventDefault()):tp.environment.root.activeElement===i&&(s.focus(),e.preventDefault())}switchFocus(){this.isFocusedContent?this.focusFirstInput():this.isFocusedContainer&&this.focusContainer()}get isPositionSet(){return this._isPositionSetValue}updateOnShowing(){this.prevActiveElement=tp.environment.root.activeElement,this.isOverlay&&this.resetDimensionsAndPositionStyleProperties(),this.switchFocus(),this._isPositionSetValue=!0}updateOnHiding(){this.isFocusedContent&&this.prevActiveElement&&this.prevActiveElement.focus({preventScroll:!0})}focusContainer(){if(!this.container)return;let e=this.container.querySelector(this.popupSelector);null==e||e.focus()}focusFirstInput(){setTimeout(()=>{if(this.container){var e=this.container.querySelector(this.model.focusFirstInputSelector||s5);e?e.focus():this.focusContainer()}},100)}clickOutside(e){this.hidePopup(),null==e||e.stopPropagation()}cancel(){this.model.onCancel(),this.hidePopup()}dispose(){super.dispose(),this.model&&this.model.onVisibilityChanged.remove(this.onModelIsVisibleChangedCallback),this.createdContainer&&(this.createdContainer.remove(),this.createdContainer=void 0),this.footerToolbarValue&&this.footerToolbarValue.dispose(),this.resetComponentElement()}initializePopupContainer(){if(!this.container){let e=r.createElement("div");this.createdContainer=e,eX(tp.environment.popupMountContainer).appendChild(e)}}setComponentElement(e){e&&(this.containerElement=e)}resetComponentElement(){this.containerElement=void 0,this.prevActiveElement=void 0}preventScrollOuside(e,t){let s=e.target;for(;s!==this.container;){if("auto"===r.getComputedStyle(s).overflowY&&s.scrollHeight!==s.offsetHeight){let{scrollHeight:e,scrollTop:i,clientHeight:r}=s;if(!(t>0&&1>Math.abs(e-r-i))&&!(t<0&&i<=0))return}s=s.parentElement}e.cancelable&&e.preventDefault()}}function s8(e,t){return Math.min(e||i.getInnerWidth(),t||i.getInnerHeight())>=s7.tabletSizeBreakpoint}ey([c({defaultValue:"0px"})],s9.prototype,"top",void 0),ey([c({defaultValue:"0px"})],s9.prototype,"left",void 0),ey([c({defaultValue:"auto"})],s9.prototype,"height",void 0),ey([c({defaultValue:"auto"})],s9.prototype,"width",void 0),ey([c({defaultValue:"auto"})],s9.prototype,"minWidth",void 0),ey([c({defaultValue:!1})],s9.prototype,"_isVisible",void 0),ey([c()],s9.prototype,"locale",void 0);class s7 extends s9{calculateIsTablet(e,t){this.isTablet=s8(e,t)}getAvailableAreaRect(){let e=this.model.getAreaCallback?this.model.getAreaCallback(this.container):void 0;if(e){let t=e.getBoundingClientRect();return new s3(t.x,t.y,t.width,t.height)}return new s3(0,0,i.getInnerWidth(),i.getInnerHeight())}getTargetElementRect(){let e=this.container,t=this.model.getTargetCallback?this.model.getTargetCallback(e):void 0;if(e&&e.parentElement&&!this.isModal&&!t&&(t=e.parentElement),!t)return null;let s=t.getBoundingClientRect(),i=this.getAvailableAreaRect();return new s3(s.left-i.left,s.top-i.top,s.width,s.height)}_updatePosition(){var e,t,s;let n=this.getTargetElementRect();if(!n)return;let a=this.getAvailableAreaRect(),o=null===(e=this.container)||void 0===e?void 0:e.querySelector(this.containerSelector);if(!o)return;let l=null===(t=this.container)||void 0===t?void 0:t.querySelector(this.fixedPopupContainer),h=o.querySelector(this.scrollingContentSelector),u=r.getComputedStyle(o),d=parseFloat(u.marginLeft)||0,c=parseFloat(u.marginRight)||0,g=parseFloat(u.marginTop)||0,p=parseFloat(u.marginBottom)||0,m=o.offsetHeight-h.offsetHeight+h.scrollHeight,v=o.getBoundingClientRect().width;this.model.setWidthByTarget&&(this.minWidth=n.width+"px");let y=this.model.verticalPosition,C=this.getActualHorizontalPosition();i.isAvailable()&&(m=Math.ceil(Math.min(...[m,.9*i.getInnerHeight(),null===(s=i.getVisualViewport())||void 0===s?void 0:s.height].filter(e=>"number"==typeof e))),y=s6.updateVerticalPosition(n,m,this.model.horizontalPosition,this.model.verticalPosition,a.height),C=s6.updateHorizontalPosition(n,v,C,a.width)),this.popupDirection=s6.calculatePopupDirection(y,C);let f=s6.calculatePosition(n,m,v+d+c,y,C,this.model.positionMode);if(i.isAvailable()){let e=s6.getCorrectedVerticalDimensions(f.top,m,a.height,y,this.model.canShrink,{top:g,bottom:p});if(e&&(this.height=e.height+"px",f.top=e.top),this.model.setWidthByTarget)this.width=n.width+"px",f.left=n.left;else{let e=s6.updateHorizontalDimensions(f.left,v,i.getInnerWidth(),C,this.model.positionMode,{left:d,right:c});e&&(this.width=e.width?e.width+"px":void 0,f.left=e.left)}}if(l){let e=l.getBoundingClientRect();f.top-=e.top,f.left-=e.left}f.left+=a.left,f.top+=a.top,this.left=f.left+"px",this.top=f.top+"px",this.showHeader&&(this.pointerTarget=s6.calculatePointerTarget(n,f.top,f.left,y,C,d,c),this.pointerTarget.top+="px",this.pointerTarget.left+="px")}getActualHorizontalPosition(){let e=this.model.horizontalPosition;return r.isAvailable()&&"rtl"==r.getComputedStyle(r.getBody()).direction&&("left"===this.model.horizontalPosition?e="right":"right"===this.model.horizontalPosition&&(e="left")),e}getStyleClass(){let e=this.model.overlayDisplayMode;return super.getStyleClass().append("sv-popup--dropdown",!this.isOverlay).append("sv-popup--dropdown-overlay",this.isOverlay&&"plain"!==e).append("sv-popup--tablet",this.isOverlay&&("tablet-dropdown-overlay"==e||"auto"==e&&this.isTablet)).append("sv-popup--show-pointer",!this.isOverlay&&this.showHeader).append(`sv-popup--${this.popupDirection}`,!this.isOverlay&&(this.showHeader||"top"==this.popupDirection||"bottom"==this.popupDirection))}getShowHeader(){return this.model.showPointer&&!this.isOverlay}getPopupHeaderTemplate(){return"popup-pointer"}constructor(e){super(e),this.scrollEventCallBack=e=>{if(this.isOverlay&&sT){e.stopPropagation(),e.preventDefault();return}this.hidePopup()},this.resizeEventCallback=()=>{if(!i.isAvailable())return;let e=i.getVisualViewport(),t=r.getDocumentElement();t&&e&&t.style.setProperty("--sv-popup-overlay-height",`${e.height*e.scale}px`)},this.resizeWindowCallback=()=>{this.isOverlay||this.updatePosition(!0,"vue"===sZ.platform||"vue3"===sZ.platform||"react"==sZ.platform||"js-ui"==sZ.platform)},this.clientY=0,this.isTablet=!1,this.touchStartEventCallback=e=>{this.clientY=e.touches[0].clientY},this.touchMoveEventCallback=e=>{this.preventScrollOuside(e,this.clientY-e.changedTouches[0].clientY)},this.model.onRecalculatePosition.add(this.recalculatePositionHandler)}setComponentElement(e){super.setComponentElement(e)}resetComponentElement(){super.resetComponentElement()}updateOnShowing(){let{root:e}=tp.environment;this.prevActiveElement=e.activeElement,this.isOverlay?this.resetDimensionsAndPositionStyleProperties():this.updatePosition(!0,!1),this.switchFocus(),i.addEventListener("resize",this.resizeWindowCallback),this.shouldCreateResizeCallback&&(i.getVisualViewport().addEventListener("resize",this.resizeEventCallback),this.container&&(this.container.addEventListener("touchstart",this.touchStartEventCallback),this.container.addEventListener("touchmove",this.touchMoveEventCallback)),this.calculateIsTablet(),this.resizeEventCallback()),i.addEventListener("scroll",this.scrollEventCallBack),this._isPositionSetValue=!0}get shouldCreateResizeCallback(){return!!i.getVisualViewport()&&this.isOverlay&&sT}updatePosition(e,t=!0){e&&(this.height="auto"),t?setTimeout(()=>{this._updatePosition()},1):this._updatePosition()}updateOnHiding(){super.updateOnHiding(),i.removeEventListener("resize",this.resizeWindowCallback),this.shouldCreateResizeCallback&&(i.getVisualViewport().removeEventListener("resize",this.resizeEventCallback),this.container&&(this.container.removeEventListener("touchstart",this.touchStartEventCallback),this.container.removeEventListener("touchmove",this.touchMoveEventCallback))),i.removeEventListener("scroll",this.scrollEventCallBack),this.isDisposed||(this.top=void 0,this.left=void 0,this.height=void 0,this.width=void 0,this.minWidth=void 0)}onModelChanging(e){this.model&&this.model.onRecalculatePosition.remove(this.recalculatePositionHandler),this.recalculatePositionHandler||(this.recalculatePositionHandler=(e,t)=>{this.isOverlay||this.updatePosition(t.isResetHeight)}),super.onModelChanging(e),e.onRecalculatePosition.add(this.recalculatePositionHandler)}dispose(){super.dispose(),this.updateOnHiding(),this.model&&(this.model.onRecalculatePosition.remove(this.recalculatePositionHandler),this.recalculatePositionHandler=void 0),this.resetComponentElement()}}s7.tabletSizeBreakpoint=600,ey([c()],s7.prototype,"isTablet",void 0),ey([c({defaultValue:"left"})],s7.prototype,"popupDirection",void 0),ey([c({defaultValue:{left:"0px",top:"0px"}})],s7.prototype,"pointerTarget",void 0);class ie extends eg{get focusFirstInputSelector(){return this.getFocusFirstInputSelector()}getFocusFirstInputSelector(){return sT?this.isValueEmpty(this.question.value)?this.itemSelector:this.selectedItemSelector:!this.listModel.showFilter&&this.question.value?this.selectedItemSelector:""}resetItemsSettings(){this.itemsSettings.skip=0,this.itemsSettings.take=Math.max(this.minPageSize,this.question.choicesLazyLoadPageSize),this.itemsSettings.totalCount=0,this.itemsSettings.items=[]}setItems(e,t){this.itemsSettings.items=[].concat(this.itemsSettings.items,e),this.itemsSettings.totalCount=t,this.listModel.isAllDataLoaded=this.question.choicesLazyLoadEnabled&&this.itemsSettings.items.length==this.itemsSettings.totalCount,this.question.choices=this.itemsSettings.items}loadQuestionChoices(e){this.question.survey.loadQuestionChoices({question:this.question,filter:this.filterString,skip:this.itemsSettings.skip,take:this.itemsSettings.take,setItems:(t,s)=>{this.setItems(t||[],s||0),this.popupRecalculatePosition(this.itemsSettings.skip===this.itemsSettings.take),e&&e()}}),this.itemsSettings.skip+=this.itemsSettings.take}updateQuestionChoices(e){let t=this.itemsSettings.skip+1<this.itemsSettings.totalCount;(!this.itemsSettings.skip||t)&&(this.resetTimer(),this.filterString&&tp.dropdownSearchDelay>0?this.timer=setTimeout(()=>{this.loadQuestionChoices(e)},tp.dropdownSearchDelay):this.loadQuestionChoices(e))}resetTimer(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)}updatePopupFocusFirstInputSelector(){this._popupModel.focusFirstInputSelector=this.focusFirstInputSelector}getDropdownMenuOptions(){let e=i.getInnerWidth(),t=i.getInnerHeight(),s=s8(e,t),r="dropdown",n="desktop";return sT&&(r=s?"popup":"overlay",n=s?"tablet":"mobile"),{menuType:r,deviceType:n,hasTouchScreen:sT,screenHeight:t,screenWidth:e}}createPopup(){this._popupModel=new eI("sv-list",{model:this.listModel},{verticalPosition:"bottom",horizontalPosition:"center",showPointer:!1}),this._popupModel.displayMode=sT?"overlay":"popup",this._popupModel.positionMode="fixed",this._popupModel.isFocusedContainer=!1,this._popupModel.isFocusedContent=sT,this._popupModel.setWidthByTarget=!sT,this._popupModel.locale=this.question.getLocale(),this.updatePopupFocusFirstInputSelector(),this.listModel.registerPropertyChangedHandlers(["showFilter"],()=>{this.updatePopupFocusFirstInputSelector()}),this._popupModel.onVisibilityChanged.add((e,t)=>{if(t.isVisible&&(this.listModel.renderElements=!0),t.isVisible&&this.question.choicesLazyLoadEnabled&&(this.listModel.actions=[],this.resetItemsSettings(),this.updateQuestionChoices()),t.isVisible){this.updatePopupFocusFirstInputSelector();let e=this.getDropdownMenuOptions(),t=e.menuType;this.question.processOpenDropdownMenu(e),t!==e.menuType&&(this._popupModel.updateDisplayMode(e.menuType),this.listModel.setSearchEnabled(this.searchEnabled&&"dropdown"!==e.menuType)),this.question.onOpenedCallBack&&this.question.onOpenedCallBack()}!t.isVisible&&(this.onHidePopup(),this.question.choicesLazyLoadEnabled&&this.resetItemsSettings()),this.question.ariaExpanded=t.isVisible?"true":"false",this.question.processPopupVisiblilityChanged(this.popupModel,t.isVisible)})}setFilterStringToListModel(e){if(this.listModel.filterString=e,this.listModel.resetFocusedItem(),this.question.selectedItem&&this.question.selectedItem.text.indexOf(e)>=0){this.listModel.focusedItem=this.getAvailableItems().filter(e=>e.id==this.question.selectedItem.value)[0],this.listModel.filterString&&this.listModel.actions.map(e=>e.selectedValue=!1);return}this.listModel.focusedItem&&this.listModel.isItemVisible(this.listModel.focusedItem)||this.listModel.focusFirstVisibleItem()}setTextWrapEnabled(e){this.listModel.textWrapEnabled=e}popupRecalculatePosition(e){setTimeout(()=>{this.popupModel.recalculatePosition(e)},1)}onHidePopup(){this.resetFilterString(),this.question.suggestedItem=null}getAvailableItems(){return this.question.visibleChoices}setOnTextSearchCallbackForListModel(e){e.setOnTextSearchCallback((e,t)=>{if(this.filteredItems)return this.filteredItems.indexOf(e)>=0;let s=e.text.toLocaleLowerCase(),i=(s=tp.comparator.normalizeTextCallback(s,"filter")).indexOf(t.toLocaleLowerCase());return"startsWith"==this.question.searchMode?0==i:i>-1})}createListModel(){let e=this.getAvailableItems(),t=this.onSelectionChanged;t||(t=e=>{this.question.value=e.id,this.question.searchEnabled&&this.applyInputString(e),this.popupModel.hide()});let s=new eS({items:e,onSelectionChanged:t,allowSelection:!1,locOwner:this.question,elementId:this.listElementId});return this.setOnTextSearchCallbackForListModel(s),s.renderElements=!1,s.forceShowFilter=!0,s.areSameItemsCallback=(e,t)=>e===t,s}updateAfterListModelCreated(e){e.isItemSelected=e=>!!e.selected,e.onPropertyChanged.add((e,t)=>{"hasVerticalScroller"==t.name&&(this.hasScroll=t.newValue)}),e.isAllDataLoaded=!this.question.choicesLazyLoadEnabled,e.actions.forEach(e=>e.disableTabStop=!0)}getPopupCssClasses(){return"sv-single-select-list"}updateCssClasses(e,t){this.popupModel.cssClass=new eV().append(e).append(this.getPopupCssClasses()).toString(),this.listModel.cssClasses=t}resetFilterString(){this.filterString&&(this.filterString=void 0)}clear(){this.inputString=null,this.hintString="",this.resetFilterString()}onSetFilterString(){if(this.filteredItems=void 0,!this.filterString&&!this.popupModel.isVisible)return;let e={question:this.question,choices:this.getAvailableItems(),filter:this.filterString,filteredChoices:void 0};this.question.survey.onChoicesSearch.fire(this.question.survey,e),this.filteredItems=e.filteredChoices,this.filterString&&!this.popupModel.isVisible&&this.popupModel.show();let t=()=>{this.setFilterStringToListModel(this.filterString),this.popupRecalculatePosition(!0)};this.question.choicesLazyLoadEnabled?(this.resetItemsSettings(),this.updateQuestionChoices(t)):t()}get isAllDataLoaded(){return!!this.itemsSettings.totalCount&&this.itemsSettings.items.length==this.itemsSettings.totalCount}get canShowSelectedItem(){return!this.focused||this._markdownMode||!this.searchEnabled}applyInputString(e){(null==e?void 0:e.locText.hasHtml)||this.question.inputFieldComponentName?(this._markdownMode=!0,this.inputString=this.cleanHtml(null==e?void 0:e.locText.getHtmlValue()),this.hintString=""):(this.inputString=null==e?void 0:e.title,this.hintString=null==e?void 0:e.title)}cleanHtml(e){return this.htmlCleanerElement?(this.htmlCleanerElement.innerHTML=e,this.htmlCleanerElement.textContent):""}fixInputCase(){let e=this.hintStringMiddle;e&&this.inputString!=e&&(this.inputString=e)}applyHintString(e){(null==e?void 0:e.locText.hasHtml)||this.question.inputFieldComponentName?(this._markdownMode=!0,this.hintString=""):this.hintString=null==e?void 0:e.title}get inputStringRendered(){return this.inputString||""}set inputStringRendered(e){this.inputString=e,this.filterString=e,e?this.applyHintString(this.listModel.focusedItem||this.question.selectedItem):this.hintString=""}get placeholderRendered(){return this.hintString?"":this.question.readOnlyText}get listElementId(){return this.question.inputId+"_list"}get hintStringLC(){var e;return(null===(e=this.hintString)||void 0===e?void 0:e.toLowerCase())||""}get inputStringLC(){var e;return(null===(e=this.inputString)||void 0===e?void 0:e.toLowerCase())||""}get showHintPrefix(){return!!this.inputString&&this.hintStringLC.indexOf(this.inputStringLC)>0}get hintStringPrefix(){return this.inputString?this.hintString.substring(0,this.hintStringLC.indexOf(this.inputStringLC)):null}get showHintString(){return!!this.question.searchEnabled&&!!(this.hintStringLC||this.inputStringLC)||!this.question.searchEnabled&&this.hintStringLC&&this.question.isEmpty()}get hintStringSuffix(){return this.hintString.substring(this.hintStringLC.indexOf(this.inputStringLC)+this.inputStringLC.length)}get hintStringMiddle(){let e=this.hintStringLC.indexOf(this.inputStringLC);return -1==e?null:this.hintString.substring(e,e+this.inputStringLC.length)}constructor(e,t){super(),this.question=e,this.onSelectionChanged=t,this.minPageSize=25,this.loadingItemHeight=40,this.timer=void 0,this._markdownMode=!1,this.filteredItems=void 0,this.selectedItemSelector=".sv-list__item--selected",this.itemSelector=".sv-list__item",this.itemsSettings={skip:0,take:0,totalCount:0,items:[]},this.listModelFilterStringChanged=e=>{this.filterString!==e&&(this.filterString=e)},this.questionPropertyChangedHandler=(e,t)=>{this.onPropertyChangedHandler(e,t)},this.htmlCleanerElement=r.createElement("div"),e.onPropertyChanged.add(this.questionPropertyChangedHandler),this.showInputFieldComponent=this.question.showInputFieldComponent,this.listModel=this.createListModel(),this.updateAfterListModelCreated(this.listModel),this.setChoicesLazyLoadEnabled(this.question.choicesLazyLoadEnabled),this.setSearchEnabled(this.question.searchEnabled),this.setTextWrapEnabled(this.question.textWrapEnabled),this.createPopup(),this.resetItemsSettings();let s=e.cssClasses;this.updateCssClasses(s.popup,s.list)}get popupModel(){return this._popupModel}get noTabIndex(){return this.question.isInputReadOnly||this.searchEnabled}get filterReadOnly(){return this.question.isInputReadOnly||!this.searchEnabled||!this.focused}get filterStringEnabled(){return!this.question.isInputReadOnly&&this.searchEnabled}get inputMode(){return sT?"none":"text"}setSearchEnabled(e){this.listModel.setSearchEnabled(sT&&e),this.searchEnabled=e}setChoicesLazyLoadEnabled(e){this.listModel.setOnFilterStringChangedCallback(e?this.listModelFilterStringChanged:void 0)}updateItems(){this.listModel.setItems(this.getAvailableItems())}onClick(e){this.question.readOnly||this.question.isDesignMode||this.question.isPreviewStyle||this.question.isReadOnlyAttr||(this._popupModel.toggleVisibility(),this.focusItemOnClickAndPopup(),this.question.focusInputElement(!1))}chevronPointerDown(e){this._popupModel.isVisible&&e.preventDefault()}onPropertyChangedHandler(e,t){"value"==t.name&&(this.showInputFieldComponent=this.question.showInputFieldComponent),"textWrapEnabled"==t.name&&this.setTextWrapEnabled(t.newValue)}focusItemOnClickAndPopup(){this._popupModel.isVisible&&this.question.value&&this.changeSelectionWithKeyboard(!1)}onClear(e){this.question.clearValue(!0),this._popupModel.hide(),e&&(e.preventDefault(),e.stopPropagation())}getSelectedAction(){return this.question.selectedItem||null}changeSelectionWithKeyboard(e){var t;let s=this.listModel.focusedItem;!s&&this.question.selectedItem?tJ.getItemByValue(this.question.visibleChoices,this.question.value)&&(this.listModel.focusedItem=this.question.selectedItem):e?this.listModel.focusPrevVisibleItem():this.listModel.focusNextVisibleItem(),this.beforeScrollToFocusedItem(s),this.scrollToFocusedItem(),this.afterScrollToFocusedItem(),this.ariaActivedescendant=null===(t=this.listModel.focusedItem)||void 0===t?void 0:t.elementId}beforeScrollToFocusedItem(e){this.question.value&&e&&(e.selectedValue=!1,this.listModel.focusedItem.selectedValue=!this.listModel.filterString,this.question.suggestedItem=this.listModel.focusedItem)}afterScrollToFocusedItem(){var e;this.question.value&&!this.listModel.filterString&&this.question.searchEnabled?this.applyInputString(this.listModel.focusedItem||this.question.selectedItem):this.applyHintString(this.listModel.focusedItem||this.question.selectedItem),this.fixInputCase(),this.ariaActivedescendant=null===(e=this.listModel.focusedItem)||void 0===e?void 0:e.elementId}keyHandler(e){let t=e.which||e.keyCode;if(this.popupModel.isVisible&&38===e.keyCode?(this.changeSelectionWithKeyboard(!0),e.preventDefault(),e.stopPropagation()):40===e.keyCode&&(this.popupModel.show(),this.changeSelectionWithKeyboard(!1),e.preventDefault(),e.stopPropagation()),9===e.keyCode)this.popupModel.hide();else if(this.popupModel.isVisible||13!==e.keyCode&&32!==e.keyCode){if(!this.popupModel.isVisible||13!==e.keyCode&&(32!==e.keyCode||this.question.searchEnabled&&this.inputString)){if(46===t||8===t)this.searchEnabled||this.onClear(e);else if(27===e.keyCode)this._popupModel.hide(),this.hintString="",this.onEscape();else{if(38!==e.keyCode&&40!==e.keyCode&&(32!==e.keyCode||this.question.searchEnabled)||(e.preventDefault(),e.stopPropagation()),32===e.keyCode&&this.question.searchEnabled)return;te(e,{processEsc:!1,disableTabStop:this.question.isInputReadOnly})}}else 13===e.keyCode&&this.question.searchEnabled&&!this.inputString&&this.question instanceof it&&!this._markdownMode&&this.question.value?(this._popupModel.hide(),this.onClear(e)):(this.listModel.selectFocusedItem(),this.onFocus(e)),e.preventDefault(),e.stopPropagation()}else 32===e.keyCode&&(this.popupModel.show(),this.changeSelectionWithKeyboard(!1)),13===e.keyCode&&this.question.survey.questionEditFinishCallback(this.question,e),e.preventDefault(),e.stopPropagation()}onEscape(){this.question.searchEnabled&&this.applyInputString(this.question.selectedItem)}onScroll(e){let t=e.target;t.scrollHeight-(t.scrollTop+t.offsetHeight)<=this.loadingItemHeight&&this.updateQuestionChoices()}onBlur(e){this.focused=!1,(!this.popupModel.isVisible||"overlay"!=this.popupModel.displayMode)&&(e7(e),this._popupModel.hide(),this.resetFilterString(),this.inputString=null,this.hintString="",e.stopPropagation())}onFocus(e){this.focused=!0,this.setInputStringFromSelectedItem(this.question.selectedItem)}setInputStringFromSelectedItem(e){this.focused&&(this.question.searchEnabled&&e?this.applyInputString(e):this.inputString=null)}dispose(){super.dispose(),this.question&&this.question.onPropertyChanged.remove(this.questionPropertyChangedHandler),this.questionPropertyChangedHandler=void 0,this.listModel&&this.listModel.dispose(),this.popupModel&&this.popupModel.dispose(),this.htmlCleanerElement=void 0}scrollToFocusedItem(){this.listModel.scrollToFocusedItem()}}ey([c({defaultValue:!1})],ie.prototype,"focused",void 0),ey([c({defaultValue:!0})],ie.prototype,"searchEnabled",void 0),ey([c({defaultValue:"",onSet:(e,t)=>{t.onSetFilterString()}})],ie.prototype,"filterString",void 0),ey([c({defaultValue:"",onSet:(e,t)=>{t.question.inputHasValue=!!e}})],ie.prototype,"inputString",void 0),ey([c({})],ie.prototype,"showInputFieldComponent",void 0),ey([c()],ie.prototype,"ariaActivedescendant",void 0),ey([c({defaultValue:!1,onSet:(e,t)=>{e?t.listModel.addScrollEventListener(e=>{t.onScroll(e)}):t.listModel.removeScrollEventListener()}})],ie.prototype,"hasScroll",void 0),ey([c({defaultValue:""})],ie.prototype,"hintString",void 0);class it extends s1{constructor(e){super(e),this.lastSelectedItemValue=null,this.minMaxChoices=[],this.onOpened=this.addEvent(),this.ariaExpanded="false",this.createLocalizableString("placeholder",this,!1,!0),this.createLocalizableString("clearCaption",this,!1,!0),this.registerPropertyChangedHandlers(["choicesMin","choicesMax","choicesStep"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["value","renderAs","showOtherItem","otherText","placeholder","choices","visibleChoices"],()=>{this.getSingleSelectedItem(),this.resetReadOnlyText()})}locStrsChanged(){super.locStrsChanged(),this.resetReadOnlyText()}get showOptionsCaption(){return this.allowClear}set showOptionsCaption(e){this.allowClear=e}get showClearButton(){return this.allowClear&&!this.isEmpty()}get optionsCaption(){return this.placeholder}set optionsCaption(e){this.placeholder=e}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}get clearCaption(){return this.getLocalizableStringText("clearCaption")}set clearCaption(e){this.setLocalizableStringText("clearCaption",e)}get locClearCaption(){return this.getLocalizableString("clearCaption")}getType(){return"dropdown"}get ariaRole(){return"combobox"}get selectedItem(){return this.getSingleSelectedItem()}onGetSingleSelectedItem(e){e&&(this.lastSelectedItemValue=e)}supportAutoAdvance(){return!this.isOtherSelected}getChoices(){var e=super.getChoices();if(this.choicesMax<=this.choicesMin)return e;for(var t=[],s=0;s<e.length;s++)t.push(e[s]);if(0===this.minMaxChoices.length||this.minMaxChoices.length!==(this.choicesMax-this.choicesMin)/this.choicesStep+1){this.minMaxChoices=[];for(var s=this.choicesMin;s<=this.choicesMax;s+=this.choicesStep)this.minMaxChoices.push(this.createItemValue(s))}return t.concat(this.minMaxChoices)}get choicesMin(){return this.getPropertyValue("choicesMin")}set choicesMin(e){this.setPropertyValue("choicesMin",e)}get choicesMax(){return this.getPropertyValue("choicesMax")}set choicesMax(e){this.setPropertyValue("choicesMax",e)}get choicesStep(){return this.getPropertyValue("choicesStep")}set choicesStep(e){e<1&&(e=1),this.setPropertyValue("choicesStep",e)}get autocomplete(){return this.getPropertyValue("autocomplete","")}set autocomplete(e){this.setPropertyValue("autocomplete",e)}get readOnlyText(){return this.getPropertyValue("readOnlyText",void 0,()=>this.calculateReadOnlyText())}calculateReadOnlyText(){if("select"==this.renderAs){if(this.isOtherSelected)return this.otherText;if(this.isNoneSelected)return this.noneText;if(this.selectedItem)return this.selectedItemText}return this.selectedItem?"":this.placeholder}resetReadOnlyText(){this.resetPropertyValue("readOnlyText")}getControlClass(){return new eV().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).append(this.cssClasses.controlInputFieldComponent,!!this.inputFieldComponentName).toString()}updateCssClasses(e,t){super.updateCssClasses(e,t),this.useDropdownList&&tl(e,t)}calcCssClasses(e){let t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModel.updateCssClasses(t.popup,t.list),t}get selectedItemLocText(){let e=this.suggestedItem||this.selectedItem;return null==e?void 0:e.locText}get inputFieldComponentName(){return this.inputFieldComponent||this.itemComponent}get showSelectedItemLocText(){return!this.inputHasValue&&!this.inputFieldComponentName&&!!this.selectedItemLocText&&this.dropdownListModel.canShowSelectedItem}get showInputFieldComponent(){return!this.inputHasValue&&!!this.inputFieldComponentName&&!this.isEmpty()}get selectedItemText(){let e=this.selectedItem;return e?e.text:""}get useDropdownList(){return"select"!==this.renderAs}get dropdownListModel(){return this.useDropdownList&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new ie(this)),this.dropdownListModelValue}set dropdownListModel(e){this.dropdownListModelValue=e}get popupModel(){return this.dropdownListModel.popupModel}onOpenedCallBack(){this.onOpened.fire(this,{question:this,choices:this.choices})}onSelectedItemValuesChangedHandler(e){var t;null===(t=this.dropdownListModelValue)||void 0===t||t.setInputStringFromSelectedItem(e),super.onSelectedItemValuesChangedHandler(e)}hasUnknownValue(e,t,s,i){return!this.choicesLazyLoadEnabled&&super.hasUnknownValue(e,t,s,i)}needConvertRenderedOtherToDataValue(){var e;let t=null===(e=this.otherValue)||void 0===e?void 0:e.trim();return!!t&&super.hasUnknownValue(t,!0,!1)}getItemIfChoicesNotContainThisValue(e,t){return this.choicesLazyLoadEnabled?this.createItemValue(e,t):super.getItemIfChoicesNotContainThisValue(e,t)}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.dropdownListModelValue&&this.dropdownListModel.updateItems()}getFirstInputElementId(){return this.inputId+(this.searchEnabled?"_0":"")}getInputId(){return this.inputId+"_0"}clearValue(e){var t;super.clearValue(e),this.lastSelectedItemValue=null,null===(t=this.dropdownListModelValue)||void 0===t||t.clear()}afterRenderCore(e){super.afterRenderCore(e),this.dropdownListModelValue&&this.dropdownListModelValue.clear()}onClick(e){this.onOpenedCallBack&&this.onOpenedCallBack()}onKeyUp(e){46===(e.which||e.keyCode)&&(this.clearValue(!0),e.preventDefault(),e.stopPropagation())}supportEmptyValidation(){return!0}onBlurCore(e){this.dropdownListModel.onBlur(e),super.onBlurCore(e)}onFocusCore(e){this.dropdownListModel.onFocus(e),super.onFocusCore(e)}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}}ey([c()],it.prototype,"allowClear",void 0),ey([c({onSet:(e,t)=>{t.dropdownListModelValue&&t.dropdownListModel.setSearchEnabled(e)}})],it.prototype,"searchEnabled",void 0),ey([c()],it.prototype,"searchMode",void 0),ey([c()],it.prototype,"textWrapEnabled",void 0),ey([c({defaultValue:!1})],it.prototype,"inputHasValue",void 0),ey([c({onSet:(e,t)=>{t.dropdownListModelValue&&t.dropdownListModel.setChoicesLazyLoadEnabled(e)}})],it.prototype,"choicesLazyLoadEnabled",void 0),ey([c()],it.prototype,"choicesLazyLoadPageSize",void 0),ey([c()],it.prototype,"suggestedItem",void 0),E.addClass("dropdown",[{name:"placeholder",alternativeName:"optionsCaption",serializationProperty:"locPlaceholder"},{name:"allowClear:boolean",alternativeName:"showOptionsCaption",default:!0},{name:"choicesMin:number",default:0},{name:"choicesMax:number",default:0},{name:"choicesStep:number",default:1,minValue:1},{name:"autocomplete",alternativeName:"autoComplete",choices:tp.questions.dataList},{name:"textWrapEnabled:boolean",default:!0},{name:"renderAs",default:"default",visible:!1},{name:"searchEnabled:boolean",default:!0,visible:!1},{name:"searchMode",default:"contains",choices:["contains","startsWith"]},{name:"choicesLazyLoadEnabled:boolean",default:!1,visible:!1},{name:"choicesLazyLoadPageSize:number",default:25,visible:!1},{name:"inputFieldComponent",visible:!1},{name:"itemComponent",visible:!1,default:""}],function(){return new it("")},"selectbase"),st.Instance.registerQuestion("dropdown",e=>{var t=new it(e);return t.choices=st.DefaultChoices,t});class is extends eg{constructor(e,t,s,i){super(),this.item=e,this.fullName=t,this.data=s,this.setValueDirectly(i),this.cellClick=e=>{this.value=e.value},this.registerPropertyChangedHandlers(["value"],()=>{this.data&&this.data.onMatrixRowChanged(this)}),this.data&&this.data.hasErrorInRow(this)&&(this.hasError=!0)}get name(){return this.item.value}get text(){return this.item.text}get locText(){return this.item.locText}get value(){return this.getPropertyValue("value")}set value(e){this.isReadOnly||this.setValueDirectly(this.data.getCorrectedRowValue(e))}setValueDirectly(e){this.setPropertyValue("value",e)}get isReadOnly(){return!this.item.enabled||this.data.isInputReadOnly}get isReadOnlyAttr(){return this.data.isReadOnlyAttr}get isDisabledAttr(){return!this.item.enabled||this.data.isDisabledAttr}get rowTextClasses(){return new eV().append(this.data.cssClasses.rowTextCell).toString()}get hasError(){return this.getPropertyValue("hasError",!1)}set hasError(e){this.setPropertyValue("hasError",e)}get rowClasses(){let e=this.data.cssClasses;return new eV().append(e.row).append(e.rowError,this.hasError).append(e.rowReadOnly,this.isReadOnly).append(e.rowDisabled,this.data.isDisabledStyle).toString()}}class ii extends eg{constructor(e){super(),this.cellsOwner=e,this.values={},this.locs={}}getType(){return"cells"}get isEmpty(){return 0==Object.keys(this.values).length}valuesChanged(){!this.locNotification&&this.onValuesChanged&&this.onValuesChanged()}getDefaultCellLocText(e){return this.getCellLocCore(this.defaultRowValue,e)}getCellDisplayLocText(e,t){return this.getCellLocCore(e,t)}getCellLocCore(e,t){if(e=this.getCellRowColumnValue(e,this.rows),t=this.getCellRowColumnValue(t,this.columns),a.isValueEmpty(e)||a.isValueEmpty(t))return null;this.locs[e]||(this.locs[e]={});let s=this.locs[e][t];return s||((s=this.createString()).setJson(this.getCellLocData(e,t)),s.onGetTextCallback=e=>{if(!e){let e=tJ.getItemByValue(this.columns,t);if(e)return e.locText.getJson()||e.value}return e},s.onStrChanged=(s,i)=>{this.updateValues(e,t,i)},this.locs[e][t]=s),s}get defaultRowValue(){return tp.matrix.defaultRowName}getCellLocData(e,t){let s=this.getCellLocDataFromValue(e,t);return s||this.getCellLocDataFromValue(this.defaultRowValue,t)}getCellLocDataFromValue(e,t){return this.values[e]&&this.values[e][t]?this.values[e][t]:null}getCellText(e,t){var s=this.getCellLocCore(e,t);return s?s.calculatedText:null}setCellText(e,t,s){let i=this.getCellLocCore(e,t);i&&(i.text=s)}updateValues(e,t,s){s?(this.values[e]||(this.values[e]={}),this.values[e][t]=s,this.valuesChanged()):this.values[e]&&this.values[e][t]&&(delete this.values[e][t],0==Object.keys(this.values[e]).length&&delete this.values[e],this.valuesChanged())}getDefaultCellText(e){var t=this.getCellLocCore(this.defaultRowValue,e);return t?t.calculatedText:null}setDefaultCellText(e,t){this.setCellText(this.defaultRowValue,e,t)}getCellDisplayText(e,t){var s=this.getCellDisplayLocText(e,t);return s?s.calculatedText:null}get rows(){return this.cellsOwner?this.cellsOwner.getRows():[]}get columns(){return this.cellsOwner?this.cellsOwner.getColumns():[]}getCellRowColumnValue(e,t){if(null==e)return null;if("number"==typeof e){if(e<0||e>=t.length)return null;e=t[e].value}return e.value?e.value:e}getJson(){if(this.isEmpty)return null;let e=this.values[this.defaultRowValue],t={};for(let s in this.values){let i={},r=this.values[s];for(let t in r)s!==this.defaultRowValue&&e&&e[t]===r[t]||(i[t]=r[t]);t[s]=i}return t}setJson(e,t){if(this.values={},e){for(var s in e)if("pos"!=s){var i=e[s];for(var r in this.values[s]={},i)"pos"!=r&&(this.values[s][r]=i[r])}}this.locNotification=!0,this.runFuncOnLocs((e,t,s)=>s.setJson(this.getCellLocData(e,t))),this.locNotification=!1,this.valuesChanged()}locStrsChanged(){this.runFuncOnLocs((e,t,s)=>s.strChanged())}runFuncOnLocs(e){for(let t in this.locs){let s=this.locs[t];for(let i in s)e(t,i,s[i])}}createString(){return new ej(this.cellsOwner,!0)}}class ir extends t0{constructor(e){super(e),this.isRowChanging=!1,this.emptyLocalizableString=new ej(this),this.cellsValue=new ii(this),this.cellsValue.onValuesChanged=()=>{this.updateHasCellText(),this.propertyValueChanged("cells",this.cells,this.cells)},this.registerPropertyChangedHandlers(["columns"],()=>{this.onColumnsChanged()}),this.registerPropertyChangedHandlers(["rows"],()=>{this.runCondition(this.getDataFilteredValues(),this.getDataFilteredProperties()),this.onRowsChanged()}),this.registerPropertyChangedHandlers(["hideIfRowsEmpty"],()=>{this.updateVisibilityBasedOnRows()})}getType(){return"matrix"}get cellComponent(){return this.getPropertyValue("cellComponent")}set itemComponent(e){this.setPropertyValue("cellComponent",e)}get hasSingleInput(){return!1}get eachRowRequired(){return this.getPropertyValue("eachRowRequired")}set eachRowRequired(e){this.setPropertyValue("eachRowRequired",e)}get isAllRowRequired(){return this.eachRowRequired}set isAllRowRequired(e){this.eachRowRequired=e}get eachRowUnique(){return this.getPropertyValue("eachRowUnique")}set eachRowUnique(e){this.setPropertyValue("eachRowUnique",e)}get hasRows(){return this.rows.length>0}get rowOrder(){return this.getPropertyValue("rowOrder")}set rowOrder(e){(e=e.toLowerCase())!=this.rowOrder&&(this.setPropertyValue("rowOrder",e),this.onRowsChanged())}get rowsOrder(){return this.rowOrder}set rowsOrder(e){this.rowOrder=e}get hideIfRowsEmpty(){return this.getPropertyValue("hideIfRowsEmpty")}set hideIfRowsEmpty(e){this.setPropertyValue("hideIfRowsEmpty",e)}getRows(){return this.rows}getColumns(){return this.visibleColumns}addColumn(e,t){var s=new tJ(e,t);return this.columns.push(s),s}getItemClass(e,t){let s=e.value==t.value,i=this.isReadOnly,r=this.hasCellText,n=this.cssClasses;return new eV().append(n.cell,r).append(r?n.cellText:n.label).append(n.itemOnError,!r&&(this.eachRowRequired||this.eachRowUnique?e.hasError:this.hasCssError())).append(r?n.cellTextSelected:n.itemChecked,s).append(r?n.cellTextDisabled:n.itemDisabled,this.isDisabledStyle).append(r?n.cellTextReadOnly:n.itemReadOnly,this.isReadOnlyStyle).append(r?n.cellTextPreview:n.itemPreview,this.isPreviewStyle).append(n.itemHover,!s&&!i&&!r).toString()}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}locStrsChanged(){super.locStrsChanged(),this.cells.locStrsChanged()}getQuizQuestionCount(){for(var e=0,t=0;t<this.rows.length;t++)!this.isValueEmpty(this.correctAnswer[this.rows[t].value])&&e++;return e}getCorrectAnswerCount(){for(var e=0,t=this.value,s=0;s<this.rows.length;s++){var i=this.rows[s].value;!this.isValueEmpty(t[i])&&this.isTwoValueEquals(this.correctAnswer[i],t[i])&&e++}return e}runConditionCore(e,t){tJ.runEnabledConditionsForItems(this.rows,void 0,e,t),super.runConditionCore(e,t)}createRowsVisibleIfRunner(){return this.rowsVisibleIf?new el(this.rowsVisibleIf):null}onRowsChanged(){this.clearGeneratedRows(),super.onRowsChanged()}getVisibleRows(){if(this.generatedVisibleRows)return this.generatedVisibleRows;let e=[],t=this.value;t||(t={});let s=this.filteredRows||this.rows;for(let i=0;i<s.length;i++){let r=s[i];if(this.isValueEmpty(r.value))continue;let n=this.id+"_"+r.value.toString().replace(/\s/g,"_");e.push(this.createMatrixRow(r,n,t[r.value]))}return this.generatedVisibleRows=e,e}sortVisibleRows(e){return this.survey&&this.survey.isDesignMode?e:"random"===this.rowOrder.toLowerCase()?a.randomizeArray(e):e}endLoadingFromJson(){super.endLoadingFromJson(),this.rows=this.sortVisibleRows(this.rows),this.onRowsChanged(),this.onColumnsChanged()}isNewValueCorrect(e){return a.isValueObject(e,!0)}processRowsOnSet(e){return this.sortVisibleRows(e)}get visibleRows(){return this.getVisibleRows()}get cells(){return this.cellsValue}set cells(e){this.cells.setJson(e&&e.getJson?e.getJson():null)}get hasCellText(){return this.getPropertyValue("hasCellText",!1)}updateHasCellText(){this.setPropertyValue("hasCellText",!this.cells.isEmpty)}setCellText(e,t,s){this.cells.setCellText(e,t,s)}getCellText(e,t){return this.cells.getCellText(e,t)}setDefaultCellText(e,t){this.cells.setDefaultCellText(e,t)}getDefaultCellText(e){return this.cells.getDefaultCellText(e)}getCellDisplayText(e,t){return this.cells.getCellDisplayText(e,t)}getCellDisplayLocText(e,t){return this.cells.getCellDisplayLocText(e,t)||this.emptyLocalizableString}supportAutoAdvance(){return!0===this.isMouseDown&&this.hasValuesInAllRows()}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),!t||this.hasCssError()){let t={noValue:!1,isNotUnique:!1};this.checkErrorsAllRows(s,t),t.noValue&&e.push(new tS(null,this)),t.isNotUnique&&e.push(new tI(null,this))}}hasValuesInAllRows(){let e={noValue:!1,isNotUnique:!1};return this.checkErrorsAllRows(!1,e,!0),!e.noValue}checkErrorsAllRows(e,t,s){var i=this.generatedVisibleRows;if(i||(i=this.visibleRows),!i)return;let r=this.eachRowRequired||s,n=this.eachRowUnique;if(t.noValue=!1,t.isNotUnique=!1,e&&(this.errorsInRow=void 0),!r&&!n)return;let a={};for(var o=0;o<i.length;o++){let s=i[o].value,l=this.isValueEmpty(s),h=n&&!l&&!0===a[s];l=l&&r,e&&(l||h)&&this.addErrorIntoRow(i[o]),l||(a[s]=!0),t.noValue=t.noValue||l,t.isNotUnique=t.isNotUnique||h}e&&i.forEach(e=>{e.hasError=this.hasErrorInRow(e)})}addErrorIntoRow(e){this.errorsInRow||(this.errorsInRow={}),this.errorsInRow[e.name]=!0,e.hasError=!0}refreshRowsErrors(){this.errorsInRow&&this.checkErrorsAllRows(!0,{noValue:!1,isNotUnique:!1})}getIsAnswered(){return super.getIsAnswered()&&this.hasValuesInAllRows()}createMatrixRow(e,t,s){var i=new is(e,t,this,s);return this.onMatrixRowCreated(i),i}onMatrixRowCreated(e){}setQuestionValue(e,t=!0){if(super.setQuestionValue(e,this.isRowChanging||t),this.generatedVisibleRows&&0!=this.generatedVisibleRows.length){this.isRowChanging=!0;var s=this.value;if(s||(s={}),0==this.rows.length)this.generatedVisibleRows[0].setValueDirectly(s);else for(var i=0;i<this.generatedVisibleRows.length;i++){var r=s[this.generatedVisibleRows[i].name];this.isValueEmpty(r)&&(r=null),this.generatedVisibleRows[i].setValueDirectly(r)}this.refreshRowsErrors(),this.updateIsAnswered(),this.isRowChanging=!1}}getDisplayValueCore(e,t){var s={};for(var i in t){var r=e?tJ.getTextOrHtmlByValue(this.rows,i):i;r||(r=i);var n=tJ.getTextOrHtmlByValue(this.columns,t[i]);n||(n=t[i]),s[r]=n}return s}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){var s=this.createValueCopy();t.isNode=!0,t.data=Object.keys(s||{}).map(t=>{var i=this.rows.filter(e=>e.value===t)[0],r={name:t,title:i?i.text:"row",value:s[t],displayValue:tJ.getTextOrHtmlByValue(this.visibleColumns,s[t]),getString:e=>"object"==typeof e?JSON.stringify(e):e,isNode:!1},n=tJ.getItemByValue(this.visibleColumns,s[t]);return n&&(e.calculations||[]).forEach(e=>{r[e.propertyName]=n[e.propertyName]}),r})}return t}addConditionObjectsByContext(e,t){for(var s=0;s<this.rows.length;s++){var i=this.rows[s];i.value&&e.push({name:this.getValueName()+"."+i.value,text:this.processedTitle+"."+i.calculatedText,question:this})}}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=new it(t);s.choices=this.columns;var i=new I().toJsonObject(s);return i.type=s.getType(),i}clearIncorrectValues(){this.clearInvisibleValuesInRowsAndColumns(!0,!0,!0),super.clearIncorrectValues()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearInvisibleValuesInRowsAndColumns(!0,!0,!1)}clearInvisibleColumnValues(){this.clearInvisibleValuesInRowsAndColumns(!1,!0,!1)}clearInvisibleValuesInRows(){this.clearInvisibleValuesInRowsAndColumns(!0,!1,!1)}clearInvisibleValuesInRowsAndColumns(e,t,s){if(this.isEmpty())return;let i=this.getUnbindValue(this.value),r={};for(var n=this.rows,a=0;a<n.length;a++){var o=n[a].value;i[o]&&(e&&!n[a].isVisible||t&&!this.getVisibleColumnByValue(i[o])?delete i[o]:r[o]=i[o])}s&&(i=r),this.isTwoValueEquals(i,this.value)||(this.value=i)}getVisibleColumnByValue(e){let t=tJ.getItemByValue(this.columns,e);return t&&t.isVisible?t:null}getFirstInputElementId(){var e=this.generatedVisibleRows;return(e||(e=this.visibleRows),e.length>0&&this.visibleColumns.length>0)?this.inputId+"_"+e[0].name+"_0":super.getFirstInputElementId()}onMatrixRowChanged(e){if(!this.isRowChanging){if(this.isRowChanging=!0,this.hasRows){var t=this.value;t||(t={}),t[e.name]=e.value,this.setNewValue(t)}else this.setNewValue(e.value);this.isRowChanging=!1}}getCorrectedRowValue(e){for(var t=0;t<this.columns.length;t++)if(e===this.columns[t].value)return e;for(var t=0;t<this.columns.length;t++)if(this.isTwoValueEquals(e,this.columns[t].value))return this.columns[t].value;return e}hasErrorInRow(e){return!!this.errorsInRow&&!!this.errorsInRow[e.name]}getSearchableItemValueKeys(e){e.push("columns"),e.push("rows")}get SurveyModel(){return this.survey}getColumnHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName({column:e},"column-header")}getColumnHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData({column:e},"column-header")}getRowHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName({row:e},"row-header")}getRowHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData({row:e},"row-header")}}E.addClass("matrix",["rowTitleWidth",{name:"columns:itemvalue[]",uniqueProperty:"value",baseValue:function(){return u("matrix_column")}},{name:"rows:itemvalue[]",uniqueProperty:"value",baseValue:function(){return u("matrix_row")}},{name:"cells:cells",serializationProperty:"cells"},{name:"rowOrder",alternativeName:"rowsOrder",default:"initial",choices:["initial","random"]},{name:"eachRowRequired:boolean",alternativeName:"isAllRowRequired"},{name:"eachRowUnique:boolean",category:"validation"},"hideIfRowsEmpty:boolean",{name:"cellComponent",visible:!1,default:"survey-matrix-cell"}],function(){return new ir("")},"matrixbase"),st.Instance.registerQuestion("matrix",e=>{var t=new ir(e);return t.rows=st.DefaultRows,t.columns=st.DefaultColums,t});class ia extends eg{updateRemainingCharacterCounter(e,t){this.remainingCharacterCounter=a.getRemainingCharacterCounterText(e,t)}}ey([c()],ia.prototype,"remainingCharacterCounter",void 0);class io extends tU{constructor(e){super(e),this.characterCounter=new ia}isTextValue(){return!0}get maxLength(){return this.getPropertyValue("maxLength")}set maxLength(e){this.setPropertyValue("maxLength",e),this.updateRemainingCharacterCounter(this.value)}getMaxLength(){return a.getMaxLength(this.maxLength,this.survey?this.survey.maxTextLength:-1)}updateRemainingCharacterCounter(e){this.characterCounter.updateRemainingCharacterCounter(e,this.getMaxLength())}get placeHolder(){return this.placeholder}set placeHolder(e){this.placeholder=e}get locPlaceHolder(){return this.locPlaceholder}getType(){return"textbase"}isEmpty(){return super.isEmpty()||""===this.value}get textUpdateMode(){return this.getPropertyValue("textUpdateMode")}set textUpdateMode(e){this.setPropertyValue("textUpdateMode",e)}getIsInputTextUpdate(){return"default"==this.textUpdateMode?super.getIsInputTextUpdate():"onTyping"==this.textUpdateMode}get renderedPlaceholder(){return this.getPropertyValue("renderedPlaceholder",void 0,()=>this.hasPlaceholder()?this.placeHolder:void 0)}onReadOnlyChanged(){super.onReadOnlyChanged(),this.resetRenderedPlaceholder()}localeChanged(){super.localeChanged(),this.resetRenderedPlaceholder()}supportEmptyValidation(){return!0}resetRenderedPlaceholder(){this.resetPropertyValue("renderedPlaceholder")}hasPlaceholder(){return!this.isReadOnly}setNewValue(e){super.setNewValue(e),this.updateRemainingCharacterCounter(e)}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.updateRemainingCharacterCounter(e)}convertToCorrectValue(e){return Array.isArray(e)?e.join(this.getValueSeparator()):e}getValueSeparator(){return", "}getControlCssClassBuilder(){return new eV().append(this.cssClasses.root).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle)}getControlClass(){return this.getControlCssClassBuilder().toString()}get isNewA11yStructure(){return!0}}ey([c({localizable:!0,onSet:(e,t)=>t.resetRenderedPlaceholder()})],io.prototype,"placeholder",void 0),E.addClass("textbase",[],function(){return new io("")},"question");class il{setInputValue(e){this.inputElement.maxLength>=0&&this.inputElement.maxLength<e.length&&(e=e.slice(0,this.inputElement.maxLength)),this.inputElement.value=e}constructor(e,t,s){this.inputMaskInstance=e,this.inputElement=t,this.prevUnmaskedValue=void 0,this.inputMaskInstancePropertyChangedHandler=(e,t)=>{if("saveMaskedValue"!==t.name){let e=this.inputMaskInstance.getMaskedValue(this.prevUnmaskedValue);this.setInputValue(e)}},this.clickHandler=e=>{this.inputElement.value==this.inputMaskInstance.getMaskedValue("")&&this.inputElement.setSelectionRange(0,0)},this.beforeInputHandler=e=>{let t=this.createArgs(e),s=this.inputMaskInstance.processInput(t);this.setInputValue(s.value),this.inputElement.setSelectionRange(s.caretPosition,s.caretPosition),s.cancelPreventDefault||e.preventDefault()},this.changeHandler=e=>{let t=this.inputMaskInstance.processInput({prevValue:"",insertedChars:e.target.value,selectionStart:0,selectionEnd:0});this.setInputValue(t.value)};let i=s;null==i&&(i=""),this.setInputValue(e.getMaskedValue(i)),this.prevUnmaskedValue=i,e.onPropertyChanged.add(this.inputMaskInstancePropertyChangedHandler),this.addInputEventListener()}createArgs(e){let t={insertedChars:e.data,selectionStart:e.target.selectionStart,selectionEnd:e.target.selectionEnd,prevValue:e.target.value,inputDirection:"forward"};return"deleteContentBackward"===e.inputType&&(t.inputDirection="backward",t.selectionStart===t.selectionEnd&&(t.selectionStart=Math.max(t.selectionStart-1,0))),"deleteContentForward"===e.inputType&&t.selectionStart===t.selectionEnd&&(t.selectionEnd+=1),t}addInputEventListener(){this.inputElement&&(this.inputElement.addEventListener("beforeinput",this.beforeInputHandler),this.inputElement.addEventListener("click",this.clickHandler),this.inputElement.addEventListener("focus",this.clickHandler),this.inputElement.addEventListener("change",this.changeHandler))}removeInputEventListener(){this.inputElement&&(this.inputElement.removeEventListener("beforeinput",this.beforeInputHandler),this.inputElement.removeEventListener("click",this.clickHandler),this.inputElement.removeEventListener("focus",this.clickHandler),this.inputElement.removeEventListener("change",this.changeHandler))}dispose(){this.removeInputEventListener(),this.inputElement=void 0,this.inputMaskInstance.onPropertyChanged.remove(this.inputMaskInstancePropertyChangedHandler)}}var ih=/[0-9]/;function iu(){let e=(E.getChildrenClasses("masksettings")||[]).map(e=>{let t=e.name;return -1!==e.name.indexOf("mask")&&(t=t.slice(0,t.indexOf("mask"))),t});return e.unshift("none"),e}class id extends io{createMaskAdapter(){this.input&&!this.maskTypeIsEmpty&&(this.maskInputAdapter=new il(this.maskInstance,this.input,this.value))}deleteMaskAdapter(){this.maskInputAdapter&&(this.maskInputAdapter.dispose(),this.maskInputAdapter=void 0)}updateMaskAdapter(){this.deleteMaskAdapter(),this.createMaskAdapter()}onSetMaskType(e){this.setNewMaskSettingsProperty(),this.updateMaskAdapter()}get maskTypeIsEmpty(){switch(this.inputType){case"tel":case"text":return"none"===this.maskType;default:return!0}}get maskSettings(){return this.getPropertyValue("maskSettings")}set maskSettings(e){e&&(this.setNewMaskSettingsProperty(),this.maskSettings.fromJSON(e.toJSON()),this.updateMaskAdapter())}setNewMaskSettingsProperty(){this.setPropertyValue("maskSettings",this.createMaskSettings())}createMaskSettings(){let e=this.maskType&&"none"!==this.maskType?this.maskType+"mask":"masksettings";E.findClass(e)||(e="masksettings");let t=E.createClass(e);return t.owner=this.survey,t}constructor(e){super(e),this._isWaitingForEnter=!1,this.onCompositionUpdate=e=>{this.isInputTextUpdate&&setTimeout(()=>{this.updateValueOnEvent(e)},1),this.updateRemainingCharacterCounter(e.target.value)},this.onKeyUp=e=>{this.updateDateValidationMessage(e),this.isInputTextUpdate?this._isWaitingForEnter&&13!==e.keyCode||(this.updateValueOnEvent(e),this._isWaitingForEnter=!1):13===e.keyCode&&this.updateValueOnEvent(e),this.updateRemainingCharacterCounter(e.target.value)},this.onKeyDown=e=>{this.onKeyDownPreprocess&&this.onKeyDownPreprocess(e),this.isInputTextUpdate&&(this._isWaitingForEnter=229===e.keyCode),this.onTextKeyDownHandler(e)},this.onChange=e=>{this.updateDateValidationMessage(e),e.target===tp.environment.root.activeElement?this.isInputTextUpdate&&this.updateValueOnEvent(e):this.updateValueOnEvent(e),this.updateRemainingCharacterCounter(e.target.value)},this.createLocalizableString("minErrorText",this,!0,"minError"),this.createLocalizableString("maxErrorText",this,!0,"maxError"),this.setNewMaskSettingsProperty(),this.locDataListValue=new eJ(this),this.locDataListValue.onValueChanged=(e,t)=>{this.propertyValueChanged("dataList",e,t)},this.registerPropertyChangedHandlers(["min","max","inputType","minValueExpression","maxValueExpression"],()=>{this.setRenderedMinMax()}),this.registerPropertyChangedHandlers(["inputType","inputSize"],()=>{this.resetInputSize(),this.resetRenderedPlaceholder()})}isTextValue(){return this.isDateInputType||["text","number","password"].indexOf(this.inputType)>-1}getType(){return"text"}onSurveyLoad(){super.onSurveyLoad(),this.setRenderedMinMax()}get inputType(){return this.getPropertyValue("inputType")}set inputType(e){("datetime_local"===(e=e.toLowerCase())||"datetime"===e)&&(e="datetime-local"),this.setPropertyValue("inputType",e.toLowerCase()),this.isLoadingFromJson||(this.min=void 0,this.max=void 0,this.step=void 0),this.updateMaskAdapter()}getMaxLength(){return this.isTextInput?super.getMaxLength():null}runConditionCore(e,t){super.runConditionCore(e,t),(this.minValueExpression||this.maxValueExpression)&&this.setRenderedMinMax(e,t)}getDisplayValueCore(e,t){return this.maskTypeIsEmpty||a.isValueEmpty(t)?super.getDisplayValueCore(e,t):this.maskInstance.getMaskedValue(t)}isLayoutTypeSupported(e){return!0}get inputSize(){return this.getPropertyValue("inputSize")}set inputSize(e){this.setPropertyValue("inputSize",e)}get size(){return this.inputSize}set size(e){this.inputSize=e}get isTextInput(){return["text","search","tel","url","email","password"].indexOf(this.inputType)>-1}get renderedInputSize(){return this.getPropertyValue("renderedInputSize",void 0,()=>{let e=this.calInputSize();return e>0?e:void 0})}get inputWidth(){return this.getPropertyValue("inputWidth",void 0,()=>this.calInputSize()>0?"auto":"")}calInputSize(){if(!this.isTextInput)return 0;let e=this.inputSize>0?this.inputSize:0;return e<1&&this.parent&&this.parent.inputSize&&(e=this.parent.inputSize),e}resetInputSize(){this.resetPropertyValue("renderedInputSize"),this.resetPropertyValue("inputWidth")}get autocomplete(){return this.getPropertyValue("autocomplete",null)}set autocomplete(e){this.setPropertyValue("autocomplete",e)}get min(){return this.getPropertyValue("min")}set min(e){if(this.isValueExpression(e)){this.minValueExpression=e.substring(1);return}this.setPropertyValue("min",e)}get max(){return this.getPropertyValue("max")}set max(e){if(this.isValueExpression(e)){this.maxValueExpression=e.substring(1);return}this.setPropertyValue("max",e)}get minValueExpression(){return this.getPropertyValue("minValueExpression","")}set minValueExpression(e){this.setPropertyValue("minValueExpression",e)}get maxValueExpression(){return this.getPropertyValue("maxValueExpression","")}set maxValueExpression(e){this.setPropertyValue("maxValueExpression",e)}get renderedMin(){return this.getPropertyValue("renderedMin")}get renderedMax(){return this.getPropertyValue("renderedMax")}get minErrorText(){return this.getLocalizableStringText("minErrorText")}set minErrorText(e){this.setLocalizableStringText("minErrorText",e)}get locMinErrorText(){return this.getLocalizableString("minErrorText")}get maxErrorText(){return this.getLocalizableStringText("maxErrorText")}set maxErrorText(e){this.setLocalizableStringText("maxErrorText",e)}get locMaxErrorText(){return this.getLocalizableString("maxErrorText")}get isMinMaxType(){return ig(this)}get maskInstance(){return this.maskSettings}get inputValue(){return this._inputValue||this.maskTypeIsEmpty?this._inputValue:this.maskInstance.getMaskedValue("")}set inputValue(e){let t=e;this._inputValue=e,!this.maskTypeIsEmpty&&(t=this.maskInstance.getUnmaskedValue(e),this._inputValue=this.maskInstance.getMaskedValue(t),t&&this.maskSettings.saveMaskedValue&&(t=this.maskInstance.getMaskedValue(t))),this.value=t}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.updateInputValue()}updateInputValue(){this.maskTypeIsEmpty?this._inputValue=this.value:this.maskSettings.saveMaskedValue?this._inputValue=this.value?this.value:this.maskInstance.getMaskedValue(""):this._inputValue=this.maskInstance.getMaskedValue(this.value)}hasToConvertToUTC(e){return tp.storeUtcDates&&this.isDateTimeLocaleType()&&!!e}createDate(e){return n("question-text",e)}valueForSurveyCore(e){return this.hasToConvertToUTC(e)&&(e=this.createDate(e).toISOString()),super.valueForSurveyCore(e)}valueFromDataCore(e){if(this.hasToConvertToUTC(e)){let t=this.createDate(e),s=this.createDate(t.getTime()-6e4*t.getTimezoneOffset()).toISOString();e=s.substring(0,s.length-2)}return super.valueFromDataCore(e)}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),t)return;if(this.isValueLessMin){let t=new tA(this.getMinMaxErrorText(this.minErrorText,this.getCalculatedMinMax(this.renderedMin)),this);t.onUpdateErrorTextCallback=e=>{e.text=this.getMinMaxErrorText(this.minErrorText,this.getCalculatedMinMax(this.renderedMin))},e.push(t)}if(this.isValueGreaterMax){let t=new tA(this.getMinMaxErrorText(this.maxErrorText,this.getCalculatedMinMax(this.renderedMax)),this);t.onUpdateErrorTextCallback=e=>{e.text=this.getMinMaxErrorText(this.maxErrorText,this.getCalculatedMinMax(this.renderedMax))},e.push(t)}this.dateValidationMessage&&e.push(new tA(this.dateValidationMessage,this));let i=this.getValidatorTitle(),r=new t_;if(r.errorOwner=this,"email"===this.inputType&&!this.validators.some(e=>"emailvalidator"===e.getType())){let t=r.validate(this.value,i);t&&t.error&&e.push(t.error)}}canSetValueToSurvey(){if(!this.isMinMaxType)return!0;let e=!this.isValueLessMin&&!this.isValueGreaterMax;return(!e||this.errors.length>0)&&this.survey&&(this.survey.isValidateOnValueChanging||this.survey.isValidateOnValueChanged)&&this.hasErrors(),e}convertFuncValuetoQuestionValue(e){let t=this.maskTypeIsEmpty?this.inputType:this.maskSettings.getTypeForExpressions();return a.convertValToQuestionVal(e,t)}getMinMaxErrorText(e,t){if(a.isValueEmpty(t))return e;let s=t.toString();return"date"===this.inputType&&t.toDateString&&(s=t.toDateString()),e.replace("{0}",s)}get isValueLessMin(){return!this.isValueEmpty(this.renderedMin)&&!this.isEmpty()&&this.getCalculatedMinMax(this.value)<this.getCalculatedMinMax(this.renderedMin)}get isValueGreaterMax(){return!this.isValueEmpty(this.renderedMax)&&!this.isEmpty()&&this.getCalculatedMinMax(this.value)>this.getCalculatedMinMax(this.renderedMax)}get isDateInputType(){return"date"===this.inputType||this.isDateTimeLocaleType()}isDateTimeLocaleType(){return"datetime-local"===this.inputType}getCalculatedMinMax(e){return this.isValueEmpty(e)?e:this.isDateInputType?this.createDate(e):e}setRenderedMinMax(e=null,t=null){this.minValueRunner=this.getDefaultRunner(this.minValueRunner,this.minValueExpression),this.setValueAndRunExpression(this.minValueRunner,this.min,e=>{!e&&this.isDateInputType&&tp.minDate&&(e=tp.minDate),this.setPropertyValue("renderedMin",e)},e,t),this.maxValueRunner=this.getDefaultRunner(this.maxValueRunner,this.maxValueExpression),this.setValueAndRunExpression(this.maxValueRunner,this.max,e=>{!e&&this.isDateInputType&&(e=tp.maxDate?tp.maxDate:"2999-12-31"),this.setPropertyValue("renderedMax",e)},e,t)}get step(){return this.getPropertyValue("step")}set step(e){this.setPropertyValue("step",e)}get renderedStep(){return this.isValueEmpty(this.step)?"number"!==this.inputType?void 0:"any":this.step}getIsInputTextUpdate(){return!!this.maskTypeIsEmpty&&super.getIsInputTextUpdate()}supportAutoAdvance(){return!this.getIsInputTextUpdate()&&!this.isDateInputType}supportGoNextPageError(){return!this.isDateInputType}get dataList(){return this.locDataList.value}set dataList(e){this.locDataList.value=e}get locDataList(){return this.locDataListValue}get dataListId(){return this.locDataList.hasValue()?this.id+"_datalist":void 0}setNewValue(e){(e=this.correctValueType(e))&&(this.dateValidationMessage=void 0),super.setNewValue(e)}correctValueType(e){if(!e)return e;if("number"===this.inputType||"range"===this.inputType)return a.isNumber(e)?a.getNumber(e):"";if("month"===this.inputType){let t=this.createDate(e),s=0==t.toISOString().indexOf(e)&&-1==e.indexOf("T"),i=s?t.getUTCMonth():t.getMonth(),r=s?t.getUTCFullYear():t.getFullYear(),n=i+1;return r+"-"+(n<10?"0":"")+n}return e}hasPlaceholder(){return!this.isReadOnly&&"range"!==this.inputType}getControlCssClassBuilder(){let e=this.getMaxLength();return super.getControlCssClassBuilder().append(this.cssClasses.constrolWithCharacterCounter,!!e).append(this.cssClasses.characterCounterBig,e>99)}isReadOnlyRenderDiv(){return this.isReadOnly&&"div"===tp.readOnly.textRenderMode}get inputStyle(){var e={};return e.width=this.inputWidth,this.updateTextAlign(e),e}updateTextAlign(e){"auto"!==this.inputTextAlignment?e.textAlign=this.inputTextAlignment:this.maskTypeIsEmpty||"auto"===this.maskSettings.getTextAlignment()||(e.textAlign=this.maskSettings.getTextAlignment())}updateValueOnEvent(e){let t=e.target.value;this.isTwoValueEquals(this.value,t)||(this.inputValue=t)}updateDateValidationMessage(e){this.dateValidationMessage=this.isDateInputType&&e.target?e.target.validationMessage:void 0}onBlurCore(e){this.updateDateValidationMessage(e),this.updateValueOnEvent(e),this.updateRemainingCharacterCounter(e.target.value),super.onBlurCore(e)}onFocusCore(e){this.updateRemainingCharacterCounter(e.target.value),super.onFocusCore(e)}afterRenderQuestionElement(e){e&&(this.input=e instanceof HTMLInputElement?e:e.querySelector("input"),this.createMaskAdapter()),super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){this.deleteMaskAdapter(),this.input=void 0}}ey([c({onSet:(e,t)=>{t.onSetMaskType(e)}})],id.prototype,"maskType",void 0),ey([c()],id.prototype,"inputTextAlignment",void 0),ey([c()],id.prototype,"_inputValue",void 0);let ic=["number","range","date","datetime-local","month","time","week"];function ig(e){let t=e?e.inputType:"";return!!t&&ic.indexOf(t)>-1}function ip(e,t){let s=e.split(t);return 2===s.length&&a.isNumber(s[0])&&a.isNumber(s[1])?60*parseFloat(s[0])+parseFloat(s[1]):-1}function im(e,t,s,i){let r=i?s:t;if(!ig(e)||a.isValueEmpty(t)||a.isValueEmpty(s))return r;if(0===e.inputType.indexOf("date")||"month"===e.inputType){let a="month"===e.inputType,o="question-text-minmax",l=n(o,a?t+"-01":t),h=n(o,a?s+"-01":s);if(!l||!h)return r;if(l>h)return i?t:s}if("week"===e.inputType||"time"===e.inputType)return!function(e,t,s){let i=ip(e,s),r=ip(t,s);return!(i<0)&&!(r<0)&&i>r}(t,s,"week"===e.inputType?"-W":":")?r:i?t:s;if("number"===e.inputType){if(!a.isNumber(t)||!a.isNumber(s))return r;if(a.getNumber(t)>a.getNumber(s))return i?t:s}return"string"==typeof t||"string"==typeof s?r:t>s?i?t:s:r}function iv(e,t){e&&e.inputType&&(t.inputType="range"!==e.inputType?e.inputType:"number",t.textUpdateMode="onBlur")}E.addClass("text",[{name:"inputType",default:"text",choices:tp.questions.inputTypes},{name:"inputSize:number",alternativeName:"size",minValue:0,dependsOn:"inputType",visibleIf:function(e){return!!e&&e.isTextInput}},{name:"textUpdateMode",default:"default",choices:["default","onBlur","onTyping"],dependsOn:"inputType",visibleIf:function(e){return!!e&&e.isTextInput}},{name:"autocomplete",alternativeName:"autoComplete",choices:tp.questions.dataList},{name:"min",dependsOn:"inputType",visibleIf:function(e){return ig(e)},onPropertyEditorUpdate:function(e,t){iv(e,t)},onSettingValue:(e,t)=>im(e,t,e.max,!1)},{name:"max",dependsOn:"inputType",nextToProperty:"*min",visibleIf:function(e){return ig(e)},onSettingValue:(e,t)=>im(e,e.min,t,!0),onPropertyEditorUpdate:function(e,t){iv(e,t)}},{name:"minValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(e){return ig(e)}},{name:"maxValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(e){return ig(e)}},{name:"minErrorText",serializationProperty:"locMinErrorText",dependsOn:"inputType",visibleIf:function(e){return ig(e)}},{name:"maxErrorText",serializationProperty:"locMaxErrorText",dependsOn:"inputType",visibleIf:function(e){return ig(e)}},{name:"inputTextAlignment",default:"auto",choices:["left","right","auto"]},{name:"maskType",default:"none",visibleIndex:0,dependsOn:"inputType",visibleIf:e=>"text"===e.inputType||"tel"===e.inputType,choices:e=>iu()},{name:"maskSettings:masksettings",className:"masksettings",visibleIndex:1,dependsOn:["inputType","maskType"],visibleIf:e=>"text"===e.inputType||"tel"===e.inputType,onGetValue:function(e){return e.maskSettings.getData()},onSetValue:function(e,t){e.maskSettings.setData(t)}},{name:"step:number",dependsOn:"inputType",visibleIf:function(e){return!!e&&("number"===e.inputType||"range"===e.inputType)}},{name:"maxLength:number",default:-1,dependsOn:"inputType",visibleIf:function(e){return!!e&&e.isTextInput}},{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder",dependsOn:"inputType",visibleIf:function(e){return!!e&&e.isTextInput}},{name:"dataList:string[]",serializationProperty:"locDataList",dependsOn:"inputType",visibleIf:function(e){return!!e&&"text"===e.inputType}}],function(){return new id("")},"textbase"),st.Instance.registerQuestion("text",e=>new id(e));class iy extends id{get a11y_input_ariaLabel(){return this.locTitle.renderedHtml}get a11y_input_ariaLabelledBy(){return null}get a11y_input_ariaDescribedBy(){return null}}class iC extends eg{constructor(e=null,t=null){super(),this.focusIn=()=>{this.editor.focusIn()},this.editorValue=this.createEditor(e),this.maskSettings=this.editorValue.maskSettings,this.editor.questionTitleTemplateCallback=function(){return""},this.editor.titleLocation="left",t&&(this.title=t),this.editor.onPropertyChanged.add((e,t)=>{this.onPropertyChanged.fire(this,t)})}getType(){return"multipletextitem"}get id(){return this.editor.id}getOriginalObj(){return this.editor}get name(){return this.editor.name}set name(e){this.editor.name=e}get question(){return this.data}get editor(){return this.editorValue}createEditor(e){return new iy(e)}addUsedLocales(e){super.addUsedLocales(e),this.editor.addUsedLocales(e)}localeChanged(){super.localeChanged(),this.editor.localeChanged()}locStrsChanged(){super.locStrsChanged(),this.editor.locStrsChanged()}setData(e){this.data=e,e&&(this.editor.defaultValue=e.getItemDefaultValue(this.name),this.editor.setSurveyImpl(this),this.editor.parent=e,this.editor.setParentQuestion(e))}get isRequired(){return this.editor.isRequired}set isRequired(e){this.editor.isRequired=e}get inputType(){return this.editor.inputType}set inputType(e){this.editor.inputType=e}get title(){return this.editor.title}set title(e){this.editor.title=e}get locTitle(){return this.editor.locTitle}get fullTitle(){return this.editor.fullTitle}get maxLength(){return this.editor.maxLength}set maxLength(e){this.editor.maxLength=e}getMaxLength(){var e=this.getSurvey();return a.getMaxLength(this.maxLength,e?e.maxTextLength:-1)}get placeholder(){return this.editor.placeholder}set placeholder(e){this.editor.placeholder=e}get locPlaceholder(){return this.editor.locPlaceholder}get placeHolder(){return this.placeholder}set placeHolder(e){this.placeholder=e}get locPlaceHolder(){return this.locPlaceholder}get requiredErrorText(){return this.editor.requiredErrorText}set requiredErrorText(e){this.editor.requiredErrorText=e}get locRequiredErrorText(){return this.editor.locRequiredErrorText}get inputSize(){return this.editor.inputSize}set inputSize(e){this.editor.inputSize=e}get size(){return this.inputSize}set size(e){this.inputSize=e}get defaultValueExpression(){return this.editor.defaultValueExpression}set defaultValueExpression(e){this.editor.defaultValueExpression=e}get minValueExpression(){return this.editor.minValueExpression}set minValueExpression(e){this.editor.minValueExpression=e}get maxValueExpression(){return this.editor.maxValueExpression}set maxValueExpression(e){this.editor.maxValueExpression=e}get validators(){return this.editor.validators}set validators(e){this.editor.validators=e}getValidators(){return this.validators}get maskType(){return this.editor.maskType}set maskType(e){this.editor.maskType=e,this.maskSettings=this.editor.maskSettings}get maskSettings(){return this.getPropertyValue("maskSettings")}set maskSettings(e){this.setPropertyValue("maskSettings",e),this.editor.maskSettings!==e&&(this.editor.maskSettings=e)}get inputTextAlignment(){return this.editor.inputTextAlignment}set inputTextAlignment(e){this.editor.inputTextAlignment=e}get value(){return this.data?this.data.getMultipleTextValue(this.name):null}set value(e){null!=this.data&&this.data.setMultipleTextValue(this.name,e)}isEmpty(){return this.editor.isEmpty()}onValueChanged(e){this.valueChangedCallback&&this.valueChangedCallback(e)}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.data?this.data.getTextProcessor():null}getValue(e){return this.data?this.data.getMultipleTextValue(e):null}setValue(e,t){this.data&&this.data.setMultipleTextValue(e,t)}getVariable(e){}setVariable(e,t){}getComment(e){return null}setComment(e,t){}getAllValues(){return this.data?this.data.getAllValues():this.value}getFilteredValues(){return this.getAllValues()}getFilteredProperties(){return{survey:this.getSurvey()}}findQuestionByName(e){let t=this.getSurvey();return t?t.getQuestionByName(e):null}getEditingSurveyElement(){}getValidatorTitle(){return this.title}get validatedValue(){return this.value}set validatedValue(e){this.value=e}getDataFilteredValues(){return this.getFilteredValues()}getDataFilteredProperties(){return this.getFilteredProperties()}}class ib extends tU{static addDefaultItems(e){for(var t=st.DefaultMutlipleTextItems,s=0;s<t.length;s++)e.addItem(t[s])}constructor(e){super(e),this.isMultipleItemValueChanging=!1,this.createNewArray("items",e=>{e.setData(this),this.survey&&this.survey.multipleTextItemAdded(this,e)}),this.registerPropertyChangedHandlers(["items","colCount","itemErrorLocation"],()=>{this.calcVisibleRows()}),this.registerPropertyChangedHandlers(["inputSize"],()=>{this.resetItemsSize()})}getType(){return"multipletext"}setSurveyImpl(e,t){super.setSurveyImpl(e,t);for(var s=0;s<this.items.length;s++)this.items[s].setData(this)}get isAllowTitleLeft(){return!1}get hasSingleInput(){return!1}get isContainer(){return!0}get id(){return this.getPropertyValue("id")}set id(e){var t;null===(t=this.items)||void 0===t||t.map((t,s)=>t.editor.id=e+"_"+s),this.setPropertyValue("id",e)}onSurveyLoad(){this.editorsOnSurveyLoad(),super.onSurveyLoad(),a.isValueEmpty(this.rows)||this.calcVisibleRows()}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.performForEveryEditor(e=>{e.editor.updateValueFromSurvey(e.value)}),this.updateIsAnswered()}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.performForEveryEditor(e=>{e.editor.onSurveyValueChanged(e.value)})}resetItemsSize(){this.performForEveryEditor(e=>{e.editor.resetInputSize()})}editorsOnSurveyLoad(){this.performForEveryEditor(e=>{e.editor.onSurveyLoad()})}performForEveryEditor(e){for(var t=0;t<this.items.length;t++){var s=this.items[t];s.editor&&e(s)}}get items(){return this.getPropertyValue("items")}set items(e){this.setPropertyValue("items",e)}addItem(e,t=null){var s=this.createTextItem(e,t);return this.items.push(s),s}getItemByName(e){for(var t=0;t<this.items.length;t++)if(this.items[t].name==e)return this.items[t];return null}getElementsInDesign(e=!1){return super.getElementsInDesign(e).concat(this.items)}addConditionObjectsByContext(e,t){for(var s=0;s<this.items.length;s++){var i=this.items[s];e.push({name:this.getValueName()+"."+i.name,text:this.processedTitle+"."+i.fullTitle,question:this})}}collectNestedQuestionsCore(e,t){this.items.forEach(s=>s.editor.collectNestedQuestions(e,t))}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=this.getItemByName(t);if(!s)return null;var i=new I().toJsonObject(s);return i.type="text",i}locStrsChanged(){super.locStrsChanged();for(var e=0;e<this.items.length;e++)this.items[e].locStrsChanged()}localeChanged(){super.localeChanged();for(var e=0;e<this.items.length;e++)this.items[e].localeChanged()}get itemErrorLocation(){return this.getPropertyValue("itemErrorLocation")}set itemErrorLocation(e){this.setPropertyValue("itemErrorLocation",e)}getQuestionErrorLocation(){return"default"!==this.itemErrorLocation?this.itemErrorLocation:this.getErrorLocation()}get showItemErrorOnTop(){return"top"==this.getQuestionErrorLocation()}get showItemErrorOnBottom(){return"bottom"==this.getQuestionErrorLocation()}getChildErrorLocation(e){return this.getQuestionErrorLocation()}isNewValueCorrect(e){return a.isValueObject(e,!0)}supportAutoAdvance(){for(var e=0;e<this.items.length;e++)if(this.items[e].isEmpty())return!1;return!0}get colCount(){return this.getPropertyValue("colCount")}set colCount(e){e<1||e>5||this.setPropertyValue("colCount",e)}get inputSize(){return this.getPropertyValue("inputSize")}set inputSize(e){this.setPropertyValue("inputSize",e)}get itemSize(){return this.inputSize}set itemSize(e){this.inputSize=e}get itemTitleWidth(){return this.getPropertyValue("itemTitleWidth")||""}set itemTitleWidth(e){this.setPropertyValue("itemTitleWidth",e)}onRowCreated(e){return e}calcVisibleRows(){let e,t;let s=this.colCount,i=this.items,r=0,n=[];for(var a=0;a<i.length;a++)0==r&&(e=this.onRowCreated(new iV),t=this.onRowCreated(new iw),this.showItemErrorOnTop?(n.push(t),n.push(e)):(n.push(e),n.push(t))),e.cells.push(new ix(i[a],this)),t.cells.push(new iP(i[a],this)),(++r>=s||a==i.length-1)&&(r=0,t.onAfterCreated());this.rows=n}getRows(){return a.isValueEmpty(this.rows)&&this.calcVisibleRows(),this.rows}onValueChanged(){super.onValueChanged(),this.onItemValueChanged()}createTextItem(e,t){return new iC(e,t)}onItemValueChanged(){if(!this.isMultipleItemValueChanging)for(var e=0;e<this.items.length;e++){var t=null;this.value&&this.items[e].name in this.value&&(t=this.value[this.items[e].name]),this.items[e].onValueChanged(t)}}runConditionCore(e,t){super.runConditionCore(e,t),this.items.forEach(s=>s.editor.runCondition(e,t))}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;for(var e=0;e<this.items.length;e++)if(this.items[e].editor.isRunningValidators)return!0;return!1}hasErrors(e=!0,t=null){for(var s=!1,i=0;i<this.items.length;i++)this.items[i].editor.onCompletedAsyncValidators=e=>{this.raiseOnCompletedAsyncValidators()},t&&!0===t.isOnValueChanged&&this.items[i].editor.isEmpty()||(s=this.items[i].editor.hasErrors(e,t)||s);return super.hasErrors(e)||s}getAllErrors(){for(var e=super.getAllErrors(),t=0;t<this.items.length;t++){var s=this.items[t].editor.getAllErrors();s&&s.length>0&&(e=e.concat(s))}return e}clearErrors(){super.clearErrors();for(var e=0;e<this.items.length;e++)this.items[e].editor.clearErrors()}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.items,s=0;s<t.length;s++)if(t[s].editor.containsErrors)return!0;return!1}getIsAnswered(){if(!super.getIsAnswered())return!1;for(var e=0;e<this.items.length;e++){var t=this.items[e].editor;if(t.isVisible&&!t.isAnswered)return!1}return!0}getProgressInfo(){for(var e=[],t=0;t<this.items.length;t++)e.push(this.items[t].editor);return eW.getProgressInfoByElements(e,this.isRequired)}getDisplayValueCore(e,t){if(!t)return t;for(var s={},i=0;i<this.items.length;i++){var r=this.items[i],n=t[r.name];if(!a.isValueEmpty(n)){var o=r.name;e&&r.title&&(o=r.title),s[o]=r.editor.getDisplayValue(e,n)}}return s}allowMobileInDesignMode(){return!0}getMultipleTextValue(e){return this.value?this.value[e]:null}setMultipleTextValue(e,t){this.isMultipleItemValueChanging=!0,this.isValueEmpty(t)&&(t=void 0);var s=this.value;s||(s={}),s[e]=t,this.setNewValue(s),this.isMultipleItemValueChanging=!1}getItemDefaultValue(e){return this.defaultValue?this.defaultValue[e]:null}getTextProcessor(){return this.textProcessor}getAllValues(){return this.data?this.data.getAllValues():null}addElement(e,t){}removeElement(e){return!1}getQuestionTitleLocation(){return"left"}getQuestionTitleWidth(){}getColumsForElement(e){return[]}updateColumns(){}getQuestionStartIndex(){return this.getStartIndex()}getChildrenLayoutType(){return"row"}elementWidthChanged(e){}get elements(){return[]}indexOf(e){return -1}ensureRowsVisibility(){}validateContainerOnly(){}onQuestionValueChanged(e){}getItemLabelCss(e){return new eV().append(this.cssClasses.itemLabel).append(this.cssClasses.itemLabelDisabled,this.isDisabledStyle).append(this.cssClasses.itemLabelReadOnly,this.isReadOnlyStyle).append(this.cssClasses.itemLabelPreview,this.isPreviewStyle).append(this.cssClasses.itemLabelAnswered,e.editor.isAnswered).append(this.cssClasses.itemLabelAllowFocus,!this.isDesignMode).append(this.cssClasses.itemLabelOnError,e.editor.errors.length>0).append(this.cssClasses.itemWithCharacterCounter,!!e.getMaxLength()).toString()}getItemCss(){return new eV().append(this.cssClasses.item).toString()}getItemTitleCss(){return new eV().append(this.cssClasses.itemTitle).toString()}}ey([p()],ib.prototype,"rows",void 0);class iV extends eg{constructor(){super(...arguments),this.isVisible=!0,this.cells=[]}}ey([c()],iV.prototype,"isVisible",void 0),ey([p()],iV.prototype,"cells",void 0);class iw extends iV{onAfterCreated(){let e=()=>{this.isVisible=this.cells.some(e=>{var t,s;return(null===(t=e.item)||void 0===t?void 0:t.editor)&&(null===(s=e.item)||void 0===s?void 0:s.editor.hasVisibleErrors)})};this.cells.forEach(t=>{var s,i;(null===(s=t.item)||void 0===s?void 0:s.editor)&&(null===(i=t.item)||void 0===i||i.editor.registerFunctionOnPropertyValueChanged("hasVisibleErrors",e))}),e()}}class ix{constructor(e,t){this.item=e,this.question=t,this.isErrorsCell=!1}getClassName(){return new eV().append(this.question.cssClasses.cell).toString()}get className(){return this.getClassName()}}class iP extends ix{constructor(){super(...arguments),this.isErrorsCell=!0}getClassName(){return new eV().append(super.getClassName()).append(this.question.cssClasses.cellError).append(this.question.cssClasses.cellErrorTop,this.question.showItemErrorOnTop).append(this.question.cssClasses.cellErrorBottom,this.question.showItemErrorOnBottom).toString()}}E.addClass("multipletextitem",[{name:"!name",isUnique:!0},"isRequired:boolean",{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder"},{name:"inputType",default:"text",choices:tp.questions.inputTypes},{name:"maskType",default:"none",visibleIndex:0,dependsOn:"inputType",visibleIf:e=>"text"===e.inputType,choices:e=>iu()},{name:"maskSettings:masksettings",className:"masksettings",visibleIndex:1,dependsOn:"inputType",visibleIf:e=>"text"===e.inputType,onGetValue:function(e){return e.maskSettings.getData()},onSetValue:function(e,t){e.maskSettings.setData(t)}},{name:"inputTextAlignment",default:"auto",choices:["left","right","auto"]},{name:"title",serializationProperty:"locTitle"},{name:"maxLength:number",default:-1},{name:"inputSize:number",alternativeName:"size",minValue:0},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"defaultValueExpression:expression",visible:!1},{name:"minValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(e){return ig(e)}},{name:"maxValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(e){return ig(e)}},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"}],function(){return new iC("")}),E.addClass("multipletext",[{name:"!items:textitems",className:"multipletextitem",isArray:!0},{name:"inputSize:number",minValue:0,visible:!1,alternativeName:"itemSize"},{name:"colCount:number",default:1,choices:[1,2,3,4,5]},{name:"itemErrorLocation",default:"default",choices:["default","top","bottom"],visible:!1},{name:"itemTitleWidth",category:"layout"}],function(){return new ib("")},"question"),st.Instance.registerQuestion("multipletext",e=>{var t=new ib(e);return ib.addDefaultItems(t),t});class iT extends sJ{constructor(e=""){super(e),this.createLocalizableString("content",this,!0),this.registerPropertyChangedHandlers(["content"],()=>{this.onContentChanged()})}getType(){return"flowpanel"}getChildrenLayoutType(){return"flow"}onSurveyLoad(){super.onSurveyLoad(),this.onContentChanged()}get content(){return this.getLocalizableStringText("content")}set content(e){this.setLocalizableStringText("content",e)}get locContent(){return this.getLocalizableString("content")}get html(){return this.getPropertyValue("html","")}set html(e){this.setPropertyValue("html",e)}onContentChanged(){var e="";e=this.onCustomHtmlProducing?this.onCustomHtmlProducing():this.produceHtml(),this.html=e,this.contentChangedCallback&&this.contentChangedCallback()}produceHtml(){for(var e=[],t=/{(.*?(element:)[^$].*?)}/g,s=this.content,i=0,r=null;null!==(r=t.exec(s));){r.index>i&&(e.push(s.substring(i,r.index)),i=r.index);var n=this.getQuestionFromText(r[0]);n?e.push(this.getHtmlForQuestion(n)):e.push(s.substring(i,r.index+r[0].length)),i=r.index+r[0].length}return i<s.length&&e.push(s.substring(i,s.length)),e.join("").replace(RegExp("<br>","g"),"<br/>")}getQuestionFromText(e){return e=(e=e.substring(1,e.length-1)).replace(iT.contentElementNamePrefix,"").trim(),this.getQuestionByName(e)}getHtmlForQuestion(e){return this.onGetHtmlForQuestion?this.onGetHtmlForQuestion(e):""}getQuestionHtmlId(e){return this.name+"_"+e.id}onAddElement(e,t){super.onAddElement(e,t),this.addElementToContent(e),e.renderWidth=""}onRemoveElement(e){var t=this.getElementContentText(e);this.content=this.content.replace(t,""),super.onRemoveElement(e)}dragDropMoveElement(e,t,s){}addElementToContent(e){if(!this.isLoadingFromJson){var t=this.getElementContentText(e);this.insertTextAtCursor(t)||(this.content=this.content+t)}}insertTextAtCursor(e,t=null){if(!this.isDesignMode||!i.isAvailable())return!1;let s=i.getSelection();if(s.getRangeAt&&s.rangeCount){let i=s.getRangeAt(0);i.deleteContents();let n=new Text(e);if(i.insertNode(n),this.getContent){var r=this.getContent(t);this.content=r}return!0}return!1}getElementContentText(e){return"{"+iT.contentElementNamePrefix+e.name+"}"}}iT.contentElementNamePrefix="element:",E.addClass("flowpanel",[{name:"content:html",serializationProperty:"locContent"}],function(){return new iT},"panel");class iS extends tU{constructor(e){super(e)}getType(){return"nonvalue"}get hasInput(){return!1}get hasTitle(){return!1}getTitleLocation(){return""}get hasComment(){return!1}hasErrors(e=!0,t=null){return!1}getAllErrors(){return[]}supportAutoAdvance(){return!1}addConditionObjectsByContext(e,t){}getConditionJson(e=null,t=null){return null}get ariaRole(){return null}get ariaRequired(){return null}}E.addClass("nonvalue",[{name:"title",visible:!1},{name:"description",visible:!1},{name:"valueName",visible:!1},{name:"enableIf",visible:!1},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"clearIfInvisible",visible:!1},{name:"isRequired",visible:!1,isSerializable:!1},{name:"requiredErrorText",visible:!1},{name:"readOnly",visible:!1},{name:"requiredIf",visible:!1},{name:"validators",visible:!1},{name:"titleLocation",visible:!1},{name:"showCommentArea",visible:!1},{name:"useDisplayValuesInDynamicTexts",alternativeName:"useDisplayValuesInTitle",visible:!1}],function(){return new iS("")},"question");class iI extends tU{constructor(e){super(e)}getType(){return"empty"}}E.addClass("empty",[],function(){return new iI("")},"question");class iE extends s2{constructor(e){super(e),this.invisibleOldValues={},this.isChangingValueOnClearIncorrect=!1,this.selectAllItemValue=new tJ(""),this.selectAllItemValue.id="selectall",this.selectAllItemText=this.createLocalizableString("selectAllText",this.selectAllItem,!0,"selectAllItemText"),this.selectAllItem.locOwner=this,this.selectAllItem.setLocText(this.selectAllItemText),this.registerPropertyChangedHandlers(["showSelectAllItem","selectAllText"],()=>{this.onVisibleChoicesChanged()})}getDefaultItemComponent(){return"survey-checkbox-item"}getType(){return"checkbox"}onCreating(){super.onCreating(),this.createNewArray("renderedValue"),this.createNewArray("value")}getFirstInputElementId(){return this.inputId+"_0"}get valuePropertyName(){return this.getPropertyValue("valuePropertyName")}set valuePropertyName(e){this.setPropertyValue("valuePropertyName",e)}getQuestionFromArray(e,t){if(e&&e===this.valuePropertyName){let e=this.value;if(Array.isArray(e)&&t<e.length)return this}return null}get selectAllItem(){return this.selectAllItemValue}get selectAllText(){return this.getLocalizableStringText("selectAllText")}set selectAllText(e){this.setLocalizableStringText("selectAllText",e)}get locSelectAllText(){return this.getLocalizableString("selectAllText")}get showSelectAllItem(){return this.getPropertyValue("showSelectAllItem")}set showSelectAllItem(e){this.setPropertyValue("showSelectAllItem",e)}get hasSelectAll(){return this.showSelectAllItem}set hasSelectAll(e){this.showSelectAllItem=e}get isAllSelected(){return this.allElementsSelected()}set isAllSelected(e){e?this.selectAll():this.clearValue(!0)}toggleSelectAll(){this.isAllSelected=!this.isAllSelected}allElementsSelected(){let e=this.getNoneItems();for(let t=0;t<e.length;t++)if(this.isItemSelected(e[t]))return!1;let t=this.getVisibleEnableItems();if(0===t.length)return!1;let s=this.value;if(!s||!Array.isArray(s)||0===s.length||s.length<t.length)return!1;let i=[];for(let e=0;e<s.length;e++)i.push(this.getRealValue(s[e]));for(let e=0;e<t.length;e++)if(0>i.indexOf(t[e].value))return!1;return!0}selectAll(){let e=[],t=this.getVisibleEnableItems();for(let s=0;s<t.length;s++)e.push(t[s].value);this.renderedValue=e}clickItemHandler(e,t){if(!this.isReadOnlyAttr){if(e===this.selectAllItem)!0===t||!1===t?this.isAllSelected=t:this.toggleSelectAll();else if(this.isNoneItem(e))this.renderedValue=t?[e.value]:[];else{let s=[].concat(this.renderedValue||[]),i=s.indexOf(e.value);t?i<0&&s.push(e.value):i>-1&&s.splice(i,1),this.renderedValue=s}}}isItemSelectedCore(e){if(e===this.selectAllItem)return this.isAllSelected;var t=this.renderedValue;if(!t||!Array.isArray(t))return!1;for(var s=0;s<t.length;s++)if(this.isTwoValueEquals(t[s],e.value))return!0;return!1}hasUnknownValueItem(e,t=!1,s=!0,i=!1){let r=this.valuePropertyName;return r&&"object"==typeof e&&void 0!==e[r]&&(e=e[r]),super.hasUnknownValueItem(e,t,s,i)}convertFuncValuetoQuestionValue(e){if(this.valuePropertyName&&Array.isArray(e)&&e.length>0){let t=[];e.forEach(e=>{let s="object"==typeof e,i=s?e:{};s||(i[this.valuePropertyName]=e),t.push(i)}),e=t}return super.convertDefaultValue(e)}getRealValue(e){return e&&this.valuePropertyName?e[this.valuePropertyName]:e}get isValueArray(){return!0}get maxSelectedChoices(){return this.getPropertyValue("maxSelectedChoices")}set maxSelectedChoices(e){e<0&&(e=0),this.setPropertyValue("maxSelectedChoices",e),this.filterItems()}get minSelectedChoices(){return this.getPropertyValue("minSelectedChoices")}set minSelectedChoices(e){e<0&&(e=0),this.setPropertyValue("minSelectedChoices",e)}get selectedChoices(){let e=this.renderedValue,t=this.visibleChoices,s=this.selectedItemValues;if(this.isEmpty())return[];let i=this.defaultSelectedItemValues?[].concat(this.defaultSelectedItemValues,t):t,r=e.map(e=>tJ.getItemByValue(i,e)).filter(e=>!!e);return r.length||s||this.updateSelectedItemValues(),this.validateItemValues(r)}get selectedItems(){return this.selectedChoices}get hasFilteredValue(){return!!this.valuePropertyName}getFilteredName(){let e=super.getFilteredName();return this.hasFilteredValue&&(e+="-unwrapped"),e}getFilteredValue(){return this.hasFilteredValue?this.renderedValue:super.getFilteredValue()}getMultipleSelectedItems(){return this.selectedChoices}validateItemValues(e){if(e.length)return e;let t=this.selectedItemValues;return t&&t.length?(this.defaultSelectedItemValues=[].concat(t),t):this.renderedValue.map(e=>this.createItemValue(e))}getAnswerCorrectIgnoreOrder(){return!0}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),!t&&this.minSelectedChoices>0&&this.checkMinSelectedChoicesUnreached()){let t=new tA(this.getLocalizationFormatString("minSelectError",this.minSelectedChoices),this);e.push(t)}}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.updateSelectAllItemProps()}onEnableItemCallBack(e){return!this.shouldCheckMaxSelectedChoices()||this.isItemSelected(e)}onAfterRunItemsEnableCondition(){if(this.updateSelectAllItemProps(),this.maxSelectedChoices<1){this.otherItem.setIsEnabled(!0);return}this.hasOther&&this.otherItem.setIsEnabled(!this.shouldCheckMaxSelectedChoices()||this.isOtherSelected)}updateSelectAllItemProps(){this.hasSelectAll&&this.selectAllItem.setIsEnabled(this.getSelectAllEnabled())}getSelectAllEnabled(){if(!this.hasSelectAll)return!0;let e=this.getVisibleEnableItems().length,t=this.maxSelectedChoices;return(!(t>0)||!(t<e))&&e>0}getVisibleEnableItems(){let e=[],t=this.visibleChoices;for(let s=0;s<t.length;s++){let i=t[s];i.isEnabled&&!this.isBuiltInChoice(i)&&e.push(i)}return e}shouldCheckMaxSelectedChoices(){if(this.maxSelectedChoices<1)return!1;var e=this.value;return(Array.isArray(e)?e.length:0)>=this.maxSelectedChoices}checkMinSelectedChoicesUnreached(){if(this.minSelectedChoices<1)return!1;var e=this.value;return(Array.isArray(e)?e.length:0)<this.minSelectedChoices}getItemClassCore(e,t){return this.value,t.isSelectAllItem=e===this.selectAllItem,new eV().append(super.getItemClassCore(e,t)).append(this.cssClasses.itemSelectAll,t.isSelectAllItem).toString()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),this.invisibleOldValues={}}setDefaultValue(){super.setDefaultValue();let e=this.defaultValue;if(Array.isArray(e))for(var t=0;t<e.length;t++){let s=this.getRealValue(e[t]);this.canClearValueAnUnknown(s)&&this.addIntoInvisibleOldValues(s)}}addIntoInvisibleOldValues(e){this.invisibleOldValues[e]=e}hasValueToClearIncorrectValues(){return super.hasValueToClearIncorrectValues()||!a.isValueEmpty(this.invisibleOldValues)}setNewValue(e){this.isChangingValueOnClearIncorrect||(this.invisibleOldValues={}),e=this.valueFromData(e);var t=this.value;e||(e=[]),t||(t=[]),this.isTwoValueEquals(t,e)||(this.removeNoneItemsValues(t,e),super.setNewValue(e))}getIsMultipleValue(){return!0}getCommentFromValue(e){var t=this.getFirstUnknownIndex(e);return t<0?"":e[t]}getStoreOthersAsComment(){return!this.valuePropertyName&&super.getStoreOthersAsComment()}setOtherValueIntoValue(e){var t=this.getFirstUnknownIndex(e);if(t<0)return e;let s=this.otherItem.value,i=this.valuePropertyName;if(i){let e={};e[i]=s,s=e}return e.splice(t,1,s),e}getFirstUnknownIndex(e){if(!Array.isArray(e))return -1;for(var t=0;t<e.length;t++)if(this.hasUnknownValueItem(e[t],!1,!1))return t;return -1}removeNoneItemsValues(e,t){let s=[];if(this.showNoneItem&&s.push(this.noneItem.value),this.showRefuseItem&&s.push(this.refuseItem.value),this.showDontKnowItem&&s.push(this.dontKnowItem.value),s.length>0){let i=this.noneIndexInArray(e,s),r=this.noneIndexInArray(t,s);if(i.index>-1){if(i.val===r.val)t.length>0&&t.splice(r.index,1);else{let e=this.noneIndexInArray(t,[i.val]);e.index>-1&&e.index<t.length-1&&t.splice(e.index,1)}}else if(r.index>-1&&t.length>1){let e=this.convertValueToObject([r.val])[0];t.splice(0,t.length,e)}}}noneIndexInArray(e,t){if(!Array.isArray(e))return{index:-1,val:void 0};for(var s=e.length-1;s>=0;s--){let i=t.indexOf(this.getRealValue(e[s]));if(i>-1)return{index:s,val:t[i]}}return{index:-1,val:void 0}}canUseFilteredChoices(){return!this.hasSelectAll&&super.canUseFilteredChoices()}supportSelectAll(){return this.isSupportProperty("showSelectAllItem")}addNonChoicesItems(e,t){super.addNonChoicesItems(e,t),this.supportSelectAll()&&this.addNonChoiceItem(e,this.selectAllItem,t,this.hasSelectAll,tp.specialChoicesOrder.selectAllItem)}isBuiltInChoice(e){return e===this.selectAllItem||super.isBuiltInChoice(e)}isItemInList(e){return e==this.selectAllItem?this.hasSelectAll:super.isItemInList(e)}getDisplayValueEmpty(){return tJ.getTextOrHtmlByValue(this.visibleChoices.filter(e=>e!=this.selectAllItemValue),void 0)}getDisplayValueCore(e,t){if(!Array.isArray(t))return super.getDisplayValueCore(e,t);let s=this.valuePropertyName;return this.getDisplayArrayValue(e,t,e=>{let i=t[e];return s&&i[s]&&(i=i[s]),i})}clearIncorrectValuesCore(){this.clearIncorrectAndDisabledValues(!1)}clearDisabledValuesCore(){this.clearIncorrectAndDisabledValues(!0)}clearIncorrectAndDisabledValues(e){var t=this.value,s=!1,i=this.restoreValuesFromInvisible();if(t||0!=i.length){if(!Array.isArray(t)||0==t.length){if(this.isChangingValueOnClearIncorrect=!0,e||(this.hasComment?this.value=null:this.clearValue(!0)),this.isChangingValueOnClearIncorrect=!1,0==i.length)return;t=[]}for(var r=[],n=0;n<t.length;n++){let i=this.getRealValue(t[n]);var a=this.canClearValueAnUnknown(i);(e||a)&&(!e||this.isValueDisabled(i))?(s=!0,a&&this.addIntoInvisibleOldValues(t[n])):r.push(t[n])}for(var n=0;n<i.length;n++)r.push(i[n]),s=!0;s&&(this.isChangingValueOnClearIncorrect=!0,0==r.length?this.clearValue(!0):this.value=r,this.isChangingValueOnClearIncorrect=!1)}}restoreValuesFromInvisible(){for(var e=[],t=this.visibleChoices,s=0;s<t.length;s++){let r=t[s];if(r!==this.selectAllItem){var i=t[s].value;a.isTwoValueEquals(i,this.invisibleOldValues[i])&&(this.isItemSelected(r)||e.push(i),delete this.invisibleOldValues[i])}}return e}getConditionJson(e=null,t=null){let s=super.getConditionJson(e,t);return("contains"==e||"notcontains"==e)&&(s.type="radiogroup"),s.maxSelectedChoices=0,s.minSelectedChoices=0,s}isAnswerCorrect(){return a.isArrayContainsEqual(this.value,this.correctAnswer)}setDefaultValueWithOthers(){this.value=this.renderedValueFromDataCore(this.defaultValue)}getIsItemValue(e,t){return!!(e&&Array.isArray(e))&&e.indexOf(t.value)>=0}valueFromData(e){if(!e)return e;if(!Array.isArray(e))return[super.valueFromData(e)];let t=[];for(let s=0;s<e.length;s++){let i=tJ.getItemByValue(this.visibleChoices,e[s]);i?t.push(i.value):t.push(e[s])}return t}rendredValueFromData(e){return e=this.convertValueFromObject(e),super.rendredValueFromData(e)}rendredValueToData(e){return e=super.rendredValueToData(e),this.convertValueToObject(e)}convertValueFromObject(e){return this.valuePropertyName?a.convertArrayObjectToValue(e,this.valuePropertyName):e}convertValueToObject(e){let t;return this.valuePropertyName?(this.survey&&this.survey.questionsByValueName(this.getValueName()).length>1&&(t=this.data.getValue(this.getValueName())),a.convertArrayValueToObject(e,this.valuePropertyName,t)):e}renderedValueFromDataCore(e){if(e&&Array.isArray(e)||(e=[]),!this.hasActiveChoices)return e;for(var t=0;t<e.length&&e[t]!=this.otherItem.value;t++)if(this.hasUnknownValueItem(e[t],!0,!1)){this.otherValue=e[t];var s=e.slice();return s[t]=this.otherItem.value,s}return e}rendredValueToDataCore(e){if(!e||!e.length)return e;for(var t=0;t<e.length;t++)if(e[t]==this.otherItem.value&&this.needConvertRenderedOtherToDataValue()){var s=e.slice();return s[t]=this.otherValue,s}return e}selectOtherValueFromComment(e){var t=[];let s=this.renderedValue;if(Array.isArray(s))for(var i=0;i<s.length;i++)s[i]!==this.otherItem.value&&t.push(s[i]);e&&t.push(this.otherItem.value),this.value=t}get checkBoxSvgPath(){return"M5,13l2-2l3,3l7-7l2,2l-9,9L5,13z"}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"group"}get a11y_input_ariaRequired(){return null}}E.addClass("checkbox",[{name:"showSelectAllItem:boolean",alternativeName:"hasSelectAll"},{name:"separateSpecialChoices",visible:!0},{name:"maxSelectedChoices:number",default:0,onSettingValue:(e,t)=>{if(t<=0)return 0;let s=e.minSelectedChoices;return s>0&&t<s?s:t}},{name:"minSelectedChoices:number",default:0,onSettingValue:(e,t)=>{if(t<=0)return 0;let s=e.maxSelectedChoices;return s>0&&t>s?s:t}},{name:"selectAllText",serializationProperty:"locSelectAllText",dependsOn:"showSelectAllItem",visibleIf:function(e){return e.hasSelectAll}},{name:"valuePropertyName",category:"data"},{name:"itemComponent",visible:!1,default:"survey-checkbox-item"}],function(){return new iE("")},"checkboxbase"),st.Instance.registerQuestion("checkbox",e=>{var t=new iE(e);return t.choices=st.DefaultChoices,t});class iR extends eS{updateItemState(){this.actions.forEach(e=>{let t=this.isItemSelected(e);e.visible=!this.hideSelectedItems||!t})}constructor(e){super(e),this.onItemClick=e=>{!this.isItemDisabled(e)&&(this.isExpanded=!1,this.isItemSelected(e)?(this.selectedItems.splice(this.selectedItems.indexOf(e),1)[0],this.onSelectionChanged&&this.onSelectionChanged(e,"removed")):(this.selectedItems.push(e),this.onSelectionChanged&&this.onSelectionChanged(e,"added")))},this.isItemDisabled=e=>void 0!==e.enabled&&!e.enabled,this.isItemSelected=e=>!!this.allowSelection&&this.selectedItems.filter(t=>this.areSameItems(t,e)).length>0,this.setSelectedItems(e.selectedItems||[])}updateState(){this.updateItemState(),this.isEmpty=0===this.renderedActions.filter(e=>this.isItemVisible(e)).length}setSelectedItems(e){this.selectedItems=e,this.updateState()}selectFocusedItem(){super.selectFocusedItem(),this.hideSelectedItems&&this.focusNextVisibleItem()}}ey([c()],iR.prototype,"hideSelectedItems",void 0);class iA extends ie{locStrsChanged(){super.locStrsChanged(),this.syncFilterStringPlaceholder()}updateListState(){this.listModel.updateState(),this.syncFilterStringPlaceholder()}syncFilterStringPlaceholder(){this.getSelectedActions().length||this.question.selectedItems.length||this.listModel.focusedItem?this.filterStringPlaceholder=void 0:this.filterStringPlaceholder=this.question.placeholder}getSelectedActions(){return this.listModel.actions.filter(e=>e.selected)}getFocusFirstInputSelector(){return this.listModel.hideSelectedItems&&sT&&!this.isValueEmpty(this.question.value)?this.itemSelector:super.getFocusFirstInputSelector()}getPopupCssClasses(){return"sv-multi-select-list"}createListModel(){let e=this.getAvailableItems(),t=this.onSelectionChanged;t||(t=(e,t)=>{this.resetFilterString(),"selectall"===e.id?this.selectAllItems():"added"===t&&e.value===tp.noneItemValue?this.selectNoneItem():"added"===t?this.selectItem(e.value):"removed"===t&&this.deselectItem(e.value),this.popupRecalculatePosition(!1),this.closeOnSelect&&(this.popupModel.isVisible=!1)});let s=new iR({items:e,onSelectionChanged:t,allowSelection:!1,locOwner:this.question,elementId:this.listElementId});return this.setOnTextSearchCallbackForListModel(s),s.forceShowFilter=!0,s}resetFilterString(){super.resetFilterString(),this.inputString=null,this.hintString=""}get shouldResetAfterCancel(){return sT&&!this.closeOnSelect}createPopup(){super.createPopup(),this.popupModel.onFooterActionsCreated.add((e,t)=>{this.shouldResetAfterCancel&&t.actions.push({id:"sv-dropdown-done-button",title:this.doneButtonCaption,innerCss:"sv-popup__button--done",needSpace:!0,action:()=>{this.popupModel.isVisible=!1},enabled:new ec(()=>!this.isTwoValueEquals(this.question.renderedValue,this.previousValue))})}),this.popupModel.onVisibilityChanged.add((e,t)=>{this.shouldResetAfterCancel&&t.isVisible&&(this.previousValue=[].concat(this.question.renderedValue||[]))}),this.popupModel.onCancel=()=>{this.shouldResetAfterCancel&&(this.question.renderedValue=this.previousValue,this.updateListState())}}selectAllItems(){this.question.toggleSelectAll(),this.question.isAllSelected&&this.question.hideSelectedItems&&this.popupModel.hide(),this.updateListState()}selectNoneItem(){this.question.renderedValue=[tp.noneItemValue],this.updateListState()}selectItem(e){let t=[].concat(this.question.renderedValue||[]);t.push(e),this.question.renderedValue=t,this.updateListState()}deselectItem(e){let t=[].concat(this.question.renderedValue||[]);t.splice(t.indexOf(e),1),this.question.renderedValue=t,this.applyHintString(this.listModel.focusedItem),this.updateListState()}clear(){super.clear(),this.syncFilterStringPlaceholder()}onClear(e){super.onClear(e),this.updateListState()}setHideSelectedItems(e){this.listModel.hideSelectedItems=e,this.updateListState()}removeLastSelectedItem(){this.deselectItem(this.question.renderedValue[this.question.renderedValue.length-1]),this.popupRecalculatePosition(!1)}constructor(e,t){super(e,t),this.setHideSelectedItems(e.hideSelectedItems),this.syncFilterStringPlaceholder(),this.closeOnSelect=e.closeOnSelect}inputKeyHandler(e){8!==e.keyCode||this.filterString||(this.removeLastSelectedItem(),e.preventDefault(),e.stopPropagation())}setInputStringFromSelectedItem(e){this.question.searchEnabled&&(this.inputString=null)}focusItemOnClickAndPopup(){}onEscape(){}beforeScrollToFocusedItem(e){}afterScrollToFocusedItem(){var e;(null===(e=this.listModel.focusedItem)||void 0===e?void 0:e.selected)?this.hintString="":this.applyHintString(this.listModel.focusedItem||this.question.selectedItem),this.syncFilterStringPlaceholder()}onPropertyChangedHandler(e,t){super.onPropertyChangedHandler(e,t),("value"===t.name||"renderedValue"===t.name||"placeholder"===t.name)&&this.syncFilterStringPlaceholder()}}ey([c({defaultValue:""})],iA.prototype,"filterStringPlaceholder",void 0),ey([c({defaultValue:!0})],iA.prototype,"closeOnSelect",void 0),ey([c()],iA.prototype,"previousValue",void 0),ey([c({localizable:{defaultStr:"tagboxDoneButtonCaption"}})],iA.prototype,"doneButtonCaption",void 0);class iD extends iE{constructor(e){super(e),this.itemDisplayNameMap={},this.onOpened=this.addEvent(),this.ariaExpanded="false",this.createLocalizableString("placeholder",this,!1,!0),this.createLocalizableString("clearCaption",this,!1,!0),this.createLocalizableString("readOnlyText",this,!0),this.deselectAllItemText=this.createLocalizableString("deselectAllText",this.selectAllItem,!0,"deselectAllItemText"),this.registerPropertyChangedHandlers(["value","renderAs","showOtherItem","otherText","placeholder","choices","visibleChoices"],()=>{this.updateReadOnlyText()}),this.updateReadOnlyText()}locStrsChanged(){var e;super.locStrsChanged(),this.updateReadOnlyText(),null===(e=this.dropdownListModelValue)||void 0===e||e.locStrsChanged()}updateReadOnlyText(){this.readOnlyText=this.displayValue||this.placeholder}getDefaultItemComponent(){return""}get dropdownListModel(){return this.dropdownListModelValue||(this.dropdownListModelValue=new iA(this)),this.dropdownListModelValue}set dropdownListModel(e){this.dropdownListModelValue=e}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}get clearCaption(){return this.getLocalizableStringText("clearCaption")}set clearCaption(e){this.setLocalizableStringText("clearCaption",e)}get locClearCaption(){return this.getLocalizableString("clearCaption")}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}getType(){return"tagbox"}get ariaRole(){return"combobox"}get popupModel(){return this.dropdownListModel.popupModel}getControlClass(){return new eV().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlEditable,!this.isDisabledStyle&&!this.isReadOnlyStyle&&!this.isPreviewStyle).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).toString()}updateCssClasses(e,t){super.updateCssClasses(e,t),tl(e,t)}calcCssClasses(e){let t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModel.updateCssClasses(t.popup,t.list),t}onOpenedCallBack(){this.onOpened.fire(this,{question:this,choices:this.choices})}hasUnknownValue(e,t=!1,s=!0,i=!1){return!this.choicesLazyLoadEnabled&&super.hasUnknownValue(e,t,s,i)}needConvertRenderedOtherToDataValue(){var e;let t=null===(e=this.otherValue)||void 0===e?void 0:e.trim();return!!t&&super.hasUnknownValue(t,!0,!1)}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.dropdownListModelValue&&this.dropdownListModel.updateItems()}getItemIfChoicesNotContainThisValue(e,t){return this.choicesLazyLoadEnabled?this.createItemValue(e,t):super.getItemIfChoicesNotContainThisValue(e,t)}validateItemValues(e){this.updateItemDisplayNameMap();let t=this.renderedValue;if(e.length&&e.length===t.length)return e;let s=this.selectedItemValues;if(!e.length&&s&&s.length)return this.defaultSelectedItemValues=[].concat(s),s;let i=e.map(e=>e.value);return t.filter(e=>-1===i.indexOf(e)).forEach(t=>{let s=this.getItemIfChoicesNotContainThisValue(t,this.itemDisplayNameMap[t]);s&&e.push(s)}),e.sort((e,s)=>t.indexOf(e.value)-t.indexOf(s.value)),e}updateItemDisplayNameMap(){let e=e=>{this.itemDisplayNameMap[e.value]=e.text};(this.defaultSelectedItemValues||[]).forEach(e),(this.selectedItemValues||[]).forEach(e),this.visibleChoices.forEach(e)}getFirstInputElementId(){return this.inputId+(this.searchEnabled?"_0":"")}getInputId(){return this.inputId+"_0"}supportEmptyValidation(){return!0}onBlurCore(e){this.dropdownListModel.onBlur(e),super.onBlurCore(e)}onFocusCore(e){this.dropdownListModel.onFocus(e),super.onFocusCore(e)}allElementsSelected(){let e=super.allElementsSelected();return this.updateSelectAllItemText(e),e}updateSelectAllItemText(e){this.selectAllItem.setLocText(e?this.deselectAllItemText:this.selectAllItemText)}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}clearValue(e){var t;super.clearValue(e),null===(t=this.dropdownListModelValue)||void 0===t||t.clear()}get showClearButton(){return this.allowClear&&!this.isEmpty()}get isNewA11yStructure(){return!1}}ey([c()],iD.prototype,"searchMode",void 0),ey([c()],iD.prototype,"allowClear",void 0),ey([c({onSet:(e,t)=>{t.dropdownListModelValue&&t.dropdownListModel.setSearchEnabled(e)}})],iD.prototype,"searchEnabled",void 0),ey([c({onSet:(e,t)=>{t.dropdownListModelValue&&t.dropdownListModel.setHideSelectedItems(e)}})],iD.prototype,"hideSelectedItems",void 0),ey([c({onSet:(e,t)=>{t.dropdownListModelValue&&t.dropdownListModel.setChoicesLazyLoadEnabled(e)}})],iD.prototype,"choicesLazyLoadEnabled",void 0),ey([c()],iD.prototype,"choicesLazyLoadPageSize",void 0),ey([c({getDefaultValue:()=>tp.tagboxCloseOnSelect})],iD.prototype,"closeOnSelect",void 0),ey([c()],iD.prototype,"textWrapEnabled",void 0),E.addClass("tagbox",[{name:"placeholder",serializationProperty:"locPlaceholder"},{name:"allowClear:boolean",default:!0},{name:"searchEnabled:boolean",default:!0},{name:"textWrapEnabled:boolean",default:!0},{name:"choicesLazyLoadEnabled:boolean",default:!1,visible:!1},{name:"choicesLazyLoadPageSize:number",default:25,visible:!1},{name:"hideSelectedItems:boolean",default:!1},{name:"closeOnSelect:boolean"},{name:"itemComponent",visible:!1,default:""},{name:"searchMode",default:"contains",choices:["contains","startsWith"]}],function(){return new iD("")},"checkbox"),st.Instance.registerQuestion("tagbox",e=>{let t=new iD(e);return t.choices=st.DefaultChoices,t});class iO extends sI{constructor(){super(...arguments),this.doDragOver=()=>{"imagepicker"!==this.parentElement.getType()&&(this.domAdapter.draggedElementShortcut.querySelector(".svc-item-value-controls__button").style.cursor="grabbing")},this.doBanDropHere=()=>{"imagepicker"!==this.parentElement.getType()&&(this.domAdapter.draggedElementShortcut.querySelector(".svc-item-value-controls__button").style.cursor="not-allowed")}}get draggedElementType(){return"item-value"}createDraggedElementShortcut(e,t,s){if("imagepicker"===this.parentElement.getType())return this.createImagePickerShortcut(this.draggedElement,e,t,s);let i=r.createElement("div");if(!i)return;i.className="sv-drag-drop-choices-shortcut";let n=t.closest("[data-sv-drop-target-item-value]").cloneNode(!0);n.classList.add("sv-drag-drop-choices-shortcut__content"),n.querySelector(".svc-item-value-controls__drag-icon").style.visibility="visible",n.querySelector(".svc-item-value-controls__remove").style.backgroundColor="transparent",n.classList.remove("svc-item-value--moveup"),n.classList.remove("svc-item-value--movedown"),this.draggedElement.isDragDropMoveDown=!1,this.draggedElement.isDragDropMoveUp=!1,i.appendChild(n);let a=t.getBoundingClientRect();return i.shortcutXOffset=s.clientX-a.x,i.shortcutYOffset=s.clientY-a.y,this.isBottom=null,"function"==typeof this.onShortcutCreated&&this.onShortcutCreated(i),i}createImagePickerShortcut(e,t,s,i){let n=r.createElement("div");if(!n)return;n.classList.add("sv-drag-drop-image-picker-shortcut");let a=s.closest("[data-sv-drop-target-item-value]");this.imagepickerControlsNode=a.querySelector(".svc-image-item-value-controls");let o=a.querySelector(".sd-imagepicker__image-container"),l=a.querySelector(e.imageLink?"img":".sd-imagepicker__no-image").cloneNode(!0);return this.imagepickerControlsNode&&(this.imagepickerControlsNode.style.display="none"),o.style.width=l.width+"px",o.style.height=l.height+"px",l.style.objectFit="cover",l.style.borderRadius="4px",n.appendChild(l),n}getDropTargetByDataAttributeValue(e){return this.parentElement.choices.filter(t=>""+t.value==e)[0]}getChoices(){let e=this.parentElement;return"ranking"===e.getType()?e.selectToRankEnabled?e.unRankingChoices:e.rankingChoices:e.visibleChoices}isDropTargetValid(e,t){let s=this.getChoices();if("imagepicker"!==this.parentElement.getType()){let e=s.indexOf(this.dropTarget),t=s.indexOf(this.draggedElement);if(t>e&&this.dropTarget.isDragDropMoveUp)return this.dropTarget.isDragDropMoveUp=!1,!1;if(t<e&&this.dropTarget.isDragDropMoveDown)return this.dropTarget.isDragDropMoveDown=!1,!1}return -1!==s.indexOf(e)}isDropTargetDoesntChanged(e){return this.dropTarget===this.prevDropTarget&&e===this.isBottom}calculateIsBottom(e,t){let s=t.getBoundingClientRect();return e>=s.y+s.height/2}afterDragOver(e){let t=this.getChoices(),s=t.indexOf(this.dropTarget),i=t.indexOf(this.draggedElement);if(i<s&&!0===this.isBottom)t.splice(i,1),t.splice(s,0,this.draggedElement);else{if(!(i>s)||!1!==this.isBottom)return;t.splice(s,1),t.splice(i,0,this.dropTarget)}"imagepicker"!==this.parentElement.getType()&&(i!==s&&(e.classList.remove("svc-item-value--moveup"),e.classList.remove("svc-item-value--movedown"),this.dropTarget.isDragDropMoveDown=!1,this.dropTarget.isDragDropMoveUp=!1),i>s&&(this.dropTarget.isDragDropMoveDown=!0),i<s&&(this.dropTarget.isDragDropMoveUp=!0),super.ghostPositionChanged())}doDrop(){let e=this.parentElement.choices,t=this.getChoices().filter(t=>-1!==e.indexOf(t)),s=e.indexOf(this.draggedElement),i=t.indexOf(this.draggedElement);return e.splice(s,1),e.splice(i,0,this.draggedElement),this.parentElement}clear(){this.parentElement&&this.updateVisibleChoices(this.parentElement),this.imagepickerControlsNode&&(this.imagepickerControlsNode.style.display="flex",this.imagepickerControlsNode=null),super.clear()}updateVisibleChoices(e){"ranking"===e.getType()?e.updateRankingChoices():e.updateVisibleChoices()}}class iL extends iO{constructor(){super(...arguments),this.isDragOverRootNode=!1,this.doDragOver=()=>{this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item").style.cursor="grabbing"},this.reorderRankedItem=(e,t,s)=>{if(t==s)return;let i=e.rankingChoices,r=i[t];e.isValueSetByUser=!0,i.splice(t,1),i.splice(s,0,r),this.updateDraggedElementShortcut(s+1)},this.doBanDropHere=()=>{if(this.isDragOverRootNode){this.allowDropHere=!0;return}this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item").style.cursor="not-allowed",sT&&this.parentElement.updateRankingChoices(!0)}}get draggedElementType(){return"ranking-item"}createDraggedElementShortcut(e,t,s){let i=r.createElement("div");if(!i)return;i.className=this.shortcutClass+" sv-ranking-shortcut";let n=t.cloneNode(!0);i.appendChild(n);let a=t.getBoundingClientRect();i.style.left=a.x,i.style.top=a.y,this.domAdapter.rootElement.append(i);let o=i.offsetHeight,l=s.clientY;return l>a.y+o&&(l=a.y+o-10),i.shortcutXOffset=s.clientX-a.x,i.shortcutYOffset=l-a.y,this.parentElement&&this.parentElement.useFullItemSizeForShortcut&&(i.style.width=t.offsetWidth+"px",i.style.height=t.offsetHeight+"px"),i}get shortcutClass(){return new eV().append(this.parentElement.cssClasses.root).append(this.parentElement.cssClasses.rootMobileMod,sx).toString()}getDropTargetByDataAttributeValue(e){return this.parentElement.rankingChoices[e]}findDropTargetNodeByDragOverNode(e){return this.isDragOverRootNode=this.getIsDragOverRootNode(e),super.findDropTargetNodeByDragOverNode(e)}getIsDragOverRootNode(e){return"string"==typeof e.className&&-1!==e.className.indexOf("sv-ranking")}isDropTargetValid(e,t){return -1!==this.parentElement.rankingChoices.indexOf(e)}calculateIsBottom(e,t){return this.dropTarget instanceof tJ&&this.draggedElement!==this.dropTarget&&super.calculateIsBottom(e,t)}getIndices(e,t,s){let i=t.indexOf(this.draggedElement),r=s.indexOf(this.dropTarget);return i<0&&this.draggedElement&&(this.draggedElement=tJ.getItemByValue(t,this.draggedElement.value)||this.draggedElement,i=t.indexOf(this.draggedElement)),-1===r?r=e.value.length:t==s?(!this.isBottom&&i<r&&r--,this.isBottom&&i>r&&r++):t!=s&&this.isBottom&&r++,{fromIndex:i,toIndex:r}}afterDragOver(e){let{fromIndex:t,toIndex:s}=this.getIndices(this.parentElement,this.parentElement.rankingChoices,this.parentElement.rankingChoices);this.reorderRankedItem(this.parentElement,t,s)}updateDraggedElementShortcut(e){var t;(null===(t=this.domAdapter)||void 0===t?void 0:t.draggedElementShortcut)&&(this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item__index").innerText=null!==e?e+"":"")}ghostPositionChanged(){this.parentElement.currentDropTarget=this.draggedElement,super.ghostPositionChanged()}doDrop(){return this.parentElement.setValue(),this.parentElement}clear(){this.parentElement&&(this.parentElement.dropTargetNodeMove=null,this.parentElement.updateRankingChoices(!0)),super.clear()}}class iN extends iL{constructor(){super(...arguments),this.selectToRank=(e,t,s)=>{let i=[].concat(e.rankingChoices),r=e.unRankingChoices[t];i.splice(s,0,r),this.updateChoices(e,i)},this.unselectFromRank=(e,t,s)=>{let i=[].concat(e.rankingChoices);i.splice(t,1),this.updateChoices(e,i)}}findDropTargetNodeByDragOverNode(e){if("from-container"===e.dataset.ranking||"to-container"===e.dataset.ranking)return e;let t=e.closest("[data-ranking='to-container']"),s=e.closest("[data-ranking='from-container']");return 0===this.parentElement.unRankingChoices.length&&s?s:0===this.parentElement.rankingChoices.length&&t?t:super.findDropTargetNodeByDragOverNode(e)}getDropTargetByDataAttributeValue(e){return this.parentElement.rankingChoices[e]||this.parentElement.unRankingChoices[e]}getDropTargetByNode(e,t){return"to-container"===e.dataset.ranking?"to-container":"from-container"===e.dataset.ranking||e.closest("[data-ranking='from-container']")?"from-container":super.getDropTargetByNode(e,t)}isDropTargetValid(e,t){return"to-container"===e||"from-container"===e||super.isDropTargetValid(e,t)}afterDragOver(e){let t=this.parentElement,s=t.rankingChoices,i=t.unRankingChoices;if(this.isDraggedElementUnranked&&this.isDropTargetRanked){this.doRankBetween(e,i,s,this.selectToRank);return}if(this.isDraggedElementRanked&&this.isDropTargetRanked){this.doRankBetween(e,s,s,this.reorderRankedItem);return}if(this.isDraggedElementRanked&&!this.isDropTargetRanked){this.doRankBetween(e,s,i,this.unselectFromRank);return}}doRankBetween(e,t,s,i){let r=this.parentElement,{fromIndex:n,toIndex:a}=this.getIndices(r,t,s);i(r,n,a,e)}get isDraggedElementRanked(){return -1!==this.parentElement.rankingChoices.indexOf(this.draggedElement)}get isDropTargetRanked(){return"to-container"===this.dropTarget||-1!==this.parentElement.rankingChoices.indexOf(this.dropTarget)}get isDraggedElementUnranked(){return!this.isDraggedElementRanked}updateChoices(e,t){e.isValueSetByUser=!0,e.rankingChoices=t,e.updateUnRankingChoices(t)}}class ik extends iE{constructor(e){super(e),this.domNode=null,this.onVisibleChoicesChanged=()=>{if(super.onVisibleChoicesChanged(),!this.carryForwardStartUnranked||this.isValueSetByUser||this.selectToRankEnabled||this.defaultValue||(this.value=[]),1===this.visibleChoices.length&&!this.selectToRankEnabled){this.value=[],this.value.push(this.visibleChoices[0].value),this.updateRankingChoices();return}if(this.isEmpty()||this.selectToRankEnabled){this.updateRankingChoices();return}this.visibleChoices.length>this.value.length&&this.addToValueByVisibleChoices(),this.visibleChoices.length<this.value.length&&this.removeFromValueByVisibleChoices(),this.updateRankingChoices()},this.localeChanged=()=>{super.localeChanged(),this.updateRankingChoicesSync()},this._rankingChoicesAnimation=new eQ(this.getChoicesAnimationOptions(!0),e=>{this._renderedRankingChoices=e},()=>this.renderedRankingChoices),this._unRankingChoicesAnimation=new eQ(this.getChoicesAnimationOptions(!1),e=>{this._renderedUnRankingChoices=e},()=>this.renderedUnRankingChoices),this.rankingChoices=[],this.unRankingChoices=[],this._renderedRankingChoices=[],this._renderedUnRankingChoices=[],this.handlePointerDown=(e,t,s)=>{let i=e.target;this.isDragStartNodeValid(i)&&this.isAllowStartDrag(i,t)&&(this.draggedChoiceValue=t.value,this.draggedTargetNode=s,this.dragOrClickHelper.onPointerDown(e))},this.startDrag=e=>{let t=tJ.getItemByValue(this.visibleChoices,this.draggedChoiceValue);this.dragDropRankingChoices.startDrag(e,t,this,this.draggedTargetNode)},this.handlePointerUp=(e,t,s)=>{if(!this.selectToRankEnabled)return;let i=e.target;this.isAllowStartDrag(i,t)&&this.handleKeydownSelectToRank(e,t," ",!1)},this.handleKeydown=(e,t)=>{if(!this.isReadOnlyAttr&&!this.isDesignMode){let s=e.key,i=this.rankingChoices.indexOf(t);if(this.selectToRankEnabled){this.handleKeydownSelectToRank(e,t);return}if("ArrowUp"===s&&i||"ArrowDown"===s&&i!==this.rankingChoices.length-1){let t="ArrowUp"==s?i-1:i+1;this.dragDropRankingChoices.reorderRankedItem(this,i,t),this.setValueAfterKeydown(t,"",!0,e)}}},this.focusItem=(e,t)=>{this.domNode&&(this.selectToRankEnabled&&t?this.domNode.querySelectorAll("[data-ranking='"+t+"'] ."+this.cssClasses.item)[e].focus():this.domNode.querySelectorAll("."+this.cssClasses.item)[e].focus())},this.isValueSetByUser=!1,this.setValue=()=>{let e=[];this.rankingChoices.forEach(t=>{e.push(t.value)}),this.value=e,this.isValueSetByUser=!0},this.registerFunctionOnPropertyValueChanged("selectToRankEnabled",()=>{this.clearValue(!0),this.setDragDropRankingChoices(),this.updateRankingChoicesSync()}),this.dragOrClickHelper=new sR(this.startDrag)}getType(){return"ranking"}getItemTabIndex(e){if(!this.isDesignMode&&!e.disabled)return 0}supportContainerQueries(){return this.selectToRankEnabled}get rootClass(){return new eV().append(this.cssClasses.root).append(this.cssClasses.rootMobileMod,this.isMobileMode()).append(this.cssClasses.rootDisabled,this.isDisabledStyle).append(this.cssClasses.rootReadOnly,this.isReadOnlyStyle).append(this.cssClasses.rootPreview,this.isPreviewStyle).append(this.cssClasses.rootDesignMode,!!this.isDesignMode).append(this.cssClasses.itemOnError,this.hasCssError()).append(this.cssClasses.rootDragHandleAreaIcon,"icon"===tp.rankingDragHandleArea).append(this.cssClasses.rootSelectToRankMod,this.selectToRankEnabled).append(this.cssClasses.rootSelectToRankEmptyValueMod,this.isEmpty()).append(this.cssClasses.rootSelectToRankAlignHorizontal,this.selectToRankEnabled&&"horizontal"===this.renderedSelectToRankAreasLayout).append(this.cssClasses.rootSelectToRankAlignVertical,this.selectToRankEnabled&&"vertical"===this.renderedSelectToRankAreasLayout).append(this.cssClasses.rootSelectToRankSwapAreas,this.selectToRankEnabled&&"horizontal"===this.renderedSelectToRankAreasLayout&&this.selectToRankSwapAreas).toString()}isItemSelectedCore(e){return!this.selectToRankEnabled||super.isItemSelectedCore(e)}getItemClassCore(e,t){return new eV().append(super.getItemClassCore(e,t)).append(this.cssClasses.itemGhostMod,this.currentDropTarget===e).toString()}getContainerClasses(e){let t=!1,s="to"===e,i="from"===e;return s?t=0===this.renderedRankingChoices.length:i&&(t=0===this.renderedUnRankingChoices.length),new eV().append(this.cssClasses.container).append(this.cssClasses.containerToMode,s).append(this.cssClasses.containerFromMode,i).append(this.cssClasses.containerEmptyMode,t).toString()}isItemCurrentDropTarget(e){return this.dragDropRankingChoices.dropTarget===e}get ghostPositionCssClass(){return"top"===this.ghostPosition?this.cssClasses.dragDropGhostPositionTop:"bottom"===this.ghostPosition?this.cssClasses.dragDropGhostPositionBottom:""}getItemIndexClasses(e){let t;return t=this.selectToRankEnabled?-1!==this.unRankingChoices.indexOf(e):this.isEmpty(),new eV().append(this.cssClasses.itemIndex).append(this.cssClasses.itemIndexEmptyMode,t).toString()}getNumberByIndex(e){return this.isEmpty()?"":e+1+""}updateRankingChoicesSync(){this.blockAnimations(),this.updateRankingChoices(),this.releaseAnimations()}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.setDragDropRankingChoices(),this.updateRankingChoicesSync()}isAnswerCorrect(){return a.isArraysEqual(this.value,this.correctAnswer,!1)}get requireStrictCompare(){return!0}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.isLoadingFromJson||this.updateRankingChoices()}onSurveyLoad(){this.blockAnimations(),super.onSurveyLoad(),this.updateRankingChoices(),this.releaseAnimations()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),e&&(this.isValueSetByUser=!0)}addToValueByVisibleChoices(){let e=this.value.slice();this.visibleChoices.forEach(t=>{-1===e.indexOf(t.value)&&e.push(t.value)}),this.value=e}removeFromValueByVisibleChoices(){let e=this.value.slice(),t=this.visibleChoices;for(let s=this.value.length-1;s>=0;s--)tJ.getItemByValue(t,this.value[s])||e.splice(s,1);this.value=e}getChoicesAnimationOptions(e){return{getKey:e=>e.value,getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed&&!this.isDesignMode&&this.isVisible&&!!this.domNode,getReorderOptions:(e,t)=>{let s="";return e!==this.currentDropTarget&&(s=t?"sv-dragdrop-movedown":"sv-dragdrop-moveup"),{cssClass:s}},getLeaveOptions:t=>{let s=e?this.renderedRankingChoices:this.renderedUnRankingChoices;return"vertical"==this.renderedSelectToRankAreasLayout&&1==s.length&&s.indexOf(t)>=0?{cssClass:"sv-ranking-item--animate-item-removing-empty"}:{cssClass:"sv-ranking-item--animate-item-removing",onBeforeRunAnimation:e=>{e.style.setProperty("--animation-height",e.offsetHeight+"px")}}},getEnterOptions:t=>{let s=e?this.renderedRankingChoices:this.renderedUnRankingChoices;return"vertical"==this.renderedSelectToRankAreasLayout&&1==s.length&&s.indexOf(t)>=0?{cssClass:"sv-ranking-item--animate-item-adding-empty"}:{cssClass:"sv-ranking-item--animate-item-adding",onBeforeRunAnimation:e=>{e.style.setProperty("--animation-height",e.offsetHeight+"px")}}},getAnimatedElement:t=>{var s;let i=this.cssClasses,r="";this.selectToRankEnabled&&(!e&&i.containerFromMode?r=tr(i.containerFromMode):e&&i.containerToMode&&(r=tr(i.containerToMode)));let n=e?this.renderedRankingChoices.indexOf(t):this.renderedUnRankingChoices.indexOf(t);return null===(s=this.domNode)||void 0===s?void 0:s.querySelector(`${r} [data-sv-drop-target-ranking-item='${n}']`)},allowSyncRemovalAddition:!0}}get rankingChoicesAnimation(){return this._rankingChoicesAnimation}get unRankingChoicesAnimation(){return this._unRankingChoicesAnimation}get renderedRankingChoices(){return this._renderedRankingChoices}set renderedRankingChoices(e){this.rankingChoicesAnimation.sync(e)}get renderedUnRankingChoices(){return this._renderedUnRankingChoices}set renderedUnRankingChoices(e){this.unRankingChoicesAnimation.sync(e)}updateRenderedRankingChoices(){this.renderedRankingChoices=this.rankingChoices}updateRenderedUnRankingChoices(){this.renderedUnRankingChoices=this.unRankingChoices}updateRankingChoices(e=!1){if(this.selectToRankEnabled){this.updateRankingChoicesSelectToRankMode(e);return}let t=[];if(e&&(this.rankingChoices=[]),this.isEmpty()){this.rankingChoices=this.visibleChoices;return}this.value.forEach(e=>{this.visibleChoices.forEach(s=>{s.value===e&&t.push(s)})}),this.rankingChoices=t}updateUnRankingChoices(e){let t=[];this.visibleChoices.forEach(e=>{t.push(e)}),e.forEach(e=>{t.forEach((s,i)=>{s.value===e.value&&t.splice(i,1)})}),this.unRankingChoices=t}updateRankingChoicesSelectToRankMode(e){let t=[];this.isEmpty()||this.value.forEach(e=>{this.visibleChoices.forEach(s=>{s.value===e&&t.push(s)})}),this.updateUnRankingChoices(t),this.rankingChoices=t}endLoadingFromJson(){super.endLoadingFromJson(),this.setDragDropRankingChoices()}setDragDropRankingChoices(){this.dragDropRankingChoices=this.createDragDropRankingChoices()}createDragDropRankingChoices(){return this.selectToRankEnabled?new iN(this.survey,null,this.longTap):new iL(this.survey,null,this.longTap)}isDragStartNodeValid(e){return"icon"!==tp.rankingDragHandleArea||e.classList.contains(this.cssClasses.itemIconHoverMod)}isAllowStartDrag(e,t){return!this.isReadOnly&&!this.isDesignMode&&this.canStartDragDueMaxSelectedChoices(e)&&this.canStartDragDueItemEnabled(t)}canStartDragDueMaxSelectedChoices(e){return!this.selectToRankEnabled||!e.closest("[data-ranking='from-container']")||this.checkMaxSelectedChoicesUnreached()}canStartDragDueItemEnabled(e){return e.enabled}checkMaxSelectedChoicesUnreached(){if(this.maxSelectedChoices<1)return!0;var e=this.value;return(Array.isArray(e)?e.length:0)<this.maxSelectedChoices}afterRenderQuestionElement(e){this.domNode=e,super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){this.domNode=void 0,super.beforeDestroyQuestionElement(e)}supportSelectAll(){return!1}supportOther(){return!1}supportNone(){return!1}supportRefuse(){return!1}supportDontKnow(){return!1}handleKeydownSelectToRank(e,t,s,i=!0){let r;if(this.isDesignMode)return;let n=e.key;if(s&&(n=s)," "!==n&&"ArrowUp"!==n&&"ArrowDown"!==n)return;let a=this.dragDropRankingChoices,o=this.rankingChoices,l=-1!==o.indexOf(t),h=(l?o:this.unRankingChoices).indexOf(t);if(h<0)return;if(" "===n&&!l){if(!this.checkMaxSelectedChoicesUnreached()||!this.canStartDragDueItemEnabled(t))return;r=this.value.length,a.selectToRank(this,h,r),this.setValueAfterKeydown(r,"to-container",i,e);return}if(!l)return;if(" "===n){a.unselectFromRank(this,h),r=this.unRankingChoices.indexOf(t),this.setValueAfterKeydown(r,"from-container",i,e);return}let u="ArrowUp"===n?-1:+("ArrowDown"===n);0!==u&&((r=h+u)<0||r>=o.length||(a.reorderRankedItem(this,h,r),this.setValueAfterKeydown(r,"to-container",i,e)))}setValueAfterKeydown(e,t,s=!0,i){this.setValue(),s&&setTimeout(()=>{this.focusItem(e,t)},1),i&&i.preventDefault()}getIconHoverCss(){return new eV().append(this.cssClasses.itemIcon).append(this.cssClasses.itemIconHoverMod).toString()}getIconFocusCss(){return new eV().append(this.cssClasses.itemIcon).append(this.cssClasses.itemIconFocusMod).toString()}get longTap(){return this.getPropertyValue("longTap")}set longTap(e){this.setPropertyValue("longTap",e)}getDefaultItemComponent(){return"sv-ranking-item"}get selectToRankEnabled(){return this.getPropertyValue("selectToRankEnabled",!1)}set selectToRankEnabled(e){this.setPropertyValue("selectToRankEnabled",e)}get selectToRankSwapAreas(){return this.getPropertyValue("selectToRankSwapAreas",!1)}set selectToRankSwapAreas(e){this.setPropertyValue("selectToRankSwapAreas",e)}get selectToRankAreasLayout(){return this.getPropertyValue("selectToRankAreasLayout")}set selectToRankAreasLayout(e){this.setPropertyValue("selectToRankAreasLayout",e)}get renderedSelectToRankAreasLayout(){return this.isMobileMode()?"vertical":this.selectToRankAreasLayout}isMobileMode(){return sx}get useFullItemSizeForShortcut(){return this.getPropertyValue("useFullItemSizeForShortcut")}set useFullItemSizeForShortcut(e){this.setPropertyValue("useFullItemSizeForShortcut",e)}get dragDropSvgIcon(){return this.cssClasses.dragDropSvgIconId||"#icon-drag-24x24"}get arrowsSvgIcon(){return this.cssClasses.arrowsSvgIconId||"#icon-reorder-24x24"}get dashSvgIcon(){return this.cssClasses.dashSvgIconId||"#icon-rankingundefined-16x16"}get isNewA11yStructure(){return!1}}ey([p({onSet:(e,t)=>t.updateRenderedRankingChoices(),onRemove:(e,t,s)=>s.updateRenderedRankingChoices(),onPush:(e,t,s)=>s.updateRenderedRankingChoices()})],ik.prototype,"rankingChoices",void 0),ey([p({onSet:(e,t)=>t.updateRenderedUnRankingChoices(),onRemove:(e,t,s)=>s.updateRenderedUnRankingChoices(),onPush:(e,t,s)=>s.updateRenderedUnRankingChoices()})],ik.prototype,"unRankingChoices",void 0),ey([p()],ik.prototype,"_renderedRankingChoices",void 0),ey([p()],ik.prototype,"_renderedUnRankingChoices",void 0),ey([c({defaultValue:null})],ik.prototype,"currentDropTarget",void 0),ey([c({defaultValue:!0})],ik.prototype,"carryForwardStartUnranked",void 0),ey([c({localizable:{defaultStr:"selectToRankEmptyRankedAreaText"}})],ik.prototype,"selectToRankEmptyRankedAreaText",void 0),ey([c({localizable:{defaultStr:"selectToRankEmptyUnrankedAreaText"}})],ik.prototype,"selectToRankEmptyUnrankedAreaText",void 0),E.addClass("ranking",[{name:"showOtherItem",visible:!1,isSerializable:!1},{name:"otherText",visible:!1,isSerializable:!1},{name:"otherErrorText",visible:!1,isSerializable:!1},{name:"storeOthersAsComment",visible:!1,isSerializable:!1},{name:"showNoneItem",visible:!1,isSerializable:!1},{name:"showRefuseItem",visible:!1,isSerializable:!1},{name:"showDontKnowItem",visible:!1,isSerializable:!1},{name:"noneText",visible:!1,isSerializable:!1},{name:"showSelectAllItem",visible:!1,isSerializable:!1},{name:"selectAllText",visible:!1,isSerializable:!1},{name:"colCount:number",visible:!1,isSerializable:!1},{name:"separateSpecialChoices",visible:!1,isSerializable:!1},{name:"longTap",default:!0,visible:!1,isSerializable:!1},{name:"selectToRankEnabled:switch",default:!1,visible:!0,isSerializable:!0},{name:"selectToRankSwapAreas:switch",default:!1,visible:!1,isSerializable:!0,dependsOn:"selectToRankEnabled"},{name:"selectToRankAreasLayout",default:"horizontal",choices:["horizontal","vertical"],dependsOn:"selectToRankEnabled",visibleIf:e=>!!e.selectToRankEnabled,visible:!0,isSerializable:!0},{name:"selectToRankEmptyRankedAreaText:text",serializationProperty:"locSelectToRankEmptyRankedAreaText",category:"general",dependsOn:"selectToRankEnabled",visibleIf:e=>!!e.selectToRankEnabled},{name:"selectToRankEmptyUnrankedAreaText:text",serializationProperty:"locSelectToRankEmptyUnrankedAreaText",category:"general",dependsOn:"selectToRankEnabled",visibleIf:e=>!!e.selectToRankEnabled},{name:"maxSelectedChoices:number",visible:!0,default:0,dependsOn:"selectToRankEnabled",visibleIf:e=>!!e.selectToRankEnabled,isSerializable:!0},{name:"minSelectedChoices:number",visible:!0,default:0,dependsOn:"selectToRankEnabled",visibleIf:e=>!!e.selectToRankEnabled,isSerializable:!0},{name:"itemComponent",visible:!1,default:"sv-ranking-item"}],function(){return new ik("")},"checkbox"),st.Instance.registerQuestion("ranking",e=>{let t=new ik(e);return t.choices=st.DefaultChoices,t});class iF extends io{constructor(e){super(e)}get textAreaModel(){return this.textAreaModelValue||(this.textAreaModelValue=new tH(this.getTextAreaOptions())),this.textAreaModelValue}getTextAreaOptions(){let e=this,t=t=>{a.isTwoValueEquals(e.value,t,!1,!0,!1)||(e.value=t)};return{question:this,id:()=>this.inputId,propertyName:"value",className:()=>this.className,placeholder:()=>this.renderedPlaceholder,isDisabledAttr:()=>this.isDisabledAttr,isReadOnlyAttr:()=>this.isReadOnlyAttr,autoGrow:()=>this.renderedAutoGrow,maxLength:()=>this.getMaxLength(),rows:()=>this.rows,cols:()=>this.cols,ariaRequired:()=>this.a11y_input_ariaRequired,ariaLabel:()=>this.a11y_input_ariaLabel,ariaLabelledBy:()=>this.a11y_input_ariaLabelledBy,ariaDescribedBy:()=>this.a11y_input_ariaDescribedBy,ariaInvalid:()=>this.a11y_input_ariaInvalid,ariaErrormessage:()=>this.a11y_input_ariaErrormessage,getTextValue:()=>this.value,onTextAreaChange:e=>{t(e.target.value)},onTextAreaInput:e=>{this.onInput(e)},onTextAreaKeyDown:e=>{this.onKeyDown(e)},onTextAreaFocus:e=>{this.onFocus(e)},onTextAreaBlur:e=>{this.onBlur(e)}}}get rows(){return this.getPropertyValue("rows")}set rows(e){this.setPropertyValue("rows",e)}get cols(){return this.getPropertyValue("cols")}set cols(e){this.setPropertyValue("cols",e)}get acceptCarriageReturn(){return this.getPropertyValue("acceptCarriageReturn")}set acceptCarriageReturn(e){this.setPropertyValue("acceptCarriageReturn",e)}get autoGrow(){return this.getPropertyValue("autoGrow")}set autoGrow(e){this.setPropertyValue("autoGrow",e)}get renderedAutoGrow(){let e=this.autoGrow;return void 0===e&&this.survey?this.survey.autoGrowComment:!!e}get allowResize(){return this.getPropertyValue("allowResize")}set allowResize(e){this.setPropertyValue("allowResize",e)}get renderedAllowResize(){let e=this.allowResize;return void 0===e&&this.survey?this.survey.allowResizeComment:!!e}get resizeStyle(){return this.renderedAllowResize?"both":"none"}getType(){return"comment"}afterRenderQuestionElement(e){let{root:t}=tp.environment;this.element=t.getElementById(this.inputId)||e,super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.element=void 0}onInput(e){this.isInputTextUpdate&&(this.value=e.target.value),this.updateRemainingCharacterCounter(e.target.value)}onBlurCore(e){super.onBlurCore(e)}onKeyDown(e){this.onKeyDownPreprocess&&this.onKeyDownPreprocess(e),this.acceptCarriageReturn||"Enter"!==e.key&&13!==e.keyCode||(e.preventDefault(),e.stopPropagation())}setNewValue(e){!this.acceptCarriageReturn&&e&&(e=e.replace(RegExp("(\r\n|\n|\r)","gm"),"")),super.setNewValue(e)}getValueSeparator(){return"\n"}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed||this.textAreaModel.updateElement()}get className(){return(this.cssClasses?this.getControlClass():"panel-comment-root")||void 0}}E.addClass("comment",[{name:"maxLength:number",default:-1},{name:"cols:number",default:50,visible:!1,isSerializable:!1},{name:"rows:number",default:4},{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder"},{name:"textUpdateMode",default:"default",choices:["default","onBlur","onTyping"]},{name:"autoGrow:boolean",defaultFunc:()=>void 0},{name:"allowResize:boolean",defaultFunc:()=>void 0},{name:"acceptCarriageReturn:boolean",default:!0,visible:!1}],function(){return new iF("")},"textbase"),st.Instance.registerQuestion("comment",e=>new iF(e));let iM="environment",i_="user";class iq{constructor(){this.canFlipValue=void 0}static clear(){iq.cameraList=void 0,iq.cameraIndex=-1}static setCameraList(e){let t=function(e){let t=e.label.toLocaleLowerCase();return t.indexOf(i_)>-1?i_:t.indexOf(iM)>-1?iM:t.indexOf("front")>-1?i_:t.indexOf("back")>-1?iM:""};iq.clear(),Array.isArray(e)&&e.length>0&&(iq.cameraIndex=-1,e.sort((s,i)=>{if(s===i)return 0;if(s.label!==i.label){let e=t(s),r=t(i);if(e!==r){if(e===i_)return -1;if(r===i_)return 1;if(e===iM)return -1;if(r===iM)return 1}}return e.indexOf(s)<e.indexOf(i)?-1:1})),iq.cameraList=e}hasCamera(e){if(void 0!==iq.cameraList){this.hasCameraCallback(e);return}if(iq.mediaDevicesCallback){iq.mediaDevicesCallback(t=>{this.setVideoInputs(t),this.hasCameraCallback(e)});return}"undefined"!=typeof navigator&&navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(t=>{this.setVideoInputs(t),this.hasCameraCallback(e),this.updateCanFlipValue()}).catch(t=>{iq.cameraList=null,this.hasCameraCallback(e)}):(iq.cameraList=null,this.hasCameraCallback(e))}getMediaConstraints(e){let t=iq.cameraList;if(!Array.isArray(t)||t.length<1)return;iq.cameraIndex<0&&(iq.cameraIndex=0);let s=t[iq.cameraIndex],i={};return s&&s.deviceId?i.deviceId={exact:s.deviceId}:i.facingMode=iq.cameraFacingMode,e&&((null==e?void 0:e.height)&&(i.height={ideal:e.height}),(null==e?void 0:e.width)&&(i.width={ideal:e.width})),{video:i,audio:!1}}startVideo(e,t,s,i){if(!e){t(void 0);return}e.style.width="100%",e.style.height="auto",e.style.height="100%",e.style.objectFit="contain";let r=this.getMediaConstraints({width:s,height:i});navigator.mediaDevices.getUserMedia(r).then(s=>{var i;e.srcObject=s,(null===(i=iq.cameraList[iq.cameraIndex])||void 0===i?void 0:i.deviceId)||!s.getTracks()[0].getCapabilities().facingMode||(iq.canSwitchFacingMode=!0,this.updateCanFlipValue()),e.play(),t(s)}).catch(e=>{t(void 0)})}getImageSize(e){return{width:e.videoWidth,height:e.videoHeight}}snap(e,t){if(!e||!r.isAvailable())return!1;let s=r.getDocument().createElement("canvas"),i=this.getImageSize(e);s.height=i.height,s.width=i.width;let n=s.getContext("2d");return n.clearRect(0,0,s.width,s.height),n.drawImage(e,0,0,s.width,s.height),s.toBlob(t,"image/png"),!0}updateCanFlipValue(){let e=iq.cameraList;this.canFlipValue=Array.isArray(e)&&e.length>1||iq.canSwitchFacingMode,this.onCanFlipChangedCallback&&this.onCanFlipChangedCallback(this.canFlipValue)}canFlip(e){return void 0===this.canFlipValue&&this.updateCanFlipValue(),e&&(this.onCanFlipChangedCallback=e),this.canFlipValue}flip(){this.canFlip()&&(iq.canSwitchFacingMode?iq.cameraFacingMode=iq.cameraFacingMode===i_?"environment":i_:iq.cameraIndex>=iq.cameraList.length-1?iq.cameraIndex=0:iq.cameraIndex++)}hasCameraCallback(e){e(Array.isArray(iq.cameraList))}setVideoInputs(e){let t=[];e.forEach(e=>{"videoinput"===e.kind&&t.push(e)}),iq.setCameraList(t.length>0?t:null)}}iq.cameraIndex=-1,iq.cameraFacingMode=i_,iq.canSwitchFacingMode=!1;class iB extends tU{constructor(){super(...arguments),this.isUploading=!1,this.onUploadStateChanged=this.addEvent(),this.onStateChanged=this.addEvent()}stateChanged(e){this.currentState!=e&&("loading"===e&&(this.isUploading=!0),"loaded"===e&&(this.isUploading=!1),"error"===e&&(this.isUploading=!1),this.currentState=e,this.onStateChanged.fire(this,{state:e}),this.onUploadStateChanged.fire(this,{state:e}))}get showLoadingIndicator(){return this.isUploading&&this.isDefaultV2Theme}get storeDataAsText(){return this.getPropertyValue("storeDataAsText")}set storeDataAsText(e){this.setPropertyValue("storeDataAsText",e)}get waitForUpload(){return this.getPropertyValue("waitForUpload")}set waitForUpload(e){this.setPropertyValue("waitForUpload",e)}clearValue(e){this.clearOnDeletingContainer(),super.clearValue(e)}clearOnDeletingContainer(){this.survey&&this.survey.clearFiles(this,this.name,this.value,null,()=>{})}onCheckForErrors(e,t,s){super.onCheckForErrors(e,t,s),this.isUploading&&this.waitForUpload&&e.push(new tT(this.getLocalizationString("uploadingFile"),this))}uploadFiles(e){this.survey&&(this.stateChanged("loading"),this.survey.uploadFiles(this,this.name,e,(e,t)=>{Array.isArray(e)&&(this.setValueFromResult(e),Array.isArray(t)&&(t.forEach(e=>this.errors.push(new tT(e,this))),this.stateChanged("error"))),"success"===e&&Array.isArray(t)&&this.setValueFromResult(t),"error"===e&&("string"==typeof t&&this.errors.push(new tT(t,this)),Array.isArray(t)&&t.length>0&&t.forEach(e=>this.errors.push(new tT(e,this))),this.stateChanged("error")),this.stateChanged("loaded")}))}loadPreview(e){}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.stateChanged(this.isEmpty()?"empty":"loaded")}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.isFileLoading}get isFileLoading(){return this.isFileLoadingValue}set isFileLoading(e){this.isFileLoadingValue=e,this.updateIsReady()}}ey([c()],iB.prototype,"isUploading",void 0),ey([c({defaultValue:"empty"})],iB.prototype,"currentState",void 0);class iQ extends eg{static getId(){return"sv_sfp_"+iQ.pageCounter++}constructor(e,t){super(),this.question=e,this.index=t,this.id=iQ.getId()}get css(){return this.question.cssClasses.page}}iQ.pageCounter=0,ey([p({})],iQ.prototype,"items",void 0);class iz extends iB{get supportFileNavigator(){return this.isDefaultV2Theme}get fileNavigatorVisible(){let e=this.isUploading,t=this.isPlayingVideo,s=this.containsMultiplyFiles,i=this.pageSize<this.previewValue.length;return!e&&!t&&s&&i&&this.isDefaultV2Theme}get pagesCount(){return Math.ceil(this.previewValue.length/this.pageSize)}get actionsContainerVisible(){let e=this.isUploading,t=this.isPlayingVideo,s=this.isDefaultV2Theme;return!e&&!t&&s}constructor(e){super(e),this.isDragging=!1,this.fileNavigator=new ex,this.canFlipCameraValue=void 0,this.prevPreviewLength=0,this._renderedPages=[],this.pagesAnimation=new ez(this.getPagesAnimationOptions(),e=>{this._renderedPages=e},()=>this.renderedPages),this.calcAvailableItemsCount=(e,t,s)=>{let i=Math.floor(e/(t+s));return(i+1)*(t+s)-s<=e&&i++,i},this.dragCounter=0,this.onDragEnter=e=>{this.canDragDrop()&&(e.preventDefault(),this.isDragging=!0,this.dragCounter++)},this.onDragOver=e=>{if(!this.canDragDrop())return e.returnValue=!1,!1;e.dataTransfer.dropEffect="copy",e.preventDefault()},this.onDrop=e=>{if(this.canDragDrop()){this.isDragging=!1,this.dragCounter=0,e.preventDefault();let t=e.dataTransfer;this.onChange(t)}},this.onDragLeave=e=>{this.canDragDrop()&&(this.dragCounter--,0===this.dragCounter&&(this.isDragging=!1))},this.doChange=e=>{var t=e.target||e.srcElement;this.onChange(t)},this.doClean=()=>{if(this.needConfirmRemoveFile){eG({message:this.confirmRemoveAllMessage,funcOnYes:()=>{this.clearFilesCore()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.clearFilesCore()},this.doDownloadFileFromContainer=e=>{e.stopPropagation();let t=e.currentTarget;if(t&&t.getElementsByTagName){let e=t.getElementsByTagName("a")[0];null==e||e.click()}},this.doDownloadFile=(e,t)=>{e.stopPropagation(),eK()&&(e.preventDefault(),function(e,t){try{let s=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(s.length),n=new Uint8Array(r);for(let e=0;e<s.length;e++)n[e]=s.charCodeAt(e);let a=new Blob([r],{type:i});navigator&&navigator.msSaveBlob&&navigator.msSaveOrOpenBlob(a,t)}catch(e){}}(t.content,t.name))},this.createLocalizableString("takePhotoCaption",this,!1,!0),this.createLocalizableString("clearCaption",this,!1,!0),this.actionsContainer=new ex,this.actionsContainer.locOwner=this,this.fileIndexAction=new eL({id:"fileIndex",title:this.getFileIndexCaption(),enabled:!1}),this.prevFileAction=new eL({id:"prevPage",iconSize:16,action:()=>{this.navigationDirection="left",this.indexToShow=this.previewValue.length&&(this.indexToShow-1+this.pagesCount)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}}),this.nextFileAction=new eL({id:"nextPage",iconSize:16,action:()=>{this.navigationDirection="right",this.indexToShow=this.previewValue.length&&(this.indexToShow+1)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}}),this.takePictureAction=new eL({iconName:"icon-takepicture",id:"sv-file-take-picture",iconSize:"auto",innerCss:new ec(()=>new eV().append(this.cssClasses.contextButton).append(this.cssClasses.takePictureButton).toString()),locTitle:this.locTakePhotoCaption,showTitle:!1,action:()=>{this.snapPicture()}}),this.closeCameraAction=new eL({iconName:"icon-closecamera",id:"sv-file-close-camera",iconSize:"auto",innerCss:new ec(()=>new eV().append(this.cssClasses.contextButton).append(this.cssClasses.closeCameraButton).toString()),action:()=>{this.stopVideo()}}),this.changeCameraAction=new eL({iconName:"icon-changecamera",id:"sv-file-change-camera",iconSize:"auto",innerCss:new ec(()=>new eV().append(this.cssClasses.contextButton).append(this.cssClasses.changeCameraButton).toString()),visible:new ec(()=>this.canFlipCamera()),action:()=>{this.flipCamera()}}),this.chooseFileAction=new eL({iconName:"icon-choosefile",id:"sv-file-choose-file",iconSize:"auto",data:{question:this},enabledIf:()=>!this.isInputReadOnly,component:"sv-file-choose-btn"}),this.startCameraAction=new eL({iconName:"icon-takepicture_24x24",id:"sv-file-start-camera",iconSize:"auto",locTitle:this.locTakePhotoCaption,showTitle:new ec(()=>!this.isAnswered),enabledIf:()=>!this.isInputReadOnly,action:()=>{this.startVideo()}}),this.cleanAction=new eL({iconName:"icon-clear",id:"sv-file-clean",iconSize:"auto",locTitle:this.locClearButtonCaption,showTitle:!1,enabledIf:()=>!this.isInputReadOnly,innerCss:new ec(()=>this.cssClasses.removeButton),action:()=>{this.doClean()}}),[this.closeCameraAction,this.changeCameraAction,this.takePictureAction].forEach(e=>{e.cssClasses={}}),this.registerFunctionOnPropertiesValueChanged(["sourceType","currentMode","isAnswered"],()=>{this.updateActionsVisibility()}),this.actionsContainer.actions=[this.chooseFileAction,this.startCameraAction,this.cleanAction],this.fileNavigator.actions=[this.prevFileAction,this.fileIndexAction,this.nextFileAction]}get videoId(){return this.id+"_video"}get hasVideoUI(){return"file"!==this.currentMode}get hasFileUI(){return"camera"!==this.currentMode}startVideo(){"file"===this.currentMode||this.isDesignMode||this.isPlayingVideo||(this.setIsPlayingVideo(!0),setTimeout(()=>{this.startVideoInCamera()},0))}get videoHtmlElement(){var e;return null===(e=this.rootElement)||void 0===e?void 0:e.querySelector(`#${this.videoId}`)}startVideoInCamera(){this.camera.startVideo(this.videoHtmlElement,e=>{this.videoStream=e,e||this.stopVideo()},e5(this.imageWidth),e5(this.imageHeight))}stopVideo(){this.setIsPlayingVideo(!1),this.closeVideoStream()}snapPicture(){this.isPlayingVideo&&(this.camera.snap(this.videoHtmlElement,e=>{if(e){let t=new File([e],"snap_picture.png",{type:"image/png"});this.loadFiles([t])}}),this.stopVideo())}canFlipCamera(){return void 0===this.canFlipCameraValue&&(this.canFlipCameraValue=this.camera.canFlip(e=>{this.canFlipCameraValue=e})),this.canFlipCameraValue}flipCamera(){this.canFlipCamera()&&(this.closeVideoStream(),this.camera.flip(),this.startVideoInCamera())}closeVideoStream(){this.videoStream&&(this.videoStream.getTracks().forEach(e=>{e.stop()}),this.videoStream=void 0)}onHidingContent(){super.onHidingContent(),this.stopVideo()}updateElementCssCore(e){super.updateElementCssCore(e),this.prevFileAction.iconName=this.cssClasses.leftIconId,this.nextFileAction.iconName=this.cssClasses.rightIconId,this.updateCurrentMode()}getFileIndexCaption(){return this.getLocalizationFormatString("indexText",this.indexToShow+1,this.pagesCount)}updateFileNavigator(){this.updatePages(),this.navigationDirection=void 0,this.indexToShow=this.previewValue.length&&(this.indexToShow+this.pagesCount)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}updateRenderedPages(){this.pages&&this.pages[this.indexToShow]&&(this.renderedPages=[this.pages[this.indexToShow]])}updatePages(){let e;this.blockAnimations(),this.pages=[],this.renderedPages=[],this.previewValue.forEach((t,s)=>{s%this.pageSize==0&&(e=new iQ(this,this.pages.length),this.pages.push(e)),e.items.push(t)}),this.releaseAnimations(),this.updateRenderedPages()}previewValueChanged(){this.navigationDirection=void 0,this.previewValue.length!==this.prevPreviewLength&&(this.previewValue.length>0?this.prevPreviewLength>this.previewValue.length?this.indexToShow>=this.pagesCount&&this.indexToShow>0&&(this.indexToShow=this.pagesCount-1,this.navigationDirection="left-delete"):this.indexToShow=Math.floor(this.prevPreviewLength/this.pageSize):this.indexToShow=0),this.updatePages(),this.fileIndexAction.title=this.getFileIndexCaption(),this.containsMultiplyFiles=this.previewValue.length>1,!(this.previewValue.length>0)||this.calculatedGapBetweenItems||this.calculatedItemWidth||setTimeout(()=>{this.processResponsiveness(0,this._width)},1),this.prevPreviewLength=this.previewValue.length}getType(){return"file"}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.isLoadingFromJson||this.loadPreview(e)}get showPreview(){return this.getPropertyValue("showPreview")}set showPreview(e){this.setPropertyValue("showPreview",e)}get allowMultiple(){return this.getPropertyValue("allowMultiple")}set allowMultiple(e){this.setPropertyValue("allowMultiple",e)}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get acceptedTypes(){return this.getPropertyValue("acceptedTypes")}set acceptedTypes(e){this.setPropertyValue("acceptedTypes",e)}get allowImagesPreview(){return this.getPropertyValue("allowImagesPreview")}set allowImagesPreview(e){this.setPropertyValue("allowImagesPreview",e)}get maxSize(){return this.getPropertyValue("maxSize")}set maxSize(e){this.setPropertyValue("maxSize",e)}chooseFile(e){if(!this.rootElement)return;let t=this.rootElement.querySelector(`#${this.inputId}`);t&&(e.preventDefault(),e.stopImmediatePropagation(),t&&(this.survey?this.survey.chooseFiles(t,e=>this.loadFiles(e),{element:this,elementType:this.getType(),propertyName:this.name}):t.click()))}get needConfirmRemoveFile(){return this.getPropertyValue("needConfirmRemoveFile")}set needConfirmRemoveFile(e){this.setPropertyValue("needConfirmRemoveFile",e)}getConfirmRemoveMessage(e){return this.confirmRemoveMessage.format(e)}get takePhotoCaption(){return this.getLocalizableStringText("takePhotoCaption")}set takePhotoCaption(e){this.setLocalizableStringText("takePhotoCaption",e)}get locTakePhotoCaption(){return this.getLocalizableString("takePhotoCaption")}get clearButtonCaption(){return this.getLocalizableStringText("clearCaption")}set clearButtonCaption(e){this.setLocalizableStringText("clearCaption",e)}get locClearButtonCaption(){return this.getLocalizableString("clearCaption")}get locRenderedPlaceholder(){return void 0===this.locRenderedPlaceholderValue&&(this.locRenderedPlaceholderValue=new ec(()=>{let e;let t=this.isReadOnly,s=!this.isDesignMode&&this.hasFileUI||this.isDesignMode&&"camera"!=this.sourceType,i=!this.isDesignMode&&this.hasVideoUI||this.isDesignMode&&"file"!=this.sourceType;return t?this.locNoFileChosenCaption:s&&i?this.locFileOrPhotoPlaceholder:s?this.locFilePlaceholder:this.locPhotoPlaceholder})),this.locRenderedPlaceholderValue}get currentMode(){return this.getPropertyValue("currentMode",this.sourceType)}get isPlayingVideo(){return this.getPropertyValue("isPlayingVideo",!1)}setIsPlayingVideo(e){this.setPropertyValue("isPlayingVideo",e)}updateCurrentMode(){!this.isDesignMode&&this.survey&&("file"!==this.sourceType?this.camera.hasCamera(e=>{this.setPropertyValue("currentMode",e&&this.isDefaultV2Theme?this.sourceType:"file")}):this.setPropertyValue("currentMode",this.sourceType))}updateActionsVisibility(){let e=this.isDesignMode;this.chooseFileAction.visible=!e&&this.hasFileUI||e&&"camera"!==this.sourceType,this.startCameraAction.visible=!e&&this.hasVideoUI||e&&"file"!==this.sourceType,this.cleanAction.visible=!!this.isAnswered}get inputTitle(){return this.isUploading?this.loadingFileTitle:this.isEmpty()?this.chooseFileTitle:" "}get chooseButtonText(){return this.isEmpty()||this.allowMultiple?this.chooseButtonCaption:this.replaceButtonCaption}clear(e){this.survey&&(this.containsMultiplyFiles=!1,this.survey.clearFiles(this,this.name,this.value,null,(t,s)=>{"success"===t&&(this.value=void 0,this.errors=[],e&&e(),this.indexToShow=0,this.fileIndexAction.title=this.getFileIndexCaption())}))}get renderCapture(){return this.allowCameraAccess?"user":void 0}get multipleRendered(){return this.allowMultiple?"multiple":void 0}get showChooseButton(){return!this.isReadOnly&&!this.isDefaultV2Theme}get showFileDecorator(){let e=this.isPlayingVideo,t=this.showLoadingIndicator;return!e&&!t}get allowShowPreview(){let e=this.showLoadingIndicator,t=this.isPlayingVideo;return!e&&!t}get showPreviewContainer(){return this.previewValue&&this.previewValue.length>0}get showRemoveButtonCore(){let e=this.showLoadingIndicator,t=this.isReadOnly,s=this.isEmpty();return!t&&!s&&!e&&!this.isDefaultV2Theme}get showRemoveButton(){return this.showRemoveButtonCore&&this.cssClasses.removeButton}get showRemoveButtonBottom(){let e=new eV().append(this.cssClasses.removeButtonBottom).append(this.cssClasses.contextButton).toString();return this.showRemoveButtonCore&&e}defaultImage(e){return!this.canPreviewImage(e)&&!!this.cssClasses.defaultImage}removeFile(e){this.removeFileByContent(this.value.filter(t=>t.name===e)[0])}removeFileByContent(e){this.survey&&this.survey.clearFiles(this,this.name,this.value,e.name,(t,s)=>{if("success"===t){var i=this.value;Array.isArray(i)?this.value=i.filter(t=>!a.isTwoValueEquals(t,e,!0,!1,!1)):this.value=void 0}})}setValueFromResult(e){this.value=(this.value||[]).concat(e.map(e=>({name:e.file.name,type:e.file.type,content:e.content})))}loadFiles(e){if(this.survey){if(this.errors=[],this.allFilesOk(e)){var t=()=>{this.stateChanged("loading");var t=[];this.storeDataAsText?e.forEach(s=>{let i=new FileReader;i.onload=r=>{(t=t.concat([{name:s.name,type:s.type,content:i.result}])).length===e.length&&(this.value=(this.value||[]).concat(t))},i.readAsDataURL(s)}):this.uploadFiles(e)};this.allowMultiple?t():this.clear(t)}}}get camera(){return this.cameraValue||(this.cameraValue=new iq),this.cameraValue}canPreviewImage(e){return this.allowImagesPreview&&!!e&&this.isFileImage(e)}loadPreview(e){if((!this.showPreview||this.prevLoadedPreviewValue!==e)&&(this.previewValue.splice(0,this.previewValue.length),this.showPreview&&e)){this.prevLoadedPreviewValue=e;var t=Array.isArray(e)?e:e?[e]:[];this.storeDataAsText?(t.forEach(e=>{var t=e.content||e;this.previewValue.push({name:e.name,type:e.type,content:t})}),this.previewValueChanged()):(this._previewLoader&&this._previewLoader.dispose(),this.isFileLoading=!0,this._previewLoader=new iH(this,(e,t)=>{"error"!==e&&(t.forEach(e=>{this.previewValue.push(e)}),this.previewValueChanged()),this.isFileLoading=!1,this._previewLoader.dispose(),this._previewLoader=void 0}),this._previewLoader.load(t))}}allFilesOk(e){var t=this.errors?this.errors.length:0;return(e||[]).forEach(e=>{this.maxSize>0&&e.size>this.maxSize&&this.errors.push(new tV(this.maxSize,this))}),t===this.errors.length}isFileImage(e){if(!e||!e.content||!e.content.substring)return!1;let t="data:image";var s=e.content&&e.content.substring(0,t.length);return(s=s&&s.toLowerCase())===t||!!e.type&&0===e.type.toLowerCase().indexOf("image/")}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);return t&&!this.isEmpty()&&(t.isNode=!1,t.data=(Array.isArray(this.value)?this.value:[this.value]).map((e,t)=>({name:t,title:"File",value:e.content&&e.content||e,displayValue:e.name&&e.name||e,getString:e=>"object"==typeof e?JSON.stringify(e):e,isNode:!1}))),t}getImageWrapperCss(e){return new eV().append(this.cssClasses.imageWrapper).append(this.cssClasses.imageWrapperDefaultImage,this.defaultImage(e)).toString()}getActionsContainerCss(e){return new eV().append(e.actionsContainer).append(e.actionsContainerAnswered,this.isAnswered).toString()}getRemoveButtonCss(){return new eV().append(this.cssClasses.removeFileButton).append(this.cssClasses.contextButton).toString()}getChooseFileCss(){let e=this.isAnswered;return new eV().append(this.cssClasses.chooseFile).append(this.cssClasses.controlDisabled,this.isReadOnly).append(this.cssClasses.chooseFileAsText,!e).append(this.cssClasses.chooseFileAsTextDisabled,!e&&this.isInputReadOnly).append(this.cssClasses.contextButton,e).append(this.cssClasses.chooseFileAsIcon,e).toString()}getReadOnlyFileCss(){return new eV().append("form-control").append(this.cssClasses.placeholderInput).toString()}get fileRootCss(){return new eV().append(this.cssClasses.root).append(this.cssClasses.rootDisabled,this.isDisabledStyle).append(this.cssClasses.rootReadOnly,this.isReadOnlyStyle).append(this.cssClasses.rootPreview,this.isPreviewStyle).append(this.cssClasses.rootDragging,this.isDragging).append(this.cssClasses.rootAnswered,this.isAnswered).append(this.cssClasses.single,!this.allowMultiple).append(this.cssClasses.singleImage,!this.allowMultiple&&this.isAnswered&&this.canPreviewImage(this.value[0])).append(this.cssClasses.mobile,this.isMobile).toString()}getFileDecoratorCss(){return new eV().append(this.cssClasses.fileDecorator).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.fileDecoratorDrag,this.isDragging).toString()}onChange(e){if(!i.isFileReaderAvailable()||!e||!e.files||e.files.length<1)return;let t=[],s=this.allowMultiple?e.files.length:1;for(let i=0;i<s;i++)t.push(e.files[i]);e.value="",this.loadFiles(t)}calcCssClasses(e){let t=super.calcCssClasses(e);return this.actionsContainer.cssClasses=e.actionBar,this.actionsContainer.cssClasses.itemWithTitle=this.actionsContainer.cssClasses.item,this.actionsContainer.cssClasses.item="",this.actionsContainer.cssClasses.itemAsIcon=t.contextButton,this.actionsContainer.containerCss=t.actionsContainer,t}onSurveyLoad(){super.onSurveyLoad(),this.updateCurrentMode(),this.updateActionsVisibility(),this.loadPreview(this.value)}needResponsiveness(){return this.supportResponsiveness()&&this.isDefaultV2Theme}supportResponsiveness(){return!0}getObservedElementSelector(){return tr(this.cssClasses.dragArea)}getFileListSelector(){return tr(this.cssClasses.fileList)}get renderedPages(){return this._renderedPages}set renderedPages(e){this.pagesAnimation.sync(e)}getPagesAnimationOptions(){return{getEnterOptions:e=>{let t=this.cssClasses.page;return{cssClass:t?new eV().append(`${t}--enter-from-left`,"left"==this.navigationDirection||"left-delete"==this.navigationDirection).append(`${t}--enter-from-right`,"right"==this.navigationDirection).toString():""}},getLeaveOptions:e=>{let t=this.cssClasses.page;return{cssClass:t?new eV().append(`${t}--leave-to-left`,"right"==this.navigationDirection).append(`${t}--leave-to-right`,"left"==this.navigationDirection).toString():""}},getAnimatedElement:e=>{var t;return null===(t=this.rootElement)||void 0===t?void 0:t.querySelector(`#${e.id}`)},isAnimationEnabled:()=>this.animationAllowed&&!!this.rootElement,getRerenderEvent:()=>this.onElementRerendered}}triggerResponsiveness(e){e&&(this.calculatedGapBetweenItems=void 0,this.calculatedItemWidth=void 0),super.triggerResponsiveness()}processResponsiveness(e,t){if(this._width=t,this.rootElement&&(!this.calculatedGapBetweenItems||!this.calculatedItemWidth)&&this.allowMultiple){let e=this.getFileListSelector()?this.rootElement.querySelector(this.getFileListSelector()):void 0;if(e){let t=e.querySelector(tr(this.cssClasses.page));if(t){let e=t.querySelector(tr(this.cssClasses.previewItem));this.calculatedGapBetweenItems=Math.ceil(Number.parseFloat(r.getComputedStyle(t).gap)),e&&(this.calculatedItemWidth=Math.ceil(Number.parseFloat(r.getComputedStyle(e).width)))}}}return!!this.calculatedGapBetweenItems&&!!this.calculatedItemWidth&&(this.pageSize=this.calcAvailableItemsCount(t,this.calculatedItemWidth,this.calculatedGapBetweenItems),!0)}canDragDrop(){return!this.isInputReadOnly&&"camera"!==this.currentMode&&!this.isPlayingVideo}afterRenderQuestionElement(e){this.rootElement=e}beforeDestroyQuestionElement(e){this.rootElement=void 0}clearFilesCore(){if(this.rootElement){let e=this.rootElement.querySelectorAll("input")[0];e&&(e.value="")}this.clear()}doRemoveFile(e,t){if(t.stopPropagation(),this.needConfirmRemoveFile){eG({message:this.getConfirmRemoveMessage(e.name),funcOnYes:()=>{this.removeFileCore(e)},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.removeFileCore(e)}removeFileCore(e){let t=this.previewValue.indexOf(e);this.removeFileByContent(-1===t?e:this.value[t])}dispose(){this.cameraValue=void 0,this.closeVideoStream(),super.dispose()}}ey([c()],iz.prototype,"isDragging",void 0),ey([p({})],iz.prototype,"previewValue",void 0),ey([p({})],iz.prototype,"pages",void 0),ey([c({defaultValue:0,onSet:(e,t)=>{t.updateRenderedPages()}})],iz.prototype,"indexToShow",void 0),ey([c({defaultValue:1,onSet:(e,t)=>{t.updateFileNavigator()}})],iz.prototype,"pageSize",void 0),ey([c({defaultValue:!1})],iz.prototype,"containsMultiplyFiles",void 0),ey([c()],iz.prototype,"allowCameraAccess",void 0),ey([c({onSet:(e,t)=>{t.isLoadingFromJson||t.updateCurrentMode()}})],iz.prototype,"sourceType",void 0),ey([c()],iz.prototype,"canFlipCameraValue",void 0),ey([c({localizable:{defaultStr:"confirmRemoveFile"}})],iz.prototype,"confirmRemoveMessage",void 0),ey([c({localizable:{defaultStr:"confirmRemoveAllFiles"}})],iz.prototype,"confirmRemoveAllMessage",void 0),ey([c({localizable:{defaultStr:"noFileChosen"}})],iz.prototype,"noFileChosenCaption",void 0),ey([c({localizable:{defaultStr:"chooseFileCaption"}})],iz.prototype,"chooseButtonCaption",void 0),ey([c({localizable:{defaultStr:"replaceFileCaption"}})],iz.prototype,"replaceButtonCaption",void 0),ey([c({localizable:{defaultStr:"removeFileCaption"}})],iz.prototype,"removeFileCaption",void 0),ey([c({localizable:{defaultStr:"loadingFile"}})],iz.prototype,"loadingFileTitle",void 0),ey([c({localizable:{defaultStr:"chooseFile"}})],iz.prototype,"chooseFileTitle",void 0),ey([c({localizable:{defaultStr:"fileOrPhotoPlaceholder"}})],iz.prototype,"fileOrPhotoPlaceholder",void 0),ey([c({localizable:{defaultStr:"photoPlaceholder"}})],iz.prototype,"photoPlaceholder",void 0),ey([c({localizable:{defaultStr:"filePlaceholder"}})],iz.prototype,"filePlaceholder",void 0),ey([c()],iz.prototype,"locRenderedPlaceholderValue",void 0),ey([p()],iz.prototype,"_renderedPages",void 0),E.addClass("file",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"showPreview:boolean",default:!0,visible:!1},"allowMultiple:boolean",{name:"allowImagesPreview:boolean",default:!0,dependsOn:"showPreview",visibleIf:e=>!!e.showPreview},"imageHeight","imageWidth","acceptedTypes",{name:"storeDataAsText:boolean",default:!0},{name:"waitForUpload:boolean",default:!1},{name:"maxSize:number",default:0},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"validators",visible:!1},{name:"needConfirmRemoveFile:boolean"},{name:"sourceType",choices:["file","camera","file-camera"],default:"file",category:"general",visible:!0},{name:"fileOrPhotoPlaceholder:text",serializationProperty:"locFileOrPhotoPlaceholder",category:"general"},{name:"photoPlaceholder:text",serializationProperty:"locPhotoPlaceholder",category:"general"},{name:"filePlaceholder:text",serializationProperty:"locFilePlaceholder",category:"general"},{name:"allowCameraAccess:switch",category:"general",visible:!1}],function(){return new iz("")},"question"),st.Instance.registerQuestion("file",e=>new iz(e));class iH{constructor(e,t){this.fileQuestion=e,this.callback=t,this.loaded=[]}load(e){let t=0;this.loaded=Array(e.length),e.forEach((s,i)=>{this.fileQuestion.survey&&this.fileQuestion.survey.downloadFile(this.fileQuestion,this.fileQuestion.name,s,(r,n)=>{this.fileQuestion&&this.callback&&("error"!==r?(this.loaded[i]={content:n,name:s.name,type:s.type},++t===e.length&&this.callback(r,this.loaded)):this.callback("error",this.loaded))})})}dispose(){this.fileQuestion=void 0,this.callback=void 0}}class iW extends iS{constructor(e){super(e),this.createLocalizableString("html",this).onGetTextCallback=e=>this.survey&&!this.ignoreHtmlProgressing?this.processHtml(e):e}getType(){return"html"}get isCompositeQuestion(){return!0}getProcessedText(e){return this.ignoreHtmlProgressing?e:super.getProcessedText(e)}get html(){return this.getLocalizableStringText("html","")}set html(e){this.setLocalizableStringText("html",e)}get locHtml(){return this.getLocalizableString("html")}get processedHtml(){return this.processHtml(this.html)}processHtml(e){return this.survey?this.survey.processHtml(e,"html-question"):this.html}get isNewA11yStructure(){return!0}get renderCssRoot(){return new eV().append(this.cssClasses.root).append(this.cssClasses.nested,this.getIsNested()).toString()||void 0}}E.addClass("html",[{name:"html:html",serializationProperty:"locHtml"},{name:"showNumber",visible:!1},{name:"state",visible:!1},{name:"titleLocation",visible:!1},{name:"descriptionLocation",visible:!1},{name:"errorLocation",visible:!1},{name:"indent",visible:!1},{name:"width",visible:!1}],function(){return new iW("")},"nonvalue"),st.Instance.registerQuestion("html",e=>new iW(e));class iU extends s2{constructor(e){super(e)}getDefaultItemComponent(){return"survey-radiogroup-item"}getType(){return"radiogroup"}getFirstInputElementId(){return this.inputId+"_0"}get selectedItem(){return this.getSingleSelectedItem()}get allowClear(){return this.getPropertyValue("allowClear")}set allowClear(e){this.setPropertyValue("allowClear",e)}get showClearButton(){return this.allowClear}set showClearButton(e){this.allowClear=e}get canShowClearButton(){return this.allowClear&&!this.isReadOnly}get clearButtonCaption(){return this.getLocalizationString("clearCaption")}supportAutoAdvance(){return!0===this.isMouseDown&&!this.isOtherSelected}getConditionJson(e=null,t=null){let s=super.getConditionJson(e,t);return delete s.allowClear,delete s.showClearButton,s}setNewComment(e){this.isMouseDown=!0,super.setNewComment(e),this.isMouseDown=!1}get showClearButtonInContent(){return!this.isDefaultV2Theme&&this.canShowClearButton}clickItemHandler(e){this.isReadOnlyAttr||(this.renderedValue=e.value)}getDefaultTitleActions(){let e=[];if(this.isDefaultV2Theme&&!this.isDesignMode){let t=new eL({locTitleName:"clearCaption",id:`sv-clr-btn-${this.id}`,action:()=>{this.clearValue(!0)},innerCss:this.cssClasses.clearButton,visible:new ec(()=>this.canShowClearButton)});e.push(t)}return e}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"radiogroup"}}E.addClass("radiogroup",[{name:"allowClear:boolean",alternativeName:"showClearButton"},{name:"separateSpecialChoices",visible:!0},{name:"itemComponent",visible:!1,default:"survey-radiogroup-item"}],function(){return new iU("")},"checkboxbase"),st.Instance.registerQuestion("radiogroup",e=>{var t=new iU(e);return t.choices=st.DefaultChoices,t});class ij extends eg{onStringChangedCallback(){this.text=this.itemValue.text}get value(){return this.itemValue.getPropertyValue("value")}get locText(){return this.locString||this.itemValue.locText}constructor(e,t=null){super(),this.itemValue=e,this.locString=t,this.locText.onStringChanged.add(this.onStringChangedCallback.bind(this)),this.onStringChangedCallback()}}ey([c({defaultValue:""})],ij.prototype,"highlight",void 0),ey([c({defaultValue:""})],ij.prototype,"text",void 0),ey([c()],ij.prototype,"style",void 0);class iJ extends tJ{constructor(e,t,s){super(e,t),this.description=s}}class iG extends tU{constructor(e){super(e),this._syncPropertiesChanging=!1,this.iCounter=0,this.createItemValues("rateValues"),this.createLocalizableString("ratingOptionsCaption",this,!1,!0),this.registerFunctionOnPropertiesValueChanged(["rateMin","rateMax","minRateDescription","maxRateDescription","rateStep","displayRateDescriptionsAsExtremeItems"],()=>this.resetRenderedItems()),this.registerFunctionOnPropertiesValueChanged(["rateType"],()=>{this.setIconsToRateValues(),this.resetRenderedItems(),this.updateRateCount()}),this.registerFunctionOnPropertiesValueChanged(["rateValues"],()=>{this.setIconsToRateValues(),this.resetRenderedItems()}),this.registerSychProperties(["rateValues"],()=>{this.autoGenerate=0==this.rateValues.length,this.setIconsToRateValues(),this.resetRenderedItems()}),this.registerFunctionOnPropertiesValueChanged(["rateColorMode","scaleColorMode"],()=>{this.updateColors(this.survey.themeVariables)}),this.registerFunctionOnPropertiesValueChanged(["displayMode"],()=>{this.updateRenderAsBasedOnDisplayMode(!0)}),this.registerSychProperties(["autoGenerate"],()=>{this.autoGenerate||0!==this.rateValues.length||this.setPropertyValue("rateValues",this.visibleRateValues),this.autoGenerate&&(this.rateValues.splice(0,this.rateValues.length),this.updateRateMax()),this.resetRenderedItems()}),this.createLocalizableString("minRateDescription",this,!0).onStringChanged.add((e,t)=>{this.setPropertyValue("hasMinRateDescription",!e.isEmpty)}),this.createLocalizableString("maxRateDescription",this,!0).onStringChanged.add((e,t)=>{this.setPropertyValue("hasMaxRateDescription",!e.isEmpty)}),this.initPropertyDependencies()}setIconsToRateValues(){"smileys"==this.rateType&&this.rateValues.map(e=>e.icon=this.getItemSmiley(e))}endLoadingFromJson(){super.endLoadingFromJson(),void 0!==this.jsonObj.rateMin&&void 0!==this.jsonObj.rateCount&&void 0===this.jsonObj.rateMax&&this.updateRateMax(),void 0!==this.jsonObj.rateMax&&void 0!==this.jsonObj.rateCount&&void 0===this.jsonObj.rateMin&&this.updateRateMin(),void 0===this.jsonObj.autoGenerate&&void 0!==this.jsonObj.rateValues&&(this.autoGenerate=!this.jsonObj.rateValues.length),this.updateRateCount(),this.setIconsToRateValues()}registerSychProperties(e,t){this.registerFunctionOnPropertiesValueChanged(e,()=>{this._syncPropertiesChanging||(this._syncPropertiesChanging=!0,t(),this._syncPropertiesChanging=!1)})}useRateValues(){return!!this.rateValues.length&&!this.autoGenerate}updateRateMax(){this.rateMax=this.rateMin+this.rateStep*(this.rateCount-1)}updateRateMin(){this.rateMin=this.rateMax-this.rateStep*(this.rateCount-1)}updateRateCount(){let e=0;(e=this.useRateValues()?this.rateValues.length:Math.trunc((this.rateMax-this.rateMin)/(this.rateStep||1))+1)>10&&"smileys"==this.rateDisplayMode&&(e=10),this.rateCount=e,this.rateValues.length>e&&this.rateValues.splice(e,this.rateValues.length-e)}initPropertyDependencies(){this.registerSychProperties(["rateCount"],()=>{if(this.useRateValues()){if(this.rateCount<this.rateValues.length)(!(this.rateCount>=10)||"smileys"!=this.rateDisplayMode)&&this.rateValues.splice(this.rateCount,this.rateValues.length-this.rateCount);else for(let e=this.rateValues.length;e<this.rateCount;e++)this.rateValues.push(new tJ(u("choices_Item")+(e+1)))}else this.rateMax=this.rateMin+this.rateStep*(this.rateCount-1)}),this.registerSychProperties(["rateMin","rateMax","rateStep","rateValues"],()=>{this.updateRateCount()})}get showSelectedItemLocText(){return!this.readOnly&&!this.inputHasValue&&!!this.selectedItemLocText}get selectedItemLocText(){var e;return!this.readOnly&&(null===(e=this.visibleRateValues.filter(e=>e.value==this.value)[0])||void 0===e?void 0:e.locText)}get rateValues(){return this.getPropertyValue("rateValues")}set rateValues(e){this.setPropertyValue("rateValues",e)}get rateMin(){return this.getPropertyValue("rateMin")}set rateMin(e){this.setPropertyValue("rateMin",e)}get rateMax(){return this.getPropertyValue("rateMax")}set rateMax(e){this.setPropertyValue("rateMax",e)}get rateStep(){return this.getPropertyValue("rateStep")}set rateStep(e){this.setPropertyValue("rateStep",e)}updateColors(e){function t(e){let t=getComputedStyle(r.getDocumentElement());return t.getPropertyValue&&t.getPropertyValue(e)}function s(s,i){let n=!!e&&e[s];if(n||(n=t(i)),!n)return null;let a=r.createElement("canvas");if(!a)return null;var o=a.getContext("2d");o.fillStyle=n,"#000000"==o.fillStyle&&(o.fillStyle=t(i));let l=o.fillStyle;if(l.startsWith("rgba"))return l.substring(5,l.length-1).split(",").map(e=>+e.trim());var h=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(l);return h?[parseInt(h[1],16),parseInt(h[2],16),parseInt(h[3],16),1]:null}"monochrome"!==this.colorMode&&r.isAvailable()&&(iG.colorsCalculated||(iG.badColor=s("--sjs-special-red","--sd-rating-bad-color"),iG.normalColor=s("--sjs-special-yellow","--sd-rating-normal-color"),iG.goodColor=s("--sjs-special-green","--sd-rating-good-color"),iG.badColorLight=s("--sjs-special-red-light","--sd-rating-bad-color-light"),iG.normalColorLight=s("--sjs-special-yellow-light","--sd-rating-normal-color-light"),iG.goodColorLight=s("--sjs-special-green-light","--sd-rating-good-color-light"),this.colorsCalculated=!0,this.resetRenderedItems()))}getDisplayValueCore(e,t){return this.useRateValues?tJ.getTextOrHtmlByValue(this.visibleRateValues,t)||t:super.getDisplayValueCore(e,t)}get visibleRateValues(){return this.renderedRateItems.map(e=>e.itemValue)}supportEmptyValidation(){return"dropdown"===this.renderAs}itemValuePropertyChanged(e,t,s,i){this.useRateValues()||void 0===i||(this.autoGenerate=!1),super.itemValuePropertyChanged(e,t,s,i)}runConditionCore(e,t){super.runConditionCore(e,t),this.runRateItesmCondition(e,t)}runRateItesmCondition(e,t){var s;if(!this.useRateValues())return;let i=!1;if((null===(s=this.survey)||void 0===s?void 0:s.areInvisibleElementsShowing)?this.rateValues.forEach(e=>{i=i||!e.isVisible,e.setIsVisible(e,!0)}):i=tJ.runConditionsForItems(this.rateValues,void 0,void 0,e,t,!0),i&&(this.resetRenderedItems(),!this.isEmpty()&&!this.isReadOnly)){let e=tJ.getItemByValue(this.rateValues,this.value);e&&!e.isVisible&&this.clearValue()}}getRateValuesCore(){if(!this.useRateValues())return this.createRateValues();let e=[];return this.rateValues.forEach(t=>{t.isVisible&&e.push(t)}),e}calculateRateValues(){let e=this.getRateValuesCore();return"smileys"==this.rateType&&e.length>10&&(e=e.slice(0,10)),e}calculateRenderedRateItems(){let e=this.calculateRateValues();return e.map((t,s)=>{let i=null;return this.displayRateDescriptionsAsExtremeItems&&(0==s&&(i=new ij(t,this.minRateDescription&&this.locMinRateDescription||t.locText)),s==e.length-1&&(i=new ij(t,this.maxRateDescription&&this.locMaxRateDescription||t.locText))),i||(i=new ij(t)),i})}calculateVisibleChoices(){return this.calculateRateValues().map((e,t)=>this.getRatingItemValue(e,t))}resetRenderedItems(){if(this.autoGenerate){let e=this.getRateValuesCore();this.rateMax=e[e.length-1].value}Array.isArray(this.getPropertyValueWithoutDefault("renderedRateItems"))&&this.setArrayPropertyDirectly("renderedRateItems",this.calculateRenderedRateItems()),Array.isArray(this.getPropertyValueWithoutDefault("visibleChoices"))&&this.setArrayPropertyDirectly("visibleChoices",this.calculateVisibleChoices)}get renderedRateItems(){return this.getPropertyValue("renderedRateItems",void 0,()=>this.calculateRenderedRateItems())}get visibleChoices(){return this.getPropertyValue("visibleChoices",void 0,()=>this.calculateVisibleChoices())}createRateValues(){for(var e=[],t=this.rateMin,s=this.rateStep;t<=this.rateMax&&e.length<tp.ratingMaximumRateValueCount;){let i=new tJ(t);i.locOwner=this,i.ownerPropertyName="rateValues",e.push(i),t=this.correctValue(t+s,s)}return e}getRatingItemValue(e,t){let s;if(!e)return null;let i=e.value;i===this.rateMin&&(s=this.minRateDescription&&this.locMinRateDescription),(i===this.rateMax||t===tp.ratingMaximumRateValueCount)&&(s=this.maxRateDescription&&this.locMaxRateDescription);let r=new iJ(i,e.text,s);return r.locOwner=e.locOwner,r.ownerPropertyName=e.ownerPropertyName,r}correctValue(e,t){if(!e||Math.round(e)==e)return e;for(var s=0;Math.round(t)!=t;)t*=10,s++;return parseFloat(e.toFixed(s))}getType(){return"rating"}getFirstInputElementId(){return this.inputId+"_0"}getInputId(e){return this.inputId+"_"+e}get questionName(){return this.name+"_"+this.id}supportAutoAdvance(){return!0===this.isMouseDown||"dropdown"===this.renderAs}supportOther(){return!1}getPlainDataCalculatedValue(e){let t=super.getPlainDataCalculatedValue(e);if(void 0!==t||!this.useRateValues||this.isEmpty())return t;let s=tJ.getItemByValue(this.visibleRateValues,this.value);return s?s[e]:void 0}get minRateDescription(){return this.getLocalizableStringText("minRateDescription")}set minRateDescription(e){this.setLocalizableStringText("minRateDescription",e)}get locMinRateDescription(){return this.getLocalizableString("minRateDescription")}get maxRateDescription(){return this.getLocalizableStringText("maxRateDescription")}set maxRateDescription(e){this.setLocalizableStringText("maxRateDescription",e)}get locMaxRateDescription(){return this.getLocalizableString("maxRateDescription")}get hasMinRateDescription(){return this.getPropertyValue("hasMinRateDescription",void 0,()=>!!this.minRateDescription)}get hasMaxRateDescription(){return this.getPropertyValue("hasMaxRateDescription",void 0,()=>!!this.maxRateDescription)}get hasMinLabel(){return!this.displayRateDescriptionsAsExtremeItems&&!!this.hasMinRateDescription}get hasMaxLabel(){return!this.displayRateDescriptionsAsExtremeItems&&!!this.hasMaxRateDescription}updateRenderAsBasedOnDisplayMode(e){this.isDesignMode?(e||"dropdown"===this.renderAs)&&(this.renderAs="default"):(e||"auto"!==this.displayMode)&&(this.renderAs="dropdown"===this.displayMode?"dropdown":"default")}onSurveyLoad(){super.onSurveyLoad(),"dropdown"===this.renderAs&&"auto"===this.displayMode?this.displayMode=this.renderAs:this.updateRenderAsBasedOnDisplayMode()}get rateDisplayMode(){return this.rateType}set rateDisplayMode(e){this.rateType=e}get isStar(){return"stars"==this.rateType}get isSmiley(){return"smileys"==this.rateType}getDefaultItemComponent(){return"dropdown"==this.renderAs?"sv-rating-dropdown-item":this.isStar?"sv-rating-item-star":this.isSmiley?"sv-rating-item-smiley":"sv-rating-item"}get itemComponent(){return this.getPropertyValue("itemComponent",this.getDefaultItemComponent())}set itemComponent(e){this.setPropertyValue("itemComponent",e)}valueToData(e){if(this.useRateValues()){var t=tJ.getItemByValue(this.rateValues,e);return t?t.value:e}return isNaN(e)?e:parseFloat(e)}setValueFromClick(e){if(!this.isReadOnlyAttr){this.value===("string"==typeof this.value?e:parseFloat(e))?this.clearValue(!0):this.value=e;for(let e=0;e<this.renderedRateItems.length;e++)this.renderedRateItems[e].highlight="none"}}onItemMouseIn(e){if(sT||this.isReadOnly||!e.itemValue.isEnabled||this.isDesignMode)return;let t=!0,s=null!=this.value;if("stars"!==this.rateType){e.highlight="highlighted";return}for(let i=0;i<this.renderedRateItems.length;i++)this.renderedRateItems[i].highlight=t&&!s&&"highlighted"||!t&&s&&"unhighlighted"||"none",this.renderedRateItems[i]==e&&(t=!1),this.renderedRateItems[i].itemValue.value==this.value&&(s=!1)}onItemMouseOut(e){sT||this.renderedRateItems.forEach(e=>e.highlight="none")}get itemSmallMode(){return this.inMatrixMode&&"small"==tp.matrix.rateSize}get ratingRootCss(){let e=this.hasMaxLabel||this.hasMinLabel;return new eV().append(this.cssClasses.root).append(this.cssClasses.rootWrappable,"buttons"==this.displayMode||!!this.survey&&this.survey.isDesignMode||"auto"==this.displayMode&&!this.supportResponsiveness()).append(this.cssClasses.rootLabelsTop,e&&"top"==this.rateDescriptionLocation).append(this.cssClasses.rootLabelsBottom,e&&"bottom"==this.rateDescriptionLocation).append(this.cssClasses.rootLabelsDiagonal,e&&"topBottom"==this.rateDescriptionLocation).append(this.cssClasses.itemSmall,this.itemSmallMode&&"labels"!=this.rateType).toString()}get itemStarIcon(){return this.itemSmallMode?"icon-rating-star-small":"icon-rating-star"}get itemStarIconAlt(){return this.itemStarIcon+"-2"}getItemSmiley(e){let t=["very-good","not-good","normal","good","average","excellent","poor","perfect","very-poor","terrible"].slice(0,this.useRateValues()?this.rateValues.length:this.rateMax-this.rateMin+1),s=["terrible","very-poor","poor","not-good","average","normal","good","very-good","excellent","perfect"].filter(e=>-1!=t.indexOf(e));return this.useRateValues()?s[this.rateValues.indexOf(e)]:s[e.value-this.rateMin]}getItemSmileyIconName(e){return"icon-"+this.getItemSmiley(e)}getItemClassByText(e,t){return this.getItemClass(e)}getRenderedItemColor(e,t){let s=t?iG.badColorLight:iG.badColor,i=t?iG.goodColorLight:iG.goodColor,r=(this.rateCount-1)/2,n=t?iG.normalColorLight:iG.normalColor;if(e<r?i=n:(s=n,e-=r),!s||!i)return null;let a=[0,0,0,0];for(let t=0;t<4;t++)a[t]=s[t]+(i[t]-s[t])*e/r,t<3&&(a[t]=Math.trunc(a[t]));return"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}getItemStyle(e,t="none"){if("monochrome"===this.scaleColorMode&&"default"==this.rateColorMode||this.isPreviewStyle||this.isReadOnlyStyle)return{};let s=this.visibleRateValues.indexOf(e),i=this.getRenderedItemColor(s,!1),r="highlighted"==t&&"colored"===this.scaleColorMode&&this.getRenderedItemColor(s,!0);return r?{"--sd-rating-item-color":i,"--sd-rating-item-color-light":r}:{"--sd-rating-item-color":i}}getItemClass(e,t="none"){let s=this.value==e.value;this.isStar&&(s=this.useRateValues()?this.rateValues.indexOf(this.rateValues.filter(e=>e.value==this.value)[0])>=this.rateValues.indexOf(e):this.value>=e.value);let i=!(this.isReadOnly||!e.isEnabled)&&this.value!=e.value&&!(this.survey&&this.survey.isDesignMode),r=this.renderedRateItems.filter(t=>t.itemValue==e)[0],n=this.isStar&&(null==r?void 0:r.highlight)=="highlighted",a=this.isStar&&(null==r?void 0:r.highlight)=="unhighlighted",o=this.cssClasses.item,l=this.cssClasses.selected,h=this.cssClasses.itemDisabled,u=this.cssClasses.itemReadOnly,d=this.cssClasses.itemPreview,c=this.cssClasses.itemHover,g=this.cssClasses.itemOnError,p=null,m=null,v=null,y=null,C=null;this.isStar&&(o=this.cssClasses.itemStar,l=this.cssClasses.itemStarSelected,h=this.cssClasses.itemStarDisabled,u=this.cssClasses.itemStarReadOnly,d=this.cssClasses.itemStarPreview,c=this.cssClasses.itemStarHover,g=this.cssClasses.itemStarOnError,p=this.cssClasses.itemStarHighlighted,m=this.cssClasses.itemStarUnhighlighted,C=this.cssClasses.itemStarSmall),this.isSmiley&&(o=this.cssClasses.itemSmiley,l=this.cssClasses.itemSmileySelected,h=this.cssClasses.itemSmileyDisabled,u=this.cssClasses.itemSmileyReadOnly,d=this.cssClasses.itemSmileyPreview,c=this.cssClasses.itemSmileyHover,g=this.cssClasses.itemSmileyOnError,p=this.cssClasses.itemSmileyHighlighted,v=this.cssClasses.itemSmileyScaleColored,y=this.cssClasses.itemSmileyRateColored,C=this.cssClasses.itemSmileySmall);let f=!this.isStar&&!this.isSmiley&&(!this.displayRateDescriptionsAsExtremeItems||this.useRateValues()&&e!=this.rateValues[0]&&e!=this.rateValues[this.rateValues.length-1]||!this.useRateValues()&&e.value!=this.rateMin&&e.value!=this.rateMax)&&e.locText.calculatedText.length<=2&&Number.isInteger(Number(e.locText.calculatedText));return new eV().append(o).append(l,s).append(h,this.isDisabledStyle).append(u,this.isReadOnlyStyle).append(d,this.isPreviewStyle).append(c,i).append(p,n).append(v,"colored"==this.scaleColorMode).append(y,"scale"==this.rateColorMode&&s).append(m,a).append(g,this.hasCssError()).append(C,this.itemSmallMode).append(this.cssClasses.itemFixedSize,f).toString()}getControlClass(){return this.isEmpty(),new eV().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).toString()}get placeholder(){return this.getLocalizableStringText("ratingOptionsCaption")}set placeholder(e){this.setLocalizableStringText("ratingOptionsCaption",e)}get locPlaceholder(){return this.getLocalizableString("ratingOptionsCaption")}get allowClear(){return!0}get searchEnabled(){return!1}get renderedValue(){return this.value}set renderedValue(e){this.value=e}isItemSelected(e){return e.value==this.value}get readOnlyText(){return this.readOnly?this.displayValue||this.placeholder:this.isEmpty()?this.placeholder:""}needResponsiveWidth(){this.getPropertyValue("rateValues");let e=this.getPropertyValue("rateStep"),t=this.getPropertyValue("rateMax"),s=this.getPropertyValue("rateMin");return"dropdown"!=this.displayMode&&!!(this.hasMinRateDescription||this.hasMaxRateDescription||e&&(t-s)/e>9)}supportResponsiveness(){return!this.inMatrixMode}onBeforeSetCompactRenderer(){this.dropdownListModelValue||(this.dropdownListModelValue=new ie(this),this.ariaExpanded="false")}getCompactRenderAs(){return"buttons"==this.displayMode?"default":"dropdown"}getDesktopRenderAs(){return"dropdown"==this.displayMode?"dropdown":"default"}set dropdownListModel(e){this.dropdownListModelValue=e,this.ariaExpanded=e?"false":void 0,this.updateElementCss()}get dropdownListModel(){return"dropdown"===this.renderAs&&this.onBeforeSetCompactRenderer(),this.dropdownListModelValue}onBlurCore(e){var t;null===(t=this.dropdownListModel)||void 0===t||t.onBlur(e),super.onBlurCore(e)}updateCssClasses(e,t){super.updateCssClasses(e,t),tl(e,t)}calcCssClasses(e){let t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModelValue.updateCssClasses(t.popup,t.list),t}themeChanged(e){this.colorsCalculated=!1,this.updateColors(e.cssVariables)}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.survey&&(this.updateColors(this.survey.themeVariables),this.updateRenderAsBasedOnDisplayMode())}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}}iG.colorsCalculated=!1,ey([c({defaultValue:!1})],iG.prototype,"inputHasValue",void 0),ey([c()],iG.prototype,"autoGenerate",void 0),ey([c()],iG.prototype,"rateCount",void 0),ey([c()],iG.prototype,"displayRateDescriptionsAsExtremeItems",void 0),ey([c()],iG.prototype,"displayMode",void 0),ey([c()],iG.prototype,"rateDescriptionLocation",void 0),ey([c()],iG.prototype,"rateType",void 0),ey([c()],iG.prototype,"scaleColorMode",void 0),ey([c()],iG.prototype,"rateColorMode",void 0),E.addClass("rating",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"rateType",alternativeName:"rateDisplayMode",default:"labels",category:"rateValues",choices:["labels","stars","smileys"],visibleIndex:1},{name:"scaleColorMode",category:"rateValues",default:"monochrome",choices:["monochrome","colored"],visibleIf:function(e){return"smileys"==e.rateDisplayMode},visibleIndex:2},{name:"rateColorMode",category:"rateValues",default:"scale",choices:["default","scale"],visibleIf:function(e){return"smileys"==e.rateDisplayMode&&"monochrome"==e.scaleColorMode},visibleIndex:3},{name:"autoGenerate",category:"rateValues",default:!0,choices:[!0,!1],visibleIndex:5},{name:"rateCount:number",default:5,category:"rateValues",visibleIndex:4,onSettingValue:(e,t)=>t<2?2:t>tp.ratingMaximumRateValueCount&&t>e.rateValues.length?tp.ratingMaximumRateValueCount:t>10&&"smileys"==e.rateDisplayMode?10:t},{name:"rateValues:itemvalue[]",baseValue:function(){return u("choices_Item")},category:"rateValues",visibleIf:function(e){return!e.autoGenerate},visibleIndex:6},{name:"rateMin:number",default:1,onSettingValue:(e,t)=>t>e.rateMax-e.rateStep?e.rateMax-e.rateStep:t,visibleIf:function(e){return!!e.autoGenerate},visibleIndex:7},{name:"rateMax:number",default:5,onSettingValue:(e,t)=>t<e.rateMin+e.rateStep?e.rateMin+e.rateStep:t,visibleIf:function(e){return!!e.autoGenerate},visibleIndex:8},{name:"rateStep:number",default:1,minValue:.1,onSettingValue:(e,t)=>(t<=0&&(t=1),t>e.rateMax-e.rateMin&&(t=e.rateMax-e.rateMin),t),visibleIf:function(e){return!!e.autoGenerate},visibleIndex:9},{name:"minRateDescription",alternativeName:"mininumRateDescription",serializationProperty:"locMinRateDescription",visibleIndex:18},{name:"maxRateDescription",alternativeName:"maximumRateDescription",serializationProperty:"locMaxRateDescription",visibleIndex:19},{name:"displayRateDescriptionsAsExtremeItems:boolean",default:!1,visibleIndex:21,visibleIf:function(e){return"labels"==e.rateType}},{name:"rateDescriptionLocation",default:"leftRight",choices:["leftRight","top","bottom","topBottom"],visibleIndex:20},{name:"displayMode",default:"auto",choices:["auto","buttons","dropdown"],visibleIndex:0},{name:"itemComponent",visible:!1,defaultFunc:e=>e?(e.getOriginalObj&&(e=e.getOriginalObj()),e.getDefaultItemComponent()):"sv-rating-item"}],function(){return new iG("")},"question"),st.Instance.registerQuestion("rating",e=>new iG(e));class iK extends tU{constructor(e){super(e),this.createLocalizableString("labelFalse",this,!0,"booleanUncheckedLabel"),this.createLocalizableString("labelTrue",this,!0,"booleanCheckedLabel")}getType(){return"boolean"}isLayoutTypeSupported(e){return!0}supportAutoAdvance(){return"checkbox"!==this.renderAs}get isIndeterminate(){return this.isEmpty()}get hasTitle(){return!0}get booleanValue(){return this.isEmpty()?null:this.value==this.getValueTrue()}set booleanValue(e){!this.isReadOnly&&!this.isDesignMode&&this.setBooleanValue(e)}get checkedValue(){return this.booleanValue}set checkedValue(e){this.booleanValue=e}setBooleanValue(e){this.isValueEmpty(e)?(this.value=void 0,this.booleanValueRendered=void 0):(this.value=!0==e?this.getValueTrue():this.getValueFalse(),this.booleanValueRendered=e)}get defaultValue(){return this.getPropertyValue("defaultValue")}set defaultValue(e){!0===e&&(e="true"),!1===e&&(e="false"),this.setPropertyValue("defaultValue",e),this.updateValueWithDefaults()}getDefaultValue(){let e=this.defaultValue;if("indeterminate"!==e&&null!=e)return"true"==e?this.getValueTrue():this.getValueFalse()}get locTitle(){let e=this.getLocalizableString("title");return(this.isLabelRendered&&!this.showTitle||this.isValueEmpty(e.text))&&!this.isValueEmpty(this.locLabel.text)?this.locLabel:e}get labelRenderedAriaID(){return this.isLabelRendered?this.ariaTitleId:null}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.leftAnswerElement=void 0}get isLabelRendered(){return"hidden"===this.titleLocation&&this.useTitleAsLabel}get canRenderLabelDescription(){return this.isLabelRendered&&this.hasDescription&&(this.hasDescriptionUnderTitle||this.hasDescriptionUnderInput)}get labelTrue(){return this.getLocalizableStringText("labelTrue")}set labelTrue(e){this.setLocalizableStringText("labelTrue",e)}get locLabelTrue(){return this.getLocalizableString("labelTrue")}get isDeterminated(){return null!==this.booleanValue&&void 0!==this.booleanValue}get locLabelLeft(){return this.swapOrder?this.getLocalizableString("labelTrue"):this.getLocalizableString("labelFalse")}get locLabelRight(){return this.swapOrder?this.getLocalizableString("labelFalse"):this.getLocalizableString("labelTrue")}get labelFalse(){return this.getLocalizableStringText("labelFalse")}set labelFalse(e){this.setLocalizableStringText("labelFalse",e)}get locLabelFalse(){return this.getLocalizableString("labelFalse")}getValueTrue(){return void 0===this.valueTrue||this.valueTrue}getValueFalse(){return void 0!==this.valueFalse&&this.valueFalse}setDefaultValue(){this.isDefaultValueSet("true",this.valueTrue)&&this.setBooleanValue(!0),this.isDefaultValueSet("false",this.valueFalse)&&this.setBooleanValue(!1);let e=this.defaultValue;("indeterminate"===e||null==e)&&this.setBooleanValue(void 0)}isDefaultValueSet(e,t){return this.defaultValue==e||void 0!==t&&this.defaultValue===t}getDisplayValueCore(e,t){return t==this.getValueTrue()?this.locLabelTrue.textOrHtml:this.locLabelFalse.textOrHtml}getItemCssValue(e){return new eV().append(e.item).append(e.itemOnError,this.hasCssError()).append(e.itemDisabled,this.isDisabledStyle).append(e.itemReadOnly,this.isReadOnlyStyle).append(e.itemPreview,this.isPreviewStyle).append(e.itemHover,!this.isDesignMode).append(e.itemChecked,!!this.booleanValue).append(e.itemExchanged,!!this.swapOrder).append(e.itemIndeterminate,!this.isDeterminated).toString()}getItemCss(){return this.getItemCssValue(this.cssClasses)}getCheckboxItemCss(){return this.getItemCssValue({item:this.cssClasses.checkboxItem,itemOnError:this.cssClasses.checkboxItemOnError,itemDisabled:this.cssClasses.checkboxItemDisabled,itemDisable:this.cssClasses.checkboxItemDisabled,itemReadOnly:this.cssClasses.checkboxItemReadOnly,itemPreview:this.cssClasses.checkboxItemPreview,itemChecked:this.cssClasses.checkboxItemChecked,itemIndeterminate:this.cssClasses.checkboxItemIndeterminate})}getLabelCss(e){return new eV().append(this.cssClasses.label).append(this.cssClasses.disabledLabel,!e===this.booleanValue||this.isDisabledStyle).append(this.cssClasses.labelReadOnly,this.isReadOnlyStyle).append(this.cssClasses.labelPreview,this.isPreviewStyle).append(this.cssClasses.labelTrue,!this.isIndeterminate&&!this.swapOrder===e).append(this.cssClasses.labelFalse,!this.isIndeterminate&&e===this.swapOrder).toString()}updateValueFromSurvey(e,t=!1){super.updateValueFromSurvey(e,t)}onValueChanged(){super.onValueChanged()}get svgIcon(){return this.booleanValue&&this.cssClasses.svgIconCheckedId?this.cssClasses.svgIconCheckedId:!this.isDeterminated&&this.cssClasses.svgIconIndId?this.cssClasses.svgIconIndId:!this.booleanValue&&this.cssClasses.svgIconUncheckedId?this.cssClasses.svgIconUncheckedId:this.cssClasses.svgIconId}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}get allowClick(){return this.isIndeterminate&&!this.isInputReadOnly}getCheckedLabel(){return!0===this.booleanValue?this.locLabelTrue:!1===this.booleanValue?this.locLabelFalse:void 0}setQuestionValue(e,t=!0){"true"===e&&"true"!==this.valueTrue&&(e=!0),"false"===e&&"false"!==this.valueFalse&&(e=!1),("indeterminate"===e||null===e)&&(e=void 0),super.setQuestionValue(e,t)}onLabelClick(e,t){return this.allowClick&&(ti(e),this.booleanValue=t),!0}calculateBooleanValueByEvent(e,t){let s=!1;r.isAvailable()&&(s="rtl"==r.getComputedStyle(e.target).direction),this.booleanValue=s?!t:t}onSwitchClickModel(e){if(this.allowClick){ti(e);var t=e.offsetX/e.target.offsetWidth>.5;this.calculateBooleanValueByEvent(e,t);return}return!0}onKeyDownCore(e){return("ArrowLeft"===e.key||"ArrowRight"===e.key)&&(e.stopPropagation(),this.calculateBooleanValueByEvent(e,"ArrowRight"===e.key)),!0}getRadioItemClass(e,t){let s;return e.radioItem&&(s=e.radioItem),e.radioItemChecked&&t===this.booleanValue&&(s=(s?s+" ":"")+e.radioItemChecked),this.isDisabledStyle&&(s+=" "+e.radioItemDisabled),this.isReadOnlyStyle&&(s+=" "+e.radioItemReadOnly),this.isPreviewStyle&&(s+=" "+e.radioItemPreview),s}supportResponsiveness(){return!0}getCompactRenderAs(){return"radio"}createActionContainer(e){return super.createActionContainer("checkbox"!==this.renderAs)}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"switch"}}ey([c()],iK.prototype,"booleanValueRendered",void 0),ey([c()],iK.prototype,"showTitle",void 0),ey([c({localizable:!0})],iK.prototype,"label",void 0),ey([c({defaultValue:!0})],iK.prototype,"useTitleAsLabel",void 0),ey([c({defaultValue:!1})],iK.prototype,"swapOrder",void 0),ey([c()],iK.prototype,"valueTrue",void 0),ey([c()],iK.prototype,"valueFalse",void 0),E.addClass("boolean",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"label:text",serializationProperty:"locLabel",isSerializable:!1,visible:!1},{name:"labelTrue:text",serializationProperty:"locLabelTrue"},{name:"labelFalse:text",serializationProperty:"locLabelFalse"},"valueTrue","valueFalse",{name:"swapOrder:boolean",category:"general"},{name:"renderAs",default:"default",visible:!1}],function(){return new iK("")},"question"),st.Instance.registerQuestion("boolean",e=>new iK(e));class iY extends tJ{constructor(e,t=null,s="imageitemvalue"){super(e,t,s),this.typeName=s,this.createLocalizableString("imageLink",this,!1)}getType(){return this.typeName?this.typeName:"itemvalue"}get imageLink(){return this.getLocalizableStringText("imageLink")}set imageLink(e){this.setLocalizableStringText("imageLink",e),this.imageNotLoaded=!1,this.videoNotLoaded=!1}get locImageLink(){return this.getLocalizableString("imageLink")}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t){return this.locOwner?this.locOwner.getMarkdownHtml(e,t):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}onErrorHandler(){this.contentNotLoaded=!0}set contentNotLoaded(e){this.locOwner instanceof iX&&"video"==this.locOwner.contentMode?this.videoNotLoaded=e:this.imageNotLoaded=e}get contentNotLoaded(){return this.locOwner instanceof iX&&"video"==this.locOwner.contentMode?this.videoNotLoaded:this.imageNotLoaded}}ey([c({defaultValue:!1})],iY.prototype,"videoNotLoaded",void 0),ey([c({defaultValue:!1})],iY.prototype,"imageNotLoaded",void 0);class iX extends s2{constructor(e){super(e),this.isResponsiveValue=!1,this.onContentLoaded=(e,t)=>{e.contentNotLoaded=!1;let s=t.target;"video"==this.contentMode?e.aspectRatio=s.videoWidth/s.videoHeight:e.aspectRatio=s.naturalWidth/s.naturalHeight,this._width&&this.processResponsiveness(0,this._width)},this.gridColCount=void 0,this.colCount=0,this.registerPropertyChangedHandlers(["minImageWidth","maxImageWidth","minImageHeight","maxImageHeight","visibleChoices","colCount","isResponsiveValue"],()=>{this._width&&this.processResponsiveness(0,this._width)}),this.registerPropertyChangedHandlers(["imageWidth","imageHeight"],()=>{this.calcIsResponsive()}),this.calcIsResponsive()}getType(){return"imagepicker"}supportAutoAdvance(){return!this.multiSelect}get hasSingleInput(){return!1}getItemValueType(){return"imageitemvalue"}get isCompositeQuestion(){return!0}get itemFlowDirection(){return"row"}supportOther(){return!1}supportNone(){return!1}supportRefuse(){return!1}supportDontKnow(){return!1}isAnswerCorrect(){return this.multiSelect?a.isArrayContainsEqual(this.value,this.correctAnswer):super.isAnswerCorrect()}get multiSelect(){return this.getPropertyValue("multiSelect")}set multiSelect(e){this.setPropertyValue("multiSelect",e)}isItemSelected(e){var t=this.value;if(this.isValueEmpty(t)||!e.imageLink||e.contentNotLoaded)return!1;if(!this.multiSelect)return this.isTwoValueEquals(t,e.value);if(!Array.isArray(t))return!1;for(var s=0;s<t.length;s++)if(this.isTwoValueEquals(t[s],e.value))return!0;return!1}getItemEnabled(e){return!!e.imageLink&&!e.contentNotLoaded&&super.getItemEnabled(e)}clearIncorrectValues(){if(this.multiSelect){var e=this.value;if(e){if(!Array.isArray(e)||0==e.length){this.clearValue(!0);return}for(var t=[],s=0;s<e.length;s++)this.hasUnknownValue(e[s],!0)||t.push(e[s]);t.length!=e.length&&(0==t.length?this.clearValue(!0):this.value=t)}}else super.clearIncorrectValues()}getDisplayValueCore(e,t){return this.multiSelect||Array.isArray(t)?this.getDisplayArrayValue(e,t):super.getDisplayValueCore(e,t)}get showLabel(){return this.getPropertyValue("showLabel")}set showLabel(e){this.setPropertyValue("showLabel",e)}endLoadingFromJson(){super.endLoadingFromJson(),!this.isDesignMode&&this.multiSelect&&(this.createNewArray("renderedValue"),this.createNewArray("value")),this.calcIsResponsive()}getValueCore(){var e=super.getValueCore();return void 0!==e?e:this.multiSelect?[]:e}convertValToArrayForMultSelect(e){return!this.multiSelect||this.isValueEmpty(e)||Array.isArray(e)?e:[e]}renderedValueFromDataCore(e){return this.convertValToArrayForMultSelect(e)}rendredValueToDataCore(e){return this.convertValToArrayForMultSelect(e)}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get imageScale(){return this.survey?this.survey.widthScale/100:1}get renderedImageHeight(){return(this.isResponsive?Math.floor(this.responsiveImageHeight):this.imageHeight*this.imageScale)||150*this.imageScale}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get renderedImageWidth(){return(this.isResponsive?Math.floor(this.responsiveImageWidth):this.imageWidth*this.imageScale)||200*this.imageScale}get imageFit(){return this.getPropertyValue("imageFit")}set imageFit(e){this.setPropertyValue("imageFit",e)}get contentMode(){return this.getPropertyValue("contentMode")}set contentMode(e){this.setPropertyValue("contentMode",e),"video"===e&&(this.showLabel=!0)}convertDefaultValue(e){return e}get inputType(){return this.multiSelect?"checkbox":"radio"}isBuiltInChoice(e){return!1}addToVisibleChoices(e,t){this.addNewItemToVisibleChoices(e,t)}getSelectBaseRootCss(){let e=this.isResponsive;return new eV().append(super.getSelectBaseRootCss()).append(this.cssClasses.rootResponsive,e).append(this.cssClasses.rootStatic,!e).append(this.cssClasses.rootColumn,1==this.getCurrentColCount()).toString()}get isResponsive(){return this.isResponsiveValue&&this.isDefaultV2Theme}get exactSizesAreEmpty(){return!["imageHeight","imageWidth"].some(e=>void 0!==this[e]&&null!==this[e])}calcIsResponsive(){this.isResponsiveValue=this.exactSizesAreEmpty}getObservedElementSelector(){return tr(this.cssClasses.root)}supportResponsiveness(){return!0}needResponsiveness(){return this.supportResponsiveness()&&this.isDefaultV2Theme}needResponsiveWidth(){return this.colCount>2}getCurrentColCount(){return void 0===this.responsiveColCount||0===this.colCount?this.colCount:this.responsiveColCount}getContainerStyle(){return this.isResponsive?{gridAutoFlow:this.gridColCount?null:"column",gridTemplateColumns:this.gridColCount?`repeat(${this.gridColCount}, 1fr)`:null}:{}}processResponsiveness(e,t){if(this._width=t=Math.floor(t),this.isResponsive){var s;let e,i;let r=this.choices.length+ +!!this.isDesignMode,n=(this.gapBetweenItems||0)*this.imageScale,a=this.minImageWidth*this.imageScale,o=this.maxImageWidth*this.imageScale,l=this.maxImageHeight*this.imageScale,h=this.minImageHeight*this.imageScale,u=this.colCount,d=(((i=Math.floor((s=t)/(a+n)))+1)*(a+n)-n<=s&&i++,i);0===u?(e=(n+a)*r-n>t?Math.floor((t-n*(d-1))/d):Math.floor((t-n*(r-1))/r),this.gridColCount=Math.max(Math.min(r,d),1)):(d<u?(this.responsiveColCount=Math.max(d,1),u=this.responsiveColCount):this.responsiveColCount=u,this.gridColCount=this.responsiveColCount,e=Math.floor((t-n*(u-1))/u)),e=Math.max(a,Math.min(e,o));let c=Number.MIN_VALUE;this.choices.forEach(t=>{let s=e/t.aspectRatio;c=s>c?s:c}),c>l?c=l:c<h&&(c=h);let g=this.responsiveImageWidth,p=this.responsiveImageHeight;return this.responsiveImageWidth=e,this.responsiveImageHeight=c,g!==this.responsiveImageWidth||p!==this.responsiveImageHeight}return!1}triggerResponsiveness(e=!0){e&&this.reCalcGapBetweenItemsCallback&&this.reCalcGapBetweenItemsCallback(),super.triggerResponsiveness(e)}afterRender(e){super.afterRender(e);let t=this.getObservedElementSelector(),s=e&&t?e.querySelector(t):void 0;s&&(this.reCalcGapBetweenItemsCallback=()=>{this.gapBetweenItems=Math.ceil(Number.parseFloat(r.getComputedStyle(s).gap))||16},this.reCalcGapBetweenItemsCallback())}}ey([c({})],iX.prototype,"responsiveImageHeight",void 0),ey([c({})],iX.prototype,"responsiveImageWidth",void 0),ey([c({})],iX.prototype,"isResponsiveValue",void 0),ey([c({})],iX.prototype,"maxImageWidth",void 0),ey([c({})],iX.prototype,"minImageWidth",void 0),ey([c({})],iX.prototype,"maxImageHeight",void 0),ey([c({})],iX.prototype,"minImageHeight",void 0),ey([c({})],iX.prototype,"responsiveColCount",void 0),ey([c()],iX.prototype,"gridColCount",void 0),E.addClass("imageitemvalue",[{name:"imageLink:file",serializationProperty:"locImageLink"}],e=>new iY(e),"itemvalue"),E.addClass("responsiveImageSize",[],void 0,"number"),E.addClass("imagepicker",[{name:"showOtherItem",visible:!1},{name:"otherText",visible:!1},{name:"showNoneItem",visible:!1},{name:"showRefuseItem",visible:!1},{name:"showDontKnowItem",visible:!1},{name:"noneText",visible:!1},{name:"optionsCaption",visible:!1},{name:"otherErrorText",visible:!1},{name:"storeOthersAsComment",visible:!1},{name:"contentMode",default:"image",choices:["image","video"]},{name:"imageFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"imageHeight:number",minValue:0},{name:"imageWidth:number",minValue:0},{name:"minImageWidth:responsiveImageSize",default:200,minValue:0},{name:"minImageHeight:responsiveImageSize",default:133,minValue:0},{name:"maxImageWidth:responsiveImageSize",default:3e3,minValue:0},{name:"maxImageHeight:responsiveImageSize",default:3e3,minValue:0}],function(){return new iX("")},"checkboxbase"),E.addProperty("imagepicker",{name:"showLabel:boolean",default:!1}),E.addProperty("imagepicker",{name:"colCount:number",default:0,choices:[0,1,2,3,4,5]}),E.addProperty("imagepicker",{name:"multiSelect:boolean",default:!1}),E.addProperty("imagepicker",{name:"choices:imageitemvalue[]"}),st.Instance.registerQuestion("imagepicker",e=>new iX(e));let i$=[".mp4",".mov",".wmv",".flv",".avi",".mkv"],iZ="embed";class i0 extends iS{constructor(e){super(e),this.createLocalizableString("imageLink",this,!1).onGetTextCallback=e=>(function(e,t){if(!e||!a.isUrlYoutubeVideo(e))return t?"":e;if(e.toLocaleLowerCase().indexOf(iZ)>-1)return e;let s="";for(var i=e.length-1;i>=0&&"="!==e[i]&&"/"!==e[i];i--)s=e[i]+s;return"https://www.youtube.com/"+iZ+"/"+s})(e,"youtube"==this.contentMode),this.createLocalizableString("altText",this,!1),this.registerPropertyChangedHandlers(["contentMode","imageLink"],()=>this.calculateRenderedMode())}getType(){return"image"}get isCompositeQuestion(){return!1}onSurveyLoad(){super.onSurveyLoad(),this.calculateRenderedMode()}get imageLink(){return this.getLocalizableStringText("imageLink")}set imageLink(e){this.setLocalizableStringText("imageLink",e)}get locImageLink(){return this.getLocalizableString("imageLink")}get altText(){return this.getLocalizableStringText("altText")}set altText(e){this.setLocalizableStringText("altText",e)}get locAltText(){return this.getLocalizableString("altText")}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get renderedStyleHeight(){return this.imageHeight?e9(this.imageHeight):void 0}get renderedHeight(){return this.imageHeight?e5(this.imageHeight):void 0}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get renderedStyleWidth(){return this.imageWidth?e9(this.imageWidth):void 0}get renderedWidth(){return this.imageWidth?e5(this.imageWidth):void 0}get imageFit(){return this.getPropertyValue("imageFit")}set imageFit(e){this.setPropertyValue("imageFit",e)}get contentMode(){return this.getPropertyValue("contentMode")}set contentMode(e){this.setPropertyValue("contentMode",e),"video"===e&&(this.showLabel=!0)}get renderedMode(){return this.getPropertyValue("renderedMode","image")}getImageCss(){let e=this.getPropertyByName("imageHeight"),t=this.getPropertyByName("imageWidth"),s=e.isDefaultValue(this.imageHeight)&&t.isDefaultValue(this.imageWidth);return new eV().append(this.cssClasses.image).append(this.cssClasses.adaptive,s).toString()}onLoadHandler(){this.contentNotLoaded=!1}onErrorHandler(){this.contentNotLoaded=!0}setRenderedMode(e){this.setPropertyValue("renderedMode",e)}calculateRenderedMode(){"auto"!==this.contentMode?this.setRenderedMode(this.contentMode):this.isYoutubeVideo()?this.setRenderedMode("youtube"):this.isVideo()?this.setRenderedMode("video"):this.setRenderedMode("image")}isYoutubeVideo(){return a.isUrlYoutubeVideo(this.imageLink)}isVideo(){let e=this.imageLink;if(!e)return!1;e=e.toLowerCase();for(let t=0;t<i$.length;t++)if(e.endsWith(i$[t]))return!0;return!1}}ey([c({defaultValue:!1})],i0.prototype,"contentNotLoaded",void 0),E.addClass("image",[{name:"imageLink:file",serializationProperty:"locImageLink"},{name:"altText",serializationProperty:"locAltText",alternativeName:"text",category:"general"},{name:"contentMode",default:"auto",choices:["auto","image","video","youtube"]},{name:"imageFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"imageHeight",default:"150"},{name:"imageWidth",default:"200"}],function(){return new i0("")},"nonvalue"),st.Instance.registerQuestion("image",e=>new i0(e));class i1{constructor(e,t,s,i){if(isNaN(e)||isNaN(t))throw Error(`Point is invalid: (${e}, ${t})`);this.x=+e,this.y=+t,this.pressure=s||0,this.time=i||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class i2{static fromPoints(e,t){let s=this.calculateControlPoints(e[0],e[1],e[2]).c2,i=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new i2(e[1],s,i,e[2],t.start,t.end)}static calculateControlPoints(e,t,s){let i=e.x-t.x,r=e.y-t.y,n=t.x-s.x,a=t.y-s.y,o={x:(e.x+t.x)/2,y:(e.y+t.y)/2},l={x:(t.x+s.x)/2,y:(t.y+s.y)/2},h=Math.sqrt(i*i+r*r),u=Math.sqrt(n*n+a*a),d=o.x-l.x,c=o.y-l.y,g=u/(h+u),p={x:l.x+d*g,y:l.y+c*g},m=t.x-p.x,v=t.y-p.y;return{c1:new i1(o.x+m,o.y+v),c2:new i1(l.x+m,l.y+v)}}constructor(e,t,s,i,r,n){this.startPoint=e,this.control2=t,this.control1=s,this.endPoint=i,this.startWidth=r,this.endWidth=n}length(){let e,t;let s=0;for(let i=0;i<=10;i+=1){let r=i/10,n=this.point(r,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),a=this.point(r,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(i>0){let i=n-e,r=a-t;s+=Math.sqrt(i*i+r*r)}e=n,t=a}return s}point(e,t,s,i,r){return t*(1-e)*(1-e)*(1-e)+3*s*(1-e)*(1-e)*e+3*i*(1-e)*e*e+r*e*e*e}}class i4{constructor(){try{this._et=new EventTarget}catch(e){this._et=document}}addEventListener(e,t,s){this._et.addEventListener(e,t,s)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,t,s){this._et.removeEventListener(e,t,s)}}class i3 extends i4{constructor(e,t={}){super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this._handleMouseDown=e=>{1===e.buttons&&this._strokeBegin(e)},this._handleMouseMove=e=>{this._strokeMoveUpdate(e)},this._handleMouseUp=e=>{1===e.buttons&&this._strokeEnd(e)},this._handleTouchStart=e=>{if(e.cancelable&&e.preventDefault(),1===e.targetTouches.length){let t=e.changedTouches[0];this._strokeBegin(t)}},this._handleTouchMove=e=>{e.cancelable&&e.preventDefault();let t=e.targetTouches[0];this._strokeMoveUpdate(t)},this._handleTouchEnd=e=>{if(e.target===this.canvas){e.cancelable&&e.preventDefault();let t=e.changedTouches[0];this._strokeEnd(t)}},this._handlePointerStart=e=>{e.preventDefault(),this._strokeBegin(e)},this._handlePointerMove=e=>{this._strokeMoveUpdate(e)},this._handlePointerEnd=e=>{this._drawingStroke&&(e.preventDefault(),this._strokeEnd(e))},this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle="throttle"in t?t.throttle:16,this.minDistance="minDistance"in t?t.minDistance:5,this.dotSize=t.dotSize||0,this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=t.compositeOperation||"source-over",this.canvasContextOptions="canvasContextOptions"in t?t.canvasContextOptions:{},this._strokeMoveUpdate=this.throttle?function(e,t=250){let s,i,r,n=0,a=null,o=()=>{n=Date.now(),a=null,s=e.apply(i,r),a||(i=null,r=[])};return function(...l){let h=Date.now(),u=t-(h-n);return i=this,r=l,u<=0||u>t?(a&&(clearTimeout(a),a=null),n=h,s=e.apply(i,r),a||(i=null,r=[])):a||(a=window.setTimeout(o,u)),s}}(i3.prototype._strokeUpdate,this.throttle):i3.prototype._strokeUpdate,this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){let{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0}fromDataURL(e,t={}){return new Promise((s,i)=>{let r=new Image,n=t.ratio||window.devicePixelRatio||1,a=t.width||this.canvas.width/n,o=t.height||this.canvas.height/n,l=t.xOffset||0,h=t.yOffset||0;this._reset(this._getPointGroupOptions()),r.onload=()=>{this._ctx.drawImage(r,l,h,a,o),s()},r.onerror=e=>{i(e)},r.crossOrigin="anonymous",r.src=e,this._isEmpty=!1})}toDataURL(e="image/png",t){return"image/svg+xml"===e?("object"!=typeof t&&(t=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(t))}`):("number"!=typeof t&&(t=void 0),this.canvas.toDataURL(e,t))}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";let e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerStart),this.canvas.removeEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.removeEventListener("pointerup",this._handlePointerEnd),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:t=!0}={}){t&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;this._drawingStroke=!0;let t=this._getPointGroupOptions(),s=Object.assign(Object.assign({},t),{points:[]});this._data.push(s),this._reset(t),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(0===this._data.length){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));let t=e.clientX,s=e.clientY,i=void 0!==e.pressure?e.pressure:void 0!==e.force?e.force:0,r=this._createPoint(t,s,i),n=this._data[this._data.length-1],a=n.points,o=a.length>0&&a[a.length-1],l=!!o&&r.distanceTo(o)<=this.minDistance,h=this._getPointGroupOptions(n);if(!o||!(o&&l)){let e=this._addPoint(r,h);o?e&&this._drawCurve(e,h):this._drawDot(r,h),a.push({time:r.time,x:r.x,y:r.y,pressure:r.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e){this._drawingStroke&&(this._strokeUpdate(e),this._drawingStroke=!1,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerStart),this.canvas.addEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.addEventListener("pointerup",this._handlePointerEnd)}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,t,s){let i=this.canvas.getBoundingClientRect();return new i1(e-i.left,t-i.top,s,new Date().getTime())}_addPoint(e,t){let{_lastPoints:s}=this;if(s.push(e),s.length>2){3===s.length&&s.unshift(s[0]);let e=this._calculateCurveWidths(s[1],s[2],t),i=i2.fromPoints(s,e);return s.shift(),i}return null}_calculateCurveWidths(e,t,s){let i=s.velocityFilterWeight*t.velocityFrom(e)+(1-s.velocityFilterWeight)*this._lastVelocity,r=this._strokeWidth(i,s),n={end:r,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=r,n}_strokeWidth(e,t){return Math.max(t.maxWidth/(e+1),t.minWidth)}_drawCurveSegment(e,t,s){let i=this._ctx;i.moveTo(e,t),i.arc(e,t,s,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,t){let s=this._ctx,i=e.endWidth-e.startWidth,r=2*Math.ceil(e.length());s.beginPath(),s.fillStyle=t.penColor;for(let s=0;s<r;s+=1){let n=s/r,a=n*n,o=a*n,l=1-n,h=l*l,u=h*l,d=u*e.startPoint.x;d+=3*h*n*e.control1.x+3*l*a*e.control2.x+o*e.endPoint.x;let c=u*e.startPoint.y;c+=3*h*n*e.control1.y+3*l*a*e.control2.y+o*e.endPoint.y;let g=Math.min(e.startWidth+o*i,t.maxWidth);this._drawCurveSegment(d,c,g)}s.closePath(),s.fill()}_drawDot(e,t){let s=this._ctx,i=t.dotSize>0?t.dotSize:(t.minWidth+t.maxWidth)/2;s.beginPath(),this._drawCurveSegment(e.x,e.y,i),s.closePath(),s.fillStyle=t.penColor,s.fill()}_fromData(e,t,s){for(let i of e){let{points:e}=i,r=this._getPointGroupOptions(i);if(e.length>1)for(let s=0;s<e.length;s+=1){let i=e[s],n=new i1(i.x,i.y,i.pressure,i.time);0===s&&this._reset(r);let a=this._addPoint(n,r);a&&t(a,r)}else this._reset(r),s(e[0],r)}}toSVG({includeBackgroundColor:e=!1}={}){let t=this._data,s=Math.max(window.devicePixelRatio||1,1),i=this.canvas.width/s,r=this.canvas.height/s,n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),n.setAttribute("viewBox",`0 0 ${i} ${r}`),n.setAttribute("width",i.toString()),n.setAttribute("height",r.toString()),e&&this.backgroundColor){let e=document.createElement("rect");e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.setAttribute("fill",this.backgroundColor),n.appendChild(e)}return this._fromData(t,(e,{penColor:t})=>{let s=document.createElement("path");if(!isNaN(e.control1.x)&&!isNaN(e.control1.y)&&!isNaN(e.control2.x)&&!isNaN(e.control2.y)){let i=`M ${e.startPoint.x.toFixed(3)},${e.startPoint.y.toFixed(3)} C ${e.control1.x.toFixed(3)},${e.control1.y.toFixed(3)} ${e.control2.x.toFixed(3)},${e.control2.y.toFixed(3)} ${e.endPoint.x.toFixed(3)},${e.endPoint.y.toFixed(3)}`;s.setAttribute("d",i),s.setAttribute("stroke-width",(2.25*e.endWidth).toFixed(3)),s.setAttribute("stroke",t),s.setAttribute("fill","none"),s.setAttribute("stroke-linecap","round"),n.appendChild(s)}},(e,{penColor:t,dotSize:s,minWidth:i,maxWidth:r})=>{let a=document.createElement("circle");a.setAttribute("r",(s>0?s:(i+r)/2).toString()),a.setAttribute("cx",e.x.toString()),a.setAttribute("cy",e.y.toString()),a.setAttribute("fill",t),n.appendChild(a)}),n.outerHTML}}class i6 extends iB{getPenColorFromTheme(){let e=this.survey;return!!e&&!!e.themeVariables&&e.themeVariables["--sjs-primary-backcolor"]}updateColors(e){let t=this.getPenColorFromTheme(),s=this.getPropertyByName("penColor");e.penColor=this.penColor||t||s.defaultValue||"#1ab394";let i=this.getPropertyByName("backgroundColor"),r=t?"transparent":void 0;e.backgroundColor=(this.backgroundImage?"transparent":this.backgroundColor)||r||i.defaultValue||"#ffffff"}getCssRoot(e){return new eV().append(super.getCssRoot(e)).append(e.small,"300"===this.signatureWidth.toString()).toString()}getFormat(){return"jpeg"===this.dataFormat?"image/jpeg":"svg"===this.dataFormat?"image/svg+xml":""}updateValue(){if(this.signaturePad){var e=this.signaturePad.toDataURL(this.getFormat());this.valueIsUpdatingInternally=!0,this.value=e,this.valueIsUpdatingInternally=!1}}constructor(e){super(e),this.valueIsUpdatingInternally=!1,this._loadedData=void 0,this.updateValueHandler=()=>{this._loadedData=void 0,this.scaleCanvas(!1,!0),this.loadPreview(this.value)}}getType(){return"signaturepad"}afterRenderQuestionElement(e){e&&(this.isDesignMode||this.initSignaturePad(e),this.element=e),super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){e&&this.destroySignaturePad(e)}themeChanged(e){this.signaturePad&&this.updateColors(this.signaturePad)}resizeCanvas(){this.canvas.width=this.containerWidth,this.canvas.height=this.containerHeight}scaleCanvas(e=!0,t=!1){let s=this.canvas,i=s.offsetWidth/this.containerWidth;(this.scale!=i||t)&&(this.scale=i,s.style.width=this.renderedCanvasWidth,this.resizeCanvas(),this.signaturePad.minWidth=this.penMinWidth*i,this.signaturePad.maxWidth=this.penMaxWidth*i,s.getContext("2d").scale(1/i,1/i),e&&this.loadPreview(this.value))}fromUrl(e){if(this.isFileLoading=!0,"string"==typeof e?/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[^;]+?)*),(.+)$/.test(e):null)this.fromDataUrl(e),this.isFileLoading=!1;else{let t=new Image;t.crossOrigin="anonymous",t.src=e,t.onload=()=>{if(this.canvas){let s=r.createElement("canvas");s.width=this.containerWidth,s.height=this.containerHeight,s.getContext("2d").drawImage(t,0,0);var e=s.toDataURL(this.getFormat());this.fromDataUrl(e)}this.isFileLoading=!1},t.onerror=()=>{this.isFileLoading=!1}}}fromDataUrl(e){this._loadedData=e,this.signaturePad&&this.signaturePad.fromDataURL(e,{width:this.canvas.width*this.scale,height:this.canvas.height*this.scale})}get loadedData(){return this._loadedData}loadPreview(e){if(!e){this.signaturePad&&this.canvas&&(this.canvas.getContext("2d").clearRect(0,0,this.canvas.width*this.scale,this.canvas.height*this.scale),this.signaturePad.clear()),this.valueWasChangedFromLastUpload=!1;return}if(this.storeDataAsText)this.fromDataUrl(e);else if(this.loadedData)this.fromDataUrl(this.loadedData);else{var t=e?[e]:[];this._previewLoader&&this._previewLoader.dispose(),this.isFileLoading=!0,this._previewLoader=new iH(this,(t,s)=>{"success"===t&&s&&s.length>0&&s[0].content?(this.fromDataUrl(s[0].content),this.isFileLoading=!1):"skipped"===t&&this.fromUrl(e),this._previewLoader.dispose(),this._previewLoader=void 0}),this._previewLoader.load(t)}}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.isLoadingFromJson||(this._loadedData=void 0,this.loadPreview(e))}onSurveyLoad(){super.onSurveyLoad(),this.loadPreview(this.value)}initSignaturePad(e){var t=e.getElementsByTagName("canvas")[0];this.canvas=t,this.resizeCanvas();var s=new i3(t,{backgroundColor:"#ffffff"});this.signaturePad=s,this.isInputReadOnly&&s.off(),this.readOnlyChangedCallback=()=>{this.isInputReadOnly?s.off():s.on()},this.updateColors(s),s.addEventListener("beginStroke",()=>{this.scaleCanvas(),this.isDrawingValue=!0,t.focus()},{once:!1}),s.addEventListener("endStroke",()=>{this.isDrawingValue=!1,this.storeDataAsText?this.updateValue():this.valueWasChangedFromLastUpload=!0},{once:!1}),this.updateValueHandler(),this.readOnlyChangedCallback();var i=(e,t)=>{"signatureWidth"!==t.name&&"signatureHeight"!==t.name||this.valueIsUpdatingInternally||this.updateValueHandler()};this.onPropertyChanged.add(i),this.signaturePad.propertyChangedHandler=i}destroySignaturePad(e){this.signaturePad&&(this.onPropertyChanged.remove(this.signaturePad.propertyChangedHandler),this.signaturePad.off()),this.readOnlyChangedCallback=null,this.signaturePad=null}get dataFormat(){return this.getPropertyValue("dataFormat")}set dataFormat(e){this.setPropertyValue("dataFormat",i5(e))}get signatureWidth(){return this.getPropertyValue("signatureWidth")}set signatureWidth(e){this.setPropertyValue("signatureWidth",e)}get signatureHeight(){return this.getPropertyValue("signatureHeight")}set signatureHeight(e){this.setPropertyValue("signatureHeight",e)}get containerHeight(){return this.signatureHeight||200}get containerWidth(){return this.signatureWidth||300}get renderedCanvasWidth(){return this.signatureAutoScaleEnabled?"100%":this.containerWidth+"px"}get height(){return this.getPropertyValue("height")}set height(e){this.setPropertyValue("height",e)}get allowClear(){return this.getPropertyValue("allowClear")}set allowClear(e){this.setPropertyValue("allowClear",e)}get canShowClearButton(){let e=!this.nothingIsDrawn(),t=this.isUploading;return!this.isInputReadOnly&&this.allowClear&&e&&!t}get penColor(){return this.getPropertyValue("penColor")}set penColor(e){this.setPropertyValue("penColor",e),this.signaturePad&&this.updateColors(this.signaturePad)}get backgroundColor(){return this.getPropertyValue("backgroundColor")}set backgroundColor(e){this.setPropertyValue("backgroundColor",e),this.signaturePad&&this.updateColors(this.signaturePad)}get backgroundImage(){return this.getPropertyValue("backgroundImage")}set backgroundImage(e){this.setPropertyValue("backgroundImage",e),this.signaturePad&&this.updateColors(this.signaturePad)}get clearButtonCaption(){return this.getLocalizationString("clearCaption")}get locRenderedPlaceholder(){return this.isReadOnly?this.locPlaceholderReadOnly:this.locPlaceholder}nothingIsDrawn(){let e=this.isDrawingValue,t=this.isEmpty(),s=this.isUploading,i=this.valueWasChangedFromLastUpload;return!e&&t&&!s&&!i}needShowPlaceholder(){return this.showPlaceholder&&this.nothingIsDrawn()}onBlurCore(e){if(super.onBlurCore(e),!this.storeDataAsText&&!this.element.contains(e.relatedTarget)){var t,s,i;this.valueWasChangedFromLastUpload&&(this.uploadFiles([(t=this.signaturePad.toDataURL(this.getFormat()),s=this.name+"."+i5(this.dataFormat),i=this.getFormat(),new File([new Uint8Array(atob(t.split(",")[1]).split("").map(e=>e.charCodeAt(0))).buffer],s,{type:i}))]),this.valueWasChangedFromLastUpload=!1)}}uploadResultItemToValue(e){return e.content}setValueFromResult(e){this.valueIsUpdatingInternally=!0,this.value=(null==e?void 0:e.length)?e.map(e=>e.content)[0]:void 0,this.valueIsUpdatingInternally=!1}clearValue(e){this.valueWasChangedFromLastUpload=!1,super.clearValue(e),this._loadedData=void 0,this.loadPreview(this.value)}endLoadingFromJson(){super.endLoadingFromJson(),300===this.signatureWidth&&this.width&&"number"==typeof this.width&&this.width&&(D.warn("Use signatureWidth property to set width for the signature pad"),this.signatureWidth=this.width,this.width=void 0),200===this.signatureHeight&&this.height&&(D.warn("Use signatureHeight property to set width for the signature pad"),this.signatureHeight=this.height,this.height=void 0)}}function i5(e){return e||(e="png"),"jpeg"!==(e=e.replace("image/","").replace("+xml",""))&&"svg"!==e&&(e="png"),e}ey([c({defaultValue:!1})],i6.prototype,"isDrawingValue",void 0),ey([c({defaultValue:!1})],i6.prototype,"isReadyForUpload",void 0),ey([c({defaultValue:!1})],i6.prototype,"valueWasChangedFromLastUpload",void 0),ey([c()],i6.prototype,"signatureAutoScaleEnabled",void 0),ey([c()],i6.prototype,"penMinWidth",void 0),ey([c()],i6.prototype,"penMaxWidth",void 0),ey([c({})],i6.prototype,"showPlaceholder",void 0),ey([c({localizable:{defaultStr:"signaturePlaceHolder"}})],i6.prototype,"placeholder",void 0),ey([c({localizable:{defaultStr:"signaturePlaceHolderReadOnly"}})],i6.prototype,"placeholderReadOnly",void 0),E.addClass("signaturepad",[{name:"signatureWidth:number",category:"general",default:300},{name:"signatureHeight:number",category:"general",default:200},{name:"signatureAutoScaleEnabled:boolean",category:"general",default:!1},{name:"penMinWidth:number",category:"general",default:.5},{name:"penMaxWidth:number",category:"general",default:2.5},{name:"height:number",category:"general",visible:!1},{name:"allowClear:boolean",category:"general",default:!0},{name:"showPlaceholder:boolean",category:"general",default:!0},{name:"placeholder:text",serializationProperty:"locPlaceholder",category:"general",dependsOn:"showPlaceholder",visibleIf:e=>e.showPlaceholder},{name:"placeholderReadOnly:text",serializationProperty:"locPlaceholderReadOnly",category:"general",dependsOn:"showPlaceholder",visibleIf:e=>e.showPlaceholder},{name:"backgroundImage:file",category:"general"},{name:"penColor:color",category:"general"},{name:"backgroundColor:color",category:"general"},{name:"dataFormat",category:"general",default:"png",choices:[{value:"png",text:"PNG"},{value:"jpeg",text:"JPEG"},{value:"svg",text:"SVG"}],onSettingValue:(e,t)=>i5(t)},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"storeDataAsText:boolean",default:!0},{name:"waitForUpload:boolean",default:!1}],function(){return new i6("")},"question"),st.Instance.registerQuestion("signaturepad",e=>new i6(e));class i9 extends t3{constructor(e,t,s){super(s),this.data=e,this.panelItem=t,this.variableName=s,this.sharedQuestions={}}get survey(){return this.panelItem.getSurvey()}get panel(){return this.panelItem.panel}get panelIndex(){return this.data?this.data.getItemIndex(this.panelItem):-1}get visiblePanelIndex(){return this.data?this.data.getVisibleItemIndex(this.panelItem):-1}getValues(){return this.panelItem.getAllValues()}getQuestionByName(e){var t=super.getQuestionByName(e);if(t)return t;var s=this.panelIndex;let i=(t=s>-1?this.data.getSharedQuestionFromArray(e,s):void 0)?t.name:e;return this.sharedQuestions[i]=e,t}getQuestionDisplayText(e){let t=this.sharedQuestions[e.name];if(!t)return super.getQuestionDisplayText(e);let s=this.panelItem.getValue(t);return e.getDisplayValue(!0,s)}onCustomProcessText(e){if(e.name==i7.IndexVariableName){var t=this.panelIndex;if(t>-1)return e.isExists=!0,e.value=t+1,!0}if(e.name==i7.VisibleIndexVariableName){var t=this.visiblePanelIndex;if(t>-1)return e.isExists=!0,e.value=t+1,!0}if(0==e.name.toLowerCase().indexOf(i7.ParentItemVariableName+".")){var s=this.data;if(s&&s.parentQuestion&&s.parent&&s.parent.data){var i=new i9(s.parentQuestion,s.parent.data,i7.ItemVariableName),r=i7.ItemVariableName+e.name.substring(i7.ParentItemVariableName.length),n=i.processValue(r,e.returnDisplayValue);e.isExists=n.isExists,e.value=n.value}return!0}return!1}}class i8 extends eL{constructor(e){super(e)}}class i7{constructor(e,t){this.data=e,this.panelValue=t,this.textPreProcessor=new i9(e,this,i7.ItemVariableName),this.setSurveyImpl()}get panel(){return this.panelValue}setSurveyImpl(){this.panel.setSurveyImpl(this)}getValue(e){return this.getAllValues()[e]}setValue(e,t){let s=this.data.getPanelItemData(this),i=s?s[e]:void 0;if(a.isTwoValueEquals(t,i,!1,!0,!1))return;this.data.setPanelItemData(this,e,a.getUnbindValue(t));let r=this.panel.questions,n=i7.ItemVariableName+"."+e;for(var o=0;o<r.length;o++){let s=r[o];s.getValueName()!==e&&s.checkBindings(e,t),s.runTriggers(n,t)}}getVariable(e){}setVariable(e,t){}getComment(e){return this.getValue(e+tp.commentSuffix)||""}setComment(e,t,s){this.setValue(e+tp.commentSuffix,t)}findQuestionByName(e){if(!e)return;let t=i7.ItemVariableName+".";if(0===e.indexOf(t))return this.panel.getQuestionByName(e.substring(t.length));let s=this.getSurvey();return s?s.getQuestionByName(e):null}getEditingSurveyElement(){}getAllValues(){return this.data.getPanelItemData(this)}getFilteredValues(){var e={},t=this.data&&this.data.getRootData()?this.data.getRootData().getFilteredValues():{};for(var s in t)e[s]=t[s];if(e[i7.ItemVariableName]=this.getAllValues(),this.data){let t=i7.IndexVariableName,s=i7.VisibleIndexVariableName;delete e[t],delete e[s],e[t.toLowerCase()]=this.data.getItemIndex(this),e[s.toLowerCase()]=this.data.getVisibleItemIndex(this);let i=this.data;i&&i.parentQuestion&&i.parent&&(e[i7.ParentItemVariableName]=i.parent.getValue())}return e}getFilteredProperties(){return this.data&&this.data.getRootData()?this.data.getRootData().getFilteredProperties():{survey:this.getSurvey()}}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.textPreProcessor}}i7.ItemVariableName="panel",i7.ParentItemVariableName="parentpanel",i7.IndexVariableName="panelIndex",i7.VisibleIndexVariableName="visiblePanelIndex";class re{constructor(e){this.data=e}getSurveyData(){return null}getSurvey(){return this.data.getSurvey()}getTextProcessor(){return null}}class rt extends tU{constructor(e){super(e),this._renderedPanels=[],this.isPanelsAnimationRunning=!1,this.isAddingNewPanels=!1,this.isSetPanelItemData={},this.createNewArray("panels",e=>{this.onPanelAdded(e)},e=>{this.onPanelRemoved(e)}),this.createNewArray("visiblePanels"),this.templateValue=this.createAndSetupNewPanelObject(),this.template.renderWidth="100%",this.template.selectedElementInDesign=this,this.template.addElementCallback=e=>{this.addOnPropertyChangedCallback(e),this.rebuildPanels()},this.template.removeElementCallback=()=>{this.rebuildPanels()},this.createLocalizableString("confirmDeleteText",this,!1,"confirmDelete"),this.createLocalizableString("keyDuplicationError",this,!1,!0),this.createLocalizableString("addPanelText",this,!1,"addPanel"),this.createLocalizableString("removePanelText",this,!1,"removePanel"),this.createLocalizableString("prevPanelText",this,!1,"pagePrevText"),this.createLocalizableString("nextPanelText",this,!1,"pageNextText"),this.createLocalizableString("noEntriesText",this,!1,"noEntriesText"),this.createLocalizableString("templateTabTitle",this,!0,"panelDynamicTabTextFormat"),this.createLocalizableString("tabTitlePlaceholder",this,!0,"tabTitlePlaceholder"),this.registerPropertyChangedHandlers(["panelsState"],()=>{this.setPanelsState()}),this.registerPropertyChangedHandlers(["newPanelPosition","displayMode","showProgressBar"],()=>{this.updateFooterActions()}),this.registerPropertyChangedHandlers(["allowAddPanel"],()=>{this.updateNoEntriesTextDefaultLoc()}),this.registerPropertyChangedHandlers(["minPanelCount"],()=>{this.onMinPanelCountChanged()}),this.registerPropertyChangedHandlers(["maxPanelCount"],()=>{this.onMaxPanelCountChanged()})}get isCompositeQuestion(){return!0}get hasSingleInput(){return!1}get isContainer(){return!0}getFirstQuestionToFocus(e){for(var t=0;t<this.visiblePanelsCore.length;t++){let s=this.visiblePanelsCore[t].getFirstQuestionToFocus(e);if(s)return s}return this.showAddPanelButton&&(!e||this.currentErrorCount>0)?this:null}getFirstInputElementId(){return this.showAddPanelButton?this.addButtonId:super.getFirstInputElementId()}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.setTemplatePanelSurveyImpl(),this.setPanelsSurveyImpl()}assignOnPropertyChangedToTemplate(){for(var e=this.template.elements,t=0;t<e.length;t++)this.addOnPropertyChangedCallback(e[t])}addOnPropertyChangedCallback(e){e.isQuestion&&e.setParentQuestion(this),e.onPropertyChanged.add((e,t)=>{this.onTemplateElementPropertyChanged(e,t)}),e.isPanel&&(e.addElementCallback=e=>{this.addOnPropertyChangedCallback(e)})}onTemplateElementPropertyChanged(e,t){if(!this.isLoadingFromJson&&!this.useTemplatePanel&&0!=this.panelsCore.length&&E.findProperty(e.getType(),t.name))for(var s=this.panelsCore,i=0;i<s.length;i++){var r=s[i].getQuestionByName(e.name);r&&r[t.name]!==t.newValue&&(r[t.name]=t.newValue)}}get useTemplatePanel(){return this.isDesignMode&&!this.isContentElement}getType(){return"paneldynamic"}clearOnDeletingContainer(){this.panelsCore.forEach(e=>{e.clearOnDeletingContainer()})}get isAllowTitleLeft(){return!1}removeElement(e){return this.template.removeElement(e)}get template(){return this.templateValue}getPanel(){return this.template}get templateElements(){return this.template.elements}get templateTitle(){return this.template.title}set templateTitle(e){this.template.title=e}get locTemplateTitle(){return this.template.locTitle}get templateTabTitle(){return this.locTemplateTabTitle.text}set templateTabTitle(e){this.locTemplateTabTitle.text=e}get locTemplateTabTitle(){return this.getLocalizableString("templateTabTitle")}get tabTitlePlaceholder(){return this.locTabTitlePlaceholder.text}set tabTitlePlaceholder(e){this.locTabTitlePlaceholder.text=e}get locTabTitlePlaceholder(){return this.getLocalizableString("tabTitlePlaceholder")}get templateDescription(){return this.template.description}set templateDescription(e){this.template.description=e}get locTemplateDescription(){return this.template.locDescription}get templateVisibleIf(){return this.getPropertyValue("templateVisibleIf")}set templateVisibleIf(e){this.setPropertyValue("templateVisibleIf",e),this.template.visibleIf=e}get items(){for(var e=[],t=0;t<this.panelsCore.length;t++)e.push(this.panelsCore[t].data);return e}get panels(){return this.buildPanelsFirstTime(this.canBuildPanels),this.panelsCore}get visiblePanels(){return this.buildPanelsFirstTime(this.canBuildPanels),this.visiblePanelsCore}get panelsCore(){return this.getPropertyValue("panels")}get visiblePanelsCore(){return this.getPropertyValue("visiblePanels")}onPanelAdded(e){if(this.onPanelRemovedCore(e),!e.visible)return;let t=0,s=this.panelsCore;for(var i=0;i<s.length&&s[i]!==e;i++)s[i].visible&&t++;this.visiblePanelsCore.splice(t,0,e),this.addTabFromToolbar(e,t),this.currentPanel||(this.currentPanel=e),this.updateRenderedPanels()}onPanelRemoved(e){let t=this.onPanelRemovedCore(e);if(this.currentPanel===e){let e=this.visiblePanelsCore;t>=e.length&&(t=e.length-1),this.currentPanel=t>=0?e[t]:null}this.updateRenderedPanels()}onPanelRemovedCore(e){let t=this.visiblePanelsCore,s=t.indexOf(e);return s>-1&&(t.splice(s,1),this.removeTabFromToolbar(e)),s}get currentIndex(){return this.isRenderModeList?-1:this.useTemplatePanel?0:this.visiblePanelsCore.indexOf(this.currentPanel)}set currentIndex(e){e<0||this.visiblePanelCount<1||(e>=this.visiblePanelCount&&(e=this.visiblePanelCount-1),this.currentPanel=this.visiblePanelsCore[e])}get currentPanel(){if(this.isDesignMode)return this.template;if(this.isRenderModeList||this.useTemplatePanel)return null;let e=this.getPropertyValue("currentPanel",null);return!e&&this.visiblePanelCount>0&&(e=this.visiblePanelsCore[0],this.currentPanel=e),e}set currentPanel(e){if(this.isRenderModeList||this.useTemplatePanel)return;let t=this.getPropertyValue("currentPanel"),s=e?this.visiblePanelsCore.indexOf(e):-1;(!e||!(s<0))&&e!==t&&(t&&t.onHidingContent(),this.setPropertyValue("currentPanel",e),this.updateRenderedPanels(),this.updateFooterActions(),this.updateTabToolbarItemsPressedState(),this.fireCallback(this.currentIndexChangedCallback),s>-1&&this.survey&&this.survey.dynamicPanelCurrentIndexChanged(this,{panel:e,visiblePanelIndex:s}))}updateRenderedPanels(){this.isRenderModeList?this.renderedPanels=[].concat(this.visiblePanels):this.currentPanel?this.renderedPanels=[this.currentPanel]:this.renderedPanels=[]}set renderedPanels(e){0==this.renderedPanels.length||0==e.length?(this.blockAnimations(),this.panelsAnimation.sync(e),this.releaseAnimations()):(this.isPanelsAnimationRunning=!0,this.panelsAnimation.sync(e))}get renderedPanels(){return this._renderedPanels}getPanelsAnimationOptions(){let e=()=>{if(this.isRenderModeList)return"";let e=new eV,t=!1,s=this.renderedPanels.filter(e=>e!==this.currentPanel)[0],i=this.visiblePanels.indexOf(s);return i<0&&(t=!0,i=this.removedPanelIndex),e.append("sv-pd-animation-adding",!!this.focusNewPanelCallback).append("sv-pd-animation-removing",t).append("sv-pd-animation-left",i<=this.currentIndex).append("sv-pd-animation-right",i>this.currentIndex).toString()};return{getRerenderEvent:()=>this.onElementRerendered,getAnimatedElement:e=>{var t,s;if(e&&this.cssContent){let i=tr(this.cssContent);return null===(s=null===(t=this.getWrapperElement())||void 0===t?void 0:t.querySelector(`:scope ${i} #${e.id}`))||void 0===s?void 0:s.parentElement}},getEnterOptions:()=>({onBeforeRunAnimation:e=>{if(this.focusNewPanelCallback){let t=this.isRenderModeList?e:e.parentElement;eW.ScrollElementToViewCore(t,!1,!1,{behavior:"smooth"})}!this.isRenderModeList&&e.parentElement?tu(e.parentElement,{heightTo:e.offsetHeight+"px"}):td(e)},onAfterRunAnimation:e=>{tc(e),e.parentElement&&tc(e.parentElement)},cssClass:new eV().append(this.cssClasses.panelWrapperEnter).append(e()).toString()}),getLeaveOptions:()=>({onBeforeRunAnimation:e=>{!this.isRenderModeList&&e.parentElement?tu(e.parentElement,{heightFrom:e.offsetHeight+"px"}):td(e)},onAfterRunAnimation:e=>{tc(e),e.parentElement&&tc(e.parentElement)},cssClass:new eV().append(this.cssClasses.panelWrapperLeave).append(e()).toString()}),isAnimationEnabled:()=>this.animationAllowed&&!!this.getWrapperElement()}}disablePanelsAnimations(){this.panelsCore.forEach(e=>{e.blockAnimations()})}enablePanelsAnimations(){this.panelsCore.forEach(e=>{e.releaseAnimations()})}updatePanelsAnimation(){this._panelsAnimations=new(this.isRenderModeList?eQ:ez)(this.getPanelsAnimationOptions(),(e,t)=>{this._renderedPanels=e,t||(this.isPanelsAnimationRunning=!1,this.focusNewPanel())},()=>this._renderedPanels)}get panelsAnimation(){return this._panelsAnimations||this.updatePanelsAnimation(),this._panelsAnimations}onHidingContent(){super.onHidingContent(),this.currentPanel?this.currentPanel.onHidingContent():this.visiblePanelsCore.forEach(e=>e.onHidingContent())}get confirmDelete(){return this.getPropertyValue("confirmDelete")}set confirmDelete(e){this.setPropertyValue("confirmDelete",e)}get keyName(){return this.getPropertyValue("keyName","")}set keyName(e){this.setPropertyValue("keyName",e)}get confirmDeleteText(){return this.getLocalizableStringText("confirmDeleteText")}set confirmDeleteText(e){this.setLocalizableStringText("confirmDeleteText",e)}get locConfirmDeleteText(){return this.getLocalizableString("confirmDeleteText")}get keyDuplicationError(){return this.getLocalizableStringText("keyDuplicationError")}set keyDuplicationError(e){this.setLocalizableStringText("keyDuplicationError",e)}get locKeyDuplicationError(){return this.getLocalizableString("keyDuplicationError")}get prevPanelText(){return this.getLocalizableStringText("prevPanelText")}set prevPanelText(e){this.setLocalizableStringText("prevPanelText",e)}get locPrevPanelText(){return this.getLocalizableString("prevPanelText")}get panelPrevText(){return this.prevPanelText}set panelPrevText(e){this.prevPanelText=e}get locPanelPrevText(){return this.locPrevPanelText}get nextPanelText(){return this.getLocalizableStringText("nextPanelText")}set nextPanelText(e){this.setLocalizableStringText("nextPanelText",e)}get locNextPanelText(){return this.getLocalizableString("nextPanelText")}get panelNextText(){return this.nextPanelText}set panelNextText(e){this.nextPanelText=e}get locPanelNextText(){return this.locNextPanelText}get addPanelText(){return this.getLocalizableStringText("addPanelText")}set addPanelText(e){this.setLocalizableStringText("addPanelText",e)}get locAddPanelText(){return this.getLocalizableString("addPanelText")}get panelAddText(){return this.addPanelText}set panelAddText(e){this.addPanelText=e}get locPanelAddText(){return this.locAddPanelText}get removePanelText(){return this.getLocalizableStringText("removePanelText")}set removePanelText(e){this.setLocalizableStringText("removePanelText",e)}get locRemovePanelText(){return this.getLocalizableString("removePanelText")}get panelRemoveText(){return this.removePanelText}set panelRemoveText(e){this.removePanelText=e}get locPanelRemoveText(){return this.locRemovePanelText}get isProgressTopShowing(){return"carousel"==this.displayMode&&("top"===this.progressBarLocation||"topBottom"===this.progressBarLocation)}get isProgressBottomShowing(){return"carousel"==this.displayMode&&("bottom"===this.progressBarLocation||"topBottom"===this.progressBarLocation)}get isPrevButtonVisible(){return this.currentIndex>0}get isPrevButtonShowing(){return this.isPrevButtonVisible}get isNextButtonVisible(){return this.currentIndex>=0&&this.currentIndex<this.visiblePanelCount-1}get isNextButtonShowing(){return this.isNextButtonVisible}get isRangeShowing(){return this.showProgressBar&&this.currentIndex>=0&&this.visiblePanelCount>1}getElementsInDesign(e=!1){return e?[this.template]:this.templateElements}prepareValueForPanelCreating(){this.addingNewPanelsValue=this.value,this.isAddingNewPanels=!0,this.isNewPanelsValueChanged=!1}setValueAfterPanelsCreating(){this.isAddingNewPanels=!1,this.isNewPanelsValueChanged&&(this.isValueChangingInternally=!0,this.value=this.addingNewPanelsValue,this.isValueChangingInternally=!1)}getValueCore(){return this.isAddingNewPanels?this.addingNewPanelsValue:super.getValueCore()}setValueCore(e){this.isAddingNewPanels?(this.isNewPanelsValueChanged=!0,this.addingNewPanelsValue=e):super.setValueCore(e)}setIsMobile(e){super.setIsMobile(e),(this.panelsCore||[]).forEach(t=>t.getQuestions(!0).forEach(t=>{t.setIsMobile(e)}))}themeChanged(e){super.themeChanged(e),(this.panelsCore||[]).forEach(t=>t.getQuestions(!0).forEach(t=>{t.themeChanged(e)}))}get panelCount(){return!this.canBuildPanels||this.wasNotRenderedInSurvey?this.getPropertyValue("panelCount"):this.panelsCore.length}set panelCount(e){if(!(e<0)){if(!this.canBuildPanels||this.wasNotRenderedInSurvey){this.setPropertyValue("panelCount",e);return}if(e!=this.panelsCore.length&&!this.useTemplatePanel){this.updateBindings("panelCount",e),this.prepareValueForPanelCreating();for(let t=this.panelCount;t<e;t++){let e=this.createNewPanel();this.panelsCore.push(e),"list"==this.displayMode&&"default"!=this.panelsState&&("expanded"===this.panelsState?e.expand():e.title&&e.collapse())}e<this.panelCount&&this.panelsCore.splice(e,this.panelCount-e),this.disablePanelsAnimations(),this.setValueAfterPanelsCreating(),this.setValueBasedOnPanelCount(),this.reRunCondition(),this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.enablePanelsAnimations()}}}get visiblePanelCount(){return this.visiblePanels.length}get panelsState(){return this.getPropertyValue("panelsState")}set panelsState(e){this.setPropertyValue("panelsState",e)}setTemplatePanelSurveyImpl(){this.template.setSurveyImpl(this.useTemplatePanel?this.surveyImpl:new re(this))}setPanelsSurveyImpl(){for(var e=0;e<this.panelsCore.length;e++){var t=this.panelsCore[e];t!=this.template&&t.setSurveyImpl(t.data)}}setPanelsState(){if(!this.useTemplatePanel&&"list"==this.displayMode&&this.templateTitle)for(var e=0;e<this.panelsCore.length;e++){var t=this.panelsState;"firstExpanded"===t&&(t=0===e?"expanded":"collapsed"),this.panelsCore[e].state=t}}setValueBasedOnPanelCount(){var e=this.value;if(e&&Array.isArray(e)||(e=[]),e.length!=this.panelCount){for(var t=e.length;t<this.panelCount;t++){let s=this.panels[t].getValue(),i=a.isValueEmpty(s)?{}:s;e.push(i)}e.length>this.panelCount&&e.splice(this.panelCount,e.length-this.panelCount),this.isValueChangingInternally=!0,this.value=e,this.isValueChangingInternally=!1}}get minPanelCount(){return this.getPropertyValue("minPanelCount")}set minPanelCount(e){e<0&&(e=0),this.setPropertyValue("minPanelCount",e)}onMinPanelCountChanged(){let e=this.minPanelCount;e>this.maxPanelCount&&(this.maxPanelCount=e),this.panelCount<e&&(this.panelCount=e)}get maxPanelCount(){return this.getPropertyValue("maxPanelCount")}set maxPanelCount(e){e<=0||(e>tp.panel.maxPanelCount&&(e=tp.panel.maxPanelCount),this.setPropertyValue("maxPanelCount",e),this.updateFooterActions())}onMaxPanelCountChanged(){let e=this.maxPanelCount;e<this.minPanelCount&&(this.minPanelCount=e),this.panelCount>e&&(this.panelCount=e),this.updateFooterActions()}get allowAddPanel(){return this.getPropertyValue("allowAddPanel")}set allowAddPanel(e){this.setPropertyValue("allowAddPanel",e)}get addButtonId(){return this.id+"addPanel"}get newPanelPosition(){return this.getPropertyValue("newPanelPosition")}set newPanelPosition(e){this.setPropertyValue("newPanelPosition",e)}get allowRemovePanel(){return this.getPropertyValue("allowRemovePanel")}set allowRemovePanel(e){this.setPropertyValue("allowRemovePanel",e)}get templateQuestionTitleLocation(){return this.getPropertyValue("templateQuestionTitleLocation")}set templateQuestionTitleLocation(e){this.setPropertyValue("templateQuestionTitleLocation",e)}get templateTitleLocation(){return this.templateQuestionTitleLocation}set templateTitleLocation(e){this.templateQuestionTitleLocation=e}get templateErrorLocation(){return this.getPropertyValue("templateErrorLocation")}set templateErrorLocation(e){this.setPropertyValue("templateErrorLocation",e.toLowerCase())}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){this.setPropertyValue("showQuestionNumbers",e),!this.isLoadingFromJson&&this.survey&&this.survey.questionVisibilityChanged(this,this.visible,!0)}notifySurveyOnChildrenVisibilityChanged(){return"onSurvey"===this.showQuestionNumbers}get removePanelButtonLocation(){return this.getPropertyValue("removePanelButtonLocation")}set removePanelButtonLocation(e){this.setPropertyValue("removePanelButtonLocation",e)}get panelRemoveButtonLocation(){return this.removePanelButtonLocation}set panelRemoveButtonLocation(e){this.removePanelButtonLocation=e}get showRangeInProgress(){return this.showProgressBar}set showRangeInProgress(e){this.showProgressBar=e}get renderMode(){let e=this.displayMode;if("carousel"==e){let e=this.progressBarLocation;if("top"==e)return"progressTop";if("bottom"==e)return"progressBottom";if("topBottom"==e)return"progressTopBottom"}return e}set renderMode(e){(e||"").startsWith("progress")?("progressTop"==e?this.progressBarLocation="top":"progressBottom"==e?this.progressBarLocation="bottom":"progressTopBottom"==e&&(this.progressBarLocation="topBottom"),this.displayMode="carousel"):this.displayMode=e}updatePanelView(){this.blockAnimations(),this.updateRenderedPanels(),this.releaseAnimations(),this.updatePanelsAnimation()}get tabAlign(){return this.getPropertyValue("tabAlign")}set tabAlign(e){this.setPropertyValue("tabAlign",e),this.isRenderModeTab&&(this.tabbedMenu.containerCss=this.getTabbedMenuCss())}get isRenderModeList(){return"list"===this.displayMode}get isRenderModeTab(){return"tab"===this.displayMode}setVisibleIndex(e){if(!this.isVisible)return 0;let t="onSurvey"===this.showQuestionNumbers,s=t?e:0,i=this.isDesignMode?[this.template]:this.visiblePanelsCore;for(let e=0;e<i.length;e++){let r=this.setPanelVisibleIndex(i[e],s,"off"!=this.showQuestionNumbers);t&&(s+=r)}return super.setVisibleIndex(t?-1:e),t?s-e:1}setPanelVisibleIndex(e,t,s){return s?e.setVisibleIndex(t):(e.setVisibleIndex(-1),0)}get canAddPanel(){return!this.isDesignMode&&(!this.isDefaultV2Theme||!!this.legacyNavigation||!!this.isRenderModeList||!(this.currentIndex<this.visiblePanelCount-1)||"next"===this.newPanelPosition)&&this.allowAddPanel&&!this.isReadOnly&&this.panelCount<this.maxPanelCount}get canRemovePanel(){return!this.isDesignMode&&this.allowRemovePanel&&!this.isReadOnly&&this.panelCount>this.minPanelCount}rebuildPanels(){if(!this.isLoadingFromJson){this.prepareValueForPanelCreating();var e=[];if(this.useTemplatePanel)new i7(this,this.template),e.push(this.template);else for(var t=0;t<this.panelCount;t++)this.createNewPanel(),e.push(this.createNewPanel());this.panelsCore.splice(0,this.panelsCore.length,...e),this.setValueAfterPanelsCreating(),this.setPanelsState(),this.reRunCondition(),this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.updateTabToolbar()}}get defaultPanelValue(){return this.getPropertyValue("defaultPanelValue")}set defaultPanelValue(e){this.setPropertyValue("defaultPanelValue",e)}get copyDefaultValueFromLastEntry(){return this.getPropertyValue("copyDefaultValueFromLastEntry")}set copyDefaultValueFromLastEntry(e){this.setPropertyValue("copyDefaultValueFromLastEntry",e)}get defaultValueFromLastPanel(){return this.copyDefaultValueFromLastEntry}set defaultValueFromLastPanel(e){this.copyDefaultValueFromLastEntry=e}isDefaultValueEmpty(){return super.isDefaultValueEmpty()&&this.isValueEmpty(this.defaultPanelValue)}setDefaultValue(){if(this.isValueEmpty(this.defaultPanelValue)||!this.isValueEmpty(this.defaultValue)){super.setDefaultValue();return}if(this.isEmpty()&&0!=this.panelCount){for(var e=[],t=0;t<this.panelCount;t++)e.push(this.defaultPanelValue);this.value=e}}get isValueArray(){return!0}isEmpty(){var e=this.value;if(!e||!Array.isArray(e))return!0;for(var t=0;t<e.length;t++)if(!this.isRowEmpty(e[t]))return!1;return!0}getProgressInfo(){return eW.getProgressInfoByElements(this.visiblePanelsCore,this.isRequired)}isRowEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}addPanelUI(){return this.addPanel(void 0,!0)}addPanel(e,t){let s=!0===t;if(s&&(!this.canAddPanel||!this.canLeaveCurrentPanel()))return null;let i=this.addPanelCore(e);return s&&("list"===this.displayMode&&"default"!==this.panelsState&&i.expand(),this.focusNewPanelCallback=()=>{i.focusFirstQuestion()},this.isPanelsAnimationRunning||this.focusNewPanel()),i}addPanelCore(e){let t=this.currentIndex;return void 0===e&&(e=t<0?this.panelCount:t+1),(e<0||e>this.panelCount)&&(e=this.panelCount),this.updateValueOnAddingPanel(t<0?this.panelCount-1:t,e),this.isRenderModeList||(this.currentIndex=e),this.survey&&this.survey.dynamicPanelAdded(this),this.panelsCore[e]}focusNewPanel(){this.focusNewPanelCallback&&(this.focusNewPanelCallback(),this.focusNewPanelCallback=void 0)}updateValueOnAddingPanel(e,t){this.panelCount++;let s=this.value;if(!Array.isArray(s)||s.length!==this.panelCount)return;let i=!1,r=this.panelCount-1;if(t<r){i=!0;let e=s[r];s.splice(r,1),s.splice(t,0,e)}if(this.isValueEmpty(this.defaultPanelValue)||(i=!0,this.copyValue(s[t],this.defaultPanelValue)),this.copyDefaultValueFromLastEntry&&s.length>1){let n=e>-1&&e<=r?e:r;i=!0,this.copyValue(s[t],s[n])}i&&(this.value=s)}canLeaveCurrentPanel(){return!("list"!==this.displayMode&&this.currentPanel&&this.currentPanel.hasErrors(!0,!0))}copyValue(e,t){for(var s in t)e[s]=t[s]}getPanelRemoveButtonId(e){return e.id+"_remove_button"}isRequireConfirmOnDelete(e){if(!this.confirmDelete)return!1;let t=this.getVisualPanelIndex(e);if(t<0||t>=this.visiblePanelCount)return!1;let s=this.visiblePanelsCore[t].getValue();return!this.isValueEmpty(s)&&(this.isValueEmpty(this.defaultPanelValue)||!this.isTwoValueEquals(s,this.defaultPanelValue))}goToNextPanel(){return!(this.currentIndex<0)&&!!this.canLeaveCurrentPanel()&&(this.currentIndex++,!0)}goToPrevPanel(){!(this.currentIndex<0)&&this.currentIndex--}removePanelUI(e){this.removePanel(e,this.isRequireConfirmOnDelete(e))}removePanel(e,t){let s=this.getVisualPanelIndex(e);if(!(s<0)&&!(s>=this.visiblePanelCount)){if(void 0!==t){if(!this.canRemovePanel)return;let e=()=>{var e;this.removePanelCore(s);let t=this.visiblePanelCount,i=s>=t?t-1:s,r=0===t?this.addButtonId:i>-1?this.getPanelRemoveButtonId(this.visiblePanels[i]):"";r&&eW.FocusElement(r,!0,null===(e=this.survey)||void 0===e?void 0:e.rootElement)};t?eG({message:this.confirmDeleteText,funcOnYes:()=>{e()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog}):e()}else this.removePanelCore(s)}}removePanelCore(e){this.removedPanelIndex=e;let t=this.visiblePanelsCore[e],s=this.panelsCore.indexOf(t);if(!(s<0)&&(!this.survey||this.survey.dynamicPanelRemoving(this,s,t))){this.panelsCore.splice(s,1),this.updateBindings("panelCount",this.panelCount);var i=this.value;i&&Array.isArray(i)&&!(s>=i.length)&&(this.isValueChangingInternally=!0,i.splice(s,1),this.value=i,this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.survey&&this.survey.dynamicPanelRemoved(this,s,t),this.isValueChangingInternally=!1)}}getVisualPanelIndex(e){if(a.isNumber(e))return e;let t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s]===e||t[s].data===e)return s;return -1}getPanelVisibleIndexById(e){let t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s].id===e)return s;return -1}locStrsChanged(){super.locStrsChanged();for(var e=this.panelsCore,t=0;t<e.length;t++)e[t].locStrsChanged();this.tabbedMenu&&this.tabbedMenu.locStrsChanged()}clearIncorrectValues(){for(var e=0;e<this.panelsCore.length;e++)this.clearIncorrectValuesInPanel(e)}clearErrors(){super.clearErrors();for(var e=0;e<this.panelsCore.length;e++)this.panelsCore[e].clearErrors()}getQuestionFromArray(e,t){return t<0||t>=this.panelsCore.length?null:this.panelsCore[t].getQuestionByName(e)}clearIncorrectValuesInPanel(e){var t=this.panelsCore[e];t.clearIncorrectValues();var s=this.value,i=s&&e<s.length?s[e]:null;if(i){var r=!1;for(var n in i)!(this.getSharedQuestionFromArray(n,e)||t.getQuestionByName(n))&&(this.iscorrectValueWithPostPrefix(t,n,tp.commentSuffix)||this.iscorrectValueWithPostPrefix(t,n,tp.matrix.totalsSuffix)||(delete i[n],r=!0));r&&(s[e]=i,this.value=s)}}iscorrectValueWithPostPrefix(e,t,s){return t.indexOf(s)===t.length-s.length&&!!e.getQuestionByName(t.substring(0,t.indexOf(s)))}getSharedQuestionFromArray(e,t){return this.survey&&this.valueName?this.survey.getQuestionByValueNameFromArray(this.valueName,e,t):null}addConditionObjectsByContext(e,t){let s=(null==t?void 0:t.isValidator)?t.errorOwner:t,i=!!t&&(!0===t||this.template.questions.indexOf(s)>-1),r=[],n=this.template.questions;for(var a=0;a<n.length;a++)n[a].addConditionObjectsByContext(r,t);for(var o=0;o<tp.panel.maxPanelCountInCondition;o++){let t="["+o+"].",s=this.getValueName()+t,i=this.processedTitle+t;for(var a=0;a<r.length;a++)r[a].context?e.push(r[a]):e.push({name:s+r[a].name,text:i+r[a].text,question:r[a].question})}if(i){let s=!0===t?this.getValueName()+".":"",i=!0===t?this.processedTitle+".":"";for(var a=0;a<r.length;a++){if(r[a].question==t)continue;let n={name:s+i7.ItemVariableName+"."+r[a].name,text:i+i7.ItemVariableName+"."+r[a].text,question:r[a].question};n.context=this,e.push(n)}}}collectNestedQuestionsCore(e,t){let s=t?this.visiblePanelsCore:this.panelsCore;Array.isArray(s)&&s.forEach(s=>{s.questions.forEach(s=>s.collectNestedQuestions(e,t))})}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=t,i=t.indexOf(".");i>-1&&(s=t.substring(0,i),t=t.substring(i+1));var r=this.template.getQuestionByName(s);return r?r.getConditionJson(e,t):null}onReadOnlyChanged(){var e=this.isReadOnly;this.template.readOnly=e;for(var t=0;t<this.panelsCore.length;t++)this.panelsCore[t].readOnly=e;this.updateNoEntriesTextDefaultLoc(),this.updateFooterActions(),super.onReadOnlyChanged()}updateNoEntriesTextDefaultLoc(){let e=this.getLocalizableString("noEntriesText");e&&(e.localizationName=this.isReadOnly||!this.allowAddPanel?"noEntriesReadonlyText":"noEntriesText")}onSurveyLoad(){this.template.readOnly=this.isReadOnly,this.template.onSurveyLoad(),this.panelCount<this.minPanelCount&&(this.panelCount=this.minPanelCount),this.panelCount>this.maxPanelCount&&(this.panelCount=this.maxPanelCount),this.buildPanelsFirstTime(),super.onSurveyLoad()}buildPanelsFirstTime(e=!1){if(!this.hasPanelBuildFirstTime&&(e||!this.wasNotRenderedInSurvey)){if(this.blockAnimations(),this.hasPanelBuildFirstTime=!0,this.isBuildingPanelsFirstTime=!0,this.getPropertyValue("panelCount")>0&&(this.panelCount=this.getPropertyValue("panelCount")),this.useTemplatePanel&&this.rebuildPanels(),this.setPanelsSurveyImpl(),this.setPanelsState(),this.assignOnPropertyChangedToTemplate(),this.survey)for(var t=0;t<this.panelCount;t++)this.survey.dynamicPanelAdded(this);this.updateIsReady(),this.showAddPanelButton||this.updateNoEntriesTextDefaultLoc(),this.updateFooterActions(),this.isBuildingPanelsFirstTime=!1,this.releaseAnimations()}}get showAddPanelButton(){return this.allowAddPanel&&!this.isReadOnly}get wasNotRenderedInSurvey(){return!this.hasPanelBuildFirstTime&&!this.wasRendered&&!!this.survey}get canBuildPanels(){return!this.isLoadingFromJson&&!this.useTemplatePanel}onFirstRenderingCore(){super.onFirstRenderingCore(),this.buildPanelsFirstTime(),this.template.onFirstRendering();for(var e=0;e<this.panelsCore.length;e++)this.panelsCore[e].onFirstRendering()}localeChanged(){super.localeChanged();for(var e=0;e<this.panelsCore.length;e++)this.panelsCore[e].localeChanged()}runConditionCore(e,t){super.runConditionCore(e,t),this.runPanelsCondition(this.panelsCore,e,t)}runTriggers(e,t,s){super.runTriggers(e,t,s),this.visiblePanelsCore.forEach(i=>{i.questions.forEach(i=>i.runTriggers(e,t,s))})}reRunCondition(){this.data&&this.runCondition(this.getDataFilteredValues(),this.getDataFilteredProperties())}runPanelsCondition(e,t,s){var i={};t&&t instanceof Object&&(i=JSON.parse(JSON.stringify(t))),this.parentQuestion&&this.parent&&(i[i7.ParentItemVariableName]=this.parent.getValue()),this.isValueChangingInternally=!0;for(var r=0;r<e.length;r++){let t=e[r];var n=this.getPanelItemData(t.data);let o=a.createCopy(i),l=i7.ItemVariableName;o[l]=n,o[i7.IndexVariableName.toLowerCase()]=r;let h=a.createCopy(s);h[l]=t,t.runCondition(o,h)}this.isValueChangingInternally=!1}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t);for(var s=0;s<this.panelsCore.length;s++)this.panelsCore[s].onAnyValueChanged(e,t),this.panelsCore[s].onAnyValueChanged(i7.ItemVariableName,"")}hasKeysDuplicated(e,t=null){for(var s,i=[],r=0;r<this.panelsCore.length;r++)s=this.isValueDuplicated(this.panelsCore[r],i,t,e)||s;return s}updatePanelsContainsErrors(){for(var e=this.changingValueQuestion.parent;e;)e.updateContainsErrors(),e=e.parent;this.updateContainsErrors()}hasErrors(e=!0,t=null){if(this.isValueChangingInternally||this.isBuildingPanelsFirstTime)return!1;var s=!1;if(this.changingValueQuestion){var s=this.changingValueQuestion.hasErrors(e,t);s=this.hasKeysDuplicated(e,t)||s,this.updatePanelsContainsErrors()}else s=this.hasErrorInPanels(e,t);return super.hasErrors(e,t)||s}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.panelsCore,s=0;s<t.length;s++)if(t[s].containsErrors)return!0;return!1}getIsAnswered(){if(!super.getIsAnswered())return!1;for(var e=this.visiblePanelsCore,t=0;t<e.length;t++){var s=[];e[t].addQuestionsToList(s,!0);for(var i=0;i<s.length;i++)if(!s[i].isAnswered)return!1}return!0}clearValueOnHidding(e){if(!e){if(this.survey&&"none"===this.survey.getQuestionClearIfInvisible("onHidden"))return;this.clearValueInPanelsIfInvisible("onHiddenContainer")}super.clearValueOnHidding(e)}clearValueIfInvisible(e="onHidden"){let t="onHidden"===e?"onHiddenContainer":e;this.clearValueInPanelsIfInvisible(t),super.clearValueIfInvisible(e)}clearValueInPanelsIfInvisible(e){for(var t=0;t<this.panelsCore.length;t++){let r=this.panelsCore[t];var s=r.questions;this.isSetPanelItemData={};for(var i=0;i<s.length;i++){let t=s[i];(!t.visible||r.isVisible)&&(t.clearValueIfInvisible(e),this.isSetPanelItemData[t.getValueName()]=this.maxCheckCount+1)}}this.isSetPanelItemData={}}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;for(var e=0;e<this.panelsCore.length;e++)for(var t=this.panelsCore[e].questions,s=0;s<t.length;s++)if(t[s].isRunningValidators)return!0;return!1}getAllErrors(){var e=super.getAllErrors();let t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)for(var i=t[s].questions,r=0;r<i.length;r++){var n=i[r].getAllErrors();n&&n.length>0&&(e=e.concat(n))}return e}getDisplayValueCore(e,t){var s=this.getUnbindValue(t);if(!s||!Array.isArray(s))return s;for(var i=0;i<this.panelsCore.length&&i<s.length;i++){var r=s[i];r&&(s[i]=this.getPanelDisplayValue(i,r,e))}return s}getPanelDisplayValue(e,t,s){if(!t)return t;for(var i=this.panelsCore[e],r=Object.keys(t),n=0;n<r.length;n++){var a=r[n],o=i.getQuestionByValueName(a);if(o||(o=this.getSharedQuestionFromArray(a,e)),o){var l=o.getDisplayValue(s,t[a]);t[a]=l,s&&o.title&&o.title!==a&&(t[o.title]=l,delete t[a])}}return t}hasErrorInPanels(e,t){for(var s=!1,i=this.visiblePanels,r=[],n=0;n<i.length;n++)this.setOnCompleteAsyncInPanel(i[n]);let a=!!t&&t.focusOnFirstError;for(let n=0;n<i.length;n++){let o=i[n].hasErrors(e,a,t);o=this.isValueDuplicated(i[n],r,t,e)||o,!this.isRenderModeList&&o&&!s&&a&&(this.currentIndex=n),s=o||s}return s}setOnCompleteAsyncInPanel(e){for(var t=e.questions,s=0;s<t.length;s++)t[s].onCompletedAsyncValidators=e=>{this.raiseOnCompletedAsyncValidators()}}isValueDuplicated(e,t,s,i){if(!this.keyName)return!1;var r=e.getQuestionByValueName(this.keyName);if(!r||r.isEmpty())return!1;var n=r.value;this.changingValueQuestion&&r!=this.changingValueQuestion&&r.hasErrors(i,s);for(var a=0;a<t.length;a++)if(n==t[a])return i&&r.addError(new tR(this.keyDuplicationError,this)),s&&!s.firstErrorQuestion&&(s.firstErrorQuestion=r),!0;return t.push(n),!1}getPanelActions(e){let t=e.footerActions;return"right"!==this.removePanelButtonLocation&&t.push(new eL({id:`remove-panel-${e.id}`,component:"sv-paneldynamic-remove-btn",visible:new ec(()=>[this.canRenderRemovePanel(e,"bottom")].every(e=>!0===e)),data:{question:this,panel:e}})),this.survey&&(t=this.survey.getUpdatedPanelFooterActions(e,t,this)),t}canRenderRemovePanelOnRight(e){return this.canRenderRemovePanel(e,"right")}canRenderRemovePanel(e,t){let s=this.canRemovePanel,i="collapsed"!==e.state;return this.removePanelButtonLocation===t&&s&&i}createNewPanel(){var e=this.createAndSetupNewPanelObject(),t=this.template.toJSON();new I().toObject(t,e),e.renderWidth="100%",e.updateCustomWidgets(),new i7(this,e),this.isDesignMode||this.isReadOnly||this.isValueEmpty(e.getValue())||this.runPanelsCondition([e],this.getDataFilteredValues(),this.getDataFilteredProperties());for(var s=e.questions,i=0;i<s.length;i++)s[i].setParentQuestion(this);return this.wasRendered&&(e.onFirstRendering(),e.locStrsChanged()),e.onGetFooterActionsCallback=()=>this.getPanelActions(e),e.onGetFooterToolbarCssCallback=()=>this.cssClasses.panelFooter,e.registerPropertyChangedHandlers(["visible"],()=>{e.visible?this.onPanelAdded(e):this.onPanelRemoved(e),this.updateFooterActions()}),e}createAndSetupNewPanelObject(){var e=this.createNewPanelObject();return e.isInteractiveDesignElement=!1,e.setParentQuestion(this),e.onGetQuestionTitleLocation=()=>this.getTemplateQuestionTitleLocation(),e}getTemplateQuestionTitleLocation(){return"default"!=this.templateQuestionTitleLocation?this.templateQuestionTitleLocation:this.getTitleLocationCore()}getChildErrorLocation(e){return"default"!==this.templateErrorLocation?this.templateErrorLocation:super.getChildErrorLocation(e)}createNewPanelObject(){return E.createClass("panel")}setPanelCountBasedOnValue(){if(!this.isValueChangingInternally&&!this.useTemplatePanel){var e=this.value,t=e&&Array.isArray(e)?e.length:0;0==t&&this.getPropertyValue("panelCount")>0&&(t=this.getPropertyValue("panelCount")),this.settingPanelCountBasedOnValue=!0,this.panelCount=t,this.settingPanelCountBasedOnValue=!1}}setQuestionValue(e){if(!this.settingPanelCountBasedOnValue){super.setQuestionValue(e,!1),this.setPanelCountBasedOnValue();for(var t=0;t<this.panelsCore.length;t++)this.panelUpdateValueFromSurvey(this.panelsCore[t]);this.updateIsAnswered()}}onSurveyValueChanged(e){if(!(void 0===e&&this.isAllPanelsEmpty())){super.onSurveyValueChanged(e);for(var t=0;t<this.panelsCore.length;t++)this.panelSurveyValueChanged(this.panelsCore[t]);void 0===e&&this.setValueBasedOnPanelCount(),this.updateIsReady()}}isAllPanelsEmpty(){for(var e=0;e<this.panelsCore.length;e++)if(!a.isValueEmpty(this.panelsCore[e].getValue()))return!1;return!0}panelUpdateValueFromSurvey(e){let t=e.questions;for(var s=this.getPanelItemData(e.data),i=0;i<t.length;i++){let e=t[i];e.updateValueFromSurvey(s[e.getValueName()]),e.updateCommentFromSurvey(s[e.getValueName()+tp.commentSuffix]),e.initDataUI()}}panelSurveyValueChanged(e){for(var t=e.questions,s=this.getPanelItemData(e.data),i=0;i<t.length;i++){var r=t[i];r.onSurveyValueChanged(s[r.getValueName()])}}onSetData(){super.onSetData(),!this.isLoadingFromJson&&this.useTemplatePanel&&(this.setTemplatePanelSurveyImpl(),this.rebuildPanels())}isNewValueCorrect(e){return Array.isArray(e)}getItemIndex(e){var t=this.items.indexOf(e);return t>-1?t:this.items.length}getVisibleItemIndex(e){let t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s].data===e)return s;return t.length}getPanelItemData(e){var t=this.items,s=t.indexOf(e),i=this.value;return(s<0&&Array.isArray(i)&&i.length>t.length&&(s=t.length),s<0||!i||!Array.isArray(i)||i.length<=s)?{}:i[s]}setPanelItemData(e,t,s){if(this.isSetPanelItemData[t]>this.maxCheckCount)return;this.isSetPanelItemData[t]||(this.isSetPanelItemData[t]=0),this.isSetPanelItemData[t]++;var i=this.items,r=i.indexOf(e);r<0&&(r=i.length);var n=this.getUnbindValue(this.value);if(n&&Array.isArray(n)||(n=[]),n.length<=r)for(var a=n.length;a<=r;a++)n.push({});n[r]||(n[r]={});let o=n[r][t];this.isValueEmpty(s)?delete n[r][t]:n[r][t]=s,r>=0&&r<this.panelsCore.length&&(this.changingValueQuestion=this.panelsCore[r].getQuestionByValueName(t));let l={panel:e.panel,name:t,panelIndex:r,panelData:n[r],value:s,oldValue:o};this.survey&&this.survey.dynamicPanelItemValueChanging(this,l),this.value=n,this.changingValueQuestion=null,this.survey&&this.survey.dynamicPanelItemValueChanged(this,l),this.isSetPanelItemData[t]--,this.isSetPanelItemData[t]-1&&delete this.isSetPanelItemData[t]}getRootData(){return this.data}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){t.isNode=!0;let s=Array.isArray(t.data)?[].concat(t.data):[];t.data=this.panels.map((t,s)=>{var i={name:t.name||s,title:t.title||"Panel",value:t.getValue(),displayValue:t.getValue(),getString:e=>"object"==typeof e?JSON.stringify(e):e,isNode:!0,data:t.questions.map(t=>t.getPlainData(e)).filter(e=>!!e)};return(e.calculations||[]).forEach(e=>{i[e.propertyName]=t[e.propertyName]}),i}),t.data=t.data.concat(s)}return t}updateElementCss(e){super.updateElementCss(e);for(var t=0;t<this.panelsCore.length;t++)this.panelsCore[t].updateElementCss(e)}get progressText(){var e=this.visiblePanelCount;return this.getLocalizationFormatString("panelDynamicProgressText",this.currentIndex+1,e)}get progress(){return(this.currentIndex+1)/this.visiblePanelCount*100+"%"}getRootCss(){return new eV().append(super.getRootCss()).append(this.cssClasses.empty,this.getShowNoEntriesPlaceholder()).toString()}get cssHeader(){let e=this.isRenderModeTab&&!!this.visiblePanelCount;return new eV().append(super.getCssHeader(this.cssClasses)).append(this.cssClasses.headerTab,this.hasTitleOnTop&&e).toString()}getTabsContainerCss(){return new eV().append(this.cssClasses.tabsContainer).append(this.cssClasses.tabsContainerWithHeader,this.hasTitleOnTop).toString()}getPanelWrapperCss(e){return new eV().append(this.cssClasses.panelWrapper,!e||e.visible).append(this.cssClasses.panelWrapperList,this.isRenderModeList).append(this.cssClasses.panelWrapperInRow,"right"===this.removePanelButtonLocation).toString()}getPanelRemoveButtonCss(){return new eV().append(this.cssClasses.button).append(this.cssClasses.buttonRemove).append(this.cssClasses.buttonRemoveRight,"right"===this.removePanelButtonLocation).toString()}getAddButtonCss(){return new eV().append(this.cssClasses.button).append(this.cssClasses.buttonAdd).append(this.cssClasses.buttonAdd+"--list-mode","list"===this.displayMode).toString()}getPrevButtonCss(){return new eV().append(this.cssClasses.buttonPrev).append(this.cssClasses.buttonPrevDisabled,!this.isPrevButtonVisible).toString()}getNextButtonCss(){return new eV().append(this.cssClasses.buttonNext).append(this.cssClasses.buttonNextDisabled,!this.isNextButtonVisible).toString()}get noEntriesText(){return this.getLocalizableStringText("noEntriesText")}set noEntriesText(e){this.setLocalizableStringText("noEntriesText",e)}get locNoEntriesText(){return this.getLocalizableString("noEntriesText")}getShowNoEntriesPlaceholder(){return!!this.cssClasses.noEntriesPlaceholder&&!this.isDesignMode&&0===this.visiblePanelCount}needResponsiveWidth(){let e=this.getPanel();return!!(e&&e.needResponsiveWidth())}get hasTabbedMenu(){return this.isRenderModeTab&&this.visiblePanels.length>0}get tabbedMenu(){return this.isRenderModeTab?(this.tabbedMenuValue||(this.tabbedMenuValue=new ek,this.tabbedMenuValue.dotsItem.popupModel.showPointer=!1,this.tabbedMenuValue.dotsItem.popupModel.verticalPosition="bottom",this.tabbedMenuValue.dotsItem.popupModel.horizontalPosition="center",this.updateElementCss(!1)),this.tabbedMenuValue):null}get footerToolbar(){return this.footerToolbarValue||this.initFooterToolbar(),this.footerToolbarValue}updateFooterActions(){this.updateFooterActionsCallback&&this.updateFooterActionsCallback()}initFooterToolbar(){this.footerToolbarValue=this.createActionContainer();let e=[],t=new eL({id:"sv-pd-prev-btn",title:this.prevPanelText,action:()=>{this.goToPrevPanel()}}),s=new eL({id:"sv-pd-next-btn",title:this.nextPanelText,action:()=>{this.goToNextPanel()}}),i=new eL({id:"sv-pd-add-btn",component:"sv-paneldynamic-add-btn",data:{question:this}}),r=new eL({id:"sv-prev-btn-icon",component:"sv-paneldynamic-prev-btn",data:{question:this}}),n=new eL({id:"sv-pd-progress-text",component:"sv-paneldynamic-progress-text",data:{question:this}}),a=new eL({id:"sv-pd-next-btn-icon",component:"sv-paneldynamic-next-btn",data:{question:this}});e.push(t,s,i,r,n,a),this.updateFooterActionsCallback=()=>{let e=this.legacyNavigation,o=this.isRenderModeList,l=this.isMobile,h=!e&&!o;t.visible=h&&this.currentIndex>0,s.visible=h&&this.currentIndex<this.visiblePanelCount-1,s.needSpace=l&&s.visible&&t.visible,i.visible=this.canAddPanel,i.needSpace=this.isMobile&&!s.visible&&t.visible,n.visible=!this.isRenderModeList&&!l,n.needSpace=!e&&!this.isMobile;let u=e&&!o;r.visible=u,a.visible=u,r.needSpace=u},this.updateFooterActionsCallback(),this.footerToolbarValue.setItems(e)}createTabByPanel(e,t){if(!this.isRenderModeTab)return;let s=new ej(e,!0);s.onGetTextCallback=s=>{if(s||(s=this.locTabTitlePlaceholder.renderedHtml),!this.survey)return s;let i={title:s,panel:e,visiblePanelIndex:t};return this.survey.dynamicPanelGetTabTitle(this,i),i.title},s.sharedData=this.locTemplateTabTitle;let i=e.id,r=this.getPanelVisibleIndexById(i)===this.currentIndex;return new i8({id:`${this.id}_tab_${i}`,panelId:i,pressed:r,locTitle:s,disableHide:r,action:()=>{this.currentIndex=this.getPanelVisibleIndexById(i)}})}getTabbedMenuCss(e){let t=null!=e?e:this.cssClasses;return new eV().append(t.tabsRoot).append(t.tabsLeft,"left"===this.tabAlign).append(t.tabsRight,"right"===this.tabAlign).append(t.tabsCenter,"center"===this.tabAlign).toString()}updateTabToolbarItemsPressedState(){if(!this.isRenderModeTab||this.currentIndex<0||this.currentIndex>=this.visiblePanelCount)return;let e=this.visiblePanelsCore[this.currentIndex];this.tabbedMenu.renderedActions.forEach(t=>{let s=t.panelId===e.id;t.pressed=s,t.disableHide=s,"popup"===t.mode&&t.disableHide&&t.raiseUpdate()})}updateTabToolbar(){if(!this.isRenderModeTab)return;let e=[],t=this.visiblePanelsCore;for(let s=0;s<t.length;s++)this.visiblePanelsCore.forEach(i=>e.push(this.createTabByPanel(t[s],s)));this.tabbedMenu.setItems(e)}addTabFromToolbar(e,t){if(!this.isRenderModeTab)return;let s=this.createTabByPanel(e,t);this.tabbedMenu.actions.splice(t,0,s),this.updateTabToolbarItemsPressedState()}removeTabFromToolbar(e){if(!this.isRenderModeTab)return;let t=this.tabbedMenu.actions.find(t=>t.panelId==e.id);t&&(this.tabbedMenu.actions.splice(this.tabbedMenu.actions.indexOf(t),1),this.updateTabToolbarItemsPressedState())}get showLegacyNavigation(){return!this.isDefaultV2Theme}get showNavigation(){return(!this.isReadOnly||1!=this.visiblePanelCount)&&this.visiblePanelCount>0&&!this.showLegacyNavigation&&!!this.cssClasses.footer}showSeparator(e){return this.isRenderModeList&&e<this.renderedPanels.length-1}calcCssClasses(e){let t=super.calcCssClasses(e),s=this.tabbedMenu;return s&&(s.containerCss=this.getTabbedMenuCss(t),s.cssClasses=t.tabs,s.dotsItem.cssClasses=t.tabs,s.dotsItem.popupModel.contentComponentData.model.cssClasses=e.list),t}onMobileChanged(){super.onMobileChanged(),this.updateFooterActions()}}rt.maxCheckCount=3,ey([p({})],rt.prototype,"_renderedPanels",void 0),ey([c({onSet:(e,t)=>{t.fireCallback(t.renderModeChangedCallback),t.updatePanelView()}})],rt.prototype,"displayMode",void 0),ey([c({onSet:(e,t)=>{t.fireCallback(t.currentIndexChangedCallback)}})],rt.prototype,"showProgressBar",void 0),ey([c({onSet:(e,t)=>{}})],rt.prototype,"progressBarLocation",void 0),ey([c({defaultValue:!1,onSet:(e,t)=>{t.updateFooterActions()}})],rt.prototype,"legacyNavigation",void 0),E.addClass("paneldynamic",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"templateElements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"templateTitle:text",serializationProperty:"locTemplateTitle"},{name:"templateTabTitle",serializationProperty:"locTemplateTabTitle",visibleIf:e=>"tab"===e.displayMode},{name:"tabTitlePlaceholder",serializationProperty:"locTabTitlePlaceholder",visibleIf:e=>"tab"===e.displayMode},{name:"templateDescription:text",serializationProperty:"locTemplateDescription"},{name:"minWidth",defaultFunc:()=>"auto"},{name:"noEntriesText:text",serializationProperty:"locNoEntriesText"},{name:"allowAddPanel:boolean",default:!0},{name:"allowRemovePanel:boolean",default:!0},{name:"newPanelPosition",choices:["next","last"],default:"last",category:"layout"},{name:"panelCount:number",isBindable:!0,default:0,choices:[0,1,2,3,4,5,6,7,8,9,10]},{name:"minPanelCount:number",default:0,minValue:0},{name:"maxPanelCount:number",defaultFunc:()=>tp.panel.maxPanelCount},"defaultPanelValue:panelvalue",{name:"copyDefaultValueFromLastEntry:boolean",alternativeName:"defaultValueFromLastPanel"},{name:"panelsState",default:"default",choices:["default","collapsed","expanded","firstExpanded"],visibleIf:e=>"list"===e.displayMode},{name:"keyName"},{name:"keyDuplicationError",serializationProperty:"locKeyDuplicationError"},{name:"confirmDelete:boolean"},{name:"confirmDeleteText",serializationProperty:"locConfirmDeleteText",visibleIf:e=>e.confirmDelete},{name:"addPanelText",alternativeName:"panelAddText",serializationProperty:"locAddPanelText",visibleIf:e=>e.allowAddPanel},{name:"removePanelText",alternativeName:"panelRemoveText",serializationProperty:"locRemovePanelText",visibleIf:e=>e.allowRemovePanel},{name:"prevPanelText",alternativeName:"panelPrevText",serializationProperty:"locPrevPanelText",visibleIf:e=>"list"!==e.displayMode},{name:"nextPanelText",alternativeName:"panelNextText",serializationProperty:"locNextPanelText",visibleIf:e=>"list"!==e.displayMode},{name:"showQuestionNumbers",default:"off",choices:["off","onPanel","onSurvey"]},{name:"renderMode",visible:!1,isSerializable:!1},{name:"displayMode",default:"list",choices:["list","carousel","tab"]},{name:"showProgressBar:boolean",alternativeName:"showRangeInProgress",default:!0,visibleIf:e=>"carousel"===e.displayMode},{name:"progressBarLocation",default:"top",choices:["top","bottom","topBottom"],visibleIf:e=>e.showProgressBar&&"carousel"===e.displayMode},{name:"tabAlign",default:"center",choices:["left","center","right"],visibleIf:e=>"tab"===e.displayMode},{name:"templateQuestionTitleLocation",alternativeName:"questionTitleLocation",default:"default",choices:["default","top","bottom","left"]},{name:"templateErrorLocation",default:"default",choices:["default","top","bottom"]},{name:"templateVisibleIf:expression",category:"logic"},{name:"removePanelButtonLocation",alternativeName:"panelRemoveButtonLocation",default:"bottom",choices:["bottom","right"],visibleIf:e=>e.allowRemovePanel}],function(){return new rt("")},"question"),st.Instance.registerQuestion("paneldynamic",e=>new rt(e));class rs{static getProgressTextInBarCss(e){return new eV().append(e.progressText).append(e.progressTextInBar).toString()}static getProgressTextUnderBarCss(e){return new eV().append(e.progressText).append(e.progressTextUnderBar).toString()}}class ri extends eg{static get operators(){return null!=ri.operatorsValue||(ri.operatorsValue={empty:function(e,t){return!e},notempty:function(e,t){return!!e},equal:function(e,t){return e==t},notequal:function(e,t){return e!=t},contains:function(e,t){return e&&e.indexOf&&e.indexOf(t)>-1},notcontains:function(e,t){return!e||!e.indexOf||-1==e.indexOf(t)},greater:function(e,t){return e>t},less:function(e,t){return e<t},greaterorequal:function(e,t){return e>=t},lessorequal:function(e,t){return e<=t}}),ri.operatorsValue}constructor(){super(),this.idValue=ri.idCounter++,this.registerPropertyChangedHandlers(["operator","value","name"],()=>{this.oldPropertiesChanged()}),this.registerPropertyChangedHandlers(["expression"],()=>{this.onExpressionChanged()})}get id(){return this.idValue}getType(){return"triggerbase"}toString(){var e=this.getType().replace("trigger",""),t=this.expression?this.expression:this.buildExpression();return t&&(e+=", "+t),e}get isInternal(){return!0===this.isGhost}get operator(){return this.getPropertyValue("operator","equal")}set operator(e){e&&(e=e.toLowerCase(),ri.operators[e]&&this.setPropertyValue("operator",e))}get value(){return this.getPropertyValue("value",null)}set value(e){this.setPropertyValue("value",e)}get name(){return this.getPropertyValue("name","")}set name(e){this.setPropertyValue("name",e)}get expression(){return this.getPropertyValue("expression","")}set expression(e){this.setPropertyValue("expression",e)}canBeExecuted(e){return!0}canBeExecutedOnComplete(){return!1}checkExpression(e){this.isExecutingOnNextPage=e.isOnNextPage,this.isExecutingOnNavigation=e.isOnNavigation||e.isOnNextPage,this.canBeExecuted(e.isOnNextPage)&&(!e.isOnComplete||this.canBeExecutedOnComplete())&&this.isCheckRequired(e.keys)&&(this.conditionRunner?this.perform(e.values,e.properties||null):this.canSuccessOnEmptyExpression()&&this.triggerResult(!0,e.values,e.properties||null))}canSuccessOnEmptyExpression(){return!1}check(e){ri.operators[this.operator](e,this.value)?this.onSuccess({},null):this.onFailure()}get requireValidQuestion(){return!1}perform(e,t){this.conditionRunner.onRunComplete=s=>{this.triggerResult(s,e,t)},this.conditionRunner.run(e,t)}triggerResult(e,t,s){e?(this.onSuccess(t,s),this.onSuccessExecuted()):this.onFailure()}onSuccess(e,t){}onFailure(){}onSuccessExecuted(){}endLoadingFromJson(){super.endLoadingFromJson(),this.oldPropertiesChanged()}oldPropertiesChanged(){this.onExpressionChanged()}onExpressionChanged(){this.conditionRunner=null}buildExpression(){return!this.name||this.isValueEmpty(this.value)&&this.isRequireValue?"":"{"+this.name+"} "+this.operator+" "+ee.toOperandString(this.value)}isCheckRequired(e){return!!e&&(this.createConditionRunner(),!!this.conditionRunner&&!0===this.conditionRunner.hasFunction()||new A().isAnyKeyChanged(e,this.getUsedVariables()))}getUsedVariables(){if(!this.conditionRunner)return[];let e=this.conditionRunner.getVariables();if(Array.isArray(e)){let t="-unwrapped";for(let s=e.length-1;s>=0;s--){let i=e[s];i.endsWith(t)&&e.push(i.substring(0,i.length-t.length))}}return e}createConditionRunner(){if(!this.conditionRunner){var e=this.expression;e||(e=this.buildExpression()),e&&(this.conditionRunner=new el(e))}}get isRequireValue(){return"empty"!==this.operator&&"notempty"!=this.operator}}ri.idCounter=1,ri.operatorsValue=null;class rr extends ri{constructor(){super(),this.ownerValue=null}get owner(){return this.ownerValue}setOwner(e){this.ownerValue=e}getSurvey(e=!1){return this.owner&&this.owner.getSurvey?this.owner.getSurvey():null}isRealExecution(){return!0}onSuccessExecuted(){this.owner&&this.isRealExecution()&&this.owner.triggerExecuted(this)}}class rn extends rr{constructor(){super(),this.pages=[],this.questions=[]}getType(){return"visibletrigger"}onSuccess(e,t){this.onTrigger(this.onItemSuccess)}onFailure(){this.onTrigger(this.onItemFailure)}onTrigger(e){if(this.owner)for(var t=this.owner.getObjects(this.pages,this.questions),s=0;s<t.length;s++)e(t[s])}onItemSuccess(e){e.visible=!0}onItemFailure(e){e.visible=!1}}class ra extends rr{constructor(){super()}getType(){return"completetrigger"}get requireValidQuestion(){return!0}isRealExecution(){return!tp.triggers.executeCompleteOnValueChanged===this.isExecutingOnNavigation}onSuccess(e,t){this.owner&&(this.isRealExecution()?this.owner.setCompleted(this):this.owner.canBeCompleted(this,!0))}onFailure(){this.owner.canBeCompleted(this,!1)}}class ro extends rr{constructor(){super()}getType(){return"setvaluetrigger"}canBeExecuted(e){return!e&&!!this.setToName}onPropertyValueChanged(e,t,s){if(super.onPropertyValueChanged(e,t,s),"setToName"===e){var i=this.getSurvey();i&&!i.isLoadingFromJson&&i.isDesignMode&&(this.setValue=void 0)}}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get setValue(){return this.getPropertyValue("setValue")}set setValue(e){this.setPropertyValue("setValue",e)}get isVariable(){return this.getPropertyValue("isVariable")}set isVariable(e){this.setPropertyValue("isVariable",e)}onSuccess(e,t){this.setToName&&this.owner&&this.owner.setTriggerValue(this.setToName,this.setValue,this.isVariable)}}class rl extends rr{constructor(){super()}getType(){return"skiptrigger"}get requireValidQuestion(){return this.canBeExecuted(!1)}get gotoName(){return this.getPropertyValue("gotoName","")}set gotoName(e){this.setPropertyValue("gotoName",e)}canBeExecuted(e){return!tp.triggers.executeSkipOnValueChanged===e}onSuccess(e,t){this.gotoName&&this.owner&&this.owner.focusQuestion(this.gotoName)}}class rh extends rr{constructor(){super()}getType(){return"runexpressiontrigger"}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get runExpression(){return this.getPropertyValue("runExpression","")}set runExpression(e){this.setPropertyValue("runExpression",e)}canBeExecuted(e){return!e}onSuccess(e,t){if(this.owner&&this.runExpression){var s=new eh(this.runExpression);s.canRun&&(s.onRunComplete=e=>{this.onCompleteRunExpression(e)},s.run(e,t))}}onCompleteRunExpression(e){this.setToName&&void 0!==e&&this.owner.setTriggerValue(this.setToName,a.convertValToQuestionVal(e),!1)}}class ru extends rr{constructor(){super()}canBeExecuted(e){return!e&&!!this.setToName&&!!this.fromName}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get fromName(){return this.getPropertyValue("fromName","")}set fromName(e){this.setPropertyValue("fromName",e)}get copyDisplayValue(){return this.getPropertyValue("copyDisplayValue")}set copyDisplayValue(e){this.setPropertyValue("copyDisplayValue",e)}getType(){return"copyvaluetrigger"}onSuccess(e,t){this.setToName&&this.owner&&this.owner.copyTriggerValue(this.setToName,this.fromName,this.copyDisplayValue)}canSuccessOnEmptyExpression(){return!0}getUsedVariables(){let e=super.getUsedVariables();return 0===e.length&&this.fromName&&e.push(this.fromName),e}}E.addClass("trigger",[{name:"operator",default:"equal",visible:!1},{name:"value",visible:!1},"expression:condition"]),E.addClass("surveytrigger",[{name:"name",visible:!1}],null,"trigger"),E.addClass("visibletrigger",["pages:pages","questions:questions"],function(){return new rn},"surveytrigger"),E.addClass("completetrigger",[],function(){return new ra},"surveytrigger"),E.addClass("setvaluetrigger",[{name:"!setToName:questionvalue"},{name:"setValue:triggervalue",dependsOn:"setToName",visibleIf:function(e){return!!e&&!!e.setToName}},{name:"isVariable:boolean",visible:!1}],function(){return new ro},"surveytrigger"),E.addClass("copyvaluetrigger",[{name:"!fromName:questionvalue"},{name:"!setToName:questionvalue"},{name:"copyDisplayValue:boolean",visible:!1}],function(){return new ru},"surveytrigger"),E.addClass("skiptrigger",[{name:"!gotoName:question"}],function(){return new rl},"surveytrigger"),E.addClass("runexpressiontrigger",[{name:"setToName:questionvalue"},"runExpression:expression"],function(){return new rh},"surveytrigger");class rd extends eg{constructor(e,t=null){super(),this.closeOnCompleteTimeout=0,t?this.surveyValue=t:this.surveyValue=this.createSurvey(e),this.surveyValue.fitToContainer=!0,this.windowElement=r.createElement("div"),this.survey.onComplete.add((e,t)=>{this.onSurveyComplete()}),this.registerPropertyChangedHandlers(["isShowing"],()=>{this.showingChangedCallback&&this.showingChangedCallback()}),this.registerPropertyChangedHandlers(["isExpanded"],()=>{this.onExpandedChanged()}),this.width=new ec(()=>this.survey.width),this.width=this.survey.width,this.updateCss(),this.onCreating()}onCreating(){}getType(){return"popupsurvey"}get survey(){return this.surveyValue}get isShowing(){return this.getPropertyValue("isShowing",!1)}set isShowing(e){this.setPropertyValue("isShowing",e)}get isFullScreen(){return this.getPropertyValue("isFullScreen",!1)}set isFullScreen(e){!this.isExpanded&&e&&(this.isExpanded=!0),this.setPropertyValue("isFullScreen",e),this.setCssRoot()}show(){this.isShowing=!0}hide(){this.isShowing=!1}toggleFullScreen(){this.isFullScreen=!this.isFullScreen}get isExpanded(){return this.getPropertyValue("isExpanded",!1)}set isExpanded(e){this.isFullScreen&&!e&&(this.isFullScreen=!1),this.setPropertyValue("isExpanded",e)}get isCollapsed(){return!this.isExpanded}onExpandedChanged(){this.expandedChangedCallback&&this.expandedChangedCallback(),this.updateCssButton()}get title(){return this.survey.title}set title(e){this.survey.title=e}get locTitle(){return this.survey.locTitle.isEmpty?null:this.survey.locTitle}get locDescription(){return this.survey.locTitle.isEmpty?null:this.survey.locDescription}expand(){this.isExpanded=!0}collapse(){this.isExpanded=!1}changeExpandCollapse(){this.isExpanded=!this.isExpanded}get allowClose(){return this.getPropertyValue("allowClose",!1)}set allowClose(e){this.setPropertyValue("allowClose",e)}get allowFullScreen(){return this.getPropertyValue("allowFullScreen",!1)}set allowFullScreen(e){this.setPropertyValue("allowFullScreen",e)}get css(){return this.survey.css}get cssButton(){return this.getPropertyValue("cssButton","")}get cssRoot(){let e=this.getPropertyValue("cssRoot","");return this.isCollapsed&&(e+=" "+this.getPropertyValue("cssRootCollapsedMod","")),e}get cssRootCollapsedMod(){return this.getPropertyValue("cssRootCollapsedMod")}get cssRootContent(){return this.getPropertyValue("cssRootContent")}get cssBody(){return this.getPropertyValue("cssBody","")}get cssHeaderRoot(){return this.getPropertyValue("cssHeaderRoot","")}get cssHeaderTitleCollapsed(){return this.getPropertyValue("cssHeaderTitleCollapsed","")}get cssHeaderButtonsContainer(){return this.getPropertyValue("cssHeaderButtonsContainer","")}get cssHeaderCollapseButton(){return this.getPropertyValue("cssHeaderCollapseButton","")}get cssHeaderCloseButton(){return this.getPropertyValue("cssHeaderCloseButton","")}get cssHeaderFullScreenButton(){return this.getPropertyValue("cssHeaderFullScreenButton","")}get renderedWidth(){let e=this.getPropertyValue("width","60%");return e&&!isNaN(e)&&(e+="px"),e}updateCss(){if(!this.css||!this.css.window)return;let e=this.css.window;this.setCssRoot(),this.setPropertyValue("cssRootCollapsedMod",e.rootCollapsedMod),this.setPropertyValue("cssRootContent",e.rootContent),this.setPropertyValue("cssBody",e.body);let t=e.header;t&&(this.setPropertyValue("cssHeaderRoot",t.root),this.setPropertyValue("cssHeaderTitleCollapsed",t.titleCollapsed),this.setPropertyValue("cssHeaderButtonsContainer",t.buttonsContainer),this.setPropertyValue("cssHeaderCollapseButton",t.collapseButton),this.setPropertyValue("cssHeaderCloseButton",t.closeButton),this.setPropertyValue("cssHeaderFullScreenButton",t.fullScreenButton),this.updateCssButton())}setCssRoot(){let e=this.css.window;this.isFullScreen?this.setPropertyValue("cssRoot",e.root+" "+e.rootFullScreenMode):this.setPropertyValue("cssRoot",e.root)}updateCssButton(){let e=this.css.window?this.css.window.header:null;e&&this.setCssButton(this.isExpanded?e.buttonExpanded:e.buttonCollapsed)}setCssButton(e){e&&this.setPropertyValue("cssButton",e)}createSurvey(e){return new sZ(e)}onSurveyComplete(){if(!(this.closeOnCompleteTimeout<0)){if(0==this.closeOnCompleteTimeout)this.hide();else{var e=this,t=null;t=setInterval(function(){e.hide(),clearInterval(t)},1e3*this.closeOnCompleteTimeout)}}}onScroll(){this.survey.onScroll()}}ey([c()],rd.prototype,"width",void 0);class rc extends s9{getStyleClass(){return super.getStyleClass().append("sv-popup--modal",!this.isOverlay)}getShowFooter(){return!0}createFooterActionBar(){super.createFooterActionBar(),this.footerToolbar.containerCss="sv-footer-action-bar",this.footerToolbarValue.addAction({id:"apply",visibleIndex:20,title:this.applyButtonText,innerCss:"sv-popup__body-footer-item sv-popup__button sv-popup__button--apply sd-btn sd-btn--action",action:()=>{this.apply()}})}constructor(e){super(e),this.onScrollOutsideCallback=e=>{this.preventScrollOuside(e,e.deltaY)}}get applyButtonText(){return this.getLocalizationString("modalApplyButtonText")}apply(){(!this.model.onApply||this.model.onApply())&&this.hidePopup()}clickOutside(){}onKeyDown(e){("Escape"===e.key||27===e.keyCode)&&this.model.onCancel(),super.onKeyDown(e)}updateOnShowing(){this.container&&this.container.addEventListener("wheel",this.onScrollOutsideCallback,{passive:!1}),super.updateOnShowing()}updateOnHiding(){this.container&&this.container.removeEventListener("wheel",this.onScrollOutsideCallback),super.updateOnHiding()}}function rg(e,t){var s;let i=Object.assign({},e);i.verticalPosition="top",i.horizontalPosition="left",i.showPointer=!1,i.isModal=!0,i.displayMode=e.displayMode||"popup";let n=new eI(e.componentName,e.data,i);n.isFocusedContent=null===(s=e.isFocusedContent)||void 0===s||s;let a=new rc(n);if(t&&t.appendChild){var o=r.createElement("div");t.appendChild(o),a.setComponentElement(o)}a.container||a.initializePopupContainer();let l=(e,t)=>{!t.isVisible&&o&&a.resetComponentElement(),a.onVisibilityChanged.remove(l)};return a.onVisibilityChanged.add(l),a}function rp(e){return e.isModal?new rc(e):new s7(e)}class rm extends tJ{constructor(e,t=null,s="buttongroupitemvalue"){super(e,t,s),this.typeName=s}getType(){return this.typeName?this.typeName:"buttongroupitemvalue"}}ey([c()],rm.prototype,"iconName",void 0),ey([c()],rm.prototype,"iconSize",void 0),ey([c()],rm.prototype,"showCaption",void 0);class rv extends s2{constructor(e){super(e)}getType(){return"buttongroup"}getItemValueType(){return"buttongroupitemvalue"}supportOther(){return!1}}E.addClass("buttongroup",[{name:"choices:buttongroupitemvalue[]"}],function(){return new rv("")},"checkboxbase"),E.addClass("buttongroupitemvalue",[{name:"showCaption:boolean",default:!0},{name:"iconName:text"},{name:"iconSize:number"}],e=>new rm(e),"itemvalue");class ry{constructor(e,t,s){this.question=e,this.item=t,this.index=s}get value(){return this.item.value}get iconName(){return this.item.iconName}get iconSize(){return this.item.iconSize||24}get caption(){return this.item.locText}get showCaption(){return this.item.showCaption||void 0===this.item.showCaption}get isRequired(){return this.question.isRequired}get selected(){return this.question.isItemSelected(this.item)}get readOnly(){return this.question.isInputReadOnly||!this.item.isEnabled}get name(){return this.question.name+"_"+this.question.id}get id(){return this.question.inputId+"_"+this.index}get hasErrors(){return this.question.errors.length>0}get describedBy(){return this.question.errors.length>0?this.question.id+"_errors":null}get labelClass(){return new eV().append(this.question.cssClasses.item).append(this.question.cssClasses.itemSelected,this.selected).append(this.question.cssClasses.itemHover,!this.readOnly&&!this.selected).append(this.question.cssClasses.itemDisabled,this.question.isReadOnly||!this.item.isEnabled).toString()}get css(){return{label:this.labelClass,icon:this.question.cssClasses.itemIcon,control:this.question.cssClasses.itemControl,caption:this.question.cssClasses.itemCaption,decorator:this.question.cssClasses.itemDecorator}}onChange(){this.question.renderedValue=this.item.value}}class rC extends eg{getSurvey(e=!1){return this.owner}getType(){return"masksettings"}setData(e){E.getProperties(this.getType()).forEach(t=>{let s=e[t.name];this[t.name]=void 0!==s?s:t.getDefaultValue(this)})}getData(){let e={};return E.getProperties(this.getType()).forEach(t=>{let s=this[t.name];t.isDefaultValue(s)||(e[t.name]=s)}),e}processInput(e){return{value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1}}getUnmaskedValue(e){return e}getMaskedValue(e){return e}getTextAlignment(){return"auto"}getTypeForExpressions(){return"text"}}function rf(e){let t=[],s=!1,i=Object.keys(tp.maskSettings.patternDefinitions);for(let r=0;r<e.length;r++){let n=e[r];n===tp.maskSettings.patternEscapeChar?s=!0:s?(s=!1,t.push({type:"fixed",value:n})):t.push({type:-1!==i.indexOf(n)?"regex":"const",value:n})}return t}function rb(e,t,s,i=!1){let r="";if(!e)return r;let n="string"==typeof t?rf(t):t;for(let t=0;t<n.length;t++)if("fixed"!==n[t].type||i||(r+=n[t].value),"regex"===n[t].type){let i=tp.maskSettings.patternDefinitions[n[t].value];if(e[t]&&e[t].match(i))r+=e[t];else if(s){r="";break}else break}return r}ey([c()],rC.prototype,"saveMaskedValue",void 0),E.addClass("masksettings",[{name:"saveMaskedValue:boolean",visibleIf:function(e){return!!e&&"masksettings"!==e.getType()}}],function(){return new rC});class rV extends rC{constructor(){super(...arguments),this.literals=[]}updateLiterals(){this.literals=rf(this.pattern||"")}onPropertyValueChanged(e,t,s){"pattern"===e&&this.updateLiterals()}getType(){return"patternmask"}fromJSON(e,t){super.fromJSON(e,t),this.updateLiterals()}_getMaskedValue(e,t=!1){return function(e,t,s){let i=null==e?"":e,r="",n=0,a="string"==typeof t?rf(t):t;for(let e=0;e<a.length;e++)switch(a[e].type){case"regex":if(n<i.length&&(n=function(e,t,s){let i=tp.maskSettings.patternDefinitions[s.value];for(;t<e.length&&!e[t].match(i);)t++;return t}(i,n,a[e])),n<i.length)r+=i[n];else{if(!s)return r;r+=tp.maskSettings.patternPlaceholderChar}n++;break;case"const":case"fixed":r+=a[e].value,a[e].value===i[n]&&n++}return r}(null==e?"":e,this.literals,t)}_getUnmaskedValue(e,t=!1){return rb(null==e?"":e,this.literals,t)}processInput(e){let t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1};if(!e.insertedChars&&e.selectionStart===e.selectionEnd)return t;let s=e.prevValue.slice(0,e.selectionStart)+(e.insertedChars||""),i=rb(e.prevValue.slice(0,e.selectionStart),this.literals.slice(0,e.selectionStart),!1),r=rb(e.prevValue.slice(e.selectionEnd),this.literals.slice(e.selectionEnd),!1,!0);return t.value=this._getMaskedValue(i+(e.insertedChars||"")+r,!0),e.insertedChars||"backward"!==e.inputDirection?t.caretPosition=this._getMaskedValue(s).length:t.caretPosition=e.selectionStart,t}getMaskedValue(e){return this._getMaskedValue(e,!0)}getUnmaskedValue(e){return this._getUnmaskedValue(e,!0)}}ey([c()],rV.prototype,"pattern",void 0),E.addClass("patternmask",[{name:"pattern"}],function(){return new rV},"masksettings");class rw extends rC{calccaretPosition(e,t,s){let i=e?this.displayNumber(this.parseNumber(e),!1).length:0,r=0,n=t.selectionStart,a=!t.insertedChars&&"forward"===t.inputDirection;for(let e=0;e<s.length;e++)if(s[e]!==this.thousandsSeparator&&r++,r===i+ +!!a){n=a?e:e+1;break}return n}numericalCompositionIsEmpty(e){return!e.integralPart&&!e.fractionalPart}displayNumber(e,t=!0,s=!1){let i=e.integralPart;t&&i&&(i=(function(e,t=!0,s=3){let i=[];if(t){for(let t=e.length-s;t>-s;t-=s)i.push(e.substring(t,t+s));i=i.reverse()}else for(let t=0;t<e.length;t+=s)i.push(e.substring(t,t+s));return i})(i).join(this.thousandsSeparator));let r=e.fractionalPart,n=e.isNegative?"-":"";if(""!==r)return[n+(i=i||"0"),r=r.substring(0,this.precision)].join(this.decimalSeparator);if(s)return i&&"0"!==i?n+i:i;{let t=i+(e.hasDecimalSeparator&&!s?this.decimalSeparator:"");return"0"===t?t:n+t}}convertNumber(e){let t;let s=e.isNegative?"-":"";return e.fractionalPart?parseFloat(s+(e.integralPart||"0")+"."+e.fractionalPart.substring(0,this.precision)):parseInt(s+e.integralPart||"0")}validateNumber(e,t){let s=this.min||Number.MIN_SAFE_INTEGER,i=this.max||Number.MAX_SAFE_INTEGER;if(this.numericalCompositionIsEmpty(e))return!0;if(void 0!==this.min||void 0!==this.max){let r=this.convertNumber(e);if(Number.isNaN(r)||r>=s&&r<=i)return!0;if(!t){if(e.hasDecimalSeparator||0==r){let t=Math.pow(.1,(e.fractionalPart||"").length);if(r>=0)return r+t>s&&r<=i;if(r<0)return r>=s&&r-t<i}else{let e=r,t=r;if(r>0){if(r+1>s&&r<=i)return!0;for(;e=10*e+9,!((t*=10)>i);)if(e>s)return!0;return!1}if(r<0){if(r>=s&&r-1<i)return!0;for(;t=10*t-9,!((e*=10)<s);)if(t<i)return!0;return!1}}return r>=0&&r<=i||r<0&&r>=s}return!1}return!0}parseNumber(e){let t={integralPart:"",fractionalPart:"",hasDecimalSeparator:!1,isNegative:!1},s=null==e?"":e.toString(),i=0;for(let e=0;e<s.length;e++){let r=s[e];switch(r){case"-":this.allowNegativeValues&&(void 0===this.min||this.min<0)&&i++;break;case this.decimalSeparator:this.precision>0&&(t.hasDecimalSeparator=!0);break;case this.thousandsSeparator:break;default:r.match(ih)&&(t.hasDecimalSeparator?t.fractionalPart+=r:t.integralPart+=r)}}return t.isNegative=i%2!=0,t.integralPart.length>1&&"0"===t.integralPart[0]&&(t.integralPart=t.integralPart.slice(1)),t}getNumberMaskedValue(e,t=!1){let s=this.parseNumber(e);return this.validateNumber(s,t)?this.displayNumber(s,!0,t):null}getNumberUnmaskedValue(e){let t=this.parseNumber(e);if(!this.numericalCompositionIsEmpty(t))return this.convertNumber(t)}getTextAlignment(){return"right"}getMaskedValue(e){let t=null==e?"":e.toString();return t=t.replace(".",this.decimalSeparator),this.getNumberMaskedValue(t,!0)}getUnmaskedValue(e){return this.getNumberUnmaskedValue(e)}processInput(e){let t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1},s=e.prevValue.slice(0,e.selectionStart)+(e.insertedChars||""),i=s+e.prevValue.slice(e.selectionEnd),r=this.parseNumber(i);if(!this.validateNumber(r,!1))return t;let n=this.getNumberMaskedValue(i),a=this.calccaretPosition(s,e,n);return t.value=n,t.caretPosition=a,t}getType(){return"numericmask"}isValueUndefined(e){return""===e||super.isValueUndefined(e)}}function rx(e,t){switch(e){case"hour":case"minute":case"second":case"day":case"month":return 2;case"timeMarker":case"year":return t;default:return 1}}ey([c()],rw.prototype,"allowNegativeValues",void 0),ey([c()],rw.prototype,"decimalSeparator",void 0),ey([c()],rw.prototype,"precision",void 0),ey([c()],rw.prototype,"thousandsSeparator",void 0),ey([c()],rw.prototype,"min",void 0),ey([c()],rw.prototype,"max",void 0),E.addClass("numericmask",[{name:"allowNegativeValues:boolean",default:!0},{name:"decimalSeparator",default:".",maxLength:1},{name:"thousandsSeparator",default:",",maxLength:1},{name:"precision:number",default:2,minValue:0},{name:"min:number"},{name:"max:number"}],function(){return new rw},"masksettings");class rP extends rV{constructor(){super(...arguments),this.defaultDate="1970-01-01T",this.turnOfTheCentury=68,this.twelve=12,this.lexems=[],this.inputDateTimeData=[],this.validBeginningOfNumbers={hour:1,hourU:2,minute:5,second:5,day:3,month:1}}get hasDatePart(){return this.lexems.some(e=>"day"===e.type||"month"===e.type||"year"===e.type)}get hasTimePart(){return this.lexems.some(e=>"hour"===e.type||"minute"===e.type||"second"===e.type)}get is12Hours(){return this.lexems.filter(e=>"hour"===e.type&&!e.upperCase).length>0}getType(){return"datetimemask"}getTypeForExpressions(){return this.hasTimePart?"datetime-local":"datetime"}updateLiterals(){this.lexems=function(e){let t;let s=[],i=(e,i,r=!1)=>{if(t&&t===e){s[s.length-1].count++;let t=rx(e,s[s.length-1].count);s[s.length-1].maxCount=t}else{let t=rx(e,1);s.push({type:e,value:i,count:1,maxCount:t,upperCase:r})}};for(let r=0;r<e.length;r++){let n=e[r];switch(n){case"m":i("month",n);break;case"d":i("day",n);break;case"y":i("year",n);break;case"h":i("hour",n,!1);break;case"H":i("hour",n,!0);break;case"M":i("minute",n);break;case"s":i("second",n);break;case"t":i("timeMarker",n);break;case"T":i("timeMarker",n,!0);break;default:s.push({type:"separator",value:n,count:1,maxCount:1,upperCase:!1})}t=s[s.length-1].type}return s}(this.pattern||"")}leaveOnlyNumbers(e){let t="";for(let s=0;s<e.length;s++)e[s].match(ih)&&(t+=e[s]);return t}getMaskedStrFromISO(e){let t=new Date(e);return this.initInputDateTimeData(),this.hasTimePart||(t=new Date(e+"T00:00:00")),this.hasDatePart||(t=new Date(this.defaultDate+e)),isNaN(t)||this.lexems.forEach((e,s)=>{let i=this.inputDateTimeData[s];switch(i.isCompleted=!0,e.type){case"hour":this.is12Hours?i.value=((t.getHours()-1)%this.twelve+1).toString():i.value=t.getHours().toString();break;case"minute":i.value=t.getMinutes().toString();break;case"second":i.value=t.getSeconds().toString();break;case"timeMarker":{let s=t.getHours()>=this.twelve?"pm":"am";i.value=e.upperCase?s.toUpperCase():s;break}case"day":i.value=t.getDate().toString();break;case"month":i.value=(t.getMonth()+1).toString();break;case"year":{let s=t.getFullYear();2==e.count&&(s%=100),i.value=s.toString()}}}),this.getFormatedString(!0)}initInputDateTimeData(){this.inputDateTimeData=[],this.lexems.forEach(e=>{this.inputDateTimeData.push({lexem:e,isCompleted:!1,value:void 0})})}getISO_8601Format(e){let t=[],s=[];if(void 0!==e.year){let s=this.getPlaceholder(4,e.year.toString(),"0")+e.year;t.push(s)}if(void 0!==e.month&&void 0!==e.year){let s=this.getPlaceholder(2,e.month.toString(),"0")+e.month;t.push(s)}if(void 0!==e.day&&void 0!==e.month&&void 0!==e.year){let s=this.getPlaceholder(2,e.day.toString(),"0")+e.day;t.push(s)}if(void 0!==e.hour){let t=this.getPlaceholder(2,e.hour.toString(),"0")+e.hour;s.push(t)}if(void 0!==e.minute&&void 0!==e.hour){let t=this.getPlaceholder(2,e.minute.toString(),"0")+e.minute;s.push(t)}if(void 0!==e.second&&void 0!==e.minute&&void 0!==e.hour){let t=this.getPlaceholder(2,e.second.toString(),"0")+e.second;s.push(t)}let i=[];return t.length>0&&i.push(t.join("-")),s.length>1&&i.push(s.join(":")),i.join("T")}isYearValid(e){if(void 0===e.min&&void 0===e.max)return!1;let t=e.year.toString(),s=e.min.toISOString().slice(0,t.length),i=e.max.toISOString().slice(0,t.length);return e.year>=parseInt(s)&&e.year<=parseInt(i)}createIDateTimeCompositionWithDefaults(e,t){let s=29==e.day&&2==e.month,i=e.min.getFullYear(),r=e.max.getFullYear();s&&(r=4*Math.floor((i=4*Math.ceil(i/4))/4),i>r&&(i=void 0,r=void 0));let n=void 0!==e.year?e.year:t?r:i,a=void 0!==e.month?e.month:t&&this.hasDatePart?12:1,o=void 0!==e.day?e.day:t&&this.hasDatePart?this.getMaxDateForMonth(n,a):1,l=void 0!==e.hour?e.hour:23*!!t;return{year:n,month:a,day:o,hour:l,minute:void 0!==e.minute?e.minute:59*!!t,second:void 0!==e.second?e.second:59*!!t}}getMaxDateForMonth(e,t){return 2==t?e%4==0&&e%100!=0||e%400?29:28:[31,28,31,30,31,30,31,31,30,31,30,31][t-1]}isDateValid(e){let t=new Date(this.getISO_8601Format(this.createIDateTimeCompositionWithDefaults(e,!1))),s=new Date(this.getISO_8601Format(this.createIDateTimeCompositionWithDefaults(e,!0)));return!isNaN(t)&&(t.getDate()===e.day||void 0===e.day)&&(t.getMonth()===e.month-1||void 0===e.month)&&(t.getFullYear()===e.year||void 0===e.year)&&s>=e.min&&t<=e.max}getPlaceholder(e,t,s){let i=e-(t||"").length;return i>0?s.repeat(i):""}isDateValid12(e){if(!this.is12Hours)return this.isDateValid(e);if(this.is12Hours&&e.hour>this.twelve)return!1;if(e.timeMarker)return"p"===e.timeMarker[0].toLowerCase()?(e.hour!==this.twelve&&(e.hour+=this.twelve),this.isDateValid(e)):(e.hour===this.twelve&&(e.hour=0),this.isDateValid(e));return!!this.isDateValid(e)||(e.hour+=this.twelve,this.isDateValid(e))}updateTimeMarkerInputDateTimeData(e,t){let s=e.value;if(!s)return;let i="timeMarker",r=Object.assign({},t);r[i]=s,this.isDateValid12(r)?e.isCompleted=!0:s=s.slice(0,s.length-1),e.value=s||void 0,t[i]=s||void 0}updateInputDateTimeData(e,t){let s=e.value;if(!s)return;let i=e.lexem.type,r=Object.assign({},t);if(r[i]=parseInt(this.parseTwoDigitYear(e)),s.length===e.lexem.maxCount){if(this.isDateValid12(r)){e.isCompleted=!0,e.value=s||void 0,t[i]=parseInt(s)>0?parseInt(s):void 0;return}s=s.slice(0,s.length-1)}r[i]=parseInt(s);let n=parseInt(s[0]),a=this.validBeginningOfNumbers[i+(e.lexem.upperCase?"U":"")];"year"!==i||this.isYearValid(r)?void 0!==a&&n>a?this.isDateValid12(r)?e.isCompleted=!0:s=s.slice(0,s.length-1):void 0!==a&&0!==n&&n<=a&&(this.checkValidationDateTimePart(r,i,e),e.isCompleted&&!this.isDateValid12(r)&&(s=s.slice(0,s.length-1))):(s=s.slice(0,s.length-1),e.isCompleted=!1),e.value=s||void 0,t[i]=parseInt(s)>0?parseInt(s):void 0}checkValidationDateTimePart(e,t,s){let i=e[t],r=10*i,n=10;"month"===t&&(n=3),"hour"===t&&(n=this.is12Hours?3:5),s.isCompleted=!0;for(let i=0;i<n;i++)if(e[t]=r+i,this.isDateValid12(e)){s.isCompleted=!1;break}e[t]=i}getCorrectDatePartFormat(e,t){let s=e.lexem,i=e.value||"";if(i&&"timeMarker"===s.type)return t&&(i+=this.getPlaceholder(s.count,i,s.value)),i;if(i&&e.isCompleted&&(i=parseInt(i).toString()),i&&e.isCompleted)i=this.getPlaceholder(s.count,i,"0")+i;else{var r;let e;e=r=i,s.count<s.maxCount&&("day"===s.type&&0===parseInt(r[0])||"month"===s.type&&0===parseInt(r[0]))&&(e=r.slice(1,r.length)),i=e,t&&(i+=this.getPlaceholder(s.count,i,s.value))}return i}createIDateTimeComposition(){let e,t;return this.hasDatePart?(e=this.min||"0001-01-01",t=this.max||"9999-12-31"):(e=this.defaultDate+(this.min||"00:00:00"),t=this.defaultDate+(this.max||"23:59:59")),{hour:void 0,minute:void 0,second:void 0,day:void 0,month:void 0,year:void 0,min:new Date(e),max:new Date(t)}}parseTwoDigitYear(e){let t=e.value;return"year"!==e.lexem.type||e.lexem.count>2?t:(this.max&&this.max.length>=4&&(this.turnOfTheCentury=parseInt(this.max.slice(2,4))),(parseInt(t)>this.turnOfTheCentury?"19":"20")+t)}getFormatedString(e){let t="",s="",i=!1,r=this.inputDateTimeData.length-1;if(!e){let e=this.inputDateTimeData.filter(e=>!!e.value);r=this.inputDateTimeData.indexOf(e[e.length-1])}for(let n=0;n<this.inputDateTimeData.length;n++){let a=this.inputDateTimeData[n];switch(a.lexem.type){case"timeMarker":case"hour":case"minute":case"second":case"day":case"month":case"year":if(void 0===a.value&&!e)return t+(i?s:"");{let o=e||r>n;t+=s+this.getCorrectDatePartFormat(a,o),i=a.isCompleted}break;case"separator":s=a.lexem.value}}return t}cleanTimeMarker(e,t){let s="";e=e.toUpperCase();for(let t=0;t<e.length;t++)(!s&&("P"==e[t]||"A"==e[t])||s&&"M"==e[t])&&(s+=e[t]);return t?s.toUpperCase():s.toLowerCase()}setInputDateTimeData(e){let t=0;this.initInputDateTimeData(),this.lexems.forEach((s,i)=>{if(e.length>0&&t<e.length){let r;if("separator"===s.type)return;let n=this.inputDateTimeData[i],a=e[t];n.value=("timeMarker"===s.type?this.cleanTimeMarker(a,s.upperCase):this.leaveOnlyNumbers(a)).slice(0,s.maxCount),t++}})}_getMaskedValue(e,t=!0){let s=null==e?"":e.toString(),i=this.getParts(s);this.setInputDateTimeData(i);let r=this.createIDateTimeComposition();return this.inputDateTimeData.forEach(e=>{"timeMarker"===e.lexem.type?this.updateTimeMarkerInputDateTimeData(e,r):this.updateInputDateTimeData(e,r)}),this.getFormatedString(t)}getParts(e){let t=[],s=this.lexems.filter(e=>"separator"!==e.type),i=this.lexems.filter(e=>"separator"===e.type).map(e=>e.value),r="",n=!1,a=!1;for(let o=0;o<e.length;o++){let l=e[o];if(l.match(ih)||l===s[t.length].value?(n=!1,a=!1,r+=l):"timeMarker"===s[t.length].type?(n=!1,a=!1,r+=l):-1!==i.indexOf(l)?a||(n=!0,t.push(r),r=""):n||(a=!0,t.push(r),r=""),t.length>=s.length){n=!1;break}}return(""!=r||n)&&t.push(r),t}getUnmaskedValue(e){var t;let s=null==e?"":e.toString(),i=this.getParts(s);this.setInputDateTimeData(i);let r=null===(t=this.inputDateTimeData.filter(e=>"timeMarker"===e.lexem.type)[0])||void 0===t?void 0:t.value.toLowerCase()[0],n=this.createIDateTimeComposition(),a=!1;return this.inputDateTimeData.forEach(e=>{let t=e.value;if("timeMarker"==e.lexem.type||"separator"==e.lexem.type)return;if(!t||t.length<e.lexem.count){a=!0;return}let s=parseInt(this.parseTwoDigitYear(e));"hour"==e.lexem.type&&"p"===r&&s!=this.twelve&&(s+=this.twelve),n[e.lexem.type]=s}),a?"":this.getISO_8601Format(n)}getMaskedValue(e){return this.getMaskedStrFromISO(e)}processInput(e){let t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1},s=e.prevValue.slice(0,e.selectionStart),i=e.prevValue.slice(e.selectionEnd);return t.value=this._getMaskedValue(s+(e.insertedChars||"")+i),e.insertedChars||"backward"!==e.inputDirection?t.caretPosition=this._getMaskedValue(s+(e.insertedChars||""),!1).length:t.caretPosition=e.selectionStart,t}}ey([c()],rP.prototype,"min",void 0),ey([c()],rP.prototype,"max",void 0),E.addClass("datetimemask",[{name:"min",type:"datetime",enableIf:e=>!!e.pattern},{name:"max",type:"datetime",enableIf:e=>!!e.pattern}],function(){return new rP},"patternmask");class rT extends rw{getType(){return"currencymask"}wrapText(e){let t=this.prefix||"",s=this.suffix||"",i=e;return i&&(-1===i.indexOf(t)&&(i=t+i),-1===i.indexOf(s)&&(i+=s)),i}unwrapInputArgs(e){let t=e.prevValue;if(t){if(this.prefix&&-1!==t.indexOf(this.prefix)){t=t.slice(t.indexOf(this.prefix)+this.prefix.length);let s=(this.prefix||"").length;e.selectionStart=Math.max(e.selectionStart-s,0),e.selectionEnd-=s}this.suffix&&-1!==t.indexOf(this.suffix)&&(t=t.slice(0,t.indexOf(this.suffix))),e.prevValue=t}}processInput(e){this.unwrapInputArgs(e);let t=super.processInput(e),s=(this.prefix||"").length;return t.value&&(t.caretPosition+=s),t.value=this.wrapText(t.value),t}getMaskedValue(e){let t=super.getMaskedValue(e);return this.wrapText(t)}}function rS(e,t){l!=e&&console.error("survey-core has version '"+l+"' and "+t+" has version '"+e+"'. SurveyJS libraries should have the same versions to work correctly.")}function rI(e){!function(e,t,s){if(!e)return;let r=(e=>{var t,s,i,r={},n=0,a=0,o="",l=String.fromCharCode,h=e.length;for(t=0;t<64;t++)r["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t)]=t;for(s=0;s<h;s++)for(n=(n<<6)+r[e.charAt(s)],a+=6;a>=8;)((i=n>>>(a-=8)&255)||s<h-2)&&(o+=l(i));return o})(e);if(!r)return;let n=r.indexOf(";");!(n<0)&&function(e){if(!e)return!0;let t="domains:",s=e.indexOf(t);if(s<0)return!0;let r=e.substring(s+t.length).toLowerCase().split(",");if(!Array.isArray(r)||0===r.length)return!0;let n=i.getLocation();if(n&&n.hostname){let e=n.hostname.toLowerCase();r.push("localhost");for(let t=0;t<r.length;t++)if(e.indexOf(r[t])>-1)return!0;return!1}return!0}(r.substring(0,n))&&(r=r.substring(n+1)).split(",").forEach(e=>{let i=e.indexOf("=");i>0&&(t[e.substring(0,i)]=new Date(s)<=new Date(e.substring(i+1)))})}(e,rR,"2025-03-07")}function rE(e){return!0===rR[e.toString()]}ey([c()],rT.prototype,"prefix",void 0),ey([c()],rT.prototype,"suffix",void 0),E.addClass("currencymask",[{name:"prefix"},{name:"suffix"}],()=>new rT,"numericmask"),tp.version=l="2.0.0";let rR={};class rA{constructor(){this.icons={},this.iconPrefix="icon-",this.onIconsChanged=new ev}processId(e,t){return 0==e.indexOf(t)&&(e=e.substring(t.length)),e=e1[e]||e}registerIconFromSymbol(e,t){this.icons[e]=t}registerIconFromSvgViaElement(e,t,s=this.iconPrefix){if(!r.isAvailable())return;e=this.processId(e,s);let i=r.createElement("div");i.innerHTML=t;let n=r.createElement("symbol"),a=i.querySelector("svg");n.innerHTML=a.innerHTML;for(var o=0;o<a.attributes.length;o++)n.setAttributeNS("http://www.w3.org/2000/svg",a.attributes[o].name,a.attributes[o].value);n.id=s+e,this.registerIconFromSymbol(e,n.outerHTML)}registerIconFromSvg(e,t,s=this.iconPrefix){e=this.processId(e,s);let i="<svg ",r="</svg>",n=(t=t.trim()).toLowerCase();return n.substring(0,i.length)===i&&n.substring(n.length-r.length,n.length)===r&&(this.registerIconFromSymbol(e,'<symbol id="'+s+e+'" '+t.substring(i.length,n.length-r.length)+"</symbol>"),!0)}registerIconsFromFolder(e){e.keys().forEach(t=>{this.registerIconFromSvg(t.substring(2,t.length-4).toLowerCase(),e(t))})}registerIcons(e){for(let t in e)this.registerIconFromSvg(t,e[t]);this.updateMarkup()}registerIcon(e,t,s="v2"){this.registerIconFromSvg(e,t),rL(s,{[e]:t})}iconsRenderedHtml(){return Object.keys(this.icons).map(e=>this.icons[e]).join("")}updateMarkup(){this.onIconsChanged.fire(this,{})}}let rD=new rA,rO={};function rL(e,t){rO[e]||(rO[e]={});let s=rO[e];for(let e in t)s[e]=t[e]}}}]);